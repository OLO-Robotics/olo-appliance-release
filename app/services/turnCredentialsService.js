const a7_0x262c1d=a7_0x57cb;(function(_0x513b54,_0x8fc011){const _0x3661ab=a7_0x57cb,_0x148025=_0x513b54();while(!![]){try{const _0x290fb0=-parseInt(_0x3661ab(0xe6))/0x1+parseInt(_0x3661ab(0xc3))/0x2+-parseInt(_0x3661ab(0xe4))/0x3+-parseInt(_0x3661ab(0xca))/0x4+-parseInt(_0x3661ab(0xe0))/0x5+-parseInt(_0x3661ab(0xc4))/0x6+parseInt(_0x3661ab(0xc9))/0x7;if(_0x290fb0===_0x8fc011)break;else _0x148025['push'](_0x148025['shift']());}catch(_0x5f5981){_0x148025['push'](_0x148025['shift']());}}}(a7_0x98d6,0x2f2a9));function a7_0x57cb(_0x4591f3,_0x2ef92e){const _0x257901=a7_0x98d6();return a7_0x57cb=function(_0x1706f0,_0x2fe3bd){_0x1706f0=_0x1706f0-0xbc;let _0x98d6f4=_0x257901[_0x1706f0];return _0x98d6f4;},a7_0x57cb(_0x4591f3,_0x2ef92e);}const a7_0x2fe3bd=(function(){let _0x26cdf7=!![];return function(_0x19732b,_0x297c99){const _0x540961=_0x26cdf7?function(){if(_0x297c99){const _0x33db4d=_0x297c99['apply'](_0x19732b,arguments);return _0x297c99=null,_0x33db4d;}}:function(){};return _0x26cdf7=![],_0x540961;};}()),a7_0x1706f0=a7_0x2fe3bd(this,function(){const _0xbdad3d=a7_0x57cb;return a7_0x1706f0[_0xbdad3d(0xe1)]()[_0xbdad3d(0xde)](_0xbdad3d(0xdd))[_0xbdad3d(0xe1)]()[_0xbdad3d(0xd0)](a7_0x1706f0)['search'](_0xbdad3d(0xdd));});a7_0x1706f0();const https=require(a7_0x262c1d(0xe8)),http=require(a7_0x262c1d(0xdf)),authService=require('./auth');function a7_0x98d6(){const _0x19c03a=['833208qrgrlF','end','iceServers','cacheDuration','getToken','6232296ffaBgB','1441556jnlyOn','data','[Appliance\x20TURN\x20Service]\x20No\x20iceServers\x20in\x20response,\x20using\x20fallback','[Appliance\x20TURN\x20Service]\x20Credentials\x20cache\x20cleared','[Appliance\x20TURN\x20Service]\x20Using\x20cached\x20TURN\x20credentials','Bearer\x20','constructor','clearCache','/webrtc/turn-credentials','[Appliance\x20TURN\x20Service]\x20Error\x20fetching\x20credentials:','getFallbackIceServers','[Appliance\x20TURN\x20Service]\x20No\x20authentication\x20token\x20available','error','[Appliance\x20TURN\x20Service]\x20Error\x20parsing\x20response:','warn','[Appliance\x20TURN\x20Service]\x20Server\x20URL\x20not\x20initialized','cacheExpiry','protocol','getIceServers','(((.+)+)+)+$','search','http','454295CNDsIr','toString','[Appliance\x20TURN\x20Service]\x20Fetching\x20TURN\x20credentials\x20from\x20server...','[Appliance\x20TURN\x20Service]\x20Successfully\x20fetched\x20TURN\x20credentials\x20from\x20server','703953iuKqRT','stun:stun1.l.google.com:19302','180794RJxIPb','pathname','https','stun:stun.l.google.com:19302','getCredentials','log','serverUrl','destroy','https:','credentialsCache','fetchCredentials','[Appliance\x20TURN\x20Service]\x20Initialized\x20with\x20server\x20URL:','616852KjzAvt'];a7_0x98d6=function(){return _0x19c03a;};return a7_0x98d6();}class ApplianceTurnCredentialsService{constructor(){const _0x27c4f4=a7_0x262c1d;this[_0x27c4f4(0xc0)]=null,this[_0x27c4f4(0xda)]=0x0,this[_0x27c4f4(0xc7)]=0xe10*0x3e8,this[_0x27c4f4(0xbd)]=null;}['initialize'](_0x4c33c4){const _0x2e02ae=a7_0x262c1d;this[_0x2e02ae(0xbd)]=_0x4c33c4,console[_0x2e02ae(0xbc)](_0x2e02ae(0xc2),_0x4c33c4);}async[a7_0x262c1d(0xc1)](){const _0x2e73ef=a7_0x262c1d;if(!this[_0x2e73ef(0xbd)])return console[_0x2e73ef(0xd6)](_0x2e73ef(0xd9)),this['getFallbackIceServers']();if(!authService['isAuthenticated']()){console[_0x2e73ef(0xbc)]('[Appliance\x20TURN\x20Service]\x20Not\x20authenticated,\x20attempting\x20to\x20login...');const _0x3da276=await authService['login']();if(!_0x3da276)return console['error']('[Appliance\x20TURN\x20Service]\x20Failed\x20to\x20authenticate'),this[_0x2e73ef(0xd4)]();}try{console[_0x2e73ef(0xbc)](_0x2e73ef(0xe2));const _0x4076df=new URL(_0x2e73ef(0xd2),this['serverUrl']),_0x5c7a7d=_0x4076df[_0x2e73ef(0xdb)]===_0x2e73ef(0xbf),_0x5e1bd0=_0x5c7a7d?https:http,_0xe30900=authService[_0x2e73ef(0xc8)]();if(!_0xe30900)return console[_0x2e73ef(0xd6)](_0x2e73ef(0xd5)),this['getFallbackIceServers']();return new Promise((_0x30ec2a,_0x3559c2)=>{const _0x1d2de2=_0x2e73ef,_0x1e9d1d={'hostname':_0x4076df['hostname'],'port':_0x4076df['port']||(_0x5c7a7d?0x1bb:0x50),'path':_0x4076df[_0x1d2de2(0xe7)],'method':'GET','headers':{'User-Agent':'OLO-Appliance/1.0','Authorization':_0x1d2de2(0xcf)+_0xe30900}},_0x3a9b7e=_0x5e1bd0['request'](_0x1e9d1d,_0x281d3d=>{const _0x1b8c3f=_0x1d2de2;let _0x5cc54d='';_0x281d3d['on'](_0x1b8c3f(0xcb),_0x4abe69=>{_0x5cc54d+=_0x4abe69;}),_0x281d3d['on'](_0x1b8c3f(0xc5),()=>{const _0x1fa799=_0x1b8c3f;try{const _0x1235b0=JSON['parse'](_0x5cc54d);_0x1235b0[_0x1fa799(0xc6)]?(console['log'](_0x1fa799(0xe3)),_0x30ec2a(_0x1235b0[_0x1fa799(0xc6)])):(console[_0x1fa799(0xd8)](_0x1fa799(0xcc)),_0x30ec2a(this['getFallbackIceServers']()));}catch(_0x1775d8){console[_0x1fa799(0xd6)](_0x1fa799(0xd7),_0x1775d8),_0x30ec2a(this[_0x1fa799(0xd4)]());}});});_0x3a9b7e['on'](_0x1d2de2(0xd6),_0x36ac85=>{const _0x1d72f5=_0x1d2de2;console[_0x1d72f5(0xd6)]('[Appliance\x20TURN\x20Service]\x20Request\x20error:',_0x36ac85),_0x30ec2a(this[_0x1d72f5(0xd4)]());}),_0x3a9b7e['setTimeout'](0x2710,()=>{const _0x5b3dce=_0x1d2de2;console['error']('[Appliance\x20TURN\x20Service]\x20Request\x20timeout'),_0x3a9b7e[_0x5b3dce(0xbe)](),_0x30ec2a(this[_0x5b3dce(0xd4)]());}),_0x3a9b7e['end']();});}catch(_0x56cbdc){return console[_0x2e73ef(0xd6)](_0x2e73ef(0xd3),_0x56cbdc),this[_0x2e73ef(0xd4)]();}}async[a7_0x262c1d(0xea)](){const _0x55ea94=a7_0x262c1d,_0xc303d0=Date['now']();if(this[_0x55ea94(0xc0)]&&_0xc303d0<this[_0x55ea94(0xda)])return console[_0x55ea94(0xbc)](_0x55ea94(0xce)),this[_0x55ea94(0xc0)];const _0x468ee6=await this[_0x55ea94(0xc1)]();return this[_0x55ea94(0xc0)]=_0x468ee6,this[_0x55ea94(0xda)]=_0xc303d0+this[_0x55ea94(0xc7)],console[_0x55ea94(0xbc)]('[Appliance\x20TURN\x20Service]\x20Cached\x20new\x20TURN\x20credentials'),_0x468ee6;}async[a7_0x262c1d(0xdc)](){const _0x4ccc78=a7_0x262c1d;return await this[_0x4ccc78(0xea)]();}[a7_0x262c1d(0xd4)](){const _0xc7dbfc=a7_0x262c1d;return console[_0xc7dbfc(0xbc)]('[Appliance\x20TURN\x20Service]\x20Using\x20fallback\x20STUN\x20servers'),[{'urls':_0xc7dbfc(0xe9)},{'urls':_0xc7dbfc(0xe5)}];}[a7_0x262c1d(0xd1)](){const _0x3ee76a=a7_0x262c1d;this[_0x3ee76a(0xc0)]=null,this[_0x3ee76a(0xda)]=0x0,console[_0x3ee76a(0xbc)](_0x3ee76a(0xcd));}}module['exports']=new ApplianceTurnCredentialsService();