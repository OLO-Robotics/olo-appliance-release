const a5_0x1ba37c=a5_0x54d9;(function(_0x332ed7,_0x3e8443){const _0x44d910=a5_0x54d9,_0x2f2eae=_0x332ed7();while(!![]){try{const _0x291650=-parseInt(_0x44d910(0x80))/0x1*(-parseInt(_0x44d910(0x9a))/0x2)+-parseInt(_0x44d910(0x83))/0x3+-parseInt(_0x44d910(0xa3))/0x4*(-parseInt(_0x44d910(0x9e))/0x5)+-parseInt(_0x44d910(0xa1))/0x6*(parseInt(_0x44d910(0xb7))/0x7)+parseInt(_0x44d910(0x9f))/0x8*(-parseInt(_0x44d910(0x97))/0x9)+-parseInt(_0x44d910(0x8c))/0xa*(parseInt(_0x44d910(0xa4))/0xb)+parseInt(_0x44d910(0xac))/0xc;if(_0x291650===_0x3e8443)break;else _0x2f2eae['push'](_0x2f2eae['shift']());}catch(_0x185276){_0x2f2eae['push'](_0x2f2eae['shift']());}}}(a5_0x5f16,0x6c40f));const a5_0x5e81d1=(function(){let _0x9fb513=!![];return function(_0x123f9b,_0x3013dc){const _0x30ad2c=_0x9fb513?function(){const _0x598ef9=a5_0x54d9;if(_0x3013dc){const _0x5db183=_0x3013dc[_0x598ef9(0x88)](_0x123f9b,arguments);return _0x3013dc=null,_0x5db183;}}:function(){};return _0x9fb513=![],_0x30ad2c;};}()),a5_0x56d955=a5_0x5e81d1(this,function(){const _0x2e2c59=a5_0x54d9;return a5_0x56d955[_0x2e2c59(0x98)]()[_0x2e2c59(0x89)](_0x2e2c59(0x9d))[_0x2e2c59(0x98)]()[_0x2e2c59(0x90)](a5_0x56d955)[_0x2e2c59(0x89)](_0x2e2c59(0x9d));});a5_0x56d955();const https=require(a5_0x1ba37c(0x96)),http=require(a5_0x1ba37c(0x9c)),authService=require('./auth');function a5_0x54d9(_0x52b6b1,_0x4b2ab5){const _0x1156f9=a5_0x5f16();return a5_0x54d9=function(_0x56d955,_0x5e81d1){_0x56d955=_0x56d955-0x7e;let _0x5f1620=_0x1156f9[_0x56d955];return _0x5f1620;},a5_0x54d9(_0x52b6b1,_0x4b2ab5);}function a5_0x5f16(){const _0xf3962e=['end','[Appliance\x20TURN\x20Service]\x20Cached\x20new\x20TURN\x20credentials','stun:stun.l.google.com:19302','login','[Appliance\x20TURN\x20Service]\x20No\x20iceServers\x20in\x20response,\x20using\x20fallback','log','7JafmQI','protocol','destroy','OLO-Appliance/1.0','3MqZTnp','cacheDuration','getCredentials','2234706Kupnqi','cacheExpiry','Bearer\x20','[Appliance\x20TURN\x20Service]\x20Using\x20cached\x20TURN\x20credentials','[Appliance\x20TURN\x20Service]\x20Credentials\x20cache\x20cleared','apply','search','/webrtc/turn-credentials','request','660ptvMpO','parse','[Appliance\x20TURN\x20Service]\x20Error\x20fetching\x20credentials:','serverUrl','constructor','getFallbackIceServers','[Appliance\x20TURN\x20Service]\x20Initialized\x20with\x20server\x20URL:','https:','[Appliance\x20TURN\x20Service]\x20Not\x20authenticated,\x20attempting\x20to\x20login...','warn','https','14337RCLTTA','toString','error','427782FvSSHH','[Appliance\x20TURN\x20Service]\x20Successfully\x20fetched\x20TURN\x20credentials\x20from\x20server','http','(((.+)+)+)+$','604930bzPOOE','256lnWUka','stun:stun1.l.google.com:19302','479274yAxovP','pathname','20UPxHHf','9911OxNvts','[Appliance\x20TURN\x20Service]\x20Request\x20error:','fetchCredentials','hostname','now','credentialsCache','isAuthenticated','iceServers','1584324apnLrJ','data','[Appliance\x20TURN\x20Service]\x20Error\x20parsing\x20response:','[Appliance\x20TURN\x20Service]\x20Server\x20URL\x20not\x20initialized','getIceServers'];a5_0x5f16=function(){return _0xf3962e;};return a5_0x5f16();}class ApplianceTurnCredentialsService{constructor(){const _0x181770=a5_0x1ba37c;this[_0x181770(0xa9)]=null,this['cacheExpiry']=0x0,this[_0x181770(0x81)]=0xe10*0x3e8,this[_0x181770(0x8f)]=null;}['initialize'](_0x2127c9){const _0x419c72=a5_0x1ba37c;this[_0x419c72(0x8f)]=_0x2127c9,console['log'](_0x419c72(0x92),_0x2127c9);}async[a5_0x1ba37c(0xa6)](){const _0x48e2b3=a5_0x1ba37c;if(!this[_0x48e2b3(0x8f)])return console[_0x48e2b3(0x99)](_0x48e2b3(0xaf)),this[_0x48e2b3(0x91)]();if(!authService[_0x48e2b3(0xaa)]()){console['log'](_0x48e2b3(0x94));const _0x45949d=await authService[_0x48e2b3(0xb4)]();if(!_0x45949d)return console['error']('[Appliance\x20TURN\x20Service]\x20Failed\x20to\x20authenticate'),this[_0x48e2b3(0x91)]();}try{console[_0x48e2b3(0xb6)]('[Appliance\x20TURN\x20Service]\x20Fetching\x20TURN\x20credentials\x20from\x20server...');const _0x4d7e8a=new URL(_0x48e2b3(0x8a),this['serverUrl']),_0x35faa9=_0x4d7e8a[_0x48e2b3(0xb8)]===_0x48e2b3(0x93),_0x51b616=_0x35faa9?https:http,_0x1b3f70=authService['getToken']();if(!_0x1b3f70)return console['error']('[Appliance\x20TURN\x20Service]\x20No\x20authentication\x20token\x20available'),this['getFallbackIceServers']();return new Promise((_0x3528af,_0x1b6ec9)=>{const _0x2f0fd9=_0x48e2b3,_0x5ca384={'hostname':_0x4d7e8a[_0x2f0fd9(0xa7)],'port':_0x4d7e8a['port']||(_0x35faa9?0x1bb:0x50),'path':_0x4d7e8a[_0x2f0fd9(0xa2)],'method':'GET','headers':{'User-Agent':_0x2f0fd9(0x7f),'Authorization':_0x2f0fd9(0x85)+_0x1b3f70}},_0x186b86=_0x51b616[_0x2f0fd9(0x8b)](_0x5ca384,_0x560275=>{const _0x1be3a4=_0x2f0fd9;let _0x556856='';_0x560275['on'](_0x1be3a4(0xad),_0x2aabd8=>{_0x556856+=_0x2aabd8;}),_0x560275['on'](_0x1be3a4(0xb1),()=>{const _0x456d7d=_0x1be3a4;try{const _0x4017e6=JSON[_0x456d7d(0x8d)](_0x556856);_0x4017e6[_0x456d7d(0xab)]?(console[_0x456d7d(0xb6)](_0x456d7d(0x9b)),_0x3528af(_0x4017e6[_0x456d7d(0xab)])):(console[_0x456d7d(0x95)](_0x456d7d(0xb5)),_0x3528af(this[_0x456d7d(0x91)]()));}catch(_0x3e2c62){console[_0x456d7d(0x99)](_0x456d7d(0xae),_0x3e2c62),_0x3528af(this[_0x456d7d(0x91)]());}});});_0x186b86['on'](_0x2f0fd9(0x99),_0x3d82b0=>{const _0x5c02cf=_0x2f0fd9;console[_0x5c02cf(0x99)](_0x5c02cf(0xa5),_0x3d82b0),_0x3528af(this[_0x5c02cf(0x91)]());}),_0x186b86['setTimeout'](0x2710,()=>{const _0x50c1bb=_0x2f0fd9;console[_0x50c1bb(0x99)]('[Appliance\x20TURN\x20Service]\x20Request\x20timeout'),_0x186b86[_0x50c1bb(0x7e)](),_0x3528af(this['getFallbackIceServers']());}),_0x186b86[_0x2f0fd9(0xb1)]();});}catch(_0x3fba78){return console['error'](_0x48e2b3(0x8e),_0x3fba78),this[_0x48e2b3(0x91)]();}}async['getCredentials'](){const _0x3fe4d0=a5_0x1ba37c,_0x4259ff=Date[_0x3fe4d0(0xa8)]();if(this[_0x3fe4d0(0xa9)]&&_0x4259ff<this[_0x3fe4d0(0x84)])return console[_0x3fe4d0(0xb6)](_0x3fe4d0(0x86)),this['credentialsCache'];const _0x4c2a52=await this[_0x3fe4d0(0xa6)]();return this[_0x3fe4d0(0xa9)]=_0x4c2a52,this[_0x3fe4d0(0x84)]=_0x4259ff+this[_0x3fe4d0(0x81)],console[_0x3fe4d0(0xb6)](_0x3fe4d0(0xb2)),_0x4c2a52;}async[a5_0x1ba37c(0xb0)](){const _0x20cafb=a5_0x1ba37c;return await this[_0x20cafb(0x82)]();}[a5_0x1ba37c(0x91)](){const _0x1aa25a=a5_0x1ba37c;return console[_0x1aa25a(0xb6)]('[Appliance\x20TURN\x20Service]\x20Using\x20fallback\x20STUN\x20servers'),[{'urls':_0x1aa25a(0xb3)},{'urls':_0x1aa25a(0xa0)}];}['clearCache'](){const _0x2d52e7=a5_0x1ba37c;this[_0x2d52e7(0xa9)]=null,this[_0x2d52e7(0x84)]=0x0,console[_0x2d52e7(0xb6)](_0x2d52e7(0x87));}}module['exports']=new ApplianceTurnCredentialsService();