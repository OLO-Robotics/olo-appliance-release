const a5_0x25237a=a5_0x5152;function a5_0x5152(_0x4e1c5c,_0x22d598){const _0x430511=a5_0x2ba9();return a5_0x5152=function(_0x5d528e,_0x1a7f4d){_0x5d528e=_0x5d528e-0x195;let _0x2ba947=_0x430511[_0x5d528e];return _0x2ba947;},a5_0x5152(_0x4e1c5c,_0x22d598);}(function(_0x10475f,_0x35afa9){const _0x16cd6a=a5_0x5152,_0x327d3b=_0x10475f();while(!![]){try{const _0x595a62=parseInt(_0x16cd6a(0x1a4))/0x1+-parseInt(_0x16cd6a(0x1bd))/0x2*(parseInt(_0x16cd6a(0x19e))/0x3)+parseInt(_0x16cd6a(0x1ad))/0x4+-parseInt(_0x16cd6a(0x1b3))/0x5*(-parseInt(_0x16cd6a(0x1be))/0x6)+-parseInt(_0x16cd6a(0x1a1))/0x7+parseInt(_0x16cd6a(0x19d))/0x8*(-parseInt(_0x16cd6a(0x1b9))/0x9)+parseInt(_0x16cd6a(0x1c2))/0xa;if(_0x595a62===_0x35afa9)break;else _0x327d3b['push'](_0x327d3b['shift']());}catch(_0x56de02){_0x327d3b['push'](_0x327d3b['shift']());}}}(a5_0x2ba9,0x337f0));function a5_0x2ba9(){const _0x56e40f=['[Appliance\x20TURN\x20Service]\x20No\x20authentication\x20token\x20available','[Appliance\x20TURN\x20Service]\x20Successfully\x20fetched\x20TURN\x20credentials\x20from\x20server','[Appliance\x20TURN\x20Service]\x20Request\x20timeout','destroy','log','[Appliance\x20TURN\x20Service]\x20Error\x20parsing\x20response:','cacheDuration','[Appliance\x20TURN\x20Service]\x20No\x20iceServers\x20in\x20response,\x20using\x20fallback','http','fetchCredentials','credentialsCache','iceServers','getCredentials','clearCache','2696Twjgrr','45OWpfeh','GET','getFallbackIceServers','2903775xIoouz','/webrtc/turn-credentials','setTimeout','192884AbLNJz','[Appliance\x20TURN\x20Service]\x20Failed\x20to\x20authenticate','protocol','now','toString','parse','hostname','[Appliance\x20TURN\x20Service]\x20Request\x20error:','search','842824iXeyHT','[Appliance\x20TURN\x20Service]\x20Fetching\x20TURN\x20credentials\x20from\x20server...','error','[Appliance\x20TURN\x20Service]\x20Cached\x20new\x20TURN\x20credentials','login','[Appliance\x20TURN\x20Service]\x20Initialized\x20with\x20server\x20URL:','22315fiuAcU','apply','constructor','isAuthenticated','end','serverUrl','9873nDtsTK','./auth','data','[Appliance\x20TURN\x20Service]\x20Using\x20cached\x20TURN\x20credentials','26690pknisD','138SwrUkw','port','https','cacheExpiry','6893780cuQwIL'];a5_0x2ba9=function(){return _0x56e40f;};return a5_0x2ba9();}const a5_0x1a7f4d=(function(){let _0x3ce48f=!![];return function(_0x593233,_0x50e6d4){const _0x2b1d93=_0x3ce48f?function(){const _0x577213=a5_0x5152;if(_0x50e6d4){const _0x42a4a5=_0x50e6d4[_0x577213(0x1b4)](_0x593233,arguments);return _0x50e6d4=null,_0x42a4a5;}}:function(){};return _0x3ce48f=![],_0x2b1d93;};}()),a5_0x5d528e=a5_0x1a7f4d(this,function(){const _0x990025=a5_0x5152;return a5_0x5d528e[_0x990025(0x1a8)]()['search']('(((.+)+)+)+$')[_0x990025(0x1a8)]()[_0x990025(0x1b5)](a5_0x5d528e)[_0x990025(0x1ac)]('(((.+)+)+)+$');});a5_0x5d528e();const https=require(a5_0x25237a(0x1c0)),http=require(a5_0x25237a(0x197)),authService=require(a5_0x25237a(0x1ba));class ApplianceTurnCredentialsService{constructor(){const _0x2f1ed8=a5_0x25237a;this[_0x2f1ed8(0x199)]=null,this['cacheExpiry']=0x0,this[_0x2f1ed8(0x195)]=0xe10*0x3e8,this[_0x2f1ed8(0x1b8)]=null;}['initialize'](_0x288886){const _0x269c0f=a5_0x25237a;this['serverUrl']=_0x288886,console[_0x269c0f(0x1c7)](_0x269c0f(0x1b2),_0x288886);}async[a5_0x25237a(0x198)](){const _0x35ef83=a5_0x25237a;if(!this[_0x35ef83(0x1b8)])return console[_0x35ef83(0x1af)]('[Appliance\x20TURN\x20Service]\x20Server\x20URL\x20not\x20initialized'),this[_0x35ef83(0x1a0)]();if(!authService[_0x35ef83(0x1b6)]()){console[_0x35ef83(0x1c7)]('[Appliance\x20TURN\x20Service]\x20Not\x20authenticated,\x20attempting\x20to\x20login...');const _0x22f601=await authService[_0x35ef83(0x1b1)]();if(!_0x22f601)return console[_0x35ef83(0x1af)](_0x35ef83(0x1a5)),this[_0x35ef83(0x1a0)]();}try{console['log'](_0x35ef83(0x1ae));const _0x1cf95d=new URL(_0x35ef83(0x1a2),this[_0x35ef83(0x1b8)]),_0x591395=_0x1cf95d[_0x35ef83(0x1a6)]==='https:',_0x4d672b=_0x591395?https:http,_0x54124e=authService['getToken']();if(!_0x54124e)return console[_0x35ef83(0x1af)](_0x35ef83(0x1c3)),this[_0x35ef83(0x1a0)]();return new Promise((_0xdbbeb,_0x48fe21)=>{const _0x2df0b0=_0x35ef83,_0x31471f={'hostname':_0x1cf95d[_0x2df0b0(0x1aa)],'port':_0x1cf95d[_0x2df0b0(0x1bf)]||(_0x591395?0x1bb:0x50),'path':_0x1cf95d['pathname'],'method':_0x2df0b0(0x19f),'headers':{'User-Agent':'OLO-Appliance/1.0','Authorization':'Bearer\x20'+_0x54124e}},_0x1180bf=_0x4d672b['request'](_0x31471f,_0x1a593e=>{const _0x3b70fa=_0x2df0b0;let _0x191400='';_0x1a593e['on'](_0x3b70fa(0x1bb),_0x2d62db=>{_0x191400+=_0x2d62db;}),_0x1a593e['on'](_0x3b70fa(0x1b7),()=>{const _0x5cd3e2=_0x3b70fa;try{const _0x3652b1=JSON[_0x5cd3e2(0x1a9)](_0x191400);_0x3652b1[_0x5cd3e2(0x19a)]?(console[_0x5cd3e2(0x1c7)](_0x5cd3e2(0x1c4)),_0xdbbeb(_0x3652b1['iceServers'])):(console['warn'](_0x5cd3e2(0x196)),_0xdbbeb(this[_0x5cd3e2(0x1a0)]()));}catch(_0x1a609f){console['error'](_0x5cd3e2(0x1c8),_0x1a609f),_0xdbbeb(this['getFallbackIceServers']());}});});_0x1180bf['on'](_0x2df0b0(0x1af),_0xdbe378=>{const _0x3c737f=_0x2df0b0;console[_0x3c737f(0x1af)](_0x3c737f(0x1ab),_0xdbe378),_0xdbbeb(this[_0x3c737f(0x1a0)]());}),_0x1180bf[_0x2df0b0(0x1a3)](0x2710,()=>{const _0x33fa0d=_0x2df0b0;console[_0x33fa0d(0x1af)](_0x33fa0d(0x1c5)),_0x1180bf[_0x33fa0d(0x1c6)](),_0xdbbeb(this[_0x33fa0d(0x1a0)]());}),_0x1180bf[_0x2df0b0(0x1b7)]();});}catch(_0x1f6989){return console[_0x35ef83(0x1af)]('[Appliance\x20TURN\x20Service]\x20Error\x20fetching\x20credentials:',_0x1f6989),this['getFallbackIceServers']();}}async[a5_0x25237a(0x19b)](){const _0x25a5b1=a5_0x25237a,_0x1cedff=Date[_0x25a5b1(0x1a7)]();if(this[_0x25a5b1(0x199)]&&_0x1cedff<this[_0x25a5b1(0x1c1)])return console[_0x25a5b1(0x1c7)](_0x25a5b1(0x1bc)),this[_0x25a5b1(0x199)];const _0x4dbccc=await this['fetchCredentials']();return this[_0x25a5b1(0x199)]=_0x4dbccc,this[_0x25a5b1(0x1c1)]=_0x1cedff+this[_0x25a5b1(0x195)],console[_0x25a5b1(0x1c7)](_0x25a5b1(0x1b0)),_0x4dbccc;}async['getIceServers'](){const _0x360a76=a5_0x25237a;return await this[_0x360a76(0x19b)]();}[a5_0x25237a(0x1a0)](){const _0x29c9c8=a5_0x25237a;return console[_0x29c9c8(0x1c7)]('[Appliance\x20TURN\x20Service]\x20Using\x20fallback\x20STUN\x20servers'),[{'urls':'stun:stun.l.google.com:19302'},{'urls':'stun:stun1.l.google.com:19302'}];}[a5_0x25237a(0x19c)](){const _0x35dec3=a5_0x25237a;this[_0x35dec3(0x199)]=null,this[_0x35dec3(0x1c1)]=0x0,console[_0x35dec3(0x1c7)]('[Appliance\x20TURN\x20Service]\x20Credentials\x20cache\x20cleared');}}module['exports']=new ApplianceTurnCredentialsService();