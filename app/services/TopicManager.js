const a4_0x36d1aa=a4_0x1deb;(function(_0x4d5e7d,_0x362782){const _0x2ce71c=a4_0x1deb,_0x35213e=_0x4d5e7d();while(!![]){try{const _0x974caf=parseInt(_0x2ce71c(0x224))/0x1*(-parseInt(_0x2ce71c(0x23d))/0x2)+-parseInt(_0x2ce71c(0x23f))/0x3*(parseInt(_0x2ce71c(0x225))/0x4)+-parseInt(_0x2ce71c(0x207))/0x5+-parseInt(_0x2ce71c(0x238))/0x6+parseInt(_0x2ce71c(0x1f1))/0x7+-parseInt(_0x2ce71c(0x1ed))/0x8+parseInt(_0x2ce71c(0x22f))/0x9;if(_0x974caf===_0x362782)break;else _0x35213e['push'](_0x35213e['shift']());}catch(_0x257813){_0x35213e['push'](_0x35213e['shift']());}}}(a4_0xa4aa,0x88e35));const a4_0x588c50=(function(){let _0x71a4dc=!![];return function(_0x35f13d,_0x308e9){const _0x547eaa=_0x71a4dc?function(){const _0xfea63a=a4_0x1deb;if(_0x308e9){const _0x2a8f53=_0x308e9[_0xfea63a(0x1f2)](_0x35f13d,arguments);return _0x308e9=null,_0x2a8f53;}}:function(){};return _0x71a4dc=![],_0x547eaa;};}()),a4_0x1b07c5=a4_0x588c50(this,function(){const _0x1b9abe=a4_0x1deb;return a4_0x1b07c5[_0x1b9abe(0x201)]()['search'](_0x1b9abe(0x206))[_0x1b9abe(0x201)]()[_0x1b9abe(0x239)](a4_0x1b07c5)[_0x1b9abe(0x205)](_0x1b9abe(0x206));});function a4_0xa4aa(){const _0x14cc40=['2318682NlBbVT','constructor','\x20topics','cloud','unknown','2avoWpc','map','1474503eheFeW','test','LaserScan','now','strategies','getTopicStrategy','estimateTopicSize','isLargeData','websocket','largeDataThreshold','topicStrategies','config','defaultLargeDataStrategy','compressed','4112120KOXHak','webrtc_skip','strategy','topic','7166236tIIJIG','apply','maxFrequency','log','Image','sensor_msgs/msg/LaserScan','scan','from','throttle','type','PointCloud2','throttle_skip','video_webrtc_streaming','split','isCameraTopic','image_throttled','toString','getTopics','replace','webrtc','search','(((.+)+)+)+$','2046650WvCZof','set','analyzeTopicStrategy','point_cloud','forEach','normal_size','get','discoveryInProgress','sensor_msgs/msg/CompressedImage','determineTopicStrategy','[TopicManager]\x20Found\x20','points','topics','child_process','topicHandling','has','name','sensor_msgs/msg/PointCloud2','[TopicManager]\x20Topic\x20discovery\x20completed','throttleFrequencies','entries','length','image_raw','lastMessageTimes','size','sensor_msgs/msg/Image','types','strategiesConfig','image','947766uswOWx','4bXGkhS','pattern_configured','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','forward','includes','[TopicManager]\x20Initialised','parseStrategyConfig','isLargeDataTopic','reason','shouldThrottle','20574036ofnUpK','loadConfig','point_cloud_throttled','webrtc_only','depth_points','error','shouldUseWebRTC','point','[TopicManager]\x20Topic\x20discovery\x20failed:'];a4_0xa4aa=function(){return _0x14cc40;};return a4_0xa4aa();}a4_0x1b07c5();const {execSync}=require(a4_0x36d1aa(0x214));class TopicManager{constructor(){const _0x2129a4=a4_0x36d1aa;this[_0x2129a4(0x1e9)]=new Map(),this[_0x2129a4(0x21e)]=new Map(),this['discoveryInProgress']=![],this[_0x2129a4(0x1ea)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x2129a4(0x232),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x2129a4(0x1f4)](_0x2129a4(0x22a));}[a4_0x36d1aa(0x230)](_0x5d92d3){const _0xddc48f=a4_0x36d1aa;if(_0x5d92d3[_0xddc48f(0x215)]){const _0xeb4fb6=_0x5d92d3[_0xddc48f(0x215)];_0xeb4fb6[_0xddc48f(0x1e8)]&&(this[_0xddc48f(0x1ea)]['largeDataThreshold']=_0xeb4fb6['largeDataThreshold']),_0xeb4fb6[_0xddc48f(0x1eb)]&&(this[_0xddc48f(0x1ea)][_0xddc48f(0x1eb)]=_0xeb4fb6['defaultLargeDataStrategy']),_0xeb4fb6[_0xddc48f(0x1e3)]&&(this[_0xddc48f(0x1ea)]['strategiesConfig']={..._0xeb4fb6['strategies']}),_0xeb4fb6['throttleFrequencies']&&(this[_0xddc48f(0x1ea)][_0xddc48f(0x21a)]={...this[_0xddc48f(0x1ea)][_0xddc48f(0x21a)],..._0xeb4fb6[_0xddc48f(0x21a)]}),console[_0xddc48f(0x1f4)]('[TopicManager]\x20Loaded\x20configuration:',this[_0xddc48f(0x1ea)]);}}async['discoverTopics'](_0x8fbef5){const _0xcb260f=a4_0x36d1aa;if(this[_0xcb260f(0x20e)]||!_0x8fbef5)return;this[_0xcb260f(0x20e)]=!![],console[_0xcb260f(0x1f4)]('[TopicManager]\x20Starting\x20topic\x20discovery...');try{await new Promise((_0x1e4ac7,_0xf84572)=>{const _0x41ee06=_0xcb260f;_0x8fbef5[_0x41ee06(0x202)](_0x2feb86=>{const _0x3b1158=_0x41ee06,_0x2ff64e=_0x2feb86[_0x3b1158(0x213)][_0x3b1158(0x23e)]((_0x4e4211,_0x37d54a)=>({'name':_0x4e4211,'type':_0x2feb86[_0x3b1158(0x221)][_0x37d54a]}));console[_0x3b1158(0x1f4)](_0x3b1158(0x211)+_0x2ff64e[_0x3b1158(0x21c)]+_0x3b1158(0x23a));for(const _0x5d0d0a of _0x2ff64e){this[_0x3b1158(0x209)](_0x5d0d0a);}console[_0x3b1158(0x1f4)](_0x3b1158(0x219)),console[_0x3b1158(0x1f4)]('[TopicManager]\x20Strategies:',Array[_0x3b1158(0x1f8)](this[_0x3b1158(0x1e9)][_0x3b1158(0x21b)]())),_0x1e4ac7();},_0x4e47f9=>{const _0x3f5dd8=_0x41ee06;console[_0x3f5dd8(0x234)]('[TopicManager]\x20Error\x20getting\x20topics:',_0x4e47f9),_0xf84572(_0x4e47f9);});});}catch(_0x15c012){console['error'](_0xcb260f(0x237),_0x15c012);}finally{this[_0xcb260f(0x20e)]=![];}}['analyzeTopicStrategy'](_0x2cc7e1){const _0x5bc30d=a4_0x36d1aa,_0x13fe81=this[_0x5bc30d(0x210)](_0x2cc7e1);this[_0x5bc30d(0x1e9)][_0x5bc30d(0x208)](_0x2cc7e1[_0x5bc30d(0x217)],{'type':_0x2cc7e1[_0x5bc30d(0x1fa)],'strategy':_0x13fe81[_0x5bc30d(0x1fa)],'reason':_0x13fe81[_0x5bc30d(0x22d)],'maxFrequency':_0x13fe81[_0x5bc30d(0x1f3)],'isLargeData':_0x13fe81['isLargeData'],'estimatedSize':_0x13fe81['estimatedSize']}),console['log']('[TopicManager]\x20Topic\x20'+_0x2cc7e1[_0x5bc30d(0x217)]+':\x20'+_0x13fe81[_0x5bc30d(0x1fa)]+'\x20('+_0x13fe81[_0x5bc30d(0x22d)]+')');}[a4_0x36d1aa(0x210)](_0x5346dc){const _0x25b54c=a4_0x36d1aa;if(this['config'][_0x25b54c(0x222)][_0x5346dc[_0x25b54c(0x217)]]){const _0x414915=this[_0x25b54c(0x1ea)][_0x25b54c(0x222)][_0x5346dc[_0x25b54c(0x217)]];return this[_0x25b54c(0x22b)](_0x414915,'user_configured');}for(const [_0x126846,_0x5a88ca]of Object[_0x25b54c(0x21b)](this['config'][_0x25b54c(0x222)])){if(_0x5346dc[_0x25b54c(0x217)][_0x25b54c(0x229)](_0x126846[_0x25b54c(0x203)]('/','')))return this[_0x25b54c(0x22b)](_0x5a88ca,_0x25b54c(0x226));}if(this[_0x25b54c(0x1ff)](_0x5346dc[_0x25b54c(0x217)],_0x5346dc['type'])){const _0x10f855=this[_0x25b54c(0x1e5)](_0x5346dc[_0x25b54c(0x217)],_0x5346dc[_0x25b54c(0x1fa)]);return{'type':_0x25b54c(0x204),'reason':_0x25b54c(0x1fd),'isLargeData':!![],'estimatedSize':_0x10f855,'maxFrequency':null};}const _0x20789d=this[_0x25b54c(0x22c)](_0x5346dc[_0x25b54c(0x217)],_0x5346dc[_0x25b54c(0x1fa)]),_0x43b2fb=this[_0x25b54c(0x1e5)](_0x5346dc['name'],_0x5346dc[_0x25b54c(0x1fa)]);if(_0x20789d||_0x43b2fb>this[_0x25b54c(0x1ea)][_0x25b54c(0x1e8)]){let _0x2a0d89=this[_0x25b54c(0x1ea)][_0x25b54c(0x21a)][_0x5346dc[_0x25b54c(0x1fa)]]||0xa,_0x59fe03='large_data_throttled';if(_0x5346dc['type']['includes'](_0x25b54c(0x1fb))||_0x5346dc[_0x25b54c(0x217)][_0x25b54c(0x229)](_0x25b54c(0x212)))_0x2a0d89=this[_0x25b54c(0x1ea)][_0x25b54c(0x21a)][_0x5346dc['type']]||0x5,_0x59fe03=_0x25b54c(0x231);else{if(_0x5346dc['type'][_0x25b54c(0x229)](_0x25b54c(0x241))||_0x5346dc['name']['includes'](_0x25b54c(0x1f7)))_0x2a0d89=this[_0x25b54c(0x1ea)]['throttleFrequencies'][_0x5346dc[_0x25b54c(0x1fa)]]||0xf,_0x59fe03='laser_scan_throttled';else _0x5346dc[_0x25b54c(0x1fa)][_0x25b54c(0x229)](_0x25b54c(0x1f5))&&(_0x2a0d89=this[_0x25b54c(0x1ea)][_0x25b54c(0x21a)][_0x5346dc[_0x25b54c(0x1fa)]]||0xa,_0x59fe03=_0x25b54c(0x200));}return{'type':_0x25b54c(0x1f9),'reason':_0x59fe03,'isLargeData':!![],'estimatedSize':_0x43b2fb,'maxFrequency':_0x2a0d89};}return{'type':_0x25b54c(0x1e7),'reason':_0x25b54c(0x20c),'isLargeData':![],'estimatedSize':_0x43b2fb,'maxFrequency':null};}[a4_0x36d1aa(0x22b)](_0x2861a5,_0x21fd0f){const _0x4d0fdf=a4_0x36d1aa;if(_0x2861a5[_0x4d0fdf(0x229)](':')){const [_0x309f8a,_0xb4ad06]=_0x2861a5[_0x4d0fdf(0x1fe)](':');return{'type':_0x309f8a,'reason':_0x21fd0f,'isLargeData':!![],'maxFrequency':_0x309f8a==='throttle'?parseFloat(_0xb4ad06):null,'estimatedSize':this[_0x4d0fdf(0x1ea)][_0x4d0fdf(0x1e8)]+0x1};}return{'type':_0x2861a5,'reason':_0x21fd0f,'isLargeData':_0x2861a5!==_0x4d0fdf(0x1e7),'maxFrequency':null,'estimatedSize':this[_0x4d0fdf(0x1ea)]['largeDataThreshold']+0x1};}[a4_0x36d1aa(0x22c)](_0x5245cb,_0x4d61a3){const _0x418c63=a4_0x36d1aa,_0x2596fc=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x19c946=[_0x418c63(0x218),'sensor_msgs/msg/Image',_0x418c63(0x1f6),'sensor_msgs/msg/CompressedImage'];return _0x2596fc['some'](_0x1aaef7=>_0x1aaef7[_0x418c63(0x240)](_0x5245cb))||_0x19c946[_0x418c63(0x229)](_0x4d61a3);}[a4_0x36d1aa(0x1ff)](_0x1e9f8b,_0x294e6b=''){const _0x3005c7=a4_0x36d1aa,_0x1f71c5=[_0x3005c7(0x220),_0x3005c7(0x20f)];if(_0x1f71c5['includes'](_0x294e6b))return!_0x1e9f8b[_0x3005c7(0x229)](_0x3005c7(0x212))&&!_0x1e9f8b['includes']('point_cloud')&&!_0x1e9f8b[_0x3005c7(0x229)](_0x3005c7(0x233));return(_0x1e9f8b['includes']('image')||_0x1e9f8b[_0x3005c7(0x229)](_0x3005c7(0x1ec)))&&!_0x1e9f8b[_0x3005c7(0x229)](_0x3005c7(0x212))&&!_0x1e9f8b[_0x3005c7(0x229)](_0x3005c7(0x20a))&&!_0x1e9f8b[_0x3005c7(0x229)](_0x3005c7(0x233));}[a4_0x36d1aa(0x1e5)](_0x3bb095,_0x5bc3cc){const _0x24ddb7=a4_0x36d1aa,_0x78a5c8={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x78a5c8[_0x5bc3cc])return _0x78a5c8[_0x5bc3cc];if(_0x3bb095[_0x24ddb7(0x229)]('point')||_0x3bb095[_0x24ddb7(0x229)]('cloud'))return 0x190*0x400;if(_0x3bb095[_0x24ddb7(0x229)](_0x24ddb7(0x21d)))return 0x12c*0x400;if(_0x3bb095[_0x24ddb7(0x229)](_0x24ddb7(0x1ec)))return 0x32*0x400;return 0x400;}['handleMessage'](_0x437115){const _0x1d62fc=a4_0x36d1aa;let _0x1d70cc=this[_0x1d62fc(0x1e9)][_0x1d62fc(0x20d)](_0x437115[_0x1d62fc(0x1f0)]);if(!_0x1d70cc){console[_0x1d62fc(0x1f4)](_0x1d62fc(0x227)+_0x437115['topic']);let _0x33f176=_0x1d62fc(0x23c);if(_0x437115[_0x1d62fc(0x1f0)][_0x1d62fc(0x229)](_0x1d62fc(0x223))&&_0x437115[_0x1d62fc(0x1f0)]['includes'](_0x1d62fc(0x1ec)))_0x33f176=_0x1d62fc(0x20f);else{if(_0x437115[_0x1d62fc(0x1f0)][_0x1d62fc(0x229)](_0x1d62fc(0x223)))_0x33f176=_0x1d62fc(0x220);else{if(_0x437115[_0x1d62fc(0x1f0)][_0x1d62fc(0x229)](_0x1d62fc(0x236))||_0x437115[_0x1d62fc(0x1f0)]['includes'](_0x1d62fc(0x23b)))_0x33f176=_0x1d62fc(0x218);else _0x437115[_0x1d62fc(0x1f0)]['includes'](_0x1d62fc(0x1f7))&&(_0x33f176=_0x1d62fc(0x1f6));}}const _0xbfc625={'name':_0x437115[_0x1d62fc(0x1f0)],'type':_0x33f176};this['analyzeTopicStrategy'](_0xbfc625),_0x1d70cc=this[_0x1d62fc(0x1e9)][_0x1d62fc(0x20d)](_0x437115[_0x1d62fc(0x1f0)]);}if(!_0x1d70cc)return{'action':_0x1d62fc(0x228),'message':_0x437115};switch(_0x1d70cc[_0x1d62fc(0x1ef)]){case'throttle':return this[_0x1d62fc(0x22e)](_0x437115['topic'],_0x1d70cc[_0x1d62fc(0x1f3)])?{'action':_0x1d62fc(0x228),'message':_0x437115}:{'action':_0x1d62fc(0x1fc)};case _0x1d62fc(0x204):return{'action':_0x1d62fc(0x1ee)};case _0x1d62fc(0x1e7):default:return{'action':_0x1d62fc(0x228),'message':_0x437115};}}[a4_0x36d1aa(0x22e)](_0x36092c,_0x4f7490){const _0x4ec6c6=a4_0x36d1aa;if(!_0x4f7490)return!![];const _0x5ea053=Date[_0x4ec6c6(0x242)](),_0x1c64f0=0x3e8/_0x4f7490;!this[_0x4ec6c6(0x21e)][_0x4ec6c6(0x216)](_0x36092c)&&this[_0x4ec6c6(0x21e)][_0x4ec6c6(0x208)](_0x36092c,0x0);const _0x38cd8a=this[_0x4ec6c6(0x21e)]['get'](_0x36092c),_0x12451a=_0x5ea053-_0x38cd8a;if(_0x12451a>=_0x1c64f0)return this[_0x4ec6c6(0x21e)][_0x4ec6c6(0x208)](_0x36092c,_0x5ea053),!![];return![];}[a4_0x36d1aa(0x1e4)](_0x4107d8){const _0x51ed87=a4_0x36d1aa;return this[_0x51ed87(0x1e9)][_0x51ed87(0x20d)](_0x4107d8);}['getManagedTopics'](){const _0x25a9de=a4_0x36d1aa;return Array[_0x25a9de(0x1f8)](this['topicStrategies'][_0x25a9de(0x21b)]())[_0x25a9de(0x23e)](([_0x5b001b,_0x2f8130])=>({'topic':_0x5b001b,..._0x2f8130}));}[a4_0x36d1aa(0x235)](_0x45037c){const _0x2d9f51=a4_0x36d1aa,_0x1e0272=this[_0x2d9f51(0x1e9)][_0x2d9f51(0x20d)](_0x45037c);return _0x1e0272?.[_0x2d9f51(0x1ef)]===_0x2d9f51(0x232);}['getStatistics'](){const _0x2cf8cb=a4_0x36d1aa,_0xe16739={};return this[_0x2cf8cb(0x1e9)][_0x2cf8cb(0x20b)]((_0x4f1025,_0x251d18)=>{const _0x2e1591=_0x2cf8cb;!_0xe16739[_0x4f1025[_0x2e1591(0x1ef)]]&&(_0xe16739[_0x4f1025[_0x2e1591(0x1ef)]]=0x0),_0xe16739[_0x4f1025[_0x2e1591(0x1ef)]]++;}),{'totalTopics':this['topicStrategies'][_0x2cf8cb(0x21f)],'strategies':_0xe16739,'largeDataTopics':Array['from'](this[_0x2cf8cb(0x1e9)][_0x2cf8cb(0x21b)]())['filter'](([_0x45dd18,_0x562015])=>_0x562015[_0x2cf8cb(0x1e6)])[_0x2cf8cb(0x23e)](([_0x49b824,_0x151bb9])=>_0x49b824)};}}function a4_0x1deb(_0x261260,_0x34e7de){const _0x12d6d9=a4_0xa4aa();return a4_0x1deb=function(_0x1b07c5,_0x588c50){_0x1b07c5=_0x1b07c5-0x1e3;let _0xa4aaf4=_0x12d6d9[_0x1b07c5];return _0xa4aaf4;},a4_0x1deb(_0x261260,_0x34e7de);}module['exports']=new TopicManager();