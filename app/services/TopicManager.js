const a4_0x4a18bb=a4_0x5245;(function(_0x38f1ba,_0x508d8a){const _0x3ff36f=a4_0x5245,_0x267809=_0x38f1ba();while(!![]){try{const _0x205218=parseInt(_0x3ff36f(0xb8))/0x1*(-parseInt(_0x3ff36f(0x8d))/0x2)+parseInt(_0x3ff36f(0xad))/0x3*(-parseInt(_0x3ff36f(0xe4))/0x4)+-parseInt(_0x3ff36f(0x8a))/0x5+parseInt(_0x3ff36f(0x98))/0x6*(parseInt(_0x3ff36f(0xa6))/0x7)+parseInt(_0x3ff36f(0xd8))/0x8*(-parseInt(_0x3ff36f(0xbc))/0x9)+-parseInt(_0x3ff36f(0xc5))/0xa+-parseInt(_0x3ff36f(0xd4))/0xb*(-parseInt(_0x3ff36f(0xce))/0xc);if(_0x205218===_0x508d8a)break;else _0x267809['push'](_0x267809['shift']());}catch(_0x149ad4){_0x267809['push'](_0x267809['shift']());}}}(a4_0x7628,0x534b2));const a4_0x5b71df=(function(){let _0x50b441=!![];return function(_0x5acfb7,_0x51bfae){const _0x40e7d7=_0x50b441?function(){const _0x587c4f=a4_0x5245;if(_0x51bfae){const _0x5ad4f8=_0x51bfae[_0x587c4f(0xcc)](_0x5acfb7,arguments);return _0x51bfae=null,_0x5ad4f8;}}:function(){};return _0x50b441=![],_0x40e7d7;};}()),a4_0x4effd2=a4_0x5b71df(this,function(){const _0x31bc30=a4_0x5245;return a4_0x4effd2[_0x31bc30(0xd9)]()[_0x31bc30(0xaf)](_0x31bc30(0xd6))[_0x31bc30(0xd9)]()[_0x31bc30(0xc1)](a4_0x4effd2)[_0x31bc30(0xaf)](_0x31bc30(0xd6));});a4_0x4effd2();function a4_0x5245(_0x25a1ad,_0x16ae33){const _0x487125=a4_0x7628();return a4_0x5245=function(_0x4effd2,_0x5b71df){_0x4effd2=_0x4effd2-0x85;let _0x7628a7=_0x487125[_0x4effd2];return _0x7628a7;},a4_0x5245(_0x25a1ad,_0x16ae33);}const {execSync}=require(a4_0x4a18bb(0x90));class TopicManager{constructor(){const _0x3dc36c=a4_0x4a18bb;this[_0x3dc36c(0xb2)]=new Map(),this[_0x3dc36c(0xc6)]=new Map(),this[_0x3dc36c(0x8c)]=![],this['config']={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x3dc36c(0xcf)]('[TopicManager]\x20Initialised');}[a4_0x4a18bb(0x8e)](_0x2a19c3){const _0x453090=a4_0x4a18bb;if(_0x2a19c3[_0x453090(0xe1)]){const _0x970b04=_0x2a19c3[_0x453090(0xe1)];_0x970b04[_0x453090(0xc8)]&&(this[_0x453090(0x86)]['largeDataThreshold']=_0x970b04['largeDataThreshold']),_0x970b04[_0x453090(0x8b)]&&(this[_0x453090(0x86)][_0x453090(0x8b)]=_0x970b04[_0x453090(0x8b)]),_0x970b04[_0x453090(0xca)]&&(this[_0x453090(0x86)][_0x453090(0xbb)]={..._0x970b04[_0x453090(0xca)]}),_0x970b04[_0x453090(0xc4)]&&(this[_0x453090(0x86)]['throttleFrequencies']={...this[_0x453090(0x86)][_0x453090(0xc4)],..._0x970b04['throttleFrequencies']}),console['log']('[TopicManager]\x20Loaded\x20configuration:',this[_0x453090(0x86)]);}}async[a4_0x4a18bb(0x91)](_0x39d774){const _0xbe81f3=a4_0x4a18bb;if(this[_0xbe81f3(0x8c)]||!_0x39d774)return;this[_0xbe81f3(0x8c)]=!![],console['log'](_0xbe81f3(0xab));try{await new Promise((_0x85565e,_0x4659e5)=>{const _0x96156b=_0xbe81f3;_0x39d774[_0x96156b(0x94)](_0x8051f7=>{const _0x34d2d0=_0x96156b,_0xed90a0=_0x8051f7[_0x34d2d0(0xba)][_0x34d2d0(0xb1)]((_0x5cdbba,_0x1f9beb)=>({'name':_0x5cdbba,'type':_0x8051f7[_0x34d2d0(0xe3)][_0x1f9beb]}));console[_0x34d2d0(0xcf)](_0x34d2d0(0xb6)+_0xed90a0[_0x34d2d0(0x9e)]+_0x34d2d0(0x89));for(const _0x3b8e19 of _0xed90a0){this[_0x34d2d0(0xa8)](_0x3b8e19);}console[_0x34d2d0(0xcf)]('[TopicManager]\x20Topic\x20discovery\x20completed'),console[_0x34d2d0(0xcf)](_0x34d2d0(0x97),Array[_0x34d2d0(0xa0)](this['topicStrategies'][_0x34d2d0(0xc3)]())),_0x85565e();},_0x40ec6c=>{const _0x1832f0=_0x96156b;console['error'](_0x1832f0(0xdf),_0x40ec6c),_0x4659e5(_0x40ec6c);});});}catch(_0x544204){console[_0xbe81f3(0xa1)](_0xbe81f3(0xa3),_0x544204);}finally{this['discoveryInProgress']=![];}}[a4_0x4a18bb(0xa8)](_0x3dc008){const _0x40bbcf=a4_0x4a18bb,_0x28649b=this[_0x40bbcf(0xb4)](_0x3dc008);this['topicStrategies'][_0x40bbcf(0xb0)](_0x3dc008[_0x40bbcf(0x9d)],{'type':_0x3dc008['type'],'strategy':_0x28649b[_0x40bbcf(0x87)],'reason':_0x28649b[_0x40bbcf(0x96)],'maxFrequency':_0x28649b[_0x40bbcf(0xbe)],'isLargeData':_0x28649b[_0x40bbcf(0xbd)],'estimatedSize':_0x28649b[_0x40bbcf(0xe2)]}),console['log'](_0x40bbcf(0xd5)+_0x3dc008[_0x40bbcf(0x9d)]+':\x20'+_0x28649b['type']+'\x20('+_0x28649b[_0x40bbcf(0x96)]+')');}[a4_0x4a18bb(0xb4)](_0x11130f){const _0x4ba138=a4_0x4a18bb;if(this['config'][_0x4ba138(0xbb)][_0x11130f[_0x4ba138(0x9d)]]){const _0x1bda7f=this[_0x4ba138(0x86)]['strategiesConfig'][_0x11130f['name']];return this['parseStrategyConfig'](_0x1bda7f,'user_configured');}for(const [_0x1258b7,_0x2478f4]of Object[_0x4ba138(0xc3)](this[_0x4ba138(0x86)][_0x4ba138(0xbb)])){if(_0x11130f[_0x4ba138(0x9d)][_0x4ba138(0xe0)](_0x1258b7['replace']('/','')))return this[_0x4ba138(0xb9)](_0x2478f4,_0x4ba138(0xc9));}if(this[_0x4ba138(0xb3)](_0x11130f[_0x4ba138(0x9d)],_0x11130f[_0x4ba138(0x87)])){const _0x1dad62=this[_0x4ba138(0xd2)](_0x11130f['name'],_0x11130f[_0x4ba138(0x87)]);return{'type':_0x4ba138(0xa2),'reason':_0x4ba138(0xaa),'isLargeData':!![],'estimatedSize':_0x1dad62,'maxFrequency':null};}const _0x566754=this['isLargeDataTopic'](_0x11130f['name'],_0x11130f[_0x4ba138(0x87)]),_0x19d0dc=this[_0x4ba138(0xd2)](_0x11130f[_0x4ba138(0x9d)],_0x11130f['type']);if(_0x566754||_0x19d0dc>this[_0x4ba138(0x86)][_0x4ba138(0xc8)]){let _0x1462ec=this['config'][_0x4ba138(0xc4)][_0x11130f[_0x4ba138(0x87)]]||0xa,_0x3faf41=_0x4ba138(0xac);if(_0x11130f[_0x4ba138(0x87)][_0x4ba138(0xe0)](_0x4ba138(0xc0))||_0x11130f[_0x4ba138(0x9d)]['includes'](_0x4ba138(0x99)))_0x1462ec=this[_0x4ba138(0x86)][_0x4ba138(0xc4)][_0x11130f[_0x4ba138(0x87)]]||0x5,_0x3faf41='point_cloud_throttled';else{if(_0x11130f['type']['includes'](_0x4ba138(0xcd))||_0x11130f[_0x4ba138(0x9d)]['includes']('scan'))_0x1462ec=this[_0x4ba138(0x86)][_0x4ba138(0xc4)][_0x11130f['type']]||0xf,_0x3faf41=_0x4ba138(0xd1);else _0x11130f[_0x4ba138(0x87)]['includes'](_0x4ba138(0x8f))&&(_0x1462ec=this[_0x4ba138(0x86)][_0x4ba138(0xc4)][_0x11130f['type']]||0xa,_0x3faf41='image_throttled');}return{'type':_0x4ba138(0x9a),'reason':_0x3faf41,'isLargeData':!![],'estimatedSize':_0x19d0dc,'maxFrequency':_0x1462ec};}return{'type':_0x4ba138(0xa4),'reason':_0x4ba138(0xd3),'isLargeData':![],'estimatedSize':_0x19d0dc,'maxFrequency':null};}[a4_0x4a18bb(0xb9)](_0x3003f6,_0x5d9251){const _0x53773e=a4_0x4a18bb;if(_0x3003f6['includes'](':')){const [_0x1bd4d4,_0x4f0b65]=_0x3003f6[_0x53773e(0x95)](':');return{'type':_0x1bd4d4,'reason':_0x5d9251,'isLargeData':!![],'maxFrequency':_0x1bd4d4==='throttle'?parseFloat(_0x4f0b65):null,'estimatedSize':this['config'][_0x53773e(0xc8)]+0x1};}return{'type':_0x3003f6,'reason':_0x5d9251,'isLargeData':_0x3003f6!=='websocket','maxFrequency':null,'estimatedSize':this[_0x53773e(0x86)][_0x53773e(0xc8)]+0x1};}[a4_0x4a18bb(0xb7)](_0x5638e9,_0x3ee24b){const _0x11646a=a4_0x4a18bb,_0x54f077=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x34fffc=[_0x11646a(0xcb),_0x11646a(0xc2),_0x11646a(0xbf),'sensor_msgs/msg/CompressedImage'];return _0x54f077[_0x11646a(0xdb)](_0x56af88=>_0x56af88['test'](_0x5638e9))||_0x34fffc['includes'](_0x3ee24b);}[a4_0x4a18bb(0xb3)](_0x39af1e,_0x3e64ef=''){const _0x62c61=a4_0x4a18bb,_0x33956a=[_0x62c61(0xc2),_0x62c61(0xa7)];if(_0x33956a[_0x62c61(0xe0)](_0x3e64ef))return!_0x39af1e[_0x62c61(0xe0)](_0x62c61(0x99))&&!_0x39af1e['includes'](_0x62c61(0xd7))&&!_0x39af1e['includes'](_0x62c61(0xa9));return(_0x39af1e[_0x62c61(0xe0)](_0x62c61(0xda))||_0x39af1e[_0x62c61(0xe0)](_0x62c61(0xb5)))&&!_0x39af1e[_0x62c61(0xe0)](_0x62c61(0x99))&&!_0x39af1e[_0x62c61(0xe0)](_0x62c61(0xd7))&&!_0x39af1e['includes'](_0x62c61(0xa9));}[a4_0x4a18bb(0xd2)](_0x236f88,_0x50a05f){const _0x470859=a4_0x4a18bb,_0x5d9177={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x5d9177[_0x50a05f])return _0x5d9177[_0x50a05f];if(_0x236f88[_0x470859(0xe0)]('point')||_0x236f88['includes'](_0x470859(0x85)))return 0x190*0x400;if(_0x236f88[_0x470859(0xe0)](_0x470859(0x93)))return 0x12c*0x400;if(_0x236f88[_0x470859(0xe0)](_0x470859(0xb5)))return 0x32*0x400;return 0x400;}['handleMessage'](_0x410d65){const _0x228d34=a4_0x4a18bb;let _0x134110=this[_0x228d34(0xb2)]['get'](_0x410d65[_0x228d34(0x88)]);if(!_0x134110){console[_0x228d34(0xcf)](_0x228d34(0xd0)+_0x410d65[_0x228d34(0x88)]);let _0xe50ff6='unknown';if(_0x410d65[_0x228d34(0x88)][_0x228d34(0xe0)](_0x228d34(0xda))&&_0x410d65['topic']['includes'](_0x228d34(0xb5)))_0xe50ff6=_0x228d34(0xa7);else{if(_0x410d65[_0x228d34(0x88)]['includes'](_0x228d34(0xda)))_0xe50ff6=_0x228d34(0xc2);else{if(_0x410d65['topic']['includes'](_0x228d34(0x92))||_0x410d65[_0x228d34(0x88)][_0x228d34(0xe0)]('cloud'))_0xe50ff6=_0x228d34(0xcb);else _0x410d65[_0x228d34(0x88)][_0x228d34(0xe0)]('scan')&&(_0xe50ff6='sensor_msgs/msg/LaserScan');}}const _0x54c61f={'name':_0x410d65[_0x228d34(0x88)],'type':_0xe50ff6};this[_0x228d34(0xa8)](_0x54c61f),_0x134110=this[_0x228d34(0xb2)]['get'](_0x410d65[_0x228d34(0x88)]);}if(!_0x134110)return{'action':'forward','message':_0x410d65};switch(_0x134110[_0x228d34(0xc7)]){case _0x228d34(0x9a):return this['shouldThrottle'](_0x410d65[_0x228d34(0x88)],_0x134110['maxFrequency'])?{'action':_0x228d34(0x9c),'message':_0x410d65}:{'action':'throttle_skip'};case _0x228d34(0xa2):return{'action':_0x228d34(0x9f)};case'websocket':default:return{'action':_0x228d34(0x9c),'message':_0x410d65};}}['shouldThrottle'](_0x13b4d4,_0x34f2f8){const _0x3208b5=a4_0x4a18bb;if(!_0x34f2f8)return!![];const _0x204e48=Date['now'](),_0x235c78=0x3e8/_0x34f2f8;!this['lastMessageTimes']['has'](_0x13b4d4)&&this['lastMessageTimes'][_0x3208b5(0xb0)](_0x13b4d4,0x0);const _0x29c890=this[_0x3208b5(0xc6)][_0x3208b5(0xa5)](_0x13b4d4),_0x12d7d2=_0x204e48-_0x29c890;if(_0x12d7d2>=_0x235c78)return this[_0x3208b5(0xc6)][_0x3208b5(0xb0)](_0x13b4d4,_0x204e48),!![];return![];}['getTopicStrategy'](_0x3e4111){const _0x473a43=a4_0x4a18bb;return this['topicStrategies'][_0x473a43(0xa5)](_0x3e4111);}[a4_0x4a18bb(0xdd)](){const _0x2fe431=a4_0x4a18bb;return Array[_0x2fe431(0xa0)](this['topicStrategies'][_0x2fe431(0xc3)]())[_0x2fe431(0xb1)](([_0x1b63a3,_0x3c7494])=>({'topic':_0x1b63a3,..._0x3c7494}));}[a4_0x4a18bb(0x9b)](_0x35e334){const _0x1cb3f8=a4_0x4a18bb,_0x56954e=this['topicStrategies']['get'](_0x35e334);return _0x56954e?.[_0x1cb3f8(0xc7)]===_0x1cb3f8(0xde);}[a4_0x4a18bb(0xdc)](){const _0x2f7c12=a4_0x4a18bb,_0x16a16c={};return this[_0x2f7c12(0xb2)]['forEach']((_0x2aedff,_0x1e06e3)=>{const _0x45d514=_0x2f7c12;!_0x16a16c[_0x2aedff[_0x45d514(0xc7)]]&&(_0x16a16c[_0x2aedff[_0x45d514(0xc7)]]=0x0),_0x16a16c[_0x2aedff[_0x45d514(0xc7)]]++;}),{'totalTopics':this['topicStrategies']['size'],'strategies':_0x16a16c,'largeDataTopics':Array[_0x2f7c12(0xa0)](this[_0x2f7c12(0xb2)]['entries']())[_0x2f7c12(0xae)](([_0x37b800,_0x4fded2])=>_0x4fded2[_0x2f7c12(0xbd)])['map'](([_0x5c8fae,_0x3572bc])=>_0x5c8fae)};}}function a4_0x7628(){const _0x3fc20d=['webrtc_only','[TopicManager]\x20Error\x20getting\x20topics:','includes','topicHandling','estimatedSize','types','5144FELmGx','cloud','config','type','topic','\x20topics','1792035GlpQdh','defaultLargeDataStrategy','discoveryInProgress','2mzasDS','loadConfig','Image','child_process','discoverTopics','point','image_raw','getTopics','split','reason','[TopicManager]\x20Strategies:','1344gmCeug','points','throttle','shouldUseWebRTC','forward','name','length','webrtc_skip','from','error','webrtc','[TopicManager]\x20Topic\x20discovery\x20failed:','websocket','get','11354gYzfBS','sensor_msgs/msg/CompressedImage','analyzeTopicStrategy','depth_points','video_webrtc_streaming','[TopicManager]\x20Starting\x20topic\x20discovery...','large_data_throttled','519ayZtpr','filter','search','set','map','topicStrategies','isCameraTopic','determineTopicStrategy','compressed','[TopicManager]\x20Found\x20','isLargeDataTopic','534308JSNaRj','parseStrategyConfig','topics','strategiesConfig','288MbhQeS','isLargeData','maxFrequency','sensor_msgs/msg/LaserScan','PointCloud2','constructor','sensor_msgs/msg/Image','entries','throttleFrequencies','292840gGXtcc','lastMessageTimes','strategy','largeDataThreshold','pattern_configured','strategies','sensor_msgs/msg/PointCloud2','apply','LaserScan','12GcoSSy','log','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','laser_scan_throttled','estimateTopicSize','normal_size','18027845sZRZGM','[TopicManager]\x20Topic\x20','(((.+)+)+)+$','point_cloud','129144krEzSz','toString','image','some','getStatistics','getManagedTopics'];a4_0x7628=function(){return _0x3fc20d;};return a4_0x7628();}module['exports']=new TopicManager();