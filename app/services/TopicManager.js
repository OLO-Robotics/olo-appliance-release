const a4_0x309fc9=a4_0x310b;(function(_0x318155,_0xc6f0){const _0x385091=a4_0x310b,_0x12fa44=_0x318155();while(!![]){try{const _0x87c5cf=parseInt(_0x385091(0xf0))/0x1*(parseInt(_0x385091(0xed))/0x2)+-parseInt(_0x385091(0xd6))/0x3*(-parseInt(_0x385091(0xf8))/0x4)+-parseInt(_0x385091(0xfa))/0x5+-parseInt(_0x385091(0xdc))/0x6*(parseInt(_0x385091(0xac))/0x7)+parseInt(_0x385091(0x103))/0x8*(-parseInt(_0x385091(0xe6))/0x9)+-parseInt(_0x385091(0xb1))/0xa+parseInt(_0x385091(0xe1))/0xb;if(_0x87c5cf===_0xc6f0)break;else _0x12fa44['push'](_0x12fa44['shift']());}catch(_0x2a8929){_0x12fa44['push'](_0x12fa44['shift']());}}}(a4_0x19bd,0x7ba90));function a4_0x19bd(){const _0x2a49b3=['image','1757850eppnAa','throttle_skip','forEach','large_data_throttled','topicHandling','websocket','length','topicStrategies','apply','13128guoWTb','webrtc','analyzeTopicStrategy','scan','includes','video_webrtc_streaming','[TopicManager]\x20Initialised','Image','getTopics','now','webrtc_skip','424886eFKudG','discoveryInProgress','config','reason','[TopicManager]\x20Starting\x20topic\x20discovery...','2382380XTIHmJ','constructor','isCameraTopic','point_cloud','sensor_msgs/msg/Image','forward','estimateTopicSize','compressed','set','point_cloud_throttled','maxFrequency','shouldUseWebRTC','estimatedSize','isLargeData','name','toString','unknown','getStatistics','sensor_msgs/msg/CompressedImage','loadConfig','defaultLargeDataStrategy','topic','strategies','sensor_msgs/msg/LaserScan','split','strategiesConfig','child_process','has','throttleFrequencies','discoverTopics','search','[TopicManager]\x20Topic\x20discovery\x20completed','type','strategy','entries','from','\x20topics','3JhKFCJ','image_throttled','point','lastMessageTimes','isLargeDataTopic','size','90cKQYuM','replace','throttle','normal_size','error','13688334ZNWjlb','filter','(((.+)+)+)+$','types','parseStrategyConfig','4842neuKQr','sensor_msgs/msg/PointCloud2','LaserScan','exports','cloud','shouldThrottle','PointCloud2','2UOzOJh','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','test','658309RPVxuO','largeDataThreshold','some','get','determineTopicStrategy','depth_points','points','log','3947780vJyIar'];a4_0x19bd=function(){return _0x2a49b3;};return a4_0x19bd();}function a4_0x310b(_0x167aed,_0x50b116){const _0x2ed271=a4_0x19bd();return a4_0x310b=function(_0x349197,_0x2868d8){_0x349197=_0x349197-0xa7;let _0x19bd16=_0x2ed271[_0x349197];return _0x19bd16;},a4_0x310b(_0x167aed,_0x50b116);}const a4_0x2868d8=(function(){let _0x53fc05=!![];return function(_0x1e885c,_0x49a572){const _0x3c0f09=_0x53fc05?function(){const _0x1dbc02=a4_0x310b;if(_0x49a572){const _0x83baa4=_0x49a572[_0x1dbc02(0x102)](_0x1e885c,arguments);return _0x49a572=null,_0x83baa4;}}:function(){};return _0x53fc05=![],_0x3c0f09;};}()),a4_0x349197=a4_0x2868d8(this,function(){const _0xaa85c7=a4_0x310b;return a4_0x349197[_0xaa85c7(0xc0)]()['search'](_0xaa85c7(0xe3))[_0xaa85c7(0xc0)]()[_0xaa85c7(0xb2)](a4_0x349197)[_0xaa85c7(0xcf)](_0xaa85c7(0xe3));});a4_0x349197();const {execSync}=require(a4_0x309fc9(0xcb));class TopicManager{constructor(){const _0x14cd69=a4_0x309fc9;this['topicStrategies']=new Map(),this[_0x14cd69(0xd9)]=new Map(),this[_0x14cd69(0xad)]=![],this[_0x14cd69(0xae)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x14cd69(0xf7)](_0x14cd69(0xa7));}[a4_0x309fc9(0xc4)](_0x233084){const _0x56b815=a4_0x309fc9;if(_0x233084[_0x56b815(0xfe)]){const _0x5c1656=_0x233084['topicHandling'];_0x5c1656[_0x56b815(0xf1)]&&(this[_0x56b815(0xae)][_0x56b815(0xf1)]=_0x5c1656[_0x56b815(0xf1)]),_0x5c1656[_0x56b815(0xc5)]&&(this[_0x56b815(0xae)][_0x56b815(0xc5)]=_0x5c1656[_0x56b815(0xc5)]),_0x5c1656['strategies']&&(this[_0x56b815(0xae)]['strategiesConfig']={..._0x5c1656[_0x56b815(0xc7)]}),_0x5c1656[_0x56b815(0xcd)]&&(this[_0x56b815(0xae)][_0x56b815(0xcd)]={...this[_0x56b815(0xae)][_0x56b815(0xcd)],..._0x5c1656[_0x56b815(0xcd)]}),console[_0x56b815(0xf7)]('[TopicManager]\x20Loaded\x20configuration:',this[_0x56b815(0xae)]);}}async[a4_0x309fc9(0xce)](_0x30595d){const _0x2bedef=a4_0x309fc9;if(this[_0x2bedef(0xad)]||!_0x30595d)return;this['discoveryInProgress']=!![],console['log'](_0x2bedef(0xb0));try{await new Promise((_0x5d192c,_0x140df2)=>{const _0x1522d3=_0x2bedef;_0x30595d[_0x1522d3(0xa9)](_0x1dd25=>{const _0x43f5c3=_0x1522d3,_0x5be3d8=_0x1dd25['topics']['map']((_0x42c271,_0x4d0303)=>({'name':_0x42c271,'type':_0x1dd25[_0x43f5c3(0xe4)][_0x4d0303]}));console[_0x43f5c3(0xf7)]('[TopicManager]\x20Found\x20'+_0x5be3d8[_0x43f5c3(0x100)]+_0x43f5c3(0xd5));for(const _0x4ffd1b of _0x5be3d8){this[_0x43f5c3(0x105)](_0x4ffd1b);}console[_0x43f5c3(0xf7)](_0x43f5c3(0xd0)),console[_0x43f5c3(0xf7)]('[TopicManager]\x20Strategies:',Array[_0x43f5c3(0xd4)](this[_0x43f5c3(0x101)][_0x43f5c3(0xd3)]())),_0x5d192c();},_0x1be973=>{console['error']('[TopicManager]\x20Error\x20getting\x20topics:',_0x1be973),_0x140df2(_0x1be973);});});}catch(_0x2eb951){console[_0x2bedef(0xe0)]('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x2eb951);}finally{this['discoveryInProgress']=![];}}[a4_0x309fc9(0x105)](_0x55dc89){const _0x486931=a4_0x309fc9,_0x1b318c=this['determineTopicStrategy'](_0x55dc89);this['topicStrategies'][_0x486931(0xb9)](_0x55dc89[_0x486931(0xbf)],{'type':_0x55dc89['type'],'strategy':_0x1b318c['type'],'reason':_0x1b318c[_0x486931(0xaf)],'maxFrequency':_0x1b318c[_0x486931(0xbb)],'isLargeData':_0x1b318c['isLargeData'],'estimatedSize':_0x1b318c[_0x486931(0xbd)]}),console['log']('[TopicManager]\x20Topic\x20'+_0x55dc89[_0x486931(0xbf)]+':\x20'+_0x1b318c[_0x486931(0xd1)]+'\x20('+_0x1b318c[_0x486931(0xaf)]+')');}[a4_0x309fc9(0xf4)](_0x22c4d8){const _0x56c967=a4_0x309fc9;if(this[_0x56c967(0xae)][_0x56c967(0xca)][_0x22c4d8[_0x56c967(0xbf)]]){const _0x1ad638=this[_0x56c967(0xae)]['strategiesConfig'][_0x22c4d8['name']];return this[_0x56c967(0xe5)](_0x1ad638,'user_configured');}for(const [_0x19bc32,_0x1f0180]of Object[_0x56c967(0xd3)](this[_0x56c967(0xae)][_0x56c967(0xca)])){if(_0x22c4d8[_0x56c967(0xbf)][_0x56c967(0x107)](_0x19bc32[_0x56c967(0xdd)]('/','')))return this[_0x56c967(0xe5)](_0x1f0180,'pattern_configured');}if(this[_0x56c967(0xb3)](_0x22c4d8[_0x56c967(0xbf)],_0x22c4d8[_0x56c967(0xd1)])){const _0x7961de=this['estimateTopicSize'](_0x22c4d8[_0x56c967(0xbf)],_0x22c4d8[_0x56c967(0xd1)]);return{'type':_0x56c967(0x104),'reason':_0x56c967(0x108),'isLargeData':!![],'estimatedSize':_0x7961de,'maxFrequency':null};}const _0x9b390a=this['isLargeDataTopic'](_0x22c4d8['name'],_0x22c4d8[_0x56c967(0xd1)]),_0x4bbf8b=this['estimateTopicSize'](_0x22c4d8[_0x56c967(0xbf)],_0x22c4d8['type']);if(_0x9b390a||_0x4bbf8b>this[_0x56c967(0xae)][_0x56c967(0xf1)]){let _0x561814=this[_0x56c967(0xae)][_0x56c967(0xcd)][_0x22c4d8[_0x56c967(0xd1)]]||0xa,_0x129651=_0x56c967(0xfd);if(_0x22c4d8[_0x56c967(0xd1)][_0x56c967(0x107)](_0x56c967(0xec))||_0x22c4d8[_0x56c967(0xbf)][_0x56c967(0x107)](_0x56c967(0xf6)))_0x561814=this[_0x56c967(0xae)]['throttleFrequencies'][_0x22c4d8['type']]||0x5,_0x129651=_0x56c967(0xba);else{if(_0x22c4d8[_0x56c967(0xd1)][_0x56c967(0x107)](_0x56c967(0xe8))||_0x22c4d8[_0x56c967(0xbf)][_0x56c967(0x107)]('scan'))_0x561814=this['config'][_0x56c967(0xcd)][_0x22c4d8[_0x56c967(0xd1)]]||0xf,_0x129651='laser_scan_throttled';else _0x22c4d8[_0x56c967(0xd1)][_0x56c967(0x107)](_0x56c967(0xa8))&&(_0x561814=this[_0x56c967(0xae)][_0x56c967(0xcd)][_0x22c4d8[_0x56c967(0xd1)]]||0xa,_0x129651=_0x56c967(0xd7));}return{'type':_0x56c967(0xde),'reason':_0x129651,'isLargeData':!![],'estimatedSize':_0x4bbf8b,'maxFrequency':_0x561814};}return{'type':_0x56c967(0xff),'reason':_0x56c967(0xdf),'isLargeData':![],'estimatedSize':_0x4bbf8b,'maxFrequency':null};}[a4_0x309fc9(0xe5)](_0x5dec9f,_0x51696a){const _0x557b6c=a4_0x309fc9;if(_0x5dec9f[_0x557b6c(0x107)](':')){const [_0x135a7a,_0x4bb021]=_0x5dec9f[_0x557b6c(0xc9)](':');return{'type':_0x135a7a,'reason':_0x51696a,'isLargeData':!![],'maxFrequency':_0x135a7a===_0x557b6c(0xde)?parseFloat(_0x4bb021):null,'estimatedSize':this[_0x557b6c(0xae)][_0x557b6c(0xf1)]+0x1};}return{'type':_0x5dec9f,'reason':_0x51696a,'isLargeData':_0x5dec9f!==_0x557b6c(0xff),'maxFrequency':null,'estimatedSize':this[_0x557b6c(0xae)][_0x557b6c(0xf1)]+0x1};}[a4_0x309fc9(0xda)](_0x35d76b,_0x57b09a){const _0x136a6e=a4_0x309fc9,_0x5cc21d=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x532a5f=['sensor_msgs/msg/PointCloud2','sensor_msgs/msg/Image',_0x136a6e(0xc8),'sensor_msgs/msg/CompressedImage'];return _0x5cc21d[_0x136a6e(0xf2)](_0x51e902=>_0x51e902[_0x136a6e(0xef)](_0x35d76b))||_0x532a5f['includes'](_0x57b09a);}[a4_0x309fc9(0xb3)](_0x93e8ea,_0x3cca74=''){const _0x4df08c=a4_0x309fc9,_0x2d2546=[_0x4df08c(0xb5),_0x4df08c(0xc3)];if(_0x2d2546['includes'](_0x3cca74))return!_0x93e8ea['includes']('points')&&!_0x93e8ea[_0x4df08c(0x107)](_0x4df08c(0xb4))&&!_0x93e8ea['includes'](_0x4df08c(0xf5));return(_0x93e8ea[_0x4df08c(0x107)](_0x4df08c(0xf9))||_0x93e8ea[_0x4df08c(0x107)]('compressed'))&&!_0x93e8ea[_0x4df08c(0x107)](_0x4df08c(0xf6))&&!_0x93e8ea[_0x4df08c(0x107)]('point_cloud')&&!_0x93e8ea[_0x4df08c(0x107)]('depth_points');}[a4_0x309fc9(0xb7)](_0x3d2f8d,_0x2fb4f7){const _0x5268d5=a4_0x309fc9,_0x3f44a={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x3f44a[_0x2fb4f7])return _0x3f44a[_0x2fb4f7];if(_0x3d2f8d['includes'](_0x5268d5(0xd8))||_0x3d2f8d[_0x5268d5(0x107)](_0x5268d5(0xea)))return 0x190*0x400;if(_0x3d2f8d[_0x5268d5(0x107)]('image_raw'))return 0x12c*0x400;if(_0x3d2f8d[_0x5268d5(0x107)](_0x5268d5(0xb8)))return 0x32*0x400;return 0x400;}['handleMessage'](_0x1a9cc5){const _0x14d42d=a4_0x309fc9;let _0x4e4789=this[_0x14d42d(0x101)][_0x14d42d(0xf3)](_0x1a9cc5[_0x14d42d(0xc6)]);if(!_0x4e4789){console['log'](_0x14d42d(0xee)+_0x1a9cc5[_0x14d42d(0xc6)]);let _0x3edf61=_0x14d42d(0xc1);if(_0x1a9cc5[_0x14d42d(0xc6)][_0x14d42d(0x107)](_0x14d42d(0xf9))&&_0x1a9cc5[_0x14d42d(0xc6)][_0x14d42d(0x107)]('compressed'))_0x3edf61=_0x14d42d(0xc3);else{if(_0x1a9cc5[_0x14d42d(0xc6)]['includes']('image'))_0x3edf61=_0x14d42d(0xb5);else{if(_0x1a9cc5[_0x14d42d(0xc6)]['includes'](_0x14d42d(0xd8))||_0x1a9cc5[_0x14d42d(0xc6)]['includes'](_0x14d42d(0xea)))_0x3edf61=_0x14d42d(0xe7);else _0x1a9cc5[_0x14d42d(0xc6)][_0x14d42d(0x107)](_0x14d42d(0x106))&&(_0x3edf61=_0x14d42d(0xc8));}}const _0x50ee34={'name':_0x1a9cc5[_0x14d42d(0xc6)],'type':_0x3edf61};this[_0x14d42d(0x105)](_0x50ee34),_0x4e4789=this[_0x14d42d(0x101)][_0x14d42d(0xf3)](_0x1a9cc5[_0x14d42d(0xc6)]);}if(!_0x4e4789)return{'action':'forward','message':_0x1a9cc5};switch(_0x4e4789['strategy']){case _0x14d42d(0xde):return this[_0x14d42d(0xeb)](_0x1a9cc5['topic'],_0x4e4789[_0x14d42d(0xbb)])?{'action':_0x14d42d(0xb6),'message':_0x1a9cc5}:{'action':_0x14d42d(0xfb)};case _0x14d42d(0x104):return{'action':_0x14d42d(0xab)};case _0x14d42d(0xff):default:return{'action':_0x14d42d(0xb6),'message':_0x1a9cc5};}}[a4_0x309fc9(0xeb)](_0x3e06d4,_0x130204){const _0x1ff6dc=a4_0x309fc9;if(!_0x130204)return!![];const _0x39559b=Date[_0x1ff6dc(0xaa)](),_0x49234e=0x3e8/_0x130204;!this[_0x1ff6dc(0xd9)][_0x1ff6dc(0xcc)](_0x3e06d4)&&this['lastMessageTimes'][_0x1ff6dc(0xb9)](_0x3e06d4,0x0);const _0x837964=this[_0x1ff6dc(0xd9)][_0x1ff6dc(0xf3)](_0x3e06d4),_0x3c0dc6=_0x39559b-_0x837964;if(_0x3c0dc6>=_0x49234e)return this['lastMessageTimes'][_0x1ff6dc(0xb9)](_0x3e06d4,_0x39559b),!![];return![];}['getTopicStrategy'](_0x5a66bd){const _0x44f84d=a4_0x309fc9;return this[_0x44f84d(0x101)]['get'](_0x5a66bd);}['getManagedTopics'](){const _0x47694f=a4_0x309fc9;return Array['from'](this[_0x47694f(0x101)][_0x47694f(0xd3)]())['map'](([_0x3448b6,_0x2ef436])=>({'topic':_0x3448b6,..._0x2ef436}));}[a4_0x309fc9(0xbc)](_0x307a10){const _0x590d19=a4_0x309fc9,_0x24bb3d=this[_0x590d19(0x101)]['get'](_0x307a10);return _0x24bb3d?.[_0x590d19(0xd2)]==='webrtc_only';}[a4_0x309fc9(0xc2)](){const _0x50147c=a4_0x309fc9,_0x396701={};return this[_0x50147c(0x101)][_0x50147c(0xfc)]((_0x3ff21f,_0x3e99d6)=>{const _0x183557=_0x50147c;!_0x396701[_0x3ff21f[_0x183557(0xd2)]]&&(_0x396701[_0x3ff21f[_0x183557(0xd2)]]=0x0),_0x396701[_0x3ff21f['strategy']]++;}),{'totalTopics':this[_0x50147c(0x101)][_0x50147c(0xdb)],'strategies':_0x396701,'largeDataTopics':Array[_0x50147c(0xd4)](this['topicStrategies'][_0x50147c(0xd3)]())[_0x50147c(0xe2)](([_0x204f8b,_0x468150])=>_0x468150[_0x50147c(0xbe)])['map'](([_0x29612c,_0x724a1])=>_0x29612c)};}}module[a4_0x309fc9(0xe9)]=new TopicManager();