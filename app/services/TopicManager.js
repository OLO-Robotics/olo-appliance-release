const a6_0x31b14f=a6_0x5091;(function(_0x22630f,_0x11efaf){const _0x417f19=a6_0x5091,_0x6e23c2=_0x22630f();while(!![]){try{const _0x2b9623=parseInt(_0x417f19(0x1fa))/0x1*(-parseInt(_0x417f19(0x1b3))/0x2)+-parseInt(_0x417f19(0x1c8))/0x3*(-parseInt(_0x417f19(0x1da))/0x4)+-parseInt(_0x417f19(0x1cf))/0x5*(parseInt(_0x417f19(0x1f4))/0x6)+-parseInt(_0x417f19(0x1d1))/0x7*(parseInt(_0x417f19(0x1d6))/0x8)+parseInt(_0x417f19(0x1b4))/0x9+-parseInt(_0x417f19(0x1d2))/0xa*(parseInt(_0x417f19(0x1b1))/0xb)+parseInt(_0x417f19(0x207))/0xc;if(_0x2b9623===_0x11efaf)break;else _0x6e23c2['push'](_0x6e23c2['shift']());}catch(_0xf126c5){_0x6e23c2['push'](_0x6e23c2['shift']());}}}(a6_0xd377,0x18cbe));const a6_0x721df1=(function(){let _0x369066=!![];return function(_0x561b87,_0x22bbc0){const _0x1af26d=_0x369066?function(){const _0x3692c8=a6_0x5091;if(_0x22bbc0){const _0x56fc7d=_0x22bbc0[_0x3692c8(0x1b6)](_0x561b87,arguments);return _0x22bbc0=null,_0x56fc7d;}}:function(){};return _0x369066=![],_0x1af26d;};}()),a6_0x19fef2=a6_0x721df1(this,function(){const _0x22ff5f=a6_0x5091;return a6_0x19fef2['toString']()[_0x22ff5f(0x1ea)](_0x22ff5f(0x1b2))[_0x22ff5f(0x1c4)]()['constructor'](a6_0x19fef2)[_0x22ff5f(0x1ea)]('(((.+)+)+)+$');});function a6_0x5091(_0x5726e8,_0x2269c1){const _0x1b538b=a6_0xd377();return a6_0x5091=function(_0x19fef2,_0x721df1){_0x19fef2=_0x19fef2-0x1aa;let _0xd37700=_0x1b538b[_0x19fef2];return _0xd37700;},a6_0x5091(_0x5726e8,_0x2269c1);}function a6_0xd377(){const _0x50d8ba=['1015PbDYTI','largeDataThreshold','82208zKBcXv','790WChdBq','has','from','defaultLargeDataStrategy','32uncxzY','isCameraTopic','discoverTopics','[TopicManager]\x20Topic\x20discovery\x20failed:','108NUPkzL','isLargeDataTopic','[TopicManager]\x20Initialised','sensor_msgs/msg/LaserScan','throttle','normal_size','estimateTopicSize','throttleFrequencies','strategy','forEach','strategiesConfig','image_raw','Image','[TopicManager]\x20Loaded\x20configuration:','strategies','webrtc_only','search','shouldUseWebRTC','reason','user_configured','LaserScan','get','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','loadConfig','sensor_msgs/msg/Image','websocket','534aBSMcU','map','getManagedTopics','video_webrtc_streaming','getTopics','includes','9967tWoqCC','[TopicManager]\x20Topic\x20','[TopicManager]\x20Strategies:','lastMessageTimes','now','topicStrategies','set','compressed','maxFrequency','determineTopicStrategy','error','point','estimatedSize','2596824rSszvB','image','\x20topics','config','isLargeData','webrtc_skip','[TopicManager]\x20Found\x20','forward','analyzeTopicStrategy','points','sensor_msgs/msg/PointCloud2','22605Yyhmiv','(((.+)+)+)+$','14dqRnrg','1268856rroTLJ','some','apply','point_cloud_throttled','handleMessage','throttle_skip','entries','replace','cloud','size','parseStrategyConfig','child_process','shouldThrottle','laser_scan_throttled','log','type','toString','name','getTopicStrategy','sensor_msgs/msg/CompressedImage','4593raEkRL','getStatistics','topics','point_cloud','discoveryInProgress','scan','topic'];a6_0xd377=function(){return _0x50d8ba;};return a6_0xd377();}a6_0x19fef2();const {execSync}=require(a6_0x31b14f(0x1bf));class TopicManager{constructor(){const _0x3cdd58=a6_0x31b14f;this['topicStrategies']=new Map(),this[_0x3cdd58(0x1fd)]=new Map(),this[_0x3cdd58(0x1cc)]=![],this[_0x3cdd58(0x20a)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x3cdd58(0x1e9),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x3cdd58(0x1c2)](_0x3cdd58(0x1dc));}[a6_0x31b14f(0x1f1)](_0x5a5422){const _0x5cf044=a6_0x31b14f;if(_0x5a5422['topicHandling']){const _0x234aee=_0x5a5422['topicHandling'];_0x234aee[_0x5cf044(0x1d0)]&&(this['config'][_0x5cf044(0x1d0)]=_0x234aee[_0x5cf044(0x1d0)]),_0x234aee[_0x5cf044(0x1d5)]&&(this['config']['defaultLargeDataStrategy']=_0x234aee[_0x5cf044(0x1d5)]),_0x234aee[_0x5cf044(0x1e8)]&&(this[_0x5cf044(0x20a)][_0x5cf044(0x1e4)]={..._0x234aee[_0x5cf044(0x1e8)]}),_0x234aee['throttleFrequencies']&&(this[_0x5cf044(0x20a)][_0x5cf044(0x1e1)]={...this[_0x5cf044(0x20a)][_0x5cf044(0x1e1)],..._0x234aee[_0x5cf044(0x1e1)]}),console[_0x5cf044(0x1c2)](_0x5cf044(0x1e7),this['config']);}}async[a6_0x31b14f(0x1d8)](_0x4d077e){const _0x58ce0e=a6_0x31b14f;if(this[_0x58ce0e(0x1cc)]||!_0x4d077e)return;this['discoveryInProgress']=!![],console[_0x58ce0e(0x1c2)]('[TopicManager]\x20Starting\x20topic\x20discovery...');try{await new Promise((_0x3ef3a4,_0x4f0b0c)=>{const _0x5d06e2=_0x58ce0e;_0x4d077e[_0x5d06e2(0x1f8)](_0x58ae4d=>{const _0x3a6681=_0x5d06e2,_0x48599b=_0x58ae4d[_0x3a6681(0x1ca)][_0x3a6681(0x1f5)]((_0x22b4b7,_0x3125ca)=>({'name':_0x22b4b7,'type':_0x58ae4d['types'][_0x3125ca]}));console[_0x3a6681(0x1c2)](_0x3a6681(0x1ac)+_0x48599b['length']+_0x3a6681(0x209));for(const _0x1eb535 of _0x48599b){this[_0x3a6681(0x1ae)](_0x1eb535);}console['log']('[TopicManager]\x20Topic\x20discovery\x20completed'),console[_0x3a6681(0x1c2)](_0x3a6681(0x1fc),Array['from'](this['topicStrategies']['entries']())),_0x3ef3a4();},_0x343949=>{console['error']('[TopicManager]\x20Error\x20getting\x20topics:',_0x343949),_0x4f0b0c(_0x343949);});});}catch(_0x413dfe){console[_0x58ce0e(0x204)](_0x58ce0e(0x1d9),_0x413dfe);}finally{this[_0x58ce0e(0x1cc)]=![];}}['analyzeTopicStrategy'](_0x26105e){const _0x3642e0=a6_0x31b14f,_0x2cdb21=this[_0x3642e0(0x203)](_0x26105e);this['topicStrategies'][_0x3642e0(0x200)](_0x26105e['name'],{'type':_0x26105e[_0x3642e0(0x1c3)],'strategy':_0x2cdb21[_0x3642e0(0x1c3)],'reason':_0x2cdb21[_0x3642e0(0x1ec)],'maxFrequency':_0x2cdb21[_0x3642e0(0x202)],'isLargeData':_0x2cdb21['isLargeData'],'estimatedSize':_0x2cdb21[_0x3642e0(0x206)]}),console[_0x3642e0(0x1c2)](_0x3642e0(0x1fb)+_0x26105e[_0x3642e0(0x1c5)]+':\x20'+_0x2cdb21['type']+'\x20('+_0x2cdb21[_0x3642e0(0x1ec)]+')');}[a6_0x31b14f(0x203)](_0x458ae1){const _0x3e1c16=a6_0x31b14f;if(this[_0x3e1c16(0x20a)][_0x3e1c16(0x1e4)][_0x458ae1[_0x3e1c16(0x1c5)]]){const _0x1a2523=this[_0x3e1c16(0x20a)][_0x3e1c16(0x1e4)][_0x458ae1[_0x3e1c16(0x1c5)]];return this[_0x3e1c16(0x1be)](_0x1a2523,_0x3e1c16(0x1ed));}for(const [_0x2a6ccf,_0x4d8a64]of Object[_0x3e1c16(0x1ba)](this[_0x3e1c16(0x20a)][_0x3e1c16(0x1e4)])){if(_0x458ae1[_0x3e1c16(0x1c5)][_0x3e1c16(0x1f9)](_0x2a6ccf[_0x3e1c16(0x1bb)]('/','')))return this[_0x3e1c16(0x1be)](_0x4d8a64,'pattern_configured');}if(this[_0x3e1c16(0x1d7)](_0x458ae1[_0x3e1c16(0x1c5)],_0x458ae1[_0x3e1c16(0x1c3)])){const _0x1467f6=this[_0x3e1c16(0x1e0)](_0x458ae1[_0x3e1c16(0x1c5)],_0x458ae1['type']);return{'type':'webrtc','reason':_0x3e1c16(0x1f7),'isLargeData':!![],'estimatedSize':_0x1467f6,'maxFrequency':null};}const _0x118f2b=this[_0x3e1c16(0x1db)](_0x458ae1['name'],_0x458ae1['type']),_0x377761=this[_0x3e1c16(0x1e0)](_0x458ae1[_0x3e1c16(0x1c5)],_0x458ae1[_0x3e1c16(0x1c3)]);if(_0x118f2b||_0x377761>this['config']['largeDataThreshold']){let _0x2e6453=this[_0x3e1c16(0x20a)][_0x3e1c16(0x1e1)][_0x458ae1[_0x3e1c16(0x1c3)]]||0xa,_0x12b502='large_data_throttled';if(_0x458ae1['type'][_0x3e1c16(0x1f9)]('PointCloud2')||_0x458ae1[_0x3e1c16(0x1c5)][_0x3e1c16(0x1f9)](_0x3e1c16(0x1af)))_0x2e6453=this[_0x3e1c16(0x20a)][_0x3e1c16(0x1e1)][_0x458ae1[_0x3e1c16(0x1c3)]]||0x5,_0x12b502=_0x3e1c16(0x1b7);else{if(_0x458ae1[_0x3e1c16(0x1c3)][_0x3e1c16(0x1f9)](_0x3e1c16(0x1ee))||_0x458ae1[_0x3e1c16(0x1c5)][_0x3e1c16(0x1f9)](_0x3e1c16(0x1cd)))_0x2e6453=this['config'][_0x3e1c16(0x1e1)][_0x458ae1['type']]||0xf,_0x12b502=_0x3e1c16(0x1c1);else _0x458ae1['type'][_0x3e1c16(0x1f9)](_0x3e1c16(0x1e6))&&(_0x2e6453=this['config'][_0x3e1c16(0x1e1)][_0x458ae1[_0x3e1c16(0x1c3)]]||0xa,_0x12b502='image_throttled');}return{'type':_0x3e1c16(0x1de),'reason':_0x12b502,'isLargeData':!![],'estimatedSize':_0x377761,'maxFrequency':_0x2e6453};}return{'type':_0x3e1c16(0x1f3),'reason':_0x3e1c16(0x1df),'isLargeData':![],'estimatedSize':_0x377761,'maxFrequency':null};}['parseStrategyConfig'](_0x4f4638,_0x45a6ac){const _0x4d9b4c=a6_0x31b14f;if(_0x4f4638[_0x4d9b4c(0x1f9)](':')){const [_0x55ece5,_0x2b45aa]=_0x4f4638['split'](':');return{'type':_0x55ece5,'reason':_0x45a6ac,'isLargeData':!![],'maxFrequency':_0x55ece5===_0x4d9b4c(0x1de)?parseFloat(_0x2b45aa):null,'estimatedSize':this[_0x4d9b4c(0x20a)]['largeDataThreshold']+0x1};}return{'type':_0x4f4638,'reason':_0x45a6ac,'isLargeData':_0x4f4638!==_0x4d9b4c(0x1f3),'maxFrequency':null,'estimatedSize':this['config'][_0x4d9b4c(0x1d0)]+0x1};}['isLargeDataTopic'](_0x5a470e,_0x3dc378){const _0x3244e4=a6_0x31b14f,_0x5b23ad=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x4a0913=[_0x3244e4(0x1b0),'sensor_msgs/msg/Image',_0x3244e4(0x1dd),_0x3244e4(0x1c7)];return _0x5b23ad[_0x3244e4(0x1b5)](_0x22a928=>_0x22a928['test'](_0x5a470e))||_0x4a0913[_0x3244e4(0x1f9)](_0x3dc378);}[a6_0x31b14f(0x1d7)](_0x21594d,_0x4d94f1=''){const _0x3154cd=a6_0x31b14f,_0x3e7e17=[_0x3154cd(0x1f2),_0x3154cd(0x1c7)];if(_0x3e7e17[_0x3154cd(0x1f9)](_0x4d94f1))return!_0x21594d[_0x3154cd(0x1f9)](_0x3154cd(0x1af))&&!_0x21594d[_0x3154cd(0x1f9)](_0x3154cd(0x1cb))&&!_0x21594d['includes']('depth_points');return(_0x21594d[_0x3154cd(0x1f9)]('image')||_0x21594d[_0x3154cd(0x1f9)](_0x3154cd(0x201)))&&!_0x21594d['includes'](_0x3154cd(0x1af))&&!_0x21594d[_0x3154cd(0x1f9)]('point_cloud')&&!_0x21594d[_0x3154cd(0x1f9)]('depth_points');}[a6_0x31b14f(0x1e0)](_0x58fe80,_0x9c9276){const _0x438145=a6_0x31b14f,_0x1b5082={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x1b5082[_0x9c9276])return _0x1b5082[_0x9c9276];if(_0x58fe80['includes'](_0x438145(0x205))||_0x58fe80[_0x438145(0x1f9)](_0x438145(0x1bc)))return 0x190*0x400;if(_0x58fe80[_0x438145(0x1f9)](_0x438145(0x1e5)))return 0x12c*0x400;if(_0x58fe80[_0x438145(0x1f9)](_0x438145(0x201)))return 0x32*0x400;return 0x400;}[a6_0x31b14f(0x1b8)](_0x2ecdf0){const _0x1f56bd=a6_0x31b14f;let _0x87b1bf=this[_0x1f56bd(0x1ff)][_0x1f56bd(0x1ef)](_0x2ecdf0['topic']);if(!_0x87b1bf){console['log'](_0x1f56bd(0x1f0)+_0x2ecdf0[_0x1f56bd(0x1ce)]);let _0x5a310a='unknown';if(_0x2ecdf0['topic'][_0x1f56bd(0x1f9)]('image')&&_0x2ecdf0[_0x1f56bd(0x1ce)][_0x1f56bd(0x1f9)](_0x1f56bd(0x201)))_0x5a310a=_0x1f56bd(0x1c7);else{if(_0x2ecdf0[_0x1f56bd(0x1ce)][_0x1f56bd(0x1f9)](_0x1f56bd(0x208)))_0x5a310a=_0x1f56bd(0x1f2);else{if(_0x2ecdf0[_0x1f56bd(0x1ce)][_0x1f56bd(0x1f9)](_0x1f56bd(0x205))||_0x2ecdf0[_0x1f56bd(0x1ce)][_0x1f56bd(0x1f9)](_0x1f56bd(0x1bc)))_0x5a310a=_0x1f56bd(0x1b0);else _0x2ecdf0[_0x1f56bd(0x1ce)][_0x1f56bd(0x1f9)]('scan')&&(_0x5a310a='sensor_msgs/msg/LaserScan');}}const _0x376780={'name':_0x2ecdf0['topic'],'type':_0x5a310a};this[_0x1f56bd(0x1ae)](_0x376780),_0x87b1bf=this[_0x1f56bd(0x1ff)][_0x1f56bd(0x1ef)](_0x2ecdf0[_0x1f56bd(0x1ce)]);}if(!_0x87b1bf)return{'action':_0x1f56bd(0x1ad),'message':_0x2ecdf0};switch(_0x87b1bf['strategy']){case _0x1f56bd(0x1de):return this['shouldThrottle'](_0x2ecdf0[_0x1f56bd(0x1ce)],_0x87b1bf['maxFrequency'])?{'action':'forward','message':_0x2ecdf0}:{'action':_0x1f56bd(0x1b9)};case'webrtc':return{'action':_0x1f56bd(0x1ab)};case _0x1f56bd(0x1f3):default:return{'action':_0x1f56bd(0x1ad),'message':_0x2ecdf0};}}[a6_0x31b14f(0x1c0)](_0x5ee0fa,_0x3cf75b){const _0x3aca38=a6_0x31b14f;if(!_0x3cf75b)return!![];const _0x24a6f9=Date[_0x3aca38(0x1fe)](),_0x55a4fd=0x3e8/_0x3cf75b;!this[_0x3aca38(0x1fd)][_0x3aca38(0x1d3)](_0x5ee0fa)&&this[_0x3aca38(0x1fd)][_0x3aca38(0x200)](_0x5ee0fa,0x0);const _0x1e9754=this[_0x3aca38(0x1fd)]['get'](_0x5ee0fa),_0x19586e=_0x24a6f9-_0x1e9754;if(_0x19586e>=_0x55a4fd)return this[_0x3aca38(0x1fd)][_0x3aca38(0x200)](_0x5ee0fa,_0x24a6f9),!![];return![];}[a6_0x31b14f(0x1c6)](_0x1f7a18){const _0x128a89=a6_0x31b14f;return this[_0x128a89(0x1ff)][_0x128a89(0x1ef)](_0x1f7a18);}[a6_0x31b14f(0x1f6)](){const _0x1f28c9=a6_0x31b14f;return Array[_0x1f28c9(0x1d4)](this['topicStrategies'][_0x1f28c9(0x1ba)]())['map'](([_0x51bc43,_0x248f5b])=>({'topic':_0x51bc43,..._0x248f5b}));}[a6_0x31b14f(0x1eb)](_0x17856b){const _0x59af07=a6_0x31b14f,_0x43e5e1=this[_0x59af07(0x1ff)][_0x59af07(0x1ef)](_0x17856b);return _0x43e5e1?.[_0x59af07(0x1e2)]===_0x59af07(0x1e9);}[a6_0x31b14f(0x1c9)](){const _0x56fe43=a6_0x31b14f,_0x526587={};return this[_0x56fe43(0x1ff)][_0x56fe43(0x1e3)]((_0x55bf27,_0x2b6acd)=>{const _0x1fe008=_0x56fe43;!_0x526587[_0x55bf27['strategy']]&&(_0x526587[_0x55bf27[_0x1fe008(0x1e2)]]=0x0),_0x526587[_0x55bf27['strategy']]++;}),{'totalTopics':this[_0x56fe43(0x1ff)][_0x56fe43(0x1bd)],'strategies':_0x526587,'largeDataTopics':Array['from'](this[_0x56fe43(0x1ff)][_0x56fe43(0x1ba)]())['filter'](([_0x56a56a,_0x45f4a3])=>_0x45f4a3[_0x56fe43(0x1aa)])[_0x56fe43(0x1f5)](([_0x2633ca,_0x2ef1f2])=>_0x2633ca)};}}module['exports']=new TopicManager();