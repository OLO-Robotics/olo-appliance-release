const a4_0x55270d=a4_0x48a6;function a4_0x48a6(_0x1bbb46,_0x4d3774){const _0x177eec=a4_0x27c8();return a4_0x48a6=function(_0x23d452,_0x1bf0cc){_0x23d452=_0x23d452-0x103;let _0x27c8b6=_0x177eec[_0x23d452];return _0x27c8b6;},a4_0x48a6(_0x1bbb46,_0x4d3774);}function a4_0x27c8(){const _0x396ee8=['strategy','topic','some','compressed','[TopicManager]\x20Topic\x20discovery\x20completed','webrtc_only','lastMessageTimes','48YXdvcT','strategiesConfig','toString','reason','now','name','webrtc','[TopicManager]\x20Topic\x20','filter','4196166IJGUAm','user_configured','estimatedSize','Image','constructor','395bTLSpp','search','17722FNVpFA','2458050hNaqAX','getStatistics','determineTopicStrategy','8216698TCAzXT','433386whbWLF','sensor_msgs/msg/Image','map','cloud','estimateTopicSize','[TopicManager]\x20Loaded\x20configuration:','LaserScan','log','laser_scan_throttled','depth_points','exports','getTopicStrategy','[TopicManager]\x20Found\x20','28vHYSNt','maxFrequency','74744dutQGV','entries','split','defaultLargeDataStrategy','parseStrategyConfig','set','child_process','analyzeTopicStrategy','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','largeDataThreshold','size','[TopicManager]\x20Strategies:','topicStrategies','points','length','config','forEach','(((.+)+)+)+$','apply','websocket','139070WLYWbr','shouldThrottle','throttleFrequencies','isLargeDataTopic','error','normal_size','[TopicManager]\x20Starting\x20topic\x20discovery...','getManagedTopics','point','sensor_msgs/msg/LaserScan','replace','isCameraTopic','loadConfig','PointCloud2','sensor_msgs/msg/PointCloud2','video_webrtc_streaming','isLargeData','includes','pattern_configured','image_throttled','throttle_skip','image_raw','large_data_throttled','webrtc_skip','sensor_msgs/msg/CompressedImage','throttle','\x20topics','forward','from','strategies','type','point_cloud','image','get','discoveryInProgress'];a4_0x27c8=function(){return _0x396ee8;};return a4_0x27c8();}(function(_0x17c004,_0xd2c2c){const _0x2837bb=a4_0x48a6,_0x1dc08e=_0x17c004();while(!![]){try{const _0x594e7e=parseInt(_0x2837bb(0x15b))/0x1*(parseInt(_0x2837bb(0x149))/0x2)+-parseInt(_0x2837bb(0x142))/0x3+-parseInt(_0x2837bb(0x15d))/0x4*(-parseInt(_0x2837bb(0x147))/0x5)+-parseInt(_0x2837bb(0x14a))/0x6+parseInt(_0x2837bb(0x14d))/0x7+parseInt(_0x2837bb(0x139))/0x8*(-parseInt(_0x2837bb(0x14e))/0x9)+parseInt(_0x2837bb(0x10f))/0xa;if(_0x594e7e===_0xd2c2c)break;else _0x1dc08e['push'](_0x1dc08e['shift']());}catch(_0x187a45){_0x1dc08e['push'](_0x1dc08e['shift']());}}}(a4_0x27c8,0xc6e6e));const a4_0x1bf0cc=(function(){let _0x5742d2=!![];return function(_0xbccb74,_0x35f95a){const _0x3e72d2=_0x5742d2?function(){const _0x3ea977=a4_0x48a6;if(_0x35f95a){const _0x474bca=_0x35f95a[_0x3ea977(0x10d)](_0xbccb74,arguments);return _0x35f95a=null,_0x474bca;}}:function(){};return _0x5742d2=![],_0x3e72d2;};}()),a4_0x23d452=a4_0x1bf0cc(this,function(){const _0x4ab2aa=a4_0x48a6;return a4_0x23d452[_0x4ab2aa(0x13b)]()['search'](_0x4ab2aa(0x10c))['toString']()[_0x4ab2aa(0x146)](a4_0x23d452)[_0x4ab2aa(0x148)]('(((.+)+)+)+$');});a4_0x23d452();const {execSync}=require(a4_0x55270d(0x163));class TopicManager{constructor(){const _0x334337=a4_0x55270d;this[_0x334337(0x107)]=new Map(),this['lastMessageTimes']=new Map(),this['discoveryInProgress']=![],this[_0x334337(0x10a)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x334337(0x137),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x334337(0x155)]('[TopicManager]\x20Initialised');}[a4_0x55270d(0x11b)](_0x115fe5){const _0x4baf9c=a4_0x55270d;if(_0x115fe5['topicHandling']){const _0x3d7b48=_0x115fe5['topicHandling'];_0x3d7b48[_0x4baf9c(0x104)]&&(this[_0x4baf9c(0x10a)][_0x4baf9c(0x104)]=_0x3d7b48['largeDataThreshold']),_0x3d7b48[_0x4baf9c(0x160)]&&(this[_0x4baf9c(0x10a)]['defaultLargeDataStrategy']=_0x3d7b48[_0x4baf9c(0x160)]),_0x3d7b48[_0x4baf9c(0x12c)]&&(this['config'][_0x4baf9c(0x13a)]={..._0x3d7b48[_0x4baf9c(0x12c)]}),_0x3d7b48[_0x4baf9c(0x111)]&&(this['config'][_0x4baf9c(0x111)]={...this[_0x4baf9c(0x10a)]['throttleFrequencies'],..._0x3d7b48[_0x4baf9c(0x111)]}),console[_0x4baf9c(0x155)](_0x4baf9c(0x153),this[_0x4baf9c(0x10a)]);}}async['discoverTopics'](_0x4698f5){const _0x2cbc89=a4_0x55270d;if(this[_0x2cbc89(0x131)]||!_0x4698f5)return;this[_0x2cbc89(0x131)]=!![],console[_0x2cbc89(0x155)](_0x2cbc89(0x115));try{await new Promise((_0x4563d8,_0x4c6c8a)=>{_0x4698f5['getTopics'](_0xf96841=>{const _0x39bdf0=a4_0x48a6,_0x504d8e=_0xf96841['topics'][_0x39bdf0(0x150)]((_0x53f5fb,_0x217a55)=>({'name':_0x53f5fb,'type':_0xf96841['types'][_0x217a55]}));console['log'](_0x39bdf0(0x15a)+_0x504d8e[_0x39bdf0(0x109)]+_0x39bdf0(0x129));for(const _0xd73011 of _0x504d8e){this[_0x39bdf0(0x164)](_0xd73011);}console['log'](_0x39bdf0(0x136)),console[_0x39bdf0(0x155)](_0x39bdf0(0x106),Array['from'](this[_0x39bdf0(0x107)][_0x39bdf0(0x15e)]())),_0x4563d8();},_0x5de85f=>{const _0x1eb83d=a4_0x48a6;console[_0x1eb83d(0x113)]('[TopicManager]\x20Error\x20getting\x20topics:',_0x5de85f),_0x4c6c8a(_0x5de85f);});});}catch(_0x119d88){console[_0x2cbc89(0x113)]('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x119d88);}finally{this['discoveryInProgress']=![];}}[a4_0x55270d(0x164)](_0x1c5fe7){const _0x1afa8a=a4_0x55270d,_0x4989ce=this[_0x1afa8a(0x14c)](_0x1c5fe7);this[_0x1afa8a(0x107)]['set'](_0x1c5fe7[_0x1afa8a(0x13e)],{'type':_0x1c5fe7['type'],'strategy':_0x4989ce[_0x1afa8a(0x12d)],'reason':_0x4989ce[_0x1afa8a(0x13c)],'maxFrequency':_0x4989ce[_0x1afa8a(0x15c)],'isLargeData':_0x4989ce['isLargeData'],'estimatedSize':_0x4989ce[_0x1afa8a(0x144)]}),console[_0x1afa8a(0x155)](_0x1afa8a(0x140)+_0x1c5fe7[_0x1afa8a(0x13e)]+':\x20'+_0x4989ce['type']+'\x20('+_0x4989ce[_0x1afa8a(0x13c)]+')');}[a4_0x55270d(0x14c)](_0x368759){const _0x31465d=a4_0x55270d;if(this['config'][_0x31465d(0x13a)][_0x368759[_0x31465d(0x13e)]]){const _0x321e14=this['config'][_0x31465d(0x13a)][_0x368759[_0x31465d(0x13e)]];return this['parseStrategyConfig'](_0x321e14,_0x31465d(0x143));}for(const [_0x555271,_0x3c2fe0]of Object['entries'](this['config']['strategiesConfig'])){if(_0x368759[_0x31465d(0x13e)][_0x31465d(0x120)](_0x555271[_0x31465d(0x119)]('/','')))return this[_0x31465d(0x161)](_0x3c2fe0,_0x31465d(0x121));}if(this['isCameraTopic'](_0x368759[_0x31465d(0x13e)],_0x368759[_0x31465d(0x12d)])){const _0x40cc64=this[_0x31465d(0x152)](_0x368759[_0x31465d(0x13e)],_0x368759[_0x31465d(0x12d)]);return{'type':_0x31465d(0x13f),'reason':_0x31465d(0x11e),'isLargeData':!![],'estimatedSize':_0x40cc64,'maxFrequency':null};}const _0x3dfdd9=this[_0x31465d(0x112)](_0x368759[_0x31465d(0x13e)],_0x368759[_0x31465d(0x12d)]),_0x365bd9=this[_0x31465d(0x152)](_0x368759[_0x31465d(0x13e)],_0x368759[_0x31465d(0x12d)]);if(_0x3dfdd9||_0x365bd9>this[_0x31465d(0x10a)][_0x31465d(0x104)]){let _0x34e48b=this[_0x31465d(0x10a)][_0x31465d(0x111)][_0x368759[_0x31465d(0x12d)]]||0xa,_0x5959bb=_0x31465d(0x125);if(_0x368759[_0x31465d(0x12d)][_0x31465d(0x120)](_0x31465d(0x11c))||_0x368759[_0x31465d(0x13e)][_0x31465d(0x120)](_0x31465d(0x108)))_0x34e48b=this[_0x31465d(0x10a)][_0x31465d(0x111)][_0x368759[_0x31465d(0x12d)]]||0x5,_0x5959bb='point_cloud_throttled';else{if(_0x368759[_0x31465d(0x12d)][_0x31465d(0x120)](_0x31465d(0x154))||_0x368759[_0x31465d(0x13e)]['includes']('scan'))_0x34e48b=this['config'][_0x31465d(0x111)][_0x368759[_0x31465d(0x12d)]]||0xf,_0x5959bb=_0x31465d(0x156);else _0x368759[_0x31465d(0x12d)][_0x31465d(0x120)](_0x31465d(0x145))&&(_0x34e48b=this['config'][_0x31465d(0x111)][_0x368759[_0x31465d(0x12d)]]||0xa,_0x5959bb=_0x31465d(0x122));}return{'type':_0x31465d(0x128),'reason':_0x5959bb,'isLargeData':!![],'estimatedSize':_0x365bd9,'maxFrequency':_0x34e48b};}return{'type':'websocket','reason':_0x31465d(0x114),'isLargeData':![],'estimatedSize':_0x365bd9,'maxFrequency':null};}[a4_0x55270d(0x161)](_0x4558ec,_0x340318){const _0x2c8b56=a4_0x55270d;if(_0x4558ec[_0x2c8b56(0x120)](':')){const [_0x16ffcc,_0x2434c8]=_0x4558ec[_0x2c8b56(0x15f)](':');return{'type':_0x16ffcc,'reason':_0x340318,'isLargeData':!![],'maxFrequency':_0x16ffcc===_0x2c8b56(0x128)?parseFloat(_0x2434c8):null,'estimatedSize':this[_0x2c8b56(0x10a)]['largeDataThreshold']+0x1};}return{'type':_0x4558ec,'reason':_0x340318,'isLargeData':_0x4558ec!=='websocket','maxFrequency':null,'estimatedSize':this[_0x2c8b56(0x10a)]['largeDataThreshold']+0x1};}[a4_0x55270d(0x112)](_0x260922,_0x116616){const _0x44c3ef=a4_0x55270d,_0x14b4f9=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x1737e8=[_0x44c3ef(0x11d),'sensor_msgs/msg/Image','sensor_msgs/msg/LaserScan',_0x44c3ef(0x127)];return _0x14b4f9[_0x44c3ef(0x134)](_0x742143=>_0x742143['test'](_0x260922))||_0x1737e8['includes'](_0x116616);}[a4_0x55270d(0x11a)](_0x50d032,_0x116a4d=''){const _0x28f85f=a4_0x55270d,_0x3cd46f=[_0x28f85f(0x14f),_0x28f85f(0x127)];if(_0x3cd46f[_0x28f85f(0x120)](_0x116a4d))return!_0x50d032[_0x28f85f(0x120)](_0x28f85f(0x108))&&!_0x50d032[_0x28f85f(0x120)](_0x28f85f(0x12e))&&!_0x50d032[_0x28f85f(0x120)](_0x28f85f(0x157));return(_0x50d032[_0x28f85f(0x120)](_0x28f85f(0x12f))||_0x50d032[_0x28f85f(0x120)](_0x28f85f(0x135)))&&!_0x50d032['includes'](_0x28f85f(0x108))&&!_0x50d032[_0x28f85f(0x120)]('point_cloud')&&!_0x50d032[_0x28f85f(0x120)](_0x28f85f(0x157));}[a4_0x55270d(0x152)](_0x53f3c2,_0xa522){const _0x510840=a4_0x55270d,_0x3022e4={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x3022e4[_0xa522])return _0x3022e4[_0xa522];if(_0x53f3c2['includes'](_0x510840(0x117))||_0x53f3c2['includes']('cloud'))return 0x190*0x400;if(_0x53f3c2['includes'](_0x510840(0x124)))return 0x12c*0x400;if(_0x53f3c2[_0x510840(0x120)](_0x510840(0x135)))return 0x32*0x400;return 0x400;}['handleMessage'](_0x5bbbf6){const _0x56c80d=a4_0x55270d;let _0x2a9ea7=this[_0x56c80d(0x107)][_0x56c80d(0x130)](_0x5bbbf6[_0x56c80d(0x133)]);if(!_0x2a9ea7){console['log'](_0x56c80d(0x103)+_0x5bbbf6[_0x56c80d(0x133)]);let _0x4e4932='unknown';if(_0x5bbbf6[_0x56c80d(0x133)][_0x56c80d(0x120)](_0x56c80d(0x12f))&&_0x5bbbf6[_0x56c80d(0x133)][_0x56c80d(0x120)]('compressed'))_0x4e4932=_0x56c80d(0x127);else{if(_0x5bbbf6[_0x56c80d(0x133)][_0x56c80d(0x120)](_0x56c80d(0x12f)))_0x4e4932=_0x56c80d(0x14f);else{if(_0x5bbbf6[_0x56c80d(0x133)][_0x56c80d(0x120)](_0x56c80d(0x117))||_0x5bbbf6['topic'][_0x56c80d(0x120)](_0x56c80d(0x151)))_0x4e4932='sensor_msgs/msg/PointCloud2';else _0x5bbbf6['topic'][_0x56c80d(0x120)]('scan')&&(_0x4e4932=_0x56c80d(0x118));}}const _0x2b1051={'name':_0x5bbbf6['topic'],'type':_0x4e4932};this[_0x56c80d(0x164)](_0x2b1051),_0x2a9ea7=this[_0x56c80d(0x107)][_0x56c80d(0x130)](_0x5bbbf6[_0x56c80d(0x133)]);}if(!_0x2a9ea7)return{'action':'forward','message':_0x5bbbf6};switch(_0x2a9ea7[_0x56c80d(0x132)]){case _0x56c80d(0x128):return this['shouldThrottle'](_0x5bbbf6[_0x56c80d(0x133)],_0x2a9ea7['maxFrequency'])?{'action':'forward','message':_0x5bbbf6}:{'action':_0x56c80d(0x123)};case _0x56c80d(0x13f):return{'action':_0x56c80d(0x126)};case _0x56c80d(0x10e):default:return{'action':_0x56c80d(0x12a),'message':_0x5bbbf6};}}[a4_0x55270d(0x110)](_0x1ea601,_0x351631){const _0x4f256c=a4_0x55270d;if(!_0x351631)return!![];const _0x5d8da5=Date[_0x4f256c(0x13d)](),_0xbcadb8=0x3e8/_0x351631;!this[_0x4f256c(0x138)]['has'](_0x1ea601)&&this[_0x4f256c(0x138)][_0x4f256c(0x162)](_0x1ea601,0x0);const _0x23d8e8=this[_0x4f256c(0x138)][_0x4f256c(0x130)](_0x1ea601),_0x519e75=_0x5d8da5-_0x23d8e8;if(_0x519e75>=_0xbcadb8)return this['lastMessageTimes']['set'](_0x1ea601,_0x5d8da5),!![];return![];}[a4_0x55270d(0x159)](_0x575a86){const _0x5534c1=a4_0x55270d;return this['topicStrategies'][_0x5534c1(0x130)](_0x575a86);}[a4_0x55270d(0x116)](){const _0x3c00a7=a4_0x55270d;return Array['from'](this[_0x3c00a7(0x107)][_0x3c00a7(0x15e)]())[_0x3c00a7(0x150)](([_0x31daf4,_0x1f387d])=>({'topic':_0x31daf4,..._0x1f387d}));}['shouldUseWebRTC'](_0x2a00c7){const _0x329a5b=a4_0x55270d,_0x1f242c=this[_0x329a5b(0x107)][_0x329a5b(0x130)](_0x2a00c7);return _0x1f242c?.[_0x329a5b(0x132)]===_0x329a5b(0x137);}[a4_0x55270d(0x14b)](){const _0x52c21d=a4_0x55270d,_0x136929={};return this[_0x52c21d(0x107)][_0x52c21d(0x10b)]((_0x2bd49d,_0x503c88)=>{const _0x11c8c5=_0x52c21d;!_0x136929[_0x2bd49d['strategy']]&&(_0x136929[_0x2bd49d[_0x11c8c5(0x132)]]=0x0),_0x136929[_0x2bd49d['strategy']]++;}),{'totalTopics':this[_0x52c21d(0x107)][_0x52c21d(0x105)],'strategies':_0x136929,'largeDataTopics':Array[_0x52c21d(0x12b)](this[_0x52c21d(0x107)]['entries']())[_0x52c21d(0x141)](([_0x36b5f3,_0x4d34ca])=>_0x4d34ca[_0x52c21d(0x11f)])[_0x52c21d(0x150)](([_0xcf5bf9,_0x1b5220])=>_0xcf5bf9)};}}module[a4_0x55270d(0x158)]=new TopicManager();