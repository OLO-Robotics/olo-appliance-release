const a4_0x5ab364=a4_0x136d;(function(_0x3a0480,_0x5f45ca){const _0x2479cc=a4_0x136d,_0x4d16f3=_0x3a0480();while(!![]){try{const _0xd78a9=-parseInt(_0x2479cc(0x180))/0x1+-parseInt(_0x2479cc(0x1be))/0x2+-parseInt(_0x2479cc(0x198))/0x3+parseInt(_0x2479cc(0x17d))/0x4*(parseInt(_0x2479cc(0x175))/0x5)+-parseInt(_0x2479cc(0x181))/0x6*(-parseInt(_0x2479cc(0x1c4))/0x7)+-parseInt(_0x2479cc(0x1a8))/0x8+-parseInt(_0x2479cc(0x16d))/0x9*(-parseInt(_0x2479cc(0x16b))/0xa);if(_0xd78a9===_0x5f45ca)break;else _0x4d16f3['push'](_0x4d16f3['shift']());}catch(_0x1a450d){_0x4d16f3['push'](_0x4d16f3['shift']());}}}(a4_0x30d2,0x46f66));const a4_0x4e996c=(function(){let _0x172b62=!![];return function(_0x57a298,_0xce6af){const _0x3cea7d=_0x172b62?function(){const _0x4ce6a3=a4_0x136d;if(_0xce6af){const _0x4be2fb=_0xce6af[_0x4ce6a3(0x1ab)](_0x57a298,arguments);return _0xce6af=null,_0x4be2fb;}}:function(){};return _0x172b62=![],_0x3cea7d;};}()),a4_0x3baa23=a4_0x4e996c(this,function(){const _0x151c3b=a4_0x136d;return a4_0x3baa23[_0x151c3b(0x19e)]()[_0x151c3b(0x19b)](_0x151c3b(0x19f))['toString']()[_0x151c3b(0x18d)](a4_0x3baa23)[_0x151c3b(0x19b)](_0x151c3b(0x19f));});a4_0x3baa23();const {execSync}=require(a4_0x5ab364(0x174));function a4_0x30d2(){const _0x1dc1ad=['apply','isCameraTopic','name','strategiesConfig','discoveryInProgress','maxFrequency','forward','sensor_msgs/msg/CompressedImage','lastMessageTimes','type','log','point','forEach','isLargeData','[TopicManager]\x20Initialised','getTopics','topics','split','defaultLargeDataStrategy','220296lVaKAG','LaserScan','isLargeDataTopic','topicHandling','exports','[TopicManager]\x20Topic\x20discovery\x20completed','189nRSiPB','webrtc_skip','includes','types','[TopicManager]\x20Topic\x20','scan','20pIOuZt','getManagedTopics','3192273MWqiIG','throttle_skip','user_configured','loadConfig','reason','has','sensor_msgs/msg/PointCloud2','child_process','1465NHTJxA','from','strategy','[TopicManager]\x20Strategies:','PointCloud2','filter','Image','handleMessage','484FEibFI','topicStrategies','determineTopicStrategy','146095QQoatC','66HgbcwV','estimateTopicSize','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','config','length','map','topic','throttle','points','depth_points','parseStrategyConfig','cloud','constructor','point_cloud_throttled','discoverTopics','now','pattern_configured','sensor_msgs/msg/Image','set','[TopicManager]\x20Loaded\x20configuration:','video_webrtc_streaming','get','webrtc_only','408789mLsvZw','websocket','analyzeTopicStrategy','search','getStatistics','error','toString','(((.+)+)+)+$','largeDataThreshold','compressed','entries','[TopicManager]\x20Starting\x20topic\x20discovery...','image','shouldThrottle','normal_size','sensor_msgs/msg/LaserScan','495808jqWOmR','image_throttled','throttleFrequencies'];a4_0x30d2=function(){return _0x1dc1ad;};return a4_0x30d2();}function a4_0x136d(_0x17ddc5,_0x3e852d){const _0x46fbbc=a4_0x30d2();return a4_0x136d=function(_0x3baa23,_0x4e996c){_0x3baa23=_0x3baa23-0x16a;let _0x30d20a=_0x46fbbc[_0x3baa23];return _0x30d20a;},a4_0x136d(_0x17ddc5,_0x3e852d);}class TopicManager{constructor(){const _0x6d9954=a4_0x5ab364;this[_0x6d9954(0x17e)]=new Map(),this['lastMessageTimes']=new Map(),this[_0x6d9954(0x1af)]=![],this['config']={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x6d9954(0x197),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x6d9954(0x1b5)](_0x6d9954(0x1b9));}[a4_0x5ab364(0x170)](_0x1eb823){const _0x33320e=a4_0x5ab364;if(_0x1eb823[_0x33320e(0x1c1)]){const _0x21be4d=_0x1eb823[_0x33320e(0x1c1)];_0x21be4d[_0x33320e(0x1a0)]&&(this[_0x33320e(0x184)]['largeDataThreshold']=_0x21be4d['largeDataThreshold']),_0x21be4d[_0x33320e(0x1bd)]&&(this[_0x33320e(0x184)][_0x33320e(0x1bd)]=_0x21be4d['defaultLargeDataStrategy']),_0x21be4d['strategies']&&(this[_0x33320e(0x184)][_0x33320e(0x1ae)]={..._0x21be4d['strategies']}),_0x21be4d['throttleFrequencies']&&(this[_0x33320e(0x184)][_0x33320e(0x1aa)]={...this[_0x33320e(0x184)][_0x33320e(0x1aa)],..._0x21be4d[_0x33320e(0x1aa)]}),console[_0x33320e(0x1b5)](_0x33320e(0x194),this[_0x33320e(0x184)]);}}async[a4_0x5ab364(0x18f)](_0x4a5be2){const _0x3b3c47=a4_0x5ab364;if(this[_0x3b3c47(0x1af)]||!_0x4a5be2)return;this[_0x3b3c47(0x1af)]=!![],console[_0x3b3c47(0x1b5)](_0x3b3c47(0x1a3));try{await new Promise((_0x3fcc5c,_0x439a1b)=>{const _0xcac4ec=_0x3b3c47;_0x4a5be2[_0xcac4ec(0x1ba)](_0x126cc8=>{const _0x272be2=_0xcac4ec,_0x3553f1=_0x126cc8[_0x272be2(0x1bb)][_0x272be2(0x186)]((_0x54390d,_0x45ae0f)=>({'name':_0x54390d,'type':_0x126cc8[_0x272be2(0x1c7)][_0x45ae0f]}));console['log']('[TopicManager]\x20Found\x20'+_0x3553f1[_0x272be2(0x185)]+'\x20topics');for(const _0x28cf45 of _0x3553f1){this['analyzeTopicStrategy'](_0x28cf45);}console['log'](_0x272be2(0x1c3)),console[_0x272be2(0x1b5)](_0x272be2(0x178),Array['from'](this['topicStrategies'][_0x272be2(0x1a2)]())),_0x3fcc5c();},_0x176fc3=>{const _0xe68a67=_0xcac4ec;console[_0xe68a67(0x19d)]('[TopicManager]\x20Error\x20getting\x20topics:',_0x176fc3),_0x439a1b(_0x176fc3);});});}catch(_0x55ebcf){console[_0x3b3c47(0x19d)]('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x55ebcf);}finally{this['discoveryInProgress']=![];}}[a4_0x5ab364(0x19a)](_0x4ded5f){const _0x45a544=a4_0x5ab364,_0x226a6b=this[_0x45a544(0x17f)](_0x4ded5f);this[_0x45a544(0x17e)][_0x45a544(0x193)](_0x4ded5f[_0x45a544(0x1ad)],{'type':_0x4ded5f[_0x45a544(0x1b4)],'strategy':_0x226a6b['type'],'reason':_0x226a6b[_0x45a544(0x171)],'maxFrequency':_0x226a6b[_0x45a544(0x1b0)],'isLargeData':_0x226a6b['isLargeData'],'estimatedSize':_0x226a6b['estimatedSize']}),console[_0x45a544(0x1b5)](_0x45a544(0x1c8)+_0x4ded5f[_0x45a544(0x1ad)]+':\x20'+_0x226a6b['type']+'\x20('+_0x226a6b[_0x45a544(0x171)]+')');}['determineTopicStrategy'](_0x1bfa3c){const _0x2b8a94=a4_0x5ab364;if(this[_0x2b8a94(0x184)][_0x2b8a94(0x1ae)][_0x1bfa3c[_0x2b8a94(0x1ad)]]){const _0x3f5c59=this[_0x2b8a94(0x184)]['strategiesConfig'][_0x1bfa3c[_0x2b8a94(0x1ad)]];return this['parseStrategyConfig'](_0x3f5c59,_0x2b8a94(0x16f));}for(const [_0x550f35,_0x5d1fd6]of Object[_0x2b8a94(0x1a2)](this[_0x2b8a94(0x184)][_0x2b8a94(0x1ae)])){if(_0x1bfa3c[_0x2b8a94(0x1ad)][_0x2b8a94(0x1c6)](_0x550f35['replace']('/','')))return this['parseStrategyConfig'](_0x5d1fd6,_0x2b8a94(0x191));}if(this['isCameraTopic'](_0x1bfa3c[_0x2b8a94(0x1ad)],_0x1bfa3c[_0x2b8a94(0x1b4)])){const _0x179ff7=this[_0x2b8a94(0x182)](_0x1bfa3c['name'],_0x1bfa3c[_0x2b8a94(0x1b4)]);return{'type':'webrtc','reason':_0x2b8a94(0x195),'isLargeData':!![],'estimatedSize':_0x179ff7,'maxFrequency':null};}const _0x5b6369=this[_0x2b8a94(0x1c0)](_0x1bfa3c['name'],_0x1bfa3c[_0x2b8a94(0x1b4)]),_0x164156=this[_0x2b8a94(0x182)](_0x1bfa3c[_0x2b8a94(0x1ad)],_0x1bfa3c['type']);if(_0x5b6369||_0x164156>this['config'][_0x2b8a94(0x1a0)]){let _0x1a034e=this[_0x2b8a94(0x184)]['throttleFrequencies'][_0x1bfa3c[_0x2b8a94(0x1b4)]]||0xa,_0x539955='large_data_throttled';if(_0x1bfa3c[_0x2b8a94(0x1b4)][_0x2b8a94(0x1c6)](_0x2b8a94(0x179))||_0x1bfa3c[_0x2b8a94(0x1ad)][_0x2b8a94(0x1c6)](_0x2b8a94(0x189)))_0x1a034e=this[_0x2b8a94(0x184)][_0x2b8a94(0x1aa)][_0x1bfa3c[_0x2b8a94(0x1b4)]]||0x5,_0x539955=_0x2b8a94(0x18e);else{if(_0x1bfa3c[_0x2b8a94(0x1b4)]['includes'](_0x2b8a94(0x1bf))||_0x1bfa3c[_0x2b8a94(0x1ad)][_0x2b8a94(0x1c6)](_0x2b8a94(0x16a)))_0x1a034e=this[_0x2b8a94(0x184)][_0x2b8a94(0x1aa)][_0x1bfa3c['type']]||0xf,_0x539955='laser_scan_throttled';else _0x1bfa3c[_0x2b8a94(0x1b4)][_0x2b8a94(0x1c6)](_0x2b8a94(0x17b))&&(_0x1a034e=this[_0x2b8a94(0x184)][_0x2b8a94(0x1aa)][_0x1bfa3c['type']]||0xa,_0x539955=_0x2b8a94(0x1a9));}return{'type':_0x2b8a94(0x188),'reason':_0x539955,'isLargeData':!![],'estimatedSize':_0x164156,'maxFrequency':_0x1a034e};}return{'type':_0x2b8a94(0x199),'reason':_0x2b8a94(0x1a6),'isLargeData':![],'estimatedSize':_0x164156,'maxFrequency':null};}[a4_0x5ab364(0x18b)](_0x49a5ec,_0x451eb0){const _0x46fc91=a4_0x5ab364;if(_0x49a5ec[_0x46fc91(0x1c6)](':')){const [_0x580de5,_0x46f364]=_0x49a5ec[_0x46fc91(0x1bc)](':');return{'type':_0x580de5,'reason':_0x451eb0,'isLargeData':!![],'maxFrequency':_0x580de5===_0x46fc91(0x188)?parseFloat(_0x46f364):null,'estimatedSize':this[_0x46fc91(0x184)][_0x46fc91(0x1a0)]+0x1};}return{'type':_0x49a5ec,'reason':_0x451eb0,'isLargeData':_0x49a5ec!==_0x46fc91(0x199),'maxFrequency':null,'estimatedSize':this[_0x46fc91(0x184)][_0x46fc91(0x1a0)]+0x1};}['isLargeDataTopic'](_0x6a20e5,_0x16e38f){const _0x5d6a9a=a4_0x5ab364,_0xa06b88=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x3a69a1=[_0x5d6a9a(0x173),_0x5d6a9a(0x192),_0x5d6a9a(0x1a7),_0x5d6a9a(0x1b2)];return _0xa06b88['some'](_0x4e7df0=>_0x4e7df0['test'](_0x6a20e5))||_0x3a69a1[_0x5d6a9a(0x1c6)](_0x16e38f);}[a4_0x5ab364(0x1ac)](_0x81880e,_0x58ef3d=''){const _0x875a06=a4_0x5ab364,_0x39fa49=[_0x875a06(0x192),_0x875a06(0x1b2)];if(_0x39fa49[_0x875a06(0x1c6)](_0x58ef3d))return!_0x81880e[_0x875a06(0x1c6)](_0x875a06(0x189))&&!_0x81880e[_0x875a06(0x1c6)]('point_cloud')&&!_0x81880e['includes'](_0x875a06(0x18a));return(_0x81880e['includes']('image')||_0x81880e[_0x875a06(0x1c6)](_0x875a06(0x1a1)))&&!_0x81880e[_0x875a06(0x1c6)](_0x875a06(0x189))&&!_0x81880e[_0x875a06(0x1c6)]('point_cloud')&&!_0x81880e[_0x875a06(0x1c6)](_0x875a06(0x18a));}[a4_0x5ab364(0x182)](_0x3b42bc,_0xb41fd9){const _0x1e09a9=a4_0x5ab364,_0x25eb63={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x25eb63[_0xb41fd9])return _0x25eb63[_0xb41fd9];if(_0x3b42bc[_0x1e09a9(0x1c6)](_0x1e09a9(0x1b6))||_0x3b42bc[_0x1e09a9(0x1c6)](_0x1e09a9(0x18c)))return 0x190*0x400;if(_0x3b42bc[_0x1e09a9(0x1c6)]('image_raw'))return 0x12c*0x400;if(_0x3b42bc[_0x1e09a9(0x1c6)]('compressed'))return 0x32*0x400;return 0x400;}[a4_0x5ab364(0x17c)](_0x573fac){const _0x2432fa=a4_0x5ab364;let _0xad082a=this[_0x2432fa(0x17e)]['get'](_0x573fac[_0x2432fa(0x187)]);if(!_0xad082a){console[_0x2432fa(0x1b5)](_0x2432fa(0x183)+_0x573fac[_0x2432fa(0x187)]);let _0xb8cce5='unknown';if(_0x573fac[_0x2432fa(0x187)]['includes'](_0x2432fa(0x1a4))&&_0x573fac['topic'][_0x2432fa(0x1c6)](_0x2432fa(0x1a1)))_0xb8cce5=_0x2432fa(0x1b2);else{if(_0x573fac[_0x2432fa(0x187)][_0x2432fa(0x1c6)](_0x2432fa(0x1a4)))_0xb8cce5=_0x2432fa(0x192);else{if(_0x573fac[_0x2432fa(0x187)][_0x2432fa(0x1c6)]('point')||_0x573fac[_0x2432fa(0x187)][_0x2432fa(0x1c6)](_0x2432fa(0x18c)))_0xb8cce5='sensor_msgs/msg/PointCloud2';else _0x573fac[_0x2432fa(0x187)][_0x2432fa(0x1c6)]('scan')&&(_0xb8cce5=_0x2432fa(0x1a7));}}const _0x305a2c={'name':_0x573fac[_0x2432fa(0x187)],'type':_0xb8cce5};this['analyzeTopicStrategy'](_0x305a2c),_0xad082a=this['topicStrategies'][_0x2432fa(0x196)](_0x573fac[_0x2432fa(0x187)]);}if(!_0xad082a)return{'action':_0x2432fa(0x1b1),'message':_0x573fac};switch(_0xad082a[_0x2432fa(0x177)]){case _0x2432fa(0x188):return this['shouldThrottle'](_0x573fac[_0x2432fa(0x187)],_0xad082a[_0x2432fa(0x1b0)])?{'action':_0x2432fa(0x1b1),'message':_0x573fac}:{'action':_0x2432fa(0x16e)};case'webrtc':return{'action':_0x2432fa(0x1c5)};case _0x2432fa(0x199):default:return{'action':_0x2432fa(0x1b1),'message':_0x573fac};}}[a4_0x5ab364(0x1a5)](_0x384f12,_0xfe6106){const _0x44dd72=a4_0x5ab364;if(!_0xfe6106)return!![];const _0x4c2d71=Date[_0x44dd72(0x190)](),_0x212477=0x3e8/_0xfe6106;!this[_0x44dd72(0x1b3)][_0x44dd72(0x172)](_0x384f12)&&this[_0x44dd72(0x1b3)][_0x44dd72(0x193)](_0x384f12,0x0);const _0x4fe59e=this[_0x44dd72(0x1b3)]['get'](_0x384f12),_0x32f8b6=_0x4c2d71-_0x4fe59e;if(_0x32f8b6>=_0x212477)return this[_0x44dd72(0x1b3)][_0x44dd72(0x193)](_0x384f12,_0x4c2d71),!![];return![];}['getTopicStrategy'](_0x526415){const _0x3dd93c=a4_0x5ab364;return this[_0x3dd93c(0x17e)]['get'](_0x526415);}[a4_0x5ab364(0x16c)](){const _0x24e9b1=a4_0x5ab364;return Array[_0x24e9b1(0x176)](this['topicStrategies'][_0x24e9b1(0x1a2)]())[_0x24e9b1(0x186)](([_0x3068bf,_0x3fb5b5])=>({'topic':_0x3068bf,..._0x3fb5b5}));}['shouldUseWebRTC'](_0x415036){const _0x3ce59d=a4_0x5ab364,_0x33140=this[_0x3ce59d(0x17e)][_0x3ce59d(0x196)](_0x415036);return _0x33140?.[_0x3ce59d(0x177)]==='webrtc_only';}[a4_0x5ab364(0x19c)](){const _0x40152f=a4_0x5ab364,_0x14e397={};return this[_0x40152f(0x17e)][_0x40152f(0x1b7)]((_0x12d7ec,_0x4260d1)=>{const _0x2f7a25=_0x40152f;!_0x14e397[_0x12d7ec[_0x2f7a25(0x177)]]&&(_0x14e397[_0x12d7ec[_0x2f7a25(0x177)]]=0x0),_0x14e397[_0x12d7ec[_0x2f7a25(0x177)]]++;}),{'totalTopics':this[_0x40152f(0x17e)]['size'],'strategies':_0x14e397,'largeDataTopics':Array[_0x40152f(0x176)](this[_0x40152f(0x17e)][_0x40152f(0x1a2)]())[_0x40152f(0x17a)](([_0x26acbf,_0x5f0968])=>_0x5f0968[_0x40152f(0x1b8)])[_0x40152f(0x186)](([_0x1c4572,_0x1c2625])=>_0x1c4572)};}}module[a4_0x5ab364(0x1c2)]=new TopicManager();