const a4_0x5aa095=a4_0x3d5f;function a4_0x498a(){const _0x10ca2f=['discoveryInProgress','includes','sensor_msgs/msg/LaserScan','types','[TopicManager]\x20Topic\x20','\x20topics','[TopicManager]\x20Strategies:','determineTopicStrategy','websocket','topic','name','isLargeDataTopic','discoverTopics','shouldThrottle','normal_size','defaultLargeDataStrategy','apply','filter','4zfHUff','compressed','replace','sensor_msgs/msg/PointCloud2','image_raw','size','image','3225032XkoGDu','topicStrategies','[TopicManager]\x20Loaded\x20configuration:','point_cloud','getStatistics','point','get','sensor_msgs/msg/Image','type','strategies','length','analyzeTopicStrategy','estimateTopicSize','unknown','[TopicManager]\x20Topic\x20discovery\x20completed','[TopicManager]\x20Starting\x20topic\x20discovery...','constructor','throttleFrequencies','webrtc','has','webrtc_only','throttle_skip','maxFrequency','lastMessageTimes','user_configured','4331852GOmDTV','1289510QlnJYa','map','(((.+)+)+)+$','PointCloud2','depth_points','cloud','98832ibtTus','pattern_configured','3000516uoINCW','set','getTopicStrategy','sensor_msgs/msg/CompressedImage','search','point_cloud_throttled','some','toString','test','points','reason','850460GbzNxE','image_throttled','[TopicManager]\x20Error\x20getting\x20topics:','LaserScan','handleMessage','topics','346467kegAuV','isLargeData','config','split','from','throttle','scan','loadConfig','largeDataThreshold','large_data_throttled','18leINHA','topicHandling','parseStrategyConfig','error','isCameraTopic','forward','strategiesConfig','log','laser_scan_throttled','entries','getManagedTopics','Image','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','forEach','strategy'];a4_0x498a=function(){return _0x10ca2f;};return a4_0x498a();}function a4_0x3d5f(_0x4fcdde,_0x1dd514){const _0x443827=a4_0x498a();return a4_0x3d5f=function(_0x381d03,_0x210dc3){_0x381d03=_0x381d03-0x6a;let _0x498a11=_0x443827[_0x381d03];return _0x498a11;},a4_0x3d5f(_0x4fcdde,_0x1dd514);}(function(_0x3addb5,_0x2dd36b){const _0x5a6de1=a4_0x3d5f,_0x42b6cb=_0x3addb5();while(!![]){try{const _0xb7f02f=-parseInt(_0x5a6de1(0xc1))/0x1+parseInt(_0x5a6de1(0xce))/0x2+parseInt(_0x5a6de1(0x6f))/0x3+-parseInt(_0x5a6de1(0x9a))/0x4*(-parseInt(_0x5a6de1(0xbb))/0x5)+-parseInt(_0x5a6de1(0xc3))/0x6+-parseInt(_0x5a6de1(0xba))/0x7+-parseInt(_0x5a6de1(0xa1))/0x8*(-parseInt(_0x5a6de1(0x79))/0x9);if(_0xb7f02f===_0x2dd36b)break;else _0x42b6cb['push'](_0x42b6cb['shift']());}catch(_0x388c14){_0x42b6cb['push'](_0x42b6cb['shift']());}}}(a4_0x498a,0x5e835));const a4_0x210dc3=(function(){let _0x1ecb6e=!![];return function(_0x25d43c,_0xa4f420){const _0x327da9=_0x1ecb6e?function(){const _0x42a42c=a4_0x3d5f;if(_0xa4f420){const _0x5d8835=_0xa4f420[_0x42a42c(0x98)](_0x25d43c,arguments);return _0xa4f420=null,_0x5d8835;}}:function(){};return _0x1ecb6e=![],_0x327da9;};}()),a4_0x381d03=a4_0x210dc3(this,function(){const _0x20fb4f=a4_0x3d5f;return a4_0x381d03['toString']()[_0x20fb4f(0xc7)](_0x20fb4f(0xbd))[_0x20fb4f(0xca)]()[_0x20fb4f(0xb1)](a4_0x381d03)['search'](_0x20fb4f(0xbd));});a4_0x381d03();const {execSync}=require('child_process');class TopicManager{constructor(){const _0x4b17a4=a4_0x3d5f;this['topicStrategies']=new Map(),this['lastMessageTimes']=new Map(),this[_0x4b17a4(0x88)]=![],this[_0x4b17a4(0x71)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x4b17a4(0xb5),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x4b17a4(0x80)]('[TopicManager]\x20Initialised');}[a4_0x5aa095(0x76)](_0x54a729){const _0x561b41=a4_0x5aa095;if(_0x54a729[_0x561b41(0x7a)]){const _0x625345=_0x54a729[_0x561b41(0x7a)];_0x625345[_0x561b41(0x77)]&&(this[_0x561b41(0x71)][_0x561b41(0x77)]=_0x625345['largeDataThreshold']),_0x625345[_0x561b41(0x97)]&&(this[_0x561b41(0x71)][_0x561b41(0x97)]=_0x625345[_0x561b41(0x97)]),_0x625345[_0x561b41(0xaa)]&&(this['config']['strategiesConfig']={..._0x625345[_0x561b41(0xaa)]}),_0x625345[_0x561b41(0xb2)]&&(this[_0x561b41(0x71)]['throttleFrequencies']={...this[_0x561b41(0x71)]['throttleFrequencies'],..._0x625345[_0x561b41(0xb2)]}),console['log'](_0x561b41(0xa3),this[_0x561b41(0x71)]);}}async[a4_0x5aa095(0x94)](_0x59e3c6){const _0x531a66=a4_0x5aa095;if(this['discoveryInProgress']||!_0x59e3c6)return;this[_0x531a66(0x88)]=!![],console['log'](_0x531a66(0xb0));try{await new Promise((_0x486344,_0x5b964e)=>{_0x59e3c6['getTopics'](_0xe63c72=>{const _0x499215=a4_0x3d5f,_0x3d211a=_0xe63c72[_0x499215(0x6e)]['map']((_0x58d7b6,_0x4caf9c)=>({'name':_0x58d7b6,'type':_0xe63c72[_0x499215(0x8b)][_0x4caf9c]}));console['log']('[TopicManager]\x20Found\x20'+_0x3d211a[_0x499215(0xab)]+_0x499215(0x8d));for(const _0x380203 of _0x3d211a){this[_0x499215(0xac)](_0x380203);}console[_0x499215(0x80)](_0x499215(0xaf)),console['log'](_0x499215(0x8e),Array[_0x499215(0x73)](this[_0x499215(0xa2)][_0x499215(0x82)]())),_0x486344();},_0x38ff58=>{const _0x918ea7=a4_0x3d5f;console[_0x918ea7(0x7c)](_0x918ea7(0x6b),_0x38ff58),_0x5b964e(_0x38ff58);});});}catch(_0x16a3db){console['error']('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x16a3db);}finally{this[_0x531a66(0x88)]=![];}}['analyzeTopicStrategy'](_0x448ec6){const _0x2bc59b=a4_0x5aa095,_0x53372c=this['determineTopicStrategy'](_0x448ec6);this[_0x2bc59b(0xa2)][_0x2bc59b(0xc4)](_0x448ec6[_0x2bc59b(0x92)],{'type':_0x448ec6[_0x2bc59b(0xa9)],'strategy':_0x53372c[_0x2bc59b(0xa9)],'reason':_0x53372c['reason'],'maxFrequency':_0x53372c[_0x2bc59b(0xb7)],'isLargeData':_0x53372c['isLargeData'],'estimatedSize':_0x53372c['estimatedSize']}),console['log'](_0x2bc59b(0x8c)+_0x448ec6[_0x2bc59b(0x92)]+':\x20'+_0x53372c[_0x2bc59b(0xa9)]+'\x20('+_0x53372c[_0x2bc59b(0xcd)]+')');}[a4_0x5aa095(0x8f)](_0x349816){const _0x8b2373=a4_0x5aa095;if(this['config']['strategiesConfig'][_0x349816[_0x8b2373(0x92)]]){const _0x5552bb=this[_0x8b2373(0x71)][_0x8b2373(0x7f)][_0x349816[_0x8b2373(0x92)]];return this['parseStrategyConfig'](_0x5552bb,_0x8b2373(0xb9));}for(const [_0x15fc38,_0x3ef034]of Object[_0x8b2373(0x82)](this[_0x8b2373(0x71)]['strategiesConfig'])){if(_0x349816[_0x8b2373(0x92)][_0x8b2373(0x89)](_0x15fc38[_0x8b2373(0x9c)]('/','')))return this[_0x8b2373(0x7b)](_0x3ef034,_0x8b2373(0xc2));}if(this[_0x8b2373(0x7d)](_0x349816[_0x8b2373(0x92)],_0x349816[_0x8b2373(0xa9)])){const _0x3aef07=this[_0x8b2373(0xad)](_0x349816[_0x8b2373(0x92)],_0x349816[_0x8b2373(0xa9)]);return{'type':_0x8b2373(0xb3),'reason':'video_webrtc_streaming','isLargeData':!![],'estimatedSize':_0x3aef07,'maxFrequency':null};}const _0x5cf938=this[_0x8b2373(0x93)](_0x349816[_0x8b2373(0x92)],_0x349816[_0x8b2373(0xa9)]),_0xd36dcb=this['estimateTopicSize'](_0x349816[_0x8b2373(0x92)],_0x349816[_0x8b2373(0xa9)]);if(_0x5cf938||_0xd36dcb>this['config'][_0x8b2373(0x77)]){let _0x200140=this[_0x8b2373(0x71)]['throttleFrequencies'][_0x349816['type']]||0xa,_0x3c6df2=_0x8b2373(0x78);if(_0x349816['type'][_0x8b2373(0x89)](_0x8b2373(0xbe))||_0x349816['name'][_0x8b2373(0x89)](_0x8b2373(0xcc)))_0x200140=this[_0x8b2373(0x71)][_0x8b2373(0xb2)][_0x349816[_0x8b2373(0xa9)]]||0x5,_0x3c6df2=_0x8b2373(0xc8);else{if(_0x349816[_0x8b2373(0xa9)]['includes'](_0x8b2373(0x6c))||_0x349816[_0x8b2373(0x92)][_0x8b2373(0x89)](_0x8b2373(0x75)))_0x200140=this[_0x8b2373(0x71)]['throttleFrequencies'][_0x349816[_0x8b2373(0xa9)]]||0xf,_0x3c6df2=_0x8b2373(0x81);else _0x349816[_0x8b2373(0xa9)][_0x8b2373(0x89)](_0x8b2373(0x84))&&(_0x200140=this[_0x8b2373(0x71)][_0x8b2373(0xb2)][_0x349816['type']]||0xa,_0x3c6df2=_0x8b2373(0x6a));}return{'type':_0x8b2373(0x74),'reason':_0x3c6df2,'isLargeData':!![],'estimatedSize':_0xd36dcb,'maxFrequency':_0x200140};}return{'type':_0x8b2373(0x90),'reason':_0x8b2373(0x96),'isLargeData':![],'estimatedSize':_0xd36dcb,'maxFrequency':null};}[a4_0x5aa095(0x7b)](_0x484b23,_0x27eafc){const _0x29c88f=a4_0x5aa095;if(_0x484b23[_0x29c88f(0x89)](':')){const [_0x4a32b8,_0x48fe3d]=_0x484b23[_0x29c88f(0x72)](':');return{'type':_0x4a32b8,'reason':_0x27eafc,'isLargeData':!![],'maxFrequency':_0x4a32b8===_0x29c88f(0x74)?parseFloat(_0x48fe3d):null,'estimatedSize':this[_0x29c88f(0x71)][_0x29c88f(0x77)]+0x1};}return{'type':_0x484b23,'reason':_0x27eafc,'isLargeData':_0x484b23!==_0x29c88f(0x90),'maxFrequency':null,'estimatedSize':this[_0x29c88f(0x71)][_0x29c88f(0x77)]+0x1};}[a4_0x5aa095(0x93)](_0x1d6e09,_0x58deec){const _0x2e6008=a4_0x5aa095,_0x5142ee=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x39ed44=[_0x2e6008(0x9d),'sensor_msgs/msg/Image',_0x2e6008(0x8a),_0x2e6008(0xc6)];return _0x5142ee[_0x2e6008(0xc9)](_0x1aa366=>_0x1aa366[_0x2e6008(0xcb)](_0x1d6e09))||_0x39ed44[_0x2e6008(0x89)](_0x58deec);}[a4_0x5aa095(0x7d)](_0x4d79d0,_0x352ab1=''){const _0x3c9e77=a4_0x5aa095,_0x50673e=[_0x3c9e77(0xa8),'sensor_msgs/msg/CompressedImage'];if(_0x50673e[_0x3c9e77(0x89)](_0x352ab1))return!_0x4d79d0[_0x3c9e77(0x89)](_0x3c9e77(0xcc))&&!_0x4d79d0[_0x3c9e77(0x89)](_0x3c9e77(0xa4))&&!_0x4d79d0['includes'](_0x3c9e77(0xbf));return(_0x4d79d0[_0x3c9e77(0x89)](_0x3c9e77(0xa0))||_0x4d79d0[_0x3c9e77(0x89)]('compressed'))&&!_0x4d79d0[_0x3c9e77(0x89)]('points')&&!_0x4d79d0[_0x3c9e77(0x89)](_0x3c9e77(0xa4))&&!_0x4d79d0[_0x3c9e77(0x89)](_0x3c9e77(0xbf));}[a4_0x5aa095(0xad)](_0x4da0cc,_0x1271de){const _0x4dfcca=a4_0x5aa095,_0x11cbc2={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x11cbc2[_0x1271de])return _0x11cbc2[_0x1271de];if(_0x4da0cc['includes'](_0x4dfcca(0xa6))||_0x4da0cc[_0x4dfcca(0x89)]('cloud'))return 0x190*0x400;if(_0x4da0cc[_0x4dfcca(0x89)](_0x4dfcca(0x9e)))return 0x12c*0x400;if(_0x4da0cc['includes'](_0x4dfcca(0x9b)))return 0x32*0x400;return 0x400;}[a4_0x5aa095(0x6d)](_0x4d2e78){const _0x553772=a4_0x5aa095;let _0x108597=this[_0x553772(0xa2)][_0x553772(0xa7)](_0x4d2e78[_0x553772(0x91)]);if(!_0x108597){console[_0x553772(0x80)](_0x553772(0x85)+_0x4d2e78[_0x553772(0x91)]);let _0x14254e=_0x553772(0xae);if(_0x4d2e78[_0x553772(0x91)][_0x553772(0x89)](_0x553772(0xa0))&&_0x4d2e78[_0x553772(0x91)][_0x553772(0x89)]('compressed'))_0x14254e=_0x553772(0xc6);else{if(_0x4d2e78['topic'][_0x553772(0x89)]('image'))_0x14254e=_0x553772(0xa8);else{if(_0x4d2e78[_0x553772(0x91)]['includes']('point')||_0x4d2e78[_0x553772(0x91)][_0x553772(0x89)](_0x553772(0xc0)))_0x14254e=_0x553772(0x9d);else _0x4d2e78[_0x553772(0x91)][_0x553772(0x89)](_0x553772(0x75))&&(_0x14254e=_0x553772(0x8a));}}const _0x3456b7={'name':_0x4d2e78['topic'],'type':_0x14254e};this[_0x553772(0xac)](_0x3456b7),_0x108597=this[_0x553772(0xa2)][_0x553772(0xa7)](_0x4d2e78[_0x553772(0x91)]);}if(!_0x108597)return{'action':'forward','message':_0x4d2e78};switch(_0x108597['strategy']){case'throttle':return this[_0x553772(0x95)](_0x4d2e78[_0x553772(0x91)],_0x108597[_0x553772(0xb7)])?{'action':_0x553772(0x7e),'message':_0x4d2e78}:{'action':_0x553772(0xb6)};case _0x553772(0xb3):return{'action':'webrtc_skip'};case _0x553772(0x90):default:return{'action':_0x553772(0x7e),'message':_0x4d2e78};}}[a4_0x5aa095(0x95)](_0x10f6b3,_0x5960ad){const _0x5e5ae3=a4_0x5aa095;if(!_0x5960ad)return!![];const _0xee4eae=Date['now'](),_0x47fe34=0x3e8/_0x5960ad;!this[_0x5e5ae3(0xb8)][_0x5e5ae3(0xb4)](_0x10f6b3)&&this['lastMessageTimes'][_0x5e5ae3(0xc4)](_0x10f6b3,0x0);const _0x13d72=this['lastMessageTimes'][_0x5e5ae3(0xa7)](_0x10f6b3),_0x3cd66d=_0xee4eae-_0x13d72;if(_0x3cd66d>=_0x47fe34)return this[_0x5e5ae3(0xb8)][_0x5e5ae3(0xc4)](_0x10f6b3,_0xee4eae),!![];return![];}[a4_0x5aa095(0xc5)](_0x4f9a36){const _0x1a4c57=a4_0x5aa095;return this['topicStrategies'][_0x1a4c57(0xa7)](_0x4f9a36);}[a4_0x5aa095(0x83)](){const _0x3ae83d=a4_0x5aa095;return Array[_0x3ae83d(0x73)](this[_0x3ae83d(0xa2)][_0x3ae83d(0x82)]())['map'](([_0x2e20b6,_0x1af169])=>({'topic':_0x2e20b6,..._0x1af169}));}['shouldUseWebRTC'](_0x3fd7c4){const _0x1f1a61=a4_0x5aa095,_0x1fdfc6=this[_0x1f1a61(0xa2)][_0x1f1a61(0xa7)](_0x3fd7c4);return _0x1fdfc6?.[_0x1f1a61(0x87)]===_0x1f1a61(0xb5);}[a4_0x5aa095(0xa5)](){const _0x473d34=a4_0x5aa095,_0x20c109={};return this['topicStrategies'][_0x473d34(0x86)]((_0x42bfa7,_0x220c6d)=>{const _0xc1c356=_0x473d34;!_0x20c109[_0x42bfa7[_0xc1c356(0x87)]]&&(_0x20c109[_0x42bfa7['strategy']]=0x0),_0x20c109[_0x42bfa7[_0xc1c356(0x87)]]++;}),{'totalTopics':this['topicStrategies'][_0x473d34(0x9f)],'strategies':_0x20c109,'largeDataTopics':Array[_0x473d34(0x73)](this[_0x473d34(0xa2)]['entries']())[_0x473d34(0x99)](([_0x2b1103,_0x1821cf])=>_0x1821cf[_0x473d34(0x70)])[_0x473d34(0xbc)](([_0x223d36,_0xd38d99])=>_0x223d36)};}}module['exports']=new TopicManager();