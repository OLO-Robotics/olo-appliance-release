const a6_0x295788=a6_0x321d;(function(_0x3a9c2e,_0x35ffa3){const _0x5a1893=a6_0x321d,_0x20aca9=_0x3a9c2e();while(!![]){try{const _0x4d87d9=parseInt(_0x5a1893(0x219))/0x1*(-parseInt(_0x5a1893(0x203))/0x2)+-parseInt(_0x5a1893(0x222))/0x3*(parseInt(_0x5a1893(0x1f1))/0x4)+-parseInt(_0x5a1893(0x226))/0x5+-parseInt(_0x5a1893(0x1ed))/0x6+parseInt(_0x5a1893(0x237))/0x7+-parseInt(_0x5a1893(0x225))/0x8*(-parseInt(_0x5a1893(0x1f4))/0x9)+parseInt(_0x5a1893(0x1ee))/0xa;if(_0x4d87d9===_0x35ffa3)break;else _0x20aca9['push'](_0x20aca9['shift']());}catch(_0x3eb65f){_0x20aca9['push'](_0x20aca9['shift']());}}}(a6_0x176d,0x85031));function a6_0x321d(_0x34baa1,_0x792b1f){const _0x27ab1c=a6_0x176d();return a6_0x321d=function(_0x352041,_0x38105a){_0x352041=_0x352041-0x1e6;let _0x176dd9=_0x27ab1c[_0x352041];return _0x176dd9;},a6_0x321d(_0x34baa1,_0x792b1f);}const a6_0x38105a=(function(){let _0x54eec2=!![];return function(_0x2f3089,_0x2f0f38){const _0x1e13e4=_0x54eec2?function(){const _0x5de106=a6_0x321d;if(_0x2f0f38){const _0x2c2baa=_0x2f0f38[_0x5de106(0x241)](_0x2f3089,arguments);return _0x2f0f38=null,_0x2c2baa;}}:function(){};return _0x54eec2=![],_0x1e13e4;};}()),a6_0x352041=a6_0x38105a(this,function(){const _0x523aa8=a6_0x321d;return a6_0x352041[_0x523aa8(0x206)]()[_0x523aa8(0x20b)](_0x523aa8(0x239))['toString']()['constructor'](a6_0x352041)[_0x523aa8(0x20b)](_0x523aa8(0x239));});a6_0x352041();const {execSync}=require('child_process');function a6_0x176d(){const _0x1a111f=['types','throttle','set','websocket','apply','handleMessage','[TopicManager]\x20Found\x20','large_data_throttled','image_throttled','point_cloud','strategies','forward','has','[TopicManager]\x20Starting\x20topic\x20discovery...','[TopicManager]\x20Error\x20getting\x20topics:','user_configured','image_raw','strategy','lastMessageTimes','type','4123278BvMZQH','17378100DGmkKO','reason','estimateTopicSize','4wfaYyz','getTopics','entries','9xdcxQO','split','webrtc_skip','isLargeDataTopic','analyzeTopicStrategy','Image','sensor_msgs/msg/CompressedImage','some','largeDataThreshold','log','point','discoveryInProgress','strategiesConfig','from','throttleFrequencies','4YaAssF','length','discoverTopics','toString','includes','webrtc_only','[TopicManager]\x20Loaded\x20configuration:','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','search','scan','config','[TopicManager]\x20Topic\x20discovery\x20completed','[TopicManager]\x20Topic\x20','error','defaultLargeDataStrategy','topicHandling','sensor_msgs/msg/LaserScan','topics','isLargeData','getTopicStrategy','size','depth_points','281199PQXcFl','[TopicManager]\x20Initialised','forEach','topicStrategies','[TopicManager]\x20Topic\x20discovery\x20failed:','[TopicManager]\x20Strategies:','laser_scan_throttled','cloud','sensor_msgs/msg/Image','2095779DuCtuz','normal_size','parseStrategyConfig','4027592KfSSlr','1676030xyHCrR','topic','replace','point_cloud_throttled','webrtc','image','sensor_msgs/msg/PointCloud2','map','\x20topics','maxFrequency','PointCloud2','name','compressed','estimatedSize','test','determineTopicStrategy','isCameraTopic','4108776GyPbJg','LaserScan','(((.+)+)+)+$','filter','get','now'];a6_0x176d=function(){return _0x1a111f;};return a6_0x176d();}class TopicManager{constructor(){const _0x199bf6=a6_0x321d;this[_0x199bf6(0x21c)]=new Map(),this[_0x199bf6(0x1eb)]=new Map(),this[_0x199bf6(0x1ff)]=![],this[_0x199bf6(0x20d)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x199bf6(0x1fd)](_0x199bf6(0x21a));}['loadConfig'](_0x12f38d){const _0x20c530=a6_0x321d;if(_0x12f38d[_0x20c530(0x212)]){const _0x75c397=_0x12f38d['topicHandling'];_0x75c397[_0x20c530(0x1fc)]&&(this[_0x20c530(0x20d)]['largeDataThreshold']=_0x75c397['largeDataThreshold']),_0x75c397[_0x20c530(0x211)]&&(this[_0x20c530(0x20d)][_0x20c530(0x211)]=_0x75c397[_0x20c530(0x211)]),_0x75c397[_0x20c530(0x247)]&&(this[_0x20c530(0x20d)][_0x20c530(0x200)]={..._0x75c397[_0x20c530(0x247)]}),_0x75c397[_0x20c530(0x202)]&&(this[_0x20c530(0x20d)][_0x20c530(0x202)]={...this[_0x20c530(0x20d)][_0x20c530(0x202)],..._0x75c397[_0x20c530(0x202)]}),console[_0x20c530(0x1fd)](_0x20c530(0x209),this['config']);}}async[a6_0x295788(0x205)](_0x51e174){const _0x1da3d5=a6_0x295788;if(this[_0x1da3d5(0x1ff)]||!_0x51e174)return;this[_0x1da3d5(0x1ff)]=!![],console[_0x1da3d5(0x1fd)](_0x1da3d5(0x1e6));try{await new Promise((_0x2ebefe,_0x50b9c5)=>{const _0x454844=_0x1da3d5;_0x51e174[_0x454844(0x1f2)](_0x5c91ea=>{const _0x37aa7d=_0x454844,_0x43b176=_0x5c91ea[_0x37aa7d(0x214)][_0x37aa7d(0x22d)]((_0x425335,_0x5e67cf)=>({'name':_0x425335,'type':_0x5c91ea[_0x37aa7d(0x23d)][_0x5e67cf]}));console[_0x37aa7d(0x1fd)](_0x37aa7d(0x243)+_0x43b176[_0x37aa7d(0x204)]+_0x37aa7d(0x22e));for(const _0x4851d0 of _0x43b176){this[_0x37aa7d(0x1f8)](_0x4851d0);}console['log'](_0x37aa7d(0x20e)),console[_0x37aa7d(0x1fd)](_0x37aa7d(0x21e),Array[_0x37aa7d(0x201)](this[_0x37aa7d(0x21c)][_0x37aa7d(0x1f3)]())),_0x2ebefe();},_0x3eff32=>{const _0x65bad=_0x454844;console[_0x65bad(0x210)](_0x65bad(0x1e7),_0x3eff32),_0x50b9c5(_0x3eff32);});});}catch(_0x2aeb1f){console[_0x1da3d5(0x210)](_0x1da3d5(0x21d),_0x2aeb1f);}finally{this['discoveryInProgress']=![];}}[a6_0x295788(0x1f8)](_0x1b7cc3){const _0x4a8d23=a6_0x295788,_0x9fd3bb=this[_0x4a8d23(0x235)](_0x1b7cc3);this[_0x4a8d23(0x21c)][_0x4a8d23(0x23f)](_0x1b7cc3[_0x4a8d23(0x231)],{'type':_0x1b7cc3[_0x4a8d23(0x1ec)],'strategy':_0x9fd3bb[_0x4a8d23(0x1ec)],'reason':_0x9fd3bb['reason'],'maxFrequency':_0x9fd3bb[_0x4a8d23(0x22f)],'isLargeData':_0x9fd3bb[_0x4a8d23(0x215)],'estimatedSize':_0x9fd3bb[_0x4a8d23(0x233)]}),console['log'](_0x4a8d23(0x20f)+_0x1b7cc3[_0x4a8d23(0x231)]+':\x20'+_0x9fd3bb['type']+'\x20('+_0x9fd3bb[_0x4a8d23(0x1ef)]+')');}['determineTopicStrategy'](_0x4ca5ba){const _0x356362=a6_0x295788;if(this[_0x356362(0x20d)][_0x356362(0x200)][_0x4ca5ba[_0x356362(0x231)]]){const _0x166ca6=this[_0x356362(0x20d)][_0x356362(0x200)][_0x4ca5ba[_0x356362(0x231)]];return this[_0x356362(0x224)](_0x166ca6,_0x356362(0x1e8));}for(const [_0x3bb75b,_0x66a29f]of Object[_0x356362(0x1f3)](this[_0x356362(0x20d)][_0x356362(0x200)])){if(_0x4ca5ba[_0x356362(0x231)][_0x356362(0x207)](_0x3bb75b[_0x356362(0x228)]('/','')))return this['parseStrategyConfig'](_0x66a29f,'pattern_configured');}if(this[_0x356362(0x236)](_0x4ca5ba[_0x356362(0x231)],_0x4ca5ba['type'])){const _0x3a9fcc=this['estimateTopicSize'](_0x4ca5ba[_0x356362(0x231)],_0x4ca5ba[_0x356362(0x1ec)]);return{'type':_0x356362(0x22a),'reason':'video_webrtc_streaming','isLargeData':!![],'estimatedSize':_0x3a9fcc,'maxFrequency':null};}const _0x19fce1=this[_0x356362(0x1f7)](_0x4ca5ba['name'],_0x4ca5ba[_0x356362(0x1ec)]),_0x53b42f=this[_0x356362(0x1f0)](_0x4ca5ba[_0x356362(0x231)],_0x4ca5ba[_0x356362(0x1ec)]);if(_0x19fce1||_0x53b42f>this[_0x356362(0x20d)][_0x356362(0x1fc)]){let _0xda177b=this['config'][_0x356362(0x202)][_0x4ca5ba[_0x356362(0x1ec)]]||0xa,_0xd1c29f=_0x356362(0x244);if(_0x4ca5ba[_0x356362(0x1ec)][_0x356362(0x207)](_0x356362(0x230))||_0x4ca5ba['name'][_0x356362(0x207)]('points'))_0xda177b=this['config']['throttleFrequencies'][_0x4ca5ba[_0x356362(0x1ec)]]||0x5,_0xd1c29f=_0x356362(0x229);else{if(_0x4ca5ba[_0x356362(0x1ec)][_0x356362(0x207)](_0x356362(0x238))||_0x4ca5ba[_0x356362(0x231)]['includes'](_0x356362(0x20c)))_0xda177b=this[_0x356362(0x20d)][_0x356362(0x202)][_0x4ca5ba[_0x356362(0x1ec)]]||0xf,_0xd1c29f=_0x356362(0x21f);else _0x4ca5ba[_0x356362(0x1ec)][_0x356362(0x207)](_0x356362(0x1f9))&&(_0xda177b=this[_0x356362(0x20d)][_0x356362(0x202)][_0x4ca5ba['type']]||0xa,_0xd1c29f=_0x356362(0x245));}return{'type':_0x356362(0x23e),'reason':_0xd1c29f,'isLargeData':!![],'estimatedSize':_0x53b42f,'maxFrequency':_0xda177b};}return{'type':'websocket','reason':_0x356362(0x223),'isLargeData':![],'estimatedSize':_0x53b42f,'maxFrequency':null};}[a6_0x295788(0x224)](_0x37993c,_0x28b6b4){const _0x129d37=a6_0x295788;if(_0x37993c[_0x129d37(0x207)](':')){const [_0x2897f1,_0x165a0b]=_0x37993c[_0x129d37(0x1f5)](':');return{'type':_0x2897f1,'reason':_0x28b6b4,'isLargeData':!![],'maxFrequency':_0x2897f1===_0x129d37(0x23e)?parseFloat(_0x165a0b):null,'estimatedSize':this[_0x129d37(0x20d)][_0x129d37(0x1fc)]+0x1};}return{'type':_0x37993c,'reason':_0x28b6b4,'isLargeData':_0x37993c!==_0x129d37(0x240),'maxFrequency':null,'estimatedSize':this['config']['largeDataThreshold']+0x1};}[a6_0x295788(0x1f7)](_0x1721dc,_0x439df3){const _0x5983ca=a6_0x295788,_0xad7bd9=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x293227=['sensor_msgs/msg/PointCloud2',_0x5983ca(0x221),_0x5983ca(0x213),_0x5983ca(0x1fa)];return _0xad7bd9[_0x5983ca(0x1fb)](_0x3705fa=>_0x3705fa[_0x5983ca(0x234)](_0x1721dc))||_0x293227['includes'](_0x439df3);}[a6_0x295788(0x236)](_0x2d2afb,_0x193a98=''){const _0x467d89=a6_0x295788,_0x49c72e=['sensor_msgs/msg/Image',_0x467d89(0x1fa)];if(_0x49c72e['includes'](_0x193a98))return!_0x2d2afb[_0x467d89(0x207)]('points')&&!_0x2d2afb[_0x467d89(0x207)](_0x467d89(0x246))&&!_0x2d2afb['includes'](_0x467d89(0x218));return(_0x2d2afb[_0x467d89(0x207)](_0x467d89(0x22b))||_0x2d2afb[_0x467d89(0x207)](_0x467d89(0x232)))&&!_0x2d2afb[_0x467d89(0x207)]('points')&&!_0x2d2afb['includes'](_0x467d89(0x246))&&!_0x2d2afb[_0x467d89(0x207)](_0x467d89(0x218));}[a6_0x295788(0x1f0)](_0x106a8d,_0x5b7951){const _0x2d90a0=a6_0x295788,_0x3de5e4={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x3de5e4[_0x5b7951])return _0x3de5e4[_0x5b7951];if(_0x106a8d['includes'](_0x2d90a0(0x1fe))||_0x106a8d[_0x2d90a0(0x207)](_0x2d90a0(0x220)))return 0x190*0x400;if(_0x106a8d[_0x2d90a0(0x207)](_0x2d90a0(0x1e9)))return 0x12c*0x400;if(_0x106a8d['includes'](_0x2d90a0(0x232)))return 0x32*0x400;return 0x400;}[a6_0x295788(0x242)](_0x4d5a34){const _0x92719a=a6_0x295788;let _0x542416=this['topicStrategies']['get'](_0x4d5a34[_0x92719a(0x227)]);if(!_0x542416){console[_0x92719a(0x1fd)](_0x92719a(0x20a)+_0x4d5a34[_0x92719a(0x227)]);let _0x51bceb='unknown';if(_0x4d5a34[_0x92719a(0x227)][_0x92719a(0x207)](_0x92719a(0x22b))&&_0x4d5a34[_0x92719a(0x227)]['includes'](_0x92719a(0x232)))_0x51bceb=_0x92719a(0x1fa);else{if(_0x4d5a34[_0x92719a(0x227)][_0x92719a(0x207)](_0x92719a(0x22b)))_0x51bceb=_0x92719a(0x221);else{if(_0x4d5a34['topic'][_0x92719a(0x207)](_0x92719a(0x1fe))||_0x4d5a34[_0x92719a(0x227)][_0x92719a(0x207)]('cloud'))_0x51bceb=_0x92719a(0x22c);else _0x4d5a34[_0x92719a(0x227)][_0x92719a(0x207)](_0x92719a(0x20c))&&(_0x51bceb='sensor_msgs/msg/LaserScan');}}const _0x576fda={'name':_0x4d5a34[_0x92719a(0x227)],'type':_0x51bceb};this[_0x92719a(0x1f8)](_0x576fda),_0x542416=this['topicStrategies'][_0x92719a(0x23b)](_0x4d5a34[_0x92719a(0x227)]);}if(!_0x542416)return{'action':'forward','message':_0x4d5a34};switch(_0x542416['strategy']){case'throttle':return this['shouldThrottle'](_0x4d5a34[_0x92719a(0x227)],_0x542416[_0x92719a(0x22f)])?{'action':_0x92719a(0x248),'message':_0x4d5a34}:{'action':'throttle_skip'};case _0x92719a(0x22a):return{'action':_0x92719a(0x1f6)};case _0x92719a(0x240):default:return{'action':_0x92719a(0x248),'message':_0x4d5a34};}}['shouldThrottle'](_0xe7b6c4,_0x5ce468){const _0xa940cd=a6_0x295788;if(!_0x5ce468)return!![];const _0x7b9961=Date[_0xa940cd(0x23c)](),_0x44b378=0x3e8/_0x5ce468;!this[_0xa940cd(0x1eb)][_0xa940cd(0x249)](_0xe7b6c4)&&this[_0xa940cd(0x1eb)][_0xa940cd(0x23f)](_0xe7b6c4,0x0);const _0x404ef2=this[_0xa940cd(0x1eb)][_0xa940cd(0x23b)](_0xe7b6c4),_0x4ed460=_0x7b9961-_0x404ef2;if(_0x4ed460>=_0x44b378)return this[_0xa940cd(0x1eb)]['set'](_0xe7b6c4,_0x7b9961),!![];return![];}[a6_0x295788(0x216)](_0x5cc403){const _0x371c7d=a6_0x295788;return this[_0x371c7d(0x21c)][_0x371c7d(0x23b)](_0x5cc403);}['getManagedTopics'](){const _0x32df69=a6_0x295788;return Array['from'](this[_0x32df69(0x21c)][_0x32df69(0x1f3)]())['map'](([_0x333f6f,_0xd1d19])=>({'topic':_0x333f6f,..._0xd1d19}));}['shouldUseWebRTC'](_0x12af7b){const _0x1db4b5=a6_0x295788,_0x3b48a5=this[_0x1db4b5(0x21c)][_0x1db4b5(0x23b)](_0x12af7b);return _0x3b48a5?.['strategy']===_0x1db4b5(0x208);}['getStatistics'](){const _0x2ba031=a6_0x295788,_0x3872a3={};return this[_0x2ba031(0x21c)][_0x2ba031(0x21b)]((_0x22284b,_0x479747)=>{const _0x37a761=_0x2ba031;!_0x3872a3[_0x22284b[_0x37a761(0x1ea)]]&&(_0x3872a3[_0x22284b['strategy']]=0x0),_0x3872a3[_0x22284b[_0x37a761(0x1ea)]]++;}),{'totalTopics':this[_0x2ba031(0x21c)][_0x2ba031(0x217)],'strategies':_0x3872a3,'largeDataTopics':Array[_0x2ba031(0x201)](this[_0x2ba031(0x21c)][_0x2ba031(0x1f3)]())[_0x2ba031(0x23a)](([_0x5aa4b9,_0x9860d])=>_0x9860d['isLargeData'])[_0x2ba031(0x22d)](([_0x2d0c64,_0xd20209])=>_0x2d0c64)};}}module['exports']=new TopicManager();