const a4_0x1dbf4b=a4_0x47f0;(function(_0x4cf438,_0x42e0f4){const _0x17206a=a4_0x47f0,_0x2b0137=_0x4cf438();while(!![]){try{const _0x35f119=-parseInt(_0x17206a(0x1e3))/0x1*(parseInt(_0x17206a(0x1dd))/0x2)+parseInt(_0x17206a(0x1ef))/0x3+parseInt(_0x17206a(0x1f6))/0x4+parseInt(_0x17206a(0x1f3))/0x5+-parseInt(_0x17206a(0x229))/0x6+parseInt(_0x17206a(0x210))/0x7+-parseInt(_0x17206a(0x1fc))/0x8;if(_0x35f119===_0x42e0f4)break;else _0x2b0137['push'](_0x2b0137['shift']());}catch(_0x3068e2){_0x2b0137['push'](_0x2b0137['shift']());}}}(a4_0x5cf1,0xf0713));function a4_0x5cf1(){const _0x1622a8=['[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','search','throttleFrequencies','webrtc','pattern_configured','17662992XgweLn','shouldUseWebRTC','estimateTopicSize','PointCloud2','[TopicManager]\x20Starting\x20topic\x20discovery...','forward','[TopicManager]\x20Initialised','[TopicManager]\x20Error\x20getting\x20topics:','name','isCameraTopic','estimatedSize','topicStrategies','(((.+)+)+)+$','shouldThrottle','sensor_msgs/msg/LaserScan','websocket','strategiesConfig','has','webrtc_only','replace','8907514DSdwuV','defaultLargeDataStrategy','[TopicManager]\x20Topic\x20','length','includes','log','handleMessage','set','from','type','sensor_msgs/msg/PointCloud2','parseStrategyConfig','apply','topicHandling','child_process','getStatistics','topic','constructor','discoveryInProgress','throttle','lastMessageTimes','isLargeData','[TopicManager]\x20Topic\x20discovery\x20completed','point_cloud','scan','3753840kJBtfZ','maxFrequency','cloud','map','sensor_msgs/msg/CompressedImage','sensor_msgs/msg/Image','compressed','webrtc_skip','error','image_throttled','points','video_webrtc_streaming','point','2ojIJcv','analyzeTopicStrategy','LaserScan','entries','strategy','\x20topics','53591XdIxVR','now','largeDataThreshold','depth_points','[TopicManager]\x20Found\x20','reason','image_raw','point_cloud_throttled','get','image','getTopicStrategy','unknown','40191aFLEHV','getManagedTopics','config','isLargeDataTopic','5747095TfPUYT','topics','toString','5746552UTSOXJ'];a4_0x5cf1=function(){return _0x1622a8;};return a4_0x5cf1();}function a4_0x47f0(_0x2e4c86,_0x1ae24d){const _0x339527=a4_0x5cf1();return a4_0x47f0=function(_0x292d08,_0x12bd87){_0x292d08=_0x292d08-0x1d5;let _0x5cf155=_0x339527[_0x292d08];return _0x5cf155;},a4_0x47f0(_0x2e4c86,_0x1ae24d);}const a4_0x12bd87=(function(){let _0x28d3c3=!![];return function(_0x4bd0c5,_0x5ecdd8){const _0x1c8205=_0x28d3c3?function(){const _0x10afd7=a4_0x47f0;if(_0x5ecdd8){const _0x5f2fa2=_0x5ecdd8[_0x10afd7(0x21c)](_0x4bd0c5,arguments);return _0x5ecdd8=null,_0x5f2fa2;}}:function(){};return _0x28d3c3=![],_0x1c8205;};}()),a4_0x292d08=a4_0x12bd87(this,function(){const _0x797c11=a4_0x47f0;return a4_0x292d08[_0x797c11(0x1f5)]()[_0x797c11(0x1f8)]('(((.+)+)+)+$')[_0x797c11(0x1f5)]()[_0x797c11(0x221)](a4_0x292d08)[_0x797c11(0x1f8)](_0x797c11(0x208));});a4_0x292d08();const {execSync}=require(a4_0x1dbf4b(0x21e));class TopicManager{constructor(){const _0x2b1dc8=a4_0x1dbf4b;this[_0x2b1dc8(0x207)]=new Map(),this[_0x2b1dc8(0x224)]=new Map(),this['discoveryInProgress']=![],this['config']={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x2b1dc8(0x20e),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x2b1dc8(0x215)](_0x2b1dc8(0x202));}['loadConfig'](_0x10f296){const _0x23b0af=a4_0x1dbf4b;if(_0x10f296[_0x23b0af(0x21d)]){const _0x5bacc0=_0x10f296[_0x23b0af(0x21d)];_0x5bacc0['largeDataThreshold']&&(this[_0x23b0af(0x1f1)]['largeDataThreshold']=_0x5bacc0[_0x23b0af(0x1e5)]),_0x5bacc0[_0x23b0af(0x211)]&&(this[_0x23b0af(0x1f1)][_0x23b0af(0x211)]=_0x5bacc0['defaultLargeDataStrategy']),_0x5bacc0['strategies']&&(this[_0x23b0af(0x1f1)][_0x23b0af(0x20c)]={..._0x5bacc0['strategies']}),_0x5bacc0['throttleFrequencies']&&(this[_0x23b0af(0x1f1)][_0x23b0af(0x1f9)]={...this[_0x23b0af(0x1f1)][_0x23b0af(0x1f9)],..._0x5bacc0[_0x23b0af(0x1f9)]}),console[_0x23b0af(0x215)]('[TopicManager]\x20Loaded\x20configuration:',this['config']);}}async['discoverTopics'](_0x4213d9){const _0x3da2e5=a4_0x1dbf4b;if(this[_0x3da2e5(0x222)]||!_0x4213d9)return;this[_0x3da2e5(0x222)]=!![],console['log'](_0x3da2e5(0x200));try{await new Promise((_0x35dacb,_0xcf8761)=>{_0x4213d9['getTopics'](_0x1915fa=>{const _0x4da4dd=a4_0x47f0,_0x439cf0=_0x1915fa[_0x4da4dd(0x1f4)][_0x4da4dd(0x22c)]((_0x389ebc,_0x5bfc7a)=>({'name':_0x389ebc,'type':_0x1915fa['types'][_0x5bfc7a]}));console[_0x4da4dd(0x215)](_0x4da4dd(0x1e7)+_0x439cf0[_0x4da4dd(0x213)]+_0x4da4dd(0x1e2));for(const _0x29fa42 of _0x439cf0){this[_0x4da4dd(0x1de)](_0x29fa42);}console[_0x4da4dd(0x215)](_0x4da4dd(0x226)),console[_0x4da4dd(0x215)]('[TopicManager]\x20Strategies:',Array[_0x4da4dd(0x218)](this['topicStrategies'][_0x4da4dd(0x1e0)]())),_0x35dacb();},_0x8c5add=>{const _0x101b7b=a4_0x47f0;console[_0x101b7b(0x1d8)](_0x101b7b(0x203),_0x8c5add),_0xcf8761(_0x8c5add);});});}catch(_0x120c62){console[_0x3da2e5(0x1d8)]('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x120c62);}finally{this[_0x3da2e5(0x222)]=![];}}[a4_0x1dbf4b(0x1de)](_0x1ef331){const _0x59bef3=a4_0x1dbf4b,_0xeeafe1=this['determineTopicStrategy'](_0x1ef331);this[_0x59bef3(0x207)][_0x59bef3(0x217)](_0x1ef331[_0x59bef3(0x204)],{'type':_0x1ef331[_0x59bef3(0x219)],'strategy':_0xeeafe1['type'],'reason':_0xeeafe1['reason'],'maxFrequency':_0xeeafe1[_0x59bef3(0x22a)],'isLargeData':_0xeeafe1[_0x59bef3(0x225)],'estimatedSize':_0xeeafe1[_0x59bef3(0x206)]}),console[_0x59bef3(0x215)](_0x59bef3(0x212)+_0x1ef331['name']+':\x20'+_0xeeafe1['type']+'\x20('+_0xeeafe1[_0x59bef3(0x1e8)]+')');}['determineTopicStrategy'](_0x25bdcd){const _0x2c2c98=a4_0x1dbf4b;if(this[_0x2c2c98(0x1f1)][_0x2c2c98(0x20c)][_0x25bdcd['name']]){const _0x126083=this[_0x2c2c98(0x1f1)]['strategiesConfig'][_0x25bdcd[_0x2c2c98(0x204)]];return this[_0x2c2c98(0x21b)](_0x126083,'user_configured');}for(const [_0x5baeb4,_0x141e49]of Object[_0x2c2c98(0x1e0)](this[_0x2c2c98(0x1f1)][_0x2c2c98(0x20c)])){if(_0x25bdcd[_0x2c2c98(0x204)]['includes'](_0x5baeb4[_0x2c2c98(0x20f)]('/','')))return this[_0x2c2c98(0x21b)](_0x141e49,_0x2c2c98(0x1fb));}if(this[_0x2c2c98(0x205)](_0x25bdcd[_0x2c2c98(0x204)],_0x25bdcd[_0x2c2c98(0x219)])){const _0x4779f5=this[_0x2c2c98(0x1fe)](_0x25bdcd[_0x2c2c98(0x204)],_0x25bdcd[_0x2c2c98(0x219)]);return{'type':_0x2c2c98(0x1fa),'reason':_0x2c2c98(0x1db),'isLargeData':!![],'estimatedSize':_0x4779f5,'maxFrequency':null};}const _0xee2cee=this[_0x2c2c98(0x1f2)](_0x25bdcd[_0x2c2c98(0x204)],_0x25bdcd['type']),_0x133427=this['estimateTopicSize'](_0x25bdcd[_0x2c2c98(0x204)],_0x25bdcd[_0x2c2c98(0x219)]);if(_0xee2cee||_0x133427>this[_0x2c2c98(0x1f1)]['largeDataThreshold']){let _0xc0ecf=this[_0x2c2c98(0x1f1)]['throttleFrequencies'][_0x25bdcd[_0x2c2c98(0x219)]]||0xa,_0x3aa3ff='large_data_throttled';if(_0x25bdcd[_0x2c2c98(0x219)][_0x2c2c98(0x214)](_0x2c2c98(0x1ff))||_0x25bdcd[_0x2c2c98(0x204)][_0x2c2c98(0x214)](_0x2c2c98(0x1da)))_0xc0ecf=this[_0x2c2c98(0x1f1)]['throttleFrequencies'][_0x25bdcd[_0x2c2c98(0x219)]]||0x5,_0x3aa3ff=_0x2c2c98(0x1ea);else{if(_0x25bdcd[_0x2c2c98(0x219)][_0x2c2c98(0x214)](_0x2c2c98(0x1df))||_0x25bdcd[_0x2c2c98(0x204)][_0x2c2c98(0x214)](_0x2c2c98(0x228)))_0xc0ecf=this[_0x2c2c98(0x1f1)]['throttleFrequencies'][_0x25bdcd[_0x2c2c98(0x219)]]||0xf,_0x3aa3ff='laser_scan_throttled';else _0x25bdcd[_0x2c2c98(0x219)]['includes']('Image')&&(_0xc0ecf=this[_0x2c2c98(0x1f1)][_0x2c2c98(0x1f9)][_0x25bdcd['type']]||0xa,_0x3aa3ff=_0x2c2c98(0x1d9));}return{'type':_0x2c2c98(0x223),'reason':_0x3aa3ff,'isLargeData':!![],'estimatedSize':_0x133427,'maxFrequency':_0xc0ecf};}return{'type':_0x2c2c98(0x20b),'reason':'normal_size','isLargeData':![],'estimatedSize':_0x133427,'maxFrequency':null};}[a4_0x1dbf4b(0x21b)](_0x29384f,_0x592e92){const _0x273652=a4_0x1dbf4b;if(_0x29384f[_0x273652(0x214)](':')){const [_0xbe90e0,_0x1ba250]=_0x29384f['split'](':');return{'type':_0xbe90e0,'reason':_0x592e92,'isLargeData':!![],'maxFrequency':_0xbe90e0===_0x273652(0x223)?parseFloat(_0x1ba250):null,'estimatedSize':this[_0x273652(0x1f1)][_0x273652(0x1e5)]+0x1};}return{'type':_0x29384f,'reason':_0x592e92,'isLargeData':_0x29384f!=='websocket','maxFrequency':null,'estimatedSize':this[_0x273652(0x1f1)]['largeDataThreshold']+0x1};}[a4_0x1dbf4b(0x1f2)](_0x845e2e,_0xb0c10e){const _0x2af5b8=a4_0x1dbf4b,_0x5c621b=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x389725=[_0x2af5b8(0x21a),_0x2af5b8(0x1d5),'sensor_msgs/msg/LaserScan',_0x2af5b8(0x22d)];return _0x5c621b['some'](_0x38caff=>_0x38caff['test'](_0x845e2e))||_0x389725[_0x2af5b8(0x214)](_0xb0c10e);}[a4_0x1dbf4b(0x205)](_0x591709,_0x2f76f7=''){const _0xc0ec96=a4_0x1dbf4b,_0x5ef1ab=['sensor_msgs/msg/Image',_0xc0ec96(0x22d)];if(_0x5ef1ab[_0xc0ec96(0x214)](_0x2f76f7))return!_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x1da))&&!_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x227))&&!_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x1e6));return(_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x1ec))||_0x591709[_0xc0ec96(0x214)]('compressed'))&&!_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x1da))&&!_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x227))&&!_0x591709[_0xc0ec96(0x214)](_0xc0ec96(0x1e6));}[a4_0x1dbf4b(0x1fe)](_0x34e1b4,_0x3fd8ee){const _0x201264=a4_0x1dbf4b,_0x208f64={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x208f64[_0x3fd8ee])return _0x208f64[_0x3fd8ee];if(_0x34e1b4['includes'](_0x201264(0x1dc))||_0x34e1b4[_0x201264(0x214)](_0x201264(0x22b)))return 0x190*0x400;if(_0x34e1b4[_0x201264(0x214)](_0x201264(0x1e9)))return 0x12c*0x400;if(_0x34e1b4[_0x201264(0x214)](_0x201264(0x1d6)))return 0x32*0x400;return 0x400;}[a4_0x1dbf4b(0x216)](_0x34233c){const _0x57054c=a4_0x1dbf4b;let _0x2876dc=this[_0x57054c(0x207)][_0x57054c(0x1eb)](_0x34233c[_0x57054c(0x220)]);if(!_0x2876dc){console[_0x57054c(0x215)](_0x57054c(0x1f7)+_0x34233c['topic']);let _0x4d9c45=_0x57054c(0x1ee);if(_0x34233c[_0x57054c(0x220)][_0x57054c(0x214)](_0x57054c(0x1ec))&&_0x34233c[_0x57054c(0x220)][_0x57054c(0x214)](_0x57054c(0x1d6)))_0x4d9c45=_0x57054c(0x22d);else{if(_0x34233c[_0x57054c(0x220)][_0x57054c(0x214)](_0x57054c(0x1ec)))_0x4d9c45='sensor_msgs/msg/Image';else{if(_0x34233c[_0x57054c(0x220)][_0x57054c(0x214)](_0x57054c(0x1dc))||_0x34233c['topic']['includes'](_0x57054c(0x22b)))_0x4d9c45=_0x57054c(0x21a);else _0x34233c['topic'][_0x57054c(0x214)](_0x57054c(0x228))&&(_0x4d9c45=_0x57054c(0x20a));}}const _0x1ce98d={'name':_0x34233c[_0x57054c(0x220)],'type':_0x4d9c45};this['analyzeTopicStrategy'](_0x1ce98d),_0x2876dc=this[_0x57054c(0x207)][_0x57054c(0x1eb)](_0x34233c[_0x57054c(0x220)]);}if(!_0x2876dc)return{'action':_0x57054c(0x201),'message':_0x34233c};switch(_0x2876dc[_0x57054c(0x1e1)]){case _0x57054c(0x223):return this[_0x57054c(0x209)](_0x34233c[_0x57054c(0x220)],_0x2876dc['maxFrequency'])?{'action':_0x57054c(0x201),'message':_0x34233c}:{'action':'throttle_skip'};case _0x57054c(0x1fa):return{'action':_0x57054c(0x1d7)};case _0x57054c(0x20b):default:return{'action':_0x57054c(0x201),'message':_0x34233c};}}[a4_0x1dbf4b(0x209)](_0x1f576f,_0x6d4769){const _0x1f929c=a4_0x1dbf4b;if(!_0x6d4769)return!![];const _0x3534dc=Date[_0x1f929c(0x1e4)](),_0x578bd0=0x3e8/_0x6d4769;!this[_0x1f929c(0x224)][_0x1f929c(0x20d)](_0x1f576f)&&this[_0x1f929c(0x224)][_0x1f929c(0x217)](_0x1f576f,0x0);const _0x5a25d3=this[_0x1f929c(0x224)]['get'](_0x1f576f),_0x4c556b=_0x3534dc-_0x5a25d3;if(_0x4c556b>=_0x578bd0)return this['lastMessageTimes'][_0x1f929c(0x217)](_0x1f576f,_0x3534dc),!![];return![];}[a4_0x1dbf4b(0x1ed)](_0x3131c7){const _0x303d79=a4_0x1dbf4b;return this['topicStrategies'][_0x303d79(0x1eb)](_0x3131c7);}[a4_0x1dbf4b(0x1f0)](){const _0x213e0e=a4_0x1dbf4b;return Array[_0x213e0e(0x218)](this[_0x213e0e(0x207)][_0x213e0e(0x1e0)]())[_0x213e0e(0x22c)](([_0xe4367d,_0x2e3658])=>({'topic':_0xe4367d,..._0x2e3658}));}[a4_0x1dbf4b(0x1fd)](_0x4ccc85){const _0x396272=a4_0x1dbf4b,_0x17c7ec=this[_0x396272(0x207)][_0x396272(0x1eb)](_0x4ccc85);return _0x17c7ec?.[_0x396272(0x1e1)]===_0x396272(0x20e);}[a4_0x1dbf4b(0x21f)](){const _0x31795f=a4_0x1dbf4b,_0x3b370b={};return this[_0x31795f(0x207)]['forEach']((_0x190e19,_0x281857)=>{const _0x582e4b=_0x31795f;!_0x3b370b[_0x190e19[_0x582e4b(0x1e1)]]&&(_0x3b370b[_0x190e19[_0x582e4b(0x1e1)]]=0x0),_0x3b370b[_0x190e19[_0x582e4b(0x1e1)]]++;}),{'totalTopics':this['topicStrategies']['size'],'strategies':_0x3b370b,'largeDataTopics':Array[_0x31795f(0x218)](this[_0x31795f(0x207)]['entries']())['filter'](([_0x3d2d7e,_0x405671])=>_0x405671['isLargeData'])[_0x31795f(0x22c)](([_0x464b4e,_0x361fbc])=>_0x464b4e)};}}module['exports']=new TopicManager();