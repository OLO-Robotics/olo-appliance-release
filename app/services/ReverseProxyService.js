const a5_0x5afdc5=a5_0x5922;(function(_0x2843ba,_0x3a0965){const _0x5d779e=a5_0x5922,_0x55c42a=_0x2843ba();while(!![]){try{const _0x4659a7=-parseInt(_0x5d779e(0x1eb))/0x1+parseInt(_0x5d779e(0x22f))/0x2+parseInt(_0x5d779e(0x223))/0x3*(-parseInt(_0x5d779e(0x242))/0x4)+parseInt(_0x5d779e(0x206))/0x5*(-parseInt(_0x5d779e(0x23f))/0x6)+parseInt(_0x5d779e(0x220))/0x7*(parseInt(_0x5d779e(0x1f9))/0x8)+-parseInt(_0x5d779e(0x214))/0x9+-parseInt(_0x5d779e(0x1f8))/0xa*(-parseInt(_0x5d779e(0x229))/0xb);if(_0x4659a7===_0x3a0965)break;else _0x55c42a['push'](_0x55c42a['shift']());}catch(_0x513210){_0x55c42a['push'](_0x55c42a['shift']());}}}(a5_0x399a,0xa21ad));const a5_0x43da39=(function(){let _0x1b8833=!![];return function(_0x129829,_0x4d219c){const _0x18d787=_0x1b8833?function(){const _0x2dfd53=a5_0x5922;if(_0x4d219c){const _0x19deed=_0x4d219c[_0x2dfd53(0x21f)](_0x129829,arguments);return _0x4d219c=null,_0x19deed;}}:function(){};return _0x1b8833=![],_0x18d787;};}()),a5_0xc0994b=a5_0x43da39(this,function(){const _0x1a672d=a5_0x5922;return a5_0xc0994b[_0x1a672d(0x23e)]()[_0x1a672d(0x238)](_0x1a672d(0x22e))[_0x1a672d(0x23e)]()[_0x1a672d(0x1ef)](a5_0xc0994b)[_0x1a672d(0x238)](_0x1a672d(0x22e));});function a5_0x399a(){const _0x118f4d=['3639933hcGhbB','type','topics','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','wsEndpoint','OPEN','308fgCOfv','/rosapi/topics','roslib','stopAllSessions','serverUrl','(((.+)+)+)+$','560614elrfne','close','name','Ros','handleRosbridgeMessage','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','webrtc_skip','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','search','throttling','CLOSED','handleMessage','closeAllConnections','Connected\x20to\x20ROSBridge\x20(main)','toString','2098002NcPlel','topicManager','action','4DUXBHd','service','initialize','rosbridgeWebRTCWs','635695dxkwWt','authService','Connected\x20to\x20ROSBridge\x20(WebRTC)','registrationToken','constructor','config','Disconnected\x20from\x20server\x20(','send','strategy','error','readyState','unknown','catch','1076210vwpKic','8lDUzDT','rosbridgeWs','topic','connectToServer','types','sample','Failed\x20to\x20connect\x20to\x20server:','service_response','call_service','log','open','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','connection','10lVSfZy','Topic\x20discovery\x20failed:','parse','ROSBridge\x20(main)\x20connection\x20error:','message','),\x20attempting\x20to\x20reconnect...','rosbridge','map','serverWs','/rosbridge?type=appliance&token=','sample_skip','samplingRate','replace','http','7159365nZrhBW','publish','connectToRosbridgeWebRTC','Server\x20connection\x20error:','robotId','estimatedSize','connectToRosbridge','getConnectionStatus','urdfService','values','webrtcService','apply','4998777tooyKy','stringify','getTopicStrategy'];a5_0x399a=function(){return _0x118f4d;};return a5_0x399a();}a5_0xc0994b();const WebSocket=require('ws'),ROSLIB=require(a5_0x5afdc5(0x22b));function a5_0x5922(_0x2925f2,_0x1ddc1b){const _0x5ba5b6=a5_0x399a();return a5_0x5922=function(_0xc0994b,_0x43da39){_0xc0994b=_0xc0994b-0x1ea;let _0x399aa5=_0x5ba5b6[_0xc0994b];return _0x399aa5;},a5_0x5922(_0x2925f2,_0x1ddc1b);}class ReverseProxyService{constructor(_0x2c21c2,_0xe84a4f,_0x29e6ca,_0x2a978d,_0x2e81fc){const _0x34390e=a5_0x5afdc5;this[_0x34390e(0x1f0)]=_0x2c21c2,this[_0x34390e(0x1ec)]=_0xe84a4f,this[_0x34390e(0x21e)]=_0x29e6ca,this[_0x34390e(0x240)]=_0x2a978d,this[_0x34390e(0x21c)]=_0x2e81fc,this[_0x34390e(0x20e)]=null,this[_0x34390e(0x1fa)]=null,this[_0x34390e(0x1ea)]=null,this[_0x34390e(0x1ee)]=null,this[_0x34390e(0x218)]=null;}['initialize'](_0x32a866,_0x30df1b){const _0x579917=a5_0x5afdc5;this[_0x579917(0x218)]=_0x32a866,this[_0x579917(0x1ee)]=_0x30df1b;}[a5_0x5afdc5(0x21a)](){const _0x22637c=a5_0x5afdc5;try{this[_0x22637c(0x1fa)]=new WebSocket(this[_0x22637c(0x1f0)][_0x22637c(0x20c)][_0x22637c(0x227)]),this[_0x22637c(0x1fa)]['on'](_0x22637c(0x203),()=>{const _0x33e389=_0x22637c;console['log'](_0x33e389(0x23d));const _0x4562db=new ROSLIB[(_0x33e389(0x232))]({'url':this[_0x33e389(0x1f0)][_0x33e389(0x20c)][_0x33e389(0x227)]});_0x4562db['on'](_0x33e389(0x205),()=>{setTimeout(()=>{const _0x1f95e6=a5_0x5922;this[_0x1f95e6(0x240)]['discoverTopics'](_0x4562db)[_0x1f95e6(0x1f7)](_0x591dc6=>{const _0xc27ad6=_0x1f95e6;console[_0xc27ad6(0x1f4)](_0xc27ad6(0x207),_0x591dc6);});},0x3e8);}),this[_0x33e389(0x216)]();}),this[_0x22637c(0x1fa)]['on'](_0x22637c(0x20a),_0x593341=>{const _0x46afb5=_0x22637c;this[_0x46afb5(0x233)](_0x593341);}),this['rosbridgeWs']['on']('close',()=>{const _0x4594b9=_0x22637c;console['log'](_0x4594b9(0x237)),this[_0x4594b9(0x21e)]['stopAllSessions'](),setTimeout(()=>this[_0x4594b9(0x21a)](),0x1388);}),this[_0x22637c(0x1fa)]['on'](_0x22637c(0x1f4),_0x1d74eb=>{const _0x187021=_0x22637c;console[_0x187021(0x1f4)](_0x187021(0x209),_0x1d74eb);});}catch(_0x2f66c1){console['error'](_0x22637c(0x204),_0x2f66c1),setTimeout(()=>this['connectToRosbridge'](),0x1388);}}['connectToRosbridgeWebRTC'](){const _0x25bea0=a5_0x5afdc5;try{this[_0x25bea0(0x1ea)]=new WebSocket(this['config']['rosbridge'][_0x25bea0(0x227)]),this[_0x25bea0(0x1ea)]['on'](_0x25bea0(0x203),()=>{const _0x2b6c0f=_0x25bea0;console[_0x2b6c0f(0x202)](_0x2b6c0f(0x1ed)),this[_0x2b6c0f(0x21e)][_0x2b6c0f(0x244)](this[_0x2b6c0f(0x1ea)],this[_0x2b6c0f(0x20e)]);}),this[_0x25bea0(0x1ea)]['on'](_0x25bea0(0x20a),_0x996b96=>{}),this[_0x25bea0(0x1ea)]['on']('close',()=>{const _0x3e2273=_0x25bea0;console['log']('Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...'),this[_0x3e2273(0x21e)][_0x3e2273(0x22c)](),setTimeout(()=>this[_0x3e2273(0x216)](),0x1388);}),this[_0x25bea0(0x1ea)]['on'](_0x25bea0(0x1f4),_0x4f172a=>{console['error']('ROSBridge\x20(WebRTC)\x20connection\x20error:',_0x4f172a);});}catch(_0x4d9247){console[_0x25bea0(0x1f4)](_0x25bea0(0x226),_0x4d9247),setTimeout(()=>this[_0x25bea0(0x216)](),0x1388);}}[a5_0x5afdc5(0x1fc)](){const _0x5ec5c0=a5_0x5afdc5;try{if(!this[_0x5ec5c0(0x1ee)])throw new Error(_0x5ec5c0(0x234));const _0x537f60=this[_0x5ec5c0(0x1f0)][_0x5ec5c0(0x22d)][_0x5ec5c0(0x212)](_0x5ec5c0(0x213),'ws')+_0x5ec5c0(0x20f)+this[_0x5ec5c0(0x1ee)];this[_0x5ec5c0(0x20e)]=new WebSocket(_0x537f60),this[_0x5ec5c0(0x20e)]['on'](_0x5ec5c0(0x203),()=>{const _0x2fb722=_0x5ec5c0;console[_0x2fb722(0x202)]('Connected\x20to\x20server'),this['rosbridgeWebRTCWs']&&this[_0x2fb722(0x1ea)][_0x2fb722(0x1f5)]===WebSocket[_0x2fb722(0x228)]&&this[_0x2fb722(0x21e)][_0x2fb722(0x244)](this['rosbridgeWebRTCWs'],this[_0x2fb722(0x20e)]);}),this['serverWs']['on'](_0x5ec5c0(0x20a),_0x13e588=>{this['handleServerMessage'](_0x13e588);}),this[_0x5ec5c0(0x20e)]['on'](_0x5ec5c0(0x230),(_0x1a0ef8,_0x14a764)=>{const _0x20424a=_0x5ec5c0;console[_0x20424a(0x202)](_0x20424a(0x1f1)+_0x1a0ef8+':\x20'+_0x14a764+_0x20424a(0x20b)),this['webrtcService'][_0x20424a(0x22c)](),setTimeout(()=>this['connectToServer'](),0x1388);}),this['serverWs']['on'](_0x5ec5c0(0x1f4),_0x39853d=>{const _0x2bf50d=_0x5ec5c0;console[_0x2bf50d(0x1f4)](_0x2bf50d(0x217),_0x39853d);});}catch(_0x15e07e){console['error'](_0x5ec5c0(0x1ff),_0x15e07e),setTimeout(()=>this['connectToServer'](),0x1388);}}['handleRosbridgeMessage'](_0xbfae5c){const _0xf78fcd=a5_0x5afdc5;if(this[_0xf78fcd(0x20e)]&&this[_0xf78fcd(0x20e)][_0xf78fcd(0x1f5)]===WebSocket[_0xf78fcd(0x228)]){let _0x1503da=_0xbfae5c['toString']();try{let _0x44fd18=JSON['parse'](_0x1503da);if(_0x44fd18['op']===_0xf78fcd(0x215)&&_0x44fd18[_0xf78fcd(0x1fb)]){const _0x371d2c=this['topicManager'][_0xf78fcd(0x23b)](_0x44fd18);switch(_0x371d2c[_0xf78fcd(0x241)]){case _0xf78fcd(0x210):return;case _0xf78fcd(0x235):return;case'forward':default:_0x1503da=JSON[_0xf78fcd(0x221)](_0x371d2c[_0xf78fcd(0x20a)]);break;}}if((_0x44fd18['op']===_0xf78fcd(0x200)||_0x44fd18['op']===_0xf78fcd(0x201))&&(_0x44fd18[_0xf78fcd(0x243)]===_0xf78fcd(0x22a)||_0x44fd18[_0xf78fcd(0x21d)]&&_0x44fd18[_0xf78fcd(0x21d)][_0xf78fcd(0x225)])){console[_0xf78fcd(0x202)](_0xf78fcd(0x236));const _0x4379e5=_0x44fd18[_0xf78fcd(0x21d)]?.[_0xf78fcd(0x225)]||[],_0x56644b=_0x44fd18['values']?.[_0xf78fcd(0x1fd)]||[],_0x241399=_0x4379e5[_0xf78fcd(0x20d)]((_0x438742,_0x14dbac)=>{const _0x1cc0e5=_0xf78fcd,_0x3af517=this[_0x1cc0e5(0x240)][_0x1cc0e5(0x222)](_0x438742);return{'name':_0x438742,'type':_0x56644b[_0x14dbac]||_0x1cc0e5(0x1f6),'throttling':_0x3af517?{'isThrottled':_0x3af517[_0x1cc0e5(0x1f3)]===_0x1cc0e5(0x1fe),'strategy':_0x3af517[_0x1cc0e5(0x1f3)],'samplingRate':_0x3af517[_0x1cc0e5(0x211)],'reason':_0x3af517['reason'],'estimatedSize':_0x3af517[_0x1cc0e5(0x219)]}:null};});_0x44fd18[_0xf78fcd(0x21d)]={'topics':_0x241399['map'](_0x20ad1c=>_0x20ad1c[_0xf78fcd(0x231)]),'types':_0x241399['map'](_0x56385d=>_0x56385d[_0xf78fcd(0x224)]),'throttling':_0x241399[_0xf78fcd(0x20d)](_0x40e0b0=>_0x40e0b0[_0xf78fcd(0x239)])},_0x1503da=JSON['stringify'](_0x44fd18),console[_0xf78fcd(0x202)]('[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client');}if(_0x44fd18['op']===_0xf78fcd(0x215)&&_0x44fd18[_0xf78fcd(0x1fb)]==='/robot_description'){const _0x1e8ef7=this[_0xf78fcd(0x21c)]['processMessage'](_0x44fd18,_0x44fd18[_0xf78fcd(0x1fb)]);_0x1e8ef7&&(_0x44fd18=_0x1e8ef7,_0x1503da=JSON[_0xf78fcd(0x221)](_0x44fd18));}}catch(_0x1a2119){console['warn']('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0x1a2119[_0xf78fcd(0x20a)]);}this[_0xf78fcd(0x20e)]['send'](_0x1503da);}}['handleServerMessage'](_0x2a1c97){const _0x3226de=a5_0x5afdc5;if(this[_0x3226de(0x1fa)]&&this[_0x3226de(0x1fa)][_0x3226de(0x1f5)]===WebSocket[_0x3226de(0x228)]){let _0x43718c=_0x2a1c97['toString']();try{const _0x3283a0=JSON[_0x3226de(0x208)](_0x43718c);if(this['webrtcService']['handleMessage'](_0x3283a0))return;if(this[_0x3226de(0x21c)][_0x3226de(0x23b)](_0x3283a0,this[_0x3226de(0x20e)]))return;this[_0x3226de(0x1fa)][_0x3226de(0x1f2)](_0x43718c);}catch(_0x49f827){this['rosbridgeWs']['send'](_0x43718c);}}}[a5_0x5afdc5(0x21b)](){const _0x2e3c9a=a5_0x5afdc5;return{'server':this[_0x2e3c9a(0x20e)]?this[_0x2e3c9a(0x20e)][_0x2e3c9a(0x1f5)]:WebSocket[_0x2e3c9a(0x23a)],'rosbridge':this[_0x2e3c9a(0x1fa)]?this['rosbridgeWs'][_0x2e3c9a(0x1f5)]:WebSocket[_0x2e3c9a(0x23a)],'rosbridgeWebRTC':this[_0x2e3c9a(0x1ea)]?this['rosbridgeWebRTCWs'][_0x2e3c9a(0x1f5)]:WebSocket['CLOSED']};}[a5_0x5afdc5(0x23c)](){const _0x1885a6=a5_0x5afdc5;this[_0x1885a6(0x20e)]&&this[_0x1885a6(0x20e)][_0x1885a6(0x230)](),this[_0x1885a6(0x1fa)]&&this[_0x1885a6(0x1fa)][_0x1885a6(0x230)](),this[_0x1885a6(0x1ea)]&&this[_0x1885a6(0x1ea)][_0x1885a6(0x230)]();}}module['exports']=ReverseProxyService;