const a5_0x559107=a5_0x589e;function a5_0x589e(_0x5318d8,_0x540ac7){const _0x2ca05f=a5_0x1161();return a5_0x589e=function(_0x3bf642,_0x4d3c85){_0x3bf642=_0x3bf642-0x16d;let _0x1161d8=_0x2ca05f[_0x3bf642];return _0x1161d8;},a5_0x589e(_0x5318d8,_0x540ac7);}(function(_0x386ede,_0x2610a6){const _0x26c1be=a5_0x589e,_0x2fd406=_0x386ede();while(!![]){try{const _0x22d174=parseInt(_0x26c1be(0x1a1))/0x1*(-parseInt(_0x26c1be(0x1b1))/0x2)+-parseInt(_0x26c1be(0x176))/0x3+-parseInt(_0x26c1be(0x17a))/0x4*(-parseInt(_0x26c1be(0x1b3))/0x5)+-parseInt(_0x26c1be(0x19d))/0x6*(-parseInt(_0x26c1be(0x177))/0x7)+-parseInt(_0x26c1be(0x16d))/0x8+-parseInt(_0x26c1be(0x174))/0x9+-parseInt(_0x26c1be(0x1c1))/0xa*(-parseInt(_0x26c1be(0x1ad))/0xb);if(_0x22d174===_0x2610a6)break;else _0x2fd406['push'](_0x2fd406['shift']());}catch(_0x3a6458){_0x2fd406['push'](_0x2fd406['shift']());}}}(a5_0x1161,0xe2589));const a5_0x4d3c85=(function(){let _0x5bf9e8=!![];return function(_0x1b8230,_0x916b9e){const _0x5c3298=_0x5bf9e8?function(){const _0x28e8b2=a5_0x589e;if(_0x916b9e){const _0x2de007=_0x916b9e[_0x28e8b2(0x1b0)](_0x1b8230,arguments);return _0x916b9e=null,_0x2de007;}}:function(){};return _0x5bf9e8=![],_0x5c3298;};}()),a5_0x3bf642=a5_0x4d3c85(this,function(){const _0x15037b=a5_0x589e;return a5_0x3bf642[_0x15037b(0x1af)]()[_0x15037b(0x17c)](_0x15037b(0x194))[_0x15037b(0x1af)]()[_0x15037b(0x192)](a5_0x3bf642)['search'](_0x15037b(0x194));});a5_0x3bf642();function a5_0x1161(){const _0x4dda32=['samplingRate','roslib','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','rosbridgeWebRTCWs','10868xldkMC','sample','toString','apply','2mFYRRl','parse','3482705MfKpva','publish','stopAllSessions','OPEN','exports','getConnectionStatus','estimatedSize','Topic\x20discovery\x20failed:','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','Connected\x20to\x20server','sample_skip','connectToRosbridge','connectToServer','name','18490ICvBIh','[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:','topic','readyState','topics','handleServerMessage','stringify','closeAllConnections','topicManager','serverUrl','Disconnected\x20from\x20server\x20(','9477432GTExck','rosbridge','webrtcService','replace','open','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','http','6052788UlZICC','warn','290676IUyviG','7AyFmHI','connectToRosbridgeWebRTC','unknown','4oNaPDa','handleMessage','search','message','service_response','),\x20attempting\x20to\x20reconnect...','Server\x20connection\x20error:','strategy','serverWs','/robot_description','getTopicStrategy','Connected\x20to\x20ROSBridge\x20(WebRTC)','catch','robotId','discoverTopics','connection','handleRosbridgeMessage','ROSBridge\x20(main)\x20connection\x20error:','error','CLOSED','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','wsEndpoint','processMessage','rosbridgeWs','constructor','values','(((.+)+)+)+$','initialize','throttling','types','log','urdfService','Failed\x20to\x20connect\x20to\x20server:','/rosbridge?type=appliance&token=','ROSBridge\x20(WebRTC)\x20connection\x20error:','7212174wcNLDQ','webrtc_skip','close','service','844166srRCVQ','reason','action','config','send','registrationToken','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata'];a5_0x1161=function(){return _0x4dda32;};return a5_0x1161();}const WebSocket=require('ws'),ROSLIB=require(a5_0x559107(0x1a9));class ReverseProxyService{constructor(_0x57354b,_0x53f3e1,_0x394c5d,_0x54e28c,_0x3dc3cc){const _0x304039=a5_0x559107;this[_0x304039(0x1a4)]=_0x57354b,this['authService']=_0x53f3e1,this[_0x304039(0x16f)]=_0x394c5d,this[_0x304039(0x1c9)]=_0x54e28c,this[_0x304039(0x199)]=_0x3dc3cc,this['serverWs']=null,this[_0x304039(0x191)]=null,this[_0x304039(0x1ac)]=null,this[_0x304039(0x1a6)]=null,this[_0x304039(0x187)]=null;}[a5_0x559107(0x195)](_0x1c069f,_0x3ea651){const _0x3f5dad=a5_0x559107;this[_0x3f5dad(0x187)]=_0x1c069f,this[_0x3f5dad(0x1a6)]=_0x3ea651;}[a5_0x559107(0x1be)](){const _0x1ce905=a5_0x559107;try{this[_0x1ce905(0x191)]=new WebSocket(this[_0x1ce905(0x1a4)][_0x1ce905(0x16e)][_0x1ce905(0x18f)]),this['rosbridgeWs']['on'](_0x1ce905(0x171),()=>{const _0x5547ce=_0x1ce905;console[_0x5547ce(0x198)]('Connected\x20to\x20ROSBridge\x20(main)');const _0x558484=new ROSLIB['Ros']({'url':this['config'][_0x5547ce(0x16e)][_0x5547ce(0x18f)]});_0x558484['on'](_0x5547ce(0x189),()=>{setTimeout(()=>{const _0x588d6f=a5_0x589e;this[_0x588d6f(0x1c9)][_0x588d6f(0x188)](_0x558484)[_0x588d6f(0x186)](_0x3bec77=>{const _0x4ba358=_0x588d6f;console['error'](_0x4ba358(0x1ba),_0x3bec77);});},0x3e8);}),this[_0x5547ce(0x178)]();}),this[_0x1ce905(0x191)]['on'](_0x1ce905(0x17d),_0x17e862=>{const _0x5bf6da=_0x1ce905;this[_0x5bf6da(0x18a)](_0x17e862);}),this['rosbridgeWs']['on'](_0x1ce905(0x19f),()=>{const _0x5f372a=_0x1ce905;console['log'](_0x5f372a(0x1aa)),this[_0x5f372a(0x16f)][_0x5f372a(0x1b5)](),setTimeout(()=>this[_0x5f372a(0x1be)](),0x1388);}),this[_0x1ce905(0x191)]['on'](_0x1ce905(0x18c),_0x5b4707=>{const _0x4c84ca=_0x1ce905;console['error'](_0x4c84ca(0x18b),_0x5b4707);});}catch(_0x2920e1){console[_0x1ce905(0x18c)](_0x1ce905(0x1ab),_0x2920e1),setTimeout(()=>this['connectToRosbridge'](),0x1388);}}[a5_0x559107(0x178)](){const _0x5b4478=a5_0x559107;try{this[_0x5b4478(0x1ac)]=new WebSocket(this[_0x5b4478(0x1a4)][_0x5b4478(0x16e)][_0x5b4478(0x18f)]),this[_0x5b4478(0x1ac)]['on'](_0x5b4478(0x171),()=>{const _0x46e279=_0x5b4478;console[_0x46e279(0x198)](_0x46e279(0x185)),this[_0x46e279(0x16f)]['initialize'](this[_0x46e279(0x1ac)],this['serverWs']);}),this['rosbridgeWebRTCWs']['on'](_0x5b4478(0x17d),_0x3f3dc8=>{}),this[_0x5b4478(0x1ac)]['on'](_0x5b4478(0x19f),()=>{const _0x53522a=_0x5b4478;console['log'](_0x53522a(0x1bb)),this[_0x53522a(0x16f)][_0x53522a(0x1b5)](),setTimeout(()=>this[_0x53522a(0x178)](),0x1388);}),this['rosbridgeWebRTCWs']['on'](_0x5b4478(0x18c),_0x404bac=>{const _0x458052=_0x5b4478;console[_0x458052(0x18c)](_0x458052(0x19c),_0x404bac);});}catch(_0xbddbb4){console[_0x5b4478(0x18c)](_0x5b4478(0x172),_0xbddbb4),setTimeout(()=>this[_0x5b4478(0x178)](),0x1388);}}['connectToServer'](){const _0x3a2c2d=a5_0x559107;try{if(!this[_0x3a2c2d(0x1a6)])throw new Error('Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.');const _0xcaea63=this[_0x3a2c2d(0x1a4)][_0x3a2c2d(0x1ca)][_0x3a2c2d(0x170)](_0x3a2c2d(0x173),'ws')+_0x3a2c2d(0x19b)+this[_0x3a2c2d(0x1a6)];this['serverWs']=new WebSocket(_0xcaea63),this[_0x3a2c2d(0x182)]['on'](_0x3a2c2d(0x171),()=>{const _0x163067=_0x3a2c2d;console['log'](_0x163067(0x1bc)),this[_0x163067(0x1ac)]&&this[_0x163067(0x1ac)][_0x163067(0x1c4)]===WebSocket['OPEN']&&this[_0x163067(0x16f)][_0x163067(0x195)](this[_0x163067(0x1ac)],this[_0x163067(0x182)]);}),this['serverWs']['on'](_0x3a2c2d(0x17d),_0x20ceb2=>{this['handleServerMessage'](_0x20ceb2);}),this[_0x3a2c2d(0x182)]['on']('close',(_0x159099,_0x3a6f9f)=>{const _0x57304b=_0x3a2c2d;console[_0x57304b(0x198)](_0x57304b(0x1cb)+_0x159099+':\x20'+_0x3a6f9f+_0x57304b(0x17f)),this[_0x57304b(0x16f)][_0x57304b(0x1b5)](),setTimeout(()=>this[_0x57304b(0x1bf)](),0x1388);}),this[_0x3a2c2d(0x182)]['on'](_0x3a2c2d(0x18c),_0x234dc9=>{const _0x506202=_0x3a2c2d;console[_0x506202(0x18c)](_0x506202(0x180),_0x234dc9);});}catch(_0x2e5df9){console[_0x3a2c2d(0x18c)](_0x3a2c2d(0x19a),_0x2e5df9),setTimeout(()=>this[_0x3a2c2d(0x1bf)](),0x1388);}}[a5_0x559107(0x18a)](_0x1a5814){const _0x39f850=a5_0x559107;if(this[_0x39f850(0x182)]&&this['serverWs'][_0x39f850(0x1c4)]===WebSocket['OPEN']){let _0x2ea8bf=_0x1a5814['toString']();try{const _0x277b6d=JSON[_0x39f850(0x1b2)](_0x2ea8bf);if(_0x277b6d['op']===_0x39f850(0x1b4)&&_0x277b6d[_0x39f850(0x1c3)]){const _0x3e60e1=this[_0x39f850(0x1c9)][_0x39f850(0x17b)](_0x277b6d);switch(_0x3e60e1[_0x39f850(0x1a3)]){case _0x39f850(0x1bd):return;case _0x39f850(0x19e):return;case'forward':default:_0x2ea8bf=JSON[_0x39f850(0x1c7)](_0x3e60e1[_0x39f850(0x17d)]);break;}}if((_0x277b6d['op']===_0x39f850(0x17e)||_0x277b6d['op']==='call_service')&&(_0x277b6d[_0x39f850(0x1a0)]==='/rosapi/topics'||_0x277b6d[_0x39f850(0x193)]&&_0x277b6d[_0x39f850(0x193)]['topics'])){console[_0x39f850(0x198)](_0x39f850(0x1a7));const _0x239176=_0x277b6d['values']?.[_0x39f850(0x1c5)]||[],_0x83f60c=_0x277b6d[_0x39f850(0x193)]?.[_0x39f850(0x197)]||[],_0x40d0f9=_0x239176['map']((_0x19d550,_0x317f42)=>{const _0x381f5e=_0x39f850,_0x52affa=this['topicManager'][_0x381f5e(0x184)](_0x19d550);return{'name':_0x19d550,'type':_0x83f60c[_0x317f42]||_0x381f5e(0x179),'throttling':_0x52affa?{'isThrottled':_0x52affa[_0x381f5e(0x181)]===_0x381f5e(0x1ae),'strategy':_0x52affa[_0x381f5e(0x181)],'samplingRate':_0x52affa[_0x381f5e(0x1a8)],'reason':_0x52affa[_0x381f5e(0x1a2)],'estimatedSize':_0x52affa[_0x381f5e(0x1b9)]}:null};});_0x277b6d[_0x39f850(0x193)]={'topics':_0x40d0f9['map'](_0x58f88f=>_0x58f88f[_0x39f850(0x1c0)]),'types':_0x40d0f9['map'](_0x14180a=>_0x14180a['type']),'throttling':_0x40d0f9['map'](_0x431a15=>_0x431a15[_0x39f850(0x196)])},_0x2ea8bf=JSON['stringify'](_0x277b6d),console[_0x39f850(0x198)](_0x39f850(0x18e));}if(_0x277b6d['op']==='publish'&&_0x277b6d[_0x39f850(0x1c3)]===_0x39f850(0x183)){const _0x2959a2=this[_0x39f850(0x199)][_0x39f850(0x190)](_0x277b6d,_0x277b6d[_0x39f850(0x1c3)]);_0x2959a2&&(_0x277b6d=_0x2959a2,_0x2ea8bf=JSON[_0x39f850(0x1c7)](_0x277b6d));}}catch(_0x4d16a3){console[_0x39f850(0x175)](_0x39f850(0x1c2),_0x4d16a3[_0x39f850(0x17d)]);}this[_0x39f850(0x182)][_0x39f850(0x1a5)](_0x2ea8bf);}}[a5_0x559107(0x1c6)](_0x25e20f){const _0x465385=a5_0x559107;if(this['rosbridgeWs']&&this['rosbridgeWs']['readyState']===WebSocket[_0x465385(0x1b6)]){let _0x5111f1=_0x25e20f['toString']();try{const _0x54bf14=JSON[_0x465385(0x1b2)](_0x5111f1);if(this[_0x465385(0x16f)][_0x465385(0x17b)](_0x54bf14))return;if(this[_0x465385(0x199)][_0x465385(0x17b)](_0x54bf14,this[_0x465385(0x182)]))return;this['rosbridgeWs']['send'](_0x5111f1);}catch(_0x26c85e){this['rosbridgeWs'][_0x465385(0x1a5)](_0x5111f1);}}}[a5_0x559107(0x1b8)](){const _0x38cffa=a5_0x559107;return{'server':this[_0x38cffa(0x182)]?this[_0x38cffa(0x182)][_0x38cffa(0x1c4)]:WebSocket[_0x38cffa(0x18d)],'rosbridge':this[_0x38cffa(0x191)]?this[_0x38cffa(0x191)]['readyState']:WebSocket[_0x38cffa(0x18d)],'rosbridgeWebRTC':this[_0x38cffa(0x1ac)]?this[_0x38cffa(0x1ac)][_0x38cffa(0x1c4)]:WebSocket[_0x38cffa(0x18d)]};}[a5_0x559107(0x1c8)](){const _0x3c29d8=a5_0x559107;this[_0x3c29d8(0x182)]&&this['serverWs'][_0x3c29d8(0x19f)](),this[_0x3c29d8(0x191)]&&this[_0x3c29d8(0x191)][_0x3c29d8(0x19f)](),this[_0x3c29d8(0x1ac)]&&this[_0x3c29d8(0x1ac)]['close']();}}module[a5_0x559107(0x1b7)]=ReverseProxyService;