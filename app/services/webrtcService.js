const a6_0x3d6aaf=a6_0x5089;(function(_0x342eab,_0xd87a24){const _0x42f786=a6_0x5089,_0x186c80=_0x342eab();while(!![]){try{const _0x42dfff=-parseInt(_0x42f786(0x186))/0x1+parseInt(_0x42f786(0xf4))/0x2+parseInt(_0x42f786(0x172))/0x3*(-parseInt(_0x42f786(0x15e))/0x4)+-parseInt(_0x42f786(0x18a))/0x5+parseInt(_0x42f786(0x166))/0x6+parseInt(_0x42f786(0x16c))/0x7*(parseInt(_0x42f786(0x1ae))/0x8)+-parseInt(_0x42f786(0x122))/0x9;if(_0x42dfff===_0xd87a24)break;else _0x186c80['push'](_0x186c80['shift']());}catch(_0x36fcce){_0x186c80['push'](_0x186c80['shift']());}}}(a6_0x3e62,0x63dc2));function a6_0x5089(_0xb088e8,_0xe3fc43){const _0x471e59=a6_0x3e62();return a6_0x5089=function(_0x4355de,_0x7db5ec){_0x4355de=_0x4355de-0xf2;let _0x3e628c=_0x471e59[_0x4355de];return _0x3e628c;},a6_0x5089(_0xb088e8,_0xe3fc43);}const a6_0x7db5ec=(function(){let _0x2af9c8=!![];return function(_0x76cf56,_0x59d58f){const _0x4a51ae=_0x2af9c8?function(){const _0x3f5003=a6_0x5089;if(_0x59d58f){const _0x37a2ed=_0x59d58f[_0x3f5003(0x160)](_0x76cf56,arguments);return _0x59d58f=null,_0x37a2ed;}}:function(){};return _0x2af9c8=![],_0x4a51ae;};}()),a6_0x4355de=a6_0x7db5ec(this,function(){const _0x1ad643=a6_0x5089;return a6_0x4355de[_0x1ad643(0x171)]()[_0x1ad643(0x155)](_0x1ad643(0x12c))['toString']()[_0x1ad643(0x164)](a6_0x4355de)[_0x1ad643(0x155)](_0x1ad643(0x12c));});a6_0x4355de();function a6_0x3e62(){const _0x99c6f7=['[WebRTC\x20Appliance]\x20Error\x20processing\x20ROS\x20message:','ðŸ”\x20Processing\x20depth...','setRemoteDescription','[WebRTC\x20Appliance]\x20Session\x20not\x20found:\x20','./turnCredentialsService','16px\x20Arial','delete','[WebRTC\x20Appliance]\x20Cleaned\x20up\x20session:\x20','fillRect','readyState','base64','sendFrameToVideoSource','forEach','send','stopAllSessions','font','subscribe','add','center','toLocaleTimeString','6147981FwNjXa','[WebRTC\x20Appliance]\x20Attempted\x20to\x20stop\x20non-existent\x20session:\x20','videoTrack','drawLoadingPattern','[WebRTC\x20Appliance]\x20Unknown\x20operation:\x20','sin','get','[WebRTC\x20Appliance]\x20Created\x20video\x20track\x20for\x20session\x20','keys','framerate','(((.+)+)+)+$','\x20sessions\x20remaining)','[WebRTC\x20Appliance]\x20Stopping\x20session:\x20','webrtc_init_session','wrtc','\x20successfully\x20connected!','webrtc_ice_candidate','../config','max','[WebRTC\x20Appliance]\x20Service\x20initialized','/compressed','./DepthImageProcessor','includes','port','beginPath',',\x20trying\x20alternative\x20depth\x20topics','getImageData','protocol','sensor_msgs/msg/CompressedImage','[WebRTC\x20Appliance]\x20ICE\x20candidate\x20added\x20for\x20session\x20','unsubscribe','sensor_msgs/CompressedImage','initializing','depthProcessor','connectionState','ðŸ“¹\x20Color','[WebRTC\x20Appliance]\x20Error\x20during\x20session\x20cleanup:\x20','[WebRTC\x20Appliance]\x20Using\x20fallback\x20STUN\x20servers','[WebRTC\x20Appliance]\x20Trying\x20alternative\x20topic:\x20','[WebRTC\x20Appliance]\x20Error\x20sending\x20frame\x20to\x20video\x20source:','initializeSession','data','[WebRTC\x20Appliance]\x20Error\x20processing\x20alternative\x20topic\x20message:','width','rosSubscriber','min','close','[WebRTC\x20Appliance]\x20No\x20data\x20received\x20on\x20','10px\x20monospace','address','onconnectionstatechange','search','[WebRTC\x20Appliance]\x20Initializing\x20session\x20','[WebRTC\x20Appliance]\x20Set\x20remote\x20description\x20(offer)','createTrack','compressed_depth_image_transport/CompressedDepthImage',',\x20size:\x20','topic','getContext','sensor_msgs/Image','1276UzeoLl','processColorImage','apply','[WebRTC\x20Appliance]\x20Creating\x20new\x20shared\x20video\x20source\x20for\x20topic\x20','handleMessage','removeEventListener','constructor','compressedDepth','4501608BCSyDo','random','\x20with\x20message\x20type\x20','getActiveSessions','[WebRTC\x20Appliance]\x20Answer\x20sent\x20for\x20session\x20','/image_raw','21juGdDc','startsWith','now','cleanupSession','fillText','toString','489OKyTUc','\x20for\x20topic:\x20','type','[WebRTC\x20Appliance]\x20Session\x20','exports','activeSessions','[WebRTC\x20Appliance]\x20Processing\x20offer\x20for\x20session\x20','updateTurnCredentials','updateCanvasWithImageData','height','#1a1a1a',',\x20converting\x20to\x20base64...','releaseSharedVideoSource','[WebRTC\x20Appliance]\x20Depth\x20processing\x20issue.\x20Alternative\x20topics:\x20','msg','stopSession','onFrame','[WebRTC\x20Appliance]\x20Stopping\x20all\x20active\x20sessions','webrtc_offer','peerConnection','187879nVJyuw','canvas','stun:stun1.l.google.com:19302','handleIceCandidate','3930155mcgpSV','log','rgba(0,\x200,\x200,\x200.7)','initialize','candidate','round','[WebRTC\x20Appliance]\x20Trying\x20subscription\x20with\x20type:\x20','connected','iceServers','#666','serverWs','subscribeToROSTopic','serverUrl','stringify','[WebRTC\x20Appliance]\x20TURN\x20credentials\x20updated\x20successfully','addTrack','sharedVideoSources','ðŸ“¹\x20Processing\x20video...','sharp','rosbridgeWs','offer','[WebRTC\x20Appliance]\x20Created\x20answer','\x20connection\x20state:\x20','unknown','\x20detected\x20as\x20','/image','topicSessions','failed','textAlign','[WebRTC\x20Appliance]\x20Processing\x20image\x20data\x20for\x20topic\x20','setLocalDescription','warn','session_id','[WebRTC\x20Appliance]\x20No\x20more\x20sessions\x20for\x20topic\x20','getSharedVideoSources','[WebRTC\x20Appliance]\x20Set\x20local\x20description\x20(answer)','1557272zQhvah','stun:stun.l.google.com:19302','split','#888','ðŸ”\x20Depth','addEventListener','[WebRTC\x20Appliance]\x20Failed\x20to\x20process\x20frame\x20for\x20topic\x20','message','\x20initialized\x20successfully','publish','fillStyle','/compressedDepth','#00ffff','webrtc','[WebRTC\x20Appliance]\x20Error\x20handling\x20offer\x20for\x20session\x20','[WebRTC\x20Appliance]\x20ROSBridge\x20not\x20connected','videoSource','size','has','pop','24px\x20Arial','isDepthTopic','1567594wFgFJh','push','[WebRTC\x20Appliance]\x20Released\x20shared\x20video\x20source\x20for\x20topic\x20','length','processDepthImage','getOrCreateSharedVideoSource','#ffffff','\x20sessions)','\x20bytes','OPEN','replace','webrtc_stop_session','compressed','#00ff00','video',',\x20cleaning\x20up\x20shared\x20resources','error','addIceCandidate','convertRGBAtoI420','depth','\x20connection\x20closed,\x20cleaning\x20up','webrtc_','frameCount','from','closed','[WebRTC\x20Appliance]\x20Generated\x20ICE\x20candidate\x20for\x20session\x20'];a6_0x3e62=function(){return _0x99c6f7;};return a6_0x3e62();}const {RTCPeerConnection,RTCSessionDescription,RTCIceCandidate,nonstandard}=require(a6_0x3d6aaf(0x130)),sharp=require(a6_0x3d6aaf(0x19c)),config=require(a6_0x3d6aaf(0x133)),DepthImageProcessor=require(a6_0x3d6aaf(0x137)),turnCredentialsService=require(a6_0x3d6aaf(0x112));class ApplianceWebRTCService{constructor(){const _0x27bb1d=a6_0x3d6aaf;this[_0x27bb1d(0x177)]=new Map(),this[_0x27bb1d(0x1a4)]=new Map(),this[_0x27bb1d(0x19a)]=new Map(),this['rosbridgeWs']=null,this[_0x27bb1d(0x194)]=null,this[_0x27bb1d(0x143)]=new DepthImageProcessor(),this['rtcConfig']={'iceServers':[{'urls':_0x27bb1d(0x1af)},{'urls':_0x27bb1d(0x188)}]};}[a6_0x3d6aaf(0x18d)](_0x107292,_0x2aa862){const _0x27bf5f=a6_0x3d6aaf;this['rosbridgeWs']=_0x107292,this['serverWs']=_0x2aa862,turnCredentialsService[_0x27bf5f(0x18d)](config[_0x27bf5f(0x196)]),this['updateTurnCredentials'](),console[_0x27bf5f(0x18b)](_0x27bf5f(0x135));}async[a6_0x3d6aaf(0x179)](){const _0x416b7f=a6_0x3d6aaf;try{console[_0x416b7f(0x18b)]('[WebRTC\x20Appliance]\x20Updating\x20TURN\x20credentials...');const _0x6652c4=await turnCredentialsService['getIceServers']();this['rtcConfig'][_0x416b7f(0x192)]=_0x6652c4,console[_0x416b7f(0x18b)](_0x416b7f(0x198));}catch(_0x5501e0){console[_0x416b7f(0x104)]('[WebRTC\x20Appliance]\x20Error\x20updating\x20TURN\x20credentials:',_0x5501e0),console['log'](_0x416b7f(0x147));}}[a6_0x3d6aaf(0x162)](_0x34f048){const _0x3bf045=a6_0x3d6aaf;if(!_0x34f048['op']||!_0x34f048['op'][_0x3bf045(0x16d)](_0x3bf045(0x109)))return![];console[_0x3bf045(0x18b)]('[WebRTC\x20Appliance]\x20Handling\x20message:\x20'+_0x34f048['op']);switch(_0x34f048['op']){case _0x3bf045(0x12f):this[_0x3bf045(0x14a)](_0x34f048[_0x3bf045(0x1aa)],_0x34f048[_0x3bf045(0x15b)]);return!![];case _0x3bf045(0x184):this['handleOffer'](_0x34f048['session_id'],_0x34f048[_0x3bf045(0x19e)]);return!![];case _0x3bf045(0x132):this[_0x3bf045(0x189)](_0x34f048[_0x3bf045(0x1aa)],_0x34f048[_0x3bf045(0x18e)]);return!![];case _0x3bf045(0xff):this[_0x3bf045(0x181)](_0x34f048['session_id']);return!![];default:console[_0x3bf045(0x1a9)](_0x3bf045(0x126)+_0x34f048['op']);return![];}}[a6_0x3d6aaf(0xf9)](_0x21b130){const _0x1b7c45=a6_0x3d6aaf;if(this[_0x1b7c45(0x19a)][_0x1b7c45(0x1c0)](_0x21b130)){const _0x5eec7c=this['sharedVideoSources'][_0x1b7c45(0x128)](_0x21b130);return _0x5eec7c[_0x1b7c45(0x10a)]++,console[_0x1b7c45(0x18b)]('[WebRTC\x20Appliance]\x20Reusing\x20shared\x20video\x20source\x20for\x20topic\x20'+_0x21b130+'\x20('+_0x5eec7c[_0x1b7c45(0x10a)]+_0x1b7c45(0xfb)),_0x5eec7c;}console[_0x1b7c45(0x18b)](_0x1b7c45(0x161)+_0x21b130);const {createCanvas:_0x1d301c}=require(_0x1b7c45(0x187)),_0x2d24b0=_0x1d301c(config[_0x1b7c45(0x1bb)]['video']['width'],config[_0x1b7c45(0x1bb)][_0x1b7c45(0x102)][_0x1b7c45(0x17b)]),_0x122f77=_0x2d24b0['getContext']('2d');this[_0x1b7c45(0x125)](_0x2d24b0,_0x122f77);const {RTCVideoSource:_0x2aa0ab}=nonstandard,_0x25fc9a=new _0x2aa0ab();let _0xe5ab99=0x0;const _0x38ab11=0x3e8/config[_0x1b7c45(0x1bb)][_0x1b7c45(0x102)][_0x1b7c45(0x12b)],_0x3a8194=this[_0x1b7c45(0x195)](_0x21b130,_0x2b9ccd=>{const _0x2a171f=_0x1b7c45,_0x44a038=Date[_0x2a171f(0x16e)]();_0x44a038-_0xe5ab99>=_0x38ab11&&(_0xe5ab99=_0x44a038,this[_0x2a171f(0x17a)](_0x2d24b0,_0x122f77,_0x2b9ccd,_0x21b130,_0x25fc9a));}),_0x1054e6={'videoSource':_0x25fc9a,'canvas':_0x2d24b0,'rosSubscriber':_0x3a8194,'frameCount':0x1,'topic':_0x21b130};return this[_0x1b7c45(0x19a)]['set'](_0x21b130,_0x1054e6),_0x1054e6;}[a6_0x3d6aaf(0x17e)](_0xe9b3a5){const _0x4b1505=a6_0x3d6aaf,_0x991350=this[_0x4b1505(0x19a)]['get'](_0xe9b3a5);if(!_0x991350)return;_0x991350[_0x4b1505(0x10a)]--,console['log'](_0x4b1505(0xf6)+_0xe9b3a5+'\x20('+_0x991350[_0x4b1505(0x10a)]+_0x4b1505(0x12d)),_0x991350[_0x4b1505(0x10a)]<=0x0&&(console[_0x4b1505(0x18b)](_0x4b1505(0x1ab)+_0xe9b3a5+_0x4b1505(0x103)),_0x991350[_0x4b1505(0x1be)]&&(_0x991350[_0x4b1505(0x1be)]=null),_0x991350[_0x4b1505(0x14e)]&&_0x991350[_0x4b1505(0x14e)][_0x4b1505(0x140)](),this[_0x4b1505(0x19a)][_0x4b1505(0x114)](_0xe9b3a5));}async[a6_0x3d6aaf(0x14a)](_0x28f925,_0x15113c){const _0x1045a5=a6_0x3d6aaf;try{console[_0x1045a5(0x18b)](_0x1045a5(0x156)+_0x28f925+'\x20for\x20topic\x20'+_0x15113c);const _0x136045=this[_0x1045a5(0xf9)](_0x15113c),_0x5a7147=new RTCPeerConnection(this['rtcConfig']),_0x1e41e8=_0x136045[_0x1045a5(0x1be)][_0x1045a5(0x158)]({'width':config[_0x1045a5(0x1bb)][_0x1045a5(0x102)][_0x1045a5(0x14d)],'height':config[_0x1045a5(0x1bb)][_0x1045a5(0x102)][_0x1045a5(0x17b)],'framerate':config[_0x1045a5(0x1bb)][_0x1045a5(0x102)][_0x1045a5(0x12b)]});console[_0x1045a5(0x18b)](_0x1045a5(0x129)+_0x28f925);const {MediaStream:_0x4e95df}=require(_0x1045a5(0x130)),_0x4dc90f=new _0x4e95df([_0x1e41e8]);_0x5a7147[_0x1045a5(0x199)](_0x1e41e8,_0x4dc90f),this[_0x1045a5(0x119)](_0x136045[_0x1045a5(0x1be)],_0x136045[_0x1045a5(0x187)]),_0x5a7147['onicecandidate']=_0x4ffcd7=>{const _0x5ea1bd=_0x1045a5;if(_0x4ffcd7[_0x5ea1bd(0x18e)]&&this['serverWs'])console[_0x5ea1bd(0x18b)](_0x5ea1bd(0x10d)+_0x28f925+':',{'type':_0x4ffcd7[_0x5ea1bd(0x18e)][_0x5ea1bd(0x174)],'protocol':_0x4ffcd7[_0x5ea1bd(0x18e)][_0x5ea1bd(0x13d)],'address':_0x4ffcd7[_0x5ea1bd(0x18e)][_0x5ea1bd(0x153)],'port':_0x4ffcd7[_0x5ea1bd(0x18e)][_0x5ea1bd(0x139)]}),this[_0x5ea1bd(0x194)][_0x5ea1bd(0x11b)](JSON[_0x5ea1bd(0x197)]({'op':'webrtc_ice_candidate','session_id':_0x28f925,'candidate':_0x4ffcd7[_0x5ea1bd(0x18e)]}));else!_0x4ffcd7[_0x5ea1bd(0x18e)]&&console[_0x5ea1bd(0x18b)]('[WebRTC\x20Appliance]\x20ICE\x20gathering\x20complete\x20for\x20session\x20'+_0x28f925);},_0x5a7147[_0x1045a5(0x154)]=()=>{const _0x541eaf=_0x1045a5;console['log'](_0x541eaf(0x175)+_0x28f925+_0x541eaf(0x1a0)+_0x5a7147[_0x541eaf(0x144)]);if(_0x5a7147[_0x541eaf(0x144)]===_0x541eaf(0x191))console['log'](_0x541eaf(0x175)+_0x28f925+_0x541eaf(0x131));else{if(_0x5a7147[_0x541eaf(0x144)]===_0x541eaf(0x1a5))console[_0x541eaf(0x18b)](_0x541eaf(0x175)+_0x28f925+'\x20connection\x20failed,\x20stopping\x20session'),this[_0x541eaf(0x181)](_0x28f925);else _0x5a7147[_0x541eaf(0x144)]===_0x541eaf(0x10c)&&(console['log'](_0x541eaf(0x175)+_0x28f925+_0x541eaf(0x108)),this[_0x541eaf(0x16f)](_0x28f925));}},this[_0x1045a5(0x177)]['set'](_0x28f925,{'peerConnection':_0x5a7147,'topic':_0x15113c,'videoTrack':_0x1e41e8,'mediaStream':_0x4dc90f,'status':_0x1045a5(0x142)}),!this[_0x1045a5(0x1a4)][_0x1045a5(0x1c0)](_0x15113c)&&this[_0x1045a5(0x1a4)]['set'](_0x15113c,new Set()),this[_0x1045a5(0x1a4)][_0x1045a5(0x128)](_0x15113c)[_0x1045a5(0x11f)](_0x28f925),console[_0x1045a5(0x18b)](_0x1045a5(0x175)+_0x28f925+_0x1045a5(0x1b6)),console[_0x1045a5(0x18b)]('[WebRTC\x20Appliance]\x20Active\x20sessions\x20for\x20topic\x20'+_0x15113c+':\x20'+this[_0x1045a5(0x1a4)]['get'](_0x15113c)[_0x1045a5(0x1bf)]);}catch(_0x51badc){console[_0x1045a5(0x104)]('[WebRTC\x20Appliance]\x20Error\x20initializing\x20session\x20'+_0x28f925+':',_0x51badc),this[_0x1045a5(0x181)](_0x28f925);}}async['handleOffer'](_0x1e0f63,_0x395106){const _0x28fde2=a6_0x3d6aaf,_0x3327e2=this[_0x28fde2(0x177)]['get'](_0x1e0f63);if(!_0x3327e2){console['error'](_0x28fde2(0x111)+_0x1e0f63);return;}try{console['log'](_0x28fde2(0x178)+_0x1e0f63),await _0x3327e2[_0x28fde2(0x185)][_0x28fde2(0x110)](new RTCSessionDescription(_0x395106)),console[_0x28fde2(0x18b)](_0x28fde2(0x157));const _0x401d85=await _0x3327e2[_0x28fde2(0x185)]['createAnswer']();console[_0x28fde2(0x18b)](_0x28fde2(0x19f)),await _0x3327e2[_0x28fde2(0x185)][_0x28fde2(0x1a8)](_0x401d85),console['log'](_0x28fde2(0x1ad)),this[_0x28fde2(0x194)]&&(this[_0x28fde2(0x194)]['send'](JSON[_0x28fde2(0x197)]({'op':'webrtc_answer','session_id':_0x1e0f63,'answer':_0x401d85})),console['log'](_0x28fde2(0x16a)+_0x1e0f63));}catch(_0x1fb253){console[_0x28fde2(0x104)](_0x28fde2(0x1bc)+_0x1e0f63+':',_0x1fb253),this[_0x28fde2(0x181)](_0x1e0f63);}}async['handleIceCandidate'](_0x4022ee,_0x1d8da2){const _0x1047ad=a6_0x3d6aaf,_0x489a98=this[_0x1047ad(0x177)]['get'](_0x4022ee);if(!_0x489a98){console[_0x1047ad(0x104)]('[WebRTC\x20Appliance]\x20Session\x20not\x20found\x20for\x20ICE\x20candidate:\x20'+_0x4022ee);return;}try{await _0x489a98[_0x1047ad(0x185)][_0x1047ad(0x105)](new RTCIceCandidate(_0x1d8da2)),console[_0x1047ad(0x18b)](_0x1047ad(0x13f)+_0x4022ee);}catch(_0x4c6e5e){console[_0x1047ad(0x104)]('[WebRTC\x20Appliance]\x20Error\x20adding\x20ICE\x20candidate\x20for\x20session\x20'+_0x4022ee+':',_0x4c6e5e);}}[a6_0x3d6aaf(0x195)](_0x491a97,_0x30c7e8){const _0x21d50b=a6_0x3d6aaf;if(!this[_0x21d50b(0x19d)]||this[_0x21d50b(0x19d)][_0x21d50b(0x117)]!==this[_0x21d50b(0x19d)][_0x21d50b(0xfd)])return console[_0x21d50b(0x104)](_0x21d50b(0x1bd)),null;console[_0x21d50b(0x18b)]('[WebRTC\x20Appliance]\x20Subscribing\x20to\x20ROS\x20topic:\x20'+_0x491a97);const _0x7375b2=_0x491a97['includes'](_0x21d50b(0x107)),_0x9ccc53=_0x491a97['includes'](_0x21d50b(0x100))||_0x491a97[_0x21d50b(0x138)](_0x21d50b(0x165));let _0x5a7700=[];_0x7375b2?_0x9ccc53?_0x5a7700=[_0x21d50b(0x141),_0x21d50b(0x13e),_0x21d50b(0x159),_0x21d50b(0x15d)]:_0x5a7700=['sensor_msgs/Image','sensor_msgs/msg/Image',_0x21d50b(0x141)]:_0x5a7700=[_0x21d50b(0x141),_0x21d50b(0x13e),_0x21d50b(0x15d)];console[_0x21d50b(0x18b)]('[WebRTC\x20Appliance]\x20Topic\x20'+_0x491a97+_0x21d50b(0x1a2)+(_0x7375b2?_0x21d50b(0x107):'color')+'\x20image,\x20trying\x20message\x20types:',_0x5a7700);const _0x374f1f=[];let _0xd5163b=![];const _0x3dc571=_0x44cb87=>{return _0x32ba29=>{const _0x1c2260=a6_0x5089;try{const _0x246595=JSON['parse'](_0x32ba29['data']);_0x246595['op']===_0x1c2260(0x1b7)&&_0x246595['topic']===_0x491a97&&_0x246595[_0x1c2260(0x180)]&&(!_0xd5163b&&(console[_0x1c2260(0x18b)]('[WebRTC\x20Appliance]\x20Successfully\x20receiving\x20data\x20on\x20'+_0x491a97+_0x1c2260(0x168)+_0x44cb87),_0xd5163b=!![]),_0x30c7e8(_0x246595[_0x1c2260(0x180)]));}catch(_0x20ebe5){console[_0x1c2260(0x104)](_0x1c2260(0x10e),_0x20ebe5);}};};for(const _0x44c072 of _0x5a7700){const _0x6b124d={'op':_0x21d50b(0x11e),'topic':_0x491a97,'type':_0x44c072};console[_0x21d50b(0x18b)](_0x21d50b(0x190)+_0x44c072),this[_0x21d50b(0x19d)][_0x21d50b(0x11b)](JSON['stringify'](_0x6b124d));const _0x29a67b=_0x3dc571(_0x44c072);this['rosbridgeWs'][_0x21d50b(0x1b3)]('message',_0x29a67b),_0x374f1f['push']({'handler':_0x29a67b,'type':_0x44c072});}return _0x7375b2&&_0x9ccc53&&setTimeout(()=>{const _0x4ee22e=_0x21d50b;if(!_0xd5163b){console[_0x4ee22e(0x18b)](_0x4ee22e(0x151)+_0x491a97+_0x4ee22e(0x13b));const _0xf441a8=_0x491a97['replace'](_0x4ee22e(0x1b9),'')[_0x4ee22e(0xfe)](_0x4ee22e(0x136),''),_0x35dd7d=[_0xf441a8+_0x4ee22e(0x16b),_0xf441a8+_0x4ee22e(0x1a3),_0xf441a8];for(const _0x5b3d6d of _0x35dd7d){console['log'](_0x4ee22e(0x148)+_0x5b3d6d);const _0xd05db9={'op':_0x4ee22e(0x11e),'topic':_0x5b3d6d,'type':'sensor_msgs/Image'};this[_0x4ee22e(0x19d)][_0x4ee22e(0x11b)](JSON[_0x4ee22e(0x197)](_0xd05db9));const _0x46d9a7=_0x293191=>{const _0x57d36d=_0x4ee22e;try{const _0x56423b=JSON['parse'](_0x293191[_0x57d36d(0x14b)]);_0x56423b['op']===_0x57d36d(0x1b7)&&_0x56423b[_0x57d36d(0x15b)]===_0x5b3d6d&&_0x56423b['msg']&&(console[_0x57d36d(0x18b)]('[WebRTC\x20Appliance]\x20Got\x20data\x20from\x20alternative\x20topic\x20'+_0x5b3d6d+_0x57d36d(0x17d)),_0x56423b['msg'][_0x57d36d(0x14b)]&&!_0x56423b[_0x57d36d(0x180)][_0x57d36d(0x14b)]['startsWith']('/9j/')&&_0x30c7e8(_0x56423b[_0x57d36d(0x180)]));}catch(_0x14a337){console[_0x57d36d(0x104)](_0x57d36d(0x14c),_0x14a337);}};this[_0x4ee22e(0x19d)][_0x4ee22e(0x1b3)](_0x4ee22e(0x1b5),_0x46d9a7),_0x374f1f[_0x4ee22e(0xf5)]({'handler':_0x46d9a7,'type':_0x4ee22e(0x15d),'topic':_0x5b3d6d});}}},0xbb8),{'unsubscribe':()=>{const _0x229326=_0x21d50b;for(const {handler:_0xc4e713,type:_0x4ee833,topic:_0x2ef296}of _0x374f1f){this[_0x229326(0x19d)][_0x229326(0x163)]('message',_0xc4e713),this[_0x229326(0x19d)][_0x229326(0x117)]===this[_0x229326(0x19d)][_0x229326(0xfd)]&&this[_0x229326(0x19d)][_0x229326(0x11b)](JSON[_0x229326(0x197)]({'op':_0x229326(0x140),'topic':_0x2ef296||_0x491a97}));}}};}['drawLoadingPattern'](_0x37424b,_0x29c409){const _0x3b10da=a6_0x3d6aaf;_0x29c409[_0x3b10da(0x1b8)]=_0x3b10da(0x17c),_0x29c409['fillRect'](0x0,0x0,_0x37424b[_0x3b10da(0x14d)],_0x37424b['height']),_0x29c409[_0x3b10da(0x1b8)]='#00aaff',_0x29c409['font']=_0x3b10da(0xf2),_0x29c409[_0x3b10da(0x1a6)]=_0x3b10da(0x120),_0x29c409[_0x3b10da(0x170)]('ðŸ¤–\x20Robot\x20Camera',_0x37424b[_0x3b10da(0x14d)]/0x2,_0x37424b[_0x3b10da(0x17b)]/0x2-0x14),_0x29c409['fillStyle']=_0x3b10da(0xfa),_0x29c409[_0x3b10da(0x11d)]='16px\x20Arial',_0x29c409['fillText']('Waiting\x20for\x20ROS\x20image\x20data...',_0x37424b['width']/0x2,_0x37424b[_0x3b10da(0x17b)]/0x2+0x14);const _0x569dce=Date['now']()/0x3e8;for(let _0x38a4c4=0x0;_0x38a4c4<0x3;_0x38a4c4++){const _0xc783a9=(Math[_0x3b10da(0x127)](_0x569dce*0x2+_0x38a4c4*0.5)+0x1)/0x2;_0x29c409['fillStyle']='rgba(0,\x20170,\x20255,\x20'+_0xc783a9*0.5+')',_0x29c409[_0x3b10da(0x13a)](),_0x29c409['arc'](_0x37424b[_0x3b10da(0x14d)]/0x2-0x28+_0x38a4c4*0x28,_0x37424b[_0x3b10da(0x17b)]/0x2+0x3c,0x8,0x0,0x2*Math['PI']),_0x29c409['fill']();}}['sendFrameToVideoSource'](_0x41b825,_0xadecb0){const _0x4b63d8=a6_0x3d6aaf;try{if(!_0x41b825||!_0xadecb0)return;const _0x2b914f=_0xadecb0[_0x4b63d8(0x15c)]('2d'),_0x5038d1=_0x2b914f[_0x4b63d8(0x13c)](0x0,0x0,_0xadecb0['width'],_0xadecb0[_0x4b63d8(0x17b)]),_0x2c13c4=this[_0x4b63d8(0x106)](_0x5038d1['data'],_0xadecb0[_0x4b63d8(0x14d)],_0xadecb0['height']),_0x4f6400={'width':_0xadecb0[_0x4b63d8(0x14d)],'height':_0xadecb0[_0x4b63d8(0x17b)],'data':_0x2c13c4};typeof _0x41b825[_0x4b63d8(0x182)]==='function'&&_0x41b825['onFrame'](_0x4f6400);}catch(_0x21b138){console[_0x4b63d8(0x104)](_0x4b63d8(0x149),_0x21b138);}}[a6_0x3d6aaf(0x106)](_0x1559a2,_0x2a5d38,_0x17e6c1){const _0x47434c=a6_0x3d6aaf,_0x3b1563=_0x2a5d38*_0x17e6c1,_0x1f7cf9=_0x2a5d38*_0x17e6c1/0x4,_0x2d071a=new Uint8Array(_0x3b1563+_0x1f7cf9*0x2);let _0x15e0f6=0x0,_0x7a1694=_0x3b1563,_0x329ff8=_0x3b1563+_0x1f7cf9;for(let _0x4d3c97=0x0;_0x4d3c97<_0x17e6c1;_0x4d3c97++){for(let _0x35684a=0x0;_0x35684a<_0x2a5d38;_0x35684a++){const _0x557e5f=(_0x4d3c97*_0x2a5d38+_0x35684a)*0x4,_0x13f074=_0x1559a2[_0x557e5f],_0x308067=_0x1559a2[_0x557e5f+0x1],_0x545668=_0x1559a2[_0x557e5f+0x2],_0x2f4e5e=Math[_0x47434c(0x18f)](0.299*_0x13f074+0.587*_0x308067+0.114*_0x545668);_0x2d071a[_0x15e0f6++]=_0x2f4e5e;if(_0x4d3c97%0x2===0x0&&_0x35684a%0x2===0x0){const _0x6181e8=Math[_0x47434c(0x18f)](-0.169*_0x13f074-0.331*_0x308067+0.5*_0x545668+0x80),_0x1f7d98=Math[_0x47434c(0x18f)](0.5*_0x13f074-0.419*_0x308067-0.081*_0x545668+0x80);_0x2d071a[_0x7a1694++]=Math[_0x47434c(0x134)](0x0,Math[_0x47434c(0x14f)](0xff,_0x6181e8)),_0x2d071a[_0x329ff8++]=Math[_0x47434c(0x134)](0x0,Math[_0x47434c(0x14f)](0xff,_0x1f7d98));}}}return _0x2d071a;}async[a6_0x3d6aaf(0x17a)](_0x47ad46,_0x521c17,_0x59a0d6,_0x2e149b,_0x57df95){const _0x5bf293=a6_0x3d6aaf;try{if(!_0x59a0d6||!_0x59a0d6[_0x5bf293(0x14b)])return;Math[_0x5bf293(0x167)]()<0.01&&console['log'](_0x5bf293(0x1a7)+_0x2e149b+_0x5bf293(0x15a)+_0x59a0d6[_0x5bf293(0x14b)][_0x5bf293(0xf7)]+_0x5bf293(0xfc));const _0x31504e=Buffer['from'](_0x59a0d6[_0x5bf293(0x14b)],_0x5bf293(0x118)),_0x2f1e6f=this[_0x5bf293(0x143)][_0x5bf293(0xf3)](_0x2e149b);let _0x5cab61;_0x2f1e6f?_0x5cab61=await this[_0x5bf293(0x143)][_0x5bf293(0xf8)](_0x31504e,_0x47ad46,_0x521c17,_0x2e149b):_0x5cab61=await this[_0x5bf293(0x143)][_0x5bf293(0x15f)](_0x31504e,_0x47ad46,_0x521c17),_0x521c17['putImageData'](_0x5cab61,0x0,0x0),_0x521c17[_0x5bf293(0x1b8)]=_0x5bf293(0x18c),_0x521c17[_0x5bf293(0x116)](0xa,0xa,0xdc,0x32),_0x521c17['fillStyle']=_0x2f1e6f?_0x5bf293(0x1ba):_0x5bf293(0x101),_0x521c17['font']='12px\x20monospace',_0x521c17[_0x5bf293(0x170)]((_0x2f1e6f?_0x5bf293(0x1b2):_0x5bf293(0x145))+':\x20'+new Date()[_0x5bf293(0x121)](),0xf,0x1c),_0x521c17['fillStyle']=_0x5bf293(0xfa),_0x521c17[_0x5bf293(0x11d)]=_0x5bf293(0x152),_0x521c17[_0x5bf293(0x170)]('Topic:\x20'+_0x2e149b[_0x5bf293(0x1b0)]('/')[_0x5bf293(0x1c1)](),0xf,0x2d),this['sendFrameToVideoSource'](_0x57df95,_0x47ad46);}catch(_0x4d873c){console[_0x5bf293(0x1a9)](_0x5bf293(0x1b4)+_0x2e149b+':',_0x4d873c[_0x5bf293(0x1b5)]);_0x2e149b['includes'](_0x5bf293(0x107))&&Math[_0x5bf293(0x167)]()<0.1&&console['warn'](_0x5bf293(0x17f)+_0x2e149b['replace'](_0x5bf293(0x1b9),_0x5bf293(0x16b)));_0x521c17[_0x5bf293(0x1b8)]='#1a1a1a',_0x521c17[_0x5bf293(0x116)](0x0,0x0,_0x47ad46['width'],_0x47ad46['height']),_0x521c17[_0x5bf293(0x1b8)]=_0x5bf293(0x1b1),_0x521c17[_0x5bf293(0x11d)]=_0x5bf293(0x113),_0x521c17['textAlign']=_0x5bf293(0x120);const _0x265810=_0x2e149b[_0x5bf293(0x138)](_0x5bf293(0x107))?_0x5bf293(0x10f):_0x5bf293(0x19b);_0x521c17[_0x5bf293(0x170)](_0x265810,_0x47ad46['width']/0x2,_0x47ad46[_0x5bf293(0x17b)]/0x2),_0x521c17[_0x5bf293(0x1b8)]=_0x5bf293(0x193),_0x521c17[_0x5bf293(0x11d)]='12px\x20Arial',_0x521c17['fillText']('Topic:\x20'+_0x2e149b[_0x5bf293(0x1b0)]('/')[_0x5bf293(0x1c1)](),_0x47ad46[_0x5bf293(0x14d)]/0x2,_0x47ad46[_0x5bf293(0x17b)]/0x2+0x19),this[_0x5bf293(0x119)](_0x57df95,_0x47ad46);}}[a6_0x3d6aaf(0x181)](_0x5d035b){const _0x55cb03=a6_0x3d6aaf,_0x49964a=this[_0x55cb03(0x177)][_0x55cb03(0x128)](_0x5d035b);if(!_0x49964a){console['warn'](_0x55cb03(0x123)+_0x5d035b);return;}console[_0x55cb03(0x18b)](_0x55cb03(0x12e)+_0x5d035b+_0x55cb03(0x173)+_0x49964a[_0x55cb03(0x15b)]);try{this[_0x55cb03(0x194)]&&this[_0x55cb03(0x194)][_0x55cb03(0x117)]===this['serverWs'][_0x55cb03(0xfd)]&&this[_0x55cb03(0x194)][_0x55cb03(0x11b)](JSON[_0x55cb03(0x197)]({'op':_0x55cb03(0xff),'session_id':_0x5d035b})),_0x49964a[_0x55cb03(0x124)]&&_0x49964a[_0x55cb03(0x124)]['stop'](),_0x49964a[_0x55cb03(0x185)]&&_0x49964a[_0x55cb03(0x185)][_0x55cb03(0x150)]();}catch(_0x5d6b4a){console['error'](_0x55cb03(0x146)+_0x5d6b4a);}this[_0x55cb03(0x16f)](_0x5d035b);}[a6_0x3d6aaf(0x16f)](_0xed84f4){const _0x17fb62=a6_0x3d6aaf,_0x2f02a4=this[_0x17fb62(0x177)]['get'](_0xed84f4);if(_0x2f02a4){const _0x53ab63=this[_0x17fb62(0x1a4)][_0x17fb62(0x128)](_0x2f02a4['topic']);_0x53ab63&&(_0x53ab63[_0x17fb62(0x114)](_0xed84f4),_0x53ab63[_0x17fb62(0x1bf)]===0x0&&this[_0x17fb62(0x1a4)]['delete'](_0x2f02a4[_0x17fb62(0x15b)])),this[_0x17fb62(0x17e)](_0x2f02a4['topic']);}this[_0x17fb62(0x177)][_0x17fb62(0x114)](_0xed84f4),console[_0x17fb62(0x18b)](_0x17fb62(0x115)+_0xed84f4);}[a6_0x3d6aaf(0x11c)](){const _0x2b4e4f=a6_0x3d6aaf;console[_0x2b4e4f(0x18b)](_0x2b4e4f(0x183));const _0x3fd92b=Array[_0x2b4e4f(0x10b)](this[_0x2b4e4f(0x177)][_0x2b4e4f(0x12a)]());_0x3fd92b[_0x2b4e4f(0x11a)](_0x20561b=>this[_0x2b4e4f(0x181)](_0x20561b));}[a6_0x3d6aaf(0x169)](){const _0x5a704d=a6_0x3d6aaf,_0x5689e9=[];for(const [_0x31f0cf,_0x487bec]of this[_0x5a704d(0x177)]){_0x5689e9[_0x5a704d(0xf5)]({'sessionId':_0x31f0cf,'topic':_0x487bec[_0x5a704d(0x15b)],'connectionState':_0x487bec[_0x5a704d(0x185)]?.['connectionState']||_0x5a704d(0x1a1),'hasVideoTrack':!!_0x487bec[_0x5a704d(0x124)]});}return _0x5689e9;}[a6_0x3d6aaf(0x1ac)](){const _0x5097bd=a6_0x3d6aaf,_0x175b30=[];for(const [_0x54e018,_0x1e94f4]of this['sharedVideoSources']){_0x175b30[_0x5097bd(0xf5)]({'topic':_0x54e018,'frameCount':_0x1e94f4[_0x5097bd(0x10a)],'hasVideoSource':!!_0x1e94f4[_0x5097bd(0x1be)],'hasRosSubscriber':!!_0x1e94f4[_0x5097bd(0x14e)]});}return _0x175b30;}}module[a6_0x3d6aaf(0x176)]=new ApplianceWebRTCService();