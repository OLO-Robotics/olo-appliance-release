function a6_0x4c99(_0x1fba61,_0x553b48){const _0x1c28b6=a6_0x25d8();return a6_0x4c99=function(_0x4a2f0f,_0x449c69){_0x4a2f0f=_0x4a2f0f-0x1df;let _0x25d8b1=_0x1c28b6[_0x4a2f0f];return _0x25d8b1;},a6_0x4c99(_0x1fba61,_0x553b48);}const a6_0x8f7223=a6_0x4c99;(function(_0x2455d2,_0xc569c6){const _0x17bb65=a6_0x4c99,_0xe4802c=_0x2455d2();while(!![]){try{const _0x10e2cb=-parseInt(_0x17bb65(0x230))/0x1*(-parseInt(_0x17bb65(0x298))/0x2)+-parseInt(_0x17bb65(0x217))/0x3+parseInt(_0x17bb65(0x24c))/0x4*(-parseInt(_0x17bb65(0x1df))/0x5)+parseInt(_0x17bb65(0x234))/0x6+-parseInt(_0x17bb65(0x251))/0x7+parseInt(_0x17bb65(0x281))/0x8*(-parseInt(_0x17bb65(0x224))/0x9)+parseInt(_0x17bb65(0x20b))/0xa*(parseInt(_0x17bb65(0x2b0))/0xb);if(_0x10e2cb===_0xc569c6)break;else _0xe4802c['push'](_0xe4802c['shift']());}catch(_0x3c38cb){_0xe4802c['push'](_0xe4802c['shift']());}}}(a6_0x25d8,0x246f9));function a6_0x25d8(){const _0x256487=['[WebRTC\x20Appliance]\x20Depth\x20processing\x20issue.\x20Alternative\x20topics:\x20','[WebRTC\x20Appliance]\x20Answer\x20sent\x20for\x20session\x20','[WebRTC\x20Appliance]\x20Error\x20updating\x20TURN\x20credentials:','\x20detected\x20as\x20','addTrack','pop','initialize','24px\x20Arial','[WebRTC\x20Appliance]\x20Generated\x20ICE\x20candidate\x20for\x20session\x20','port','sendFrameToVideoSource','[WebRTC\x20Appliance]\x20Error\x20initializing\x20session\x20','serverUrl','11vdRhZM','has','sensor_msgs/CompressedImage','error','setRemoteDescription','77785FoUSWf','\x20successfully\x20connected!','createTrack','apply','warn','videoTrack','[WebRTC\x20Appliance]\x20Set\x20remote\x20description\x20(offer)','from','[WebRTC\x20Appliance]\x20Failed\x20to\x20process\x20frame\x20for\x20topic\x20','depthProcessor','activeSessions','push','[WebRTC\x20Appliance]\x20Trying\x20subscription\x20with\x20type:\x20','convertRGBAtoI420','random','connected','subscribeToROSTopic','sharedVideoSources','\x20for\x20topic:\x20','canvas',',\x20trying\x20alternative\x20depth\x20topics','putImageData','updateTurnCredentials','getOrCreateSharedVideoSource','[WebRTC\x20Appliance]\x20Got\x20data\x20from\x20alternative\x20topic\x20','videoSource','stringify','toLocaleTimeString','compressed','getActiveSessions','Topic:\x20','rtcConfig','fillRect','[WebRTC\x20Appliance]\x20TURN\x20credentials\x20updated\x20successfully','[WebRTC\x20Appliance]\x20Error\x20handling\x20offer\x20for\x20session\x20','log','processDepthImage','length','frameCount','(((.+)+)+)+$','candidate','session_id','updateCanvasWithImageData','#00ffff','3439390Qwrnzs','framerate','[WebRTC\x20Appliance]\x20Released\x20shared\x20video\x20source\x20for\x20topic\x20','base64','[WebRTC\x20Appliance]\x20Trying\x20alternative\x20topic:\x20','arc','[WebRTC\x20Appliance]\x20No\x20more\x20sessions\x20for\x20topic\x20','[WebRTC\x20Appliance]\x20Error\x20processing\x20ROS\x20message:','rgba(0,\x20170,\x20255,\x20','cleanupSession','\x20connection\x20failed,\x20stopping\x20session','./DepthImageProcessor','398742wMPwxG','fillStyle','stopSession','function','fill','releaseSharedVideoSource','includes','getImageData','close','processColorImage','[WebRTC\x20Appliance]\x20Attempted\x20to\x20stop\x20non-existent\x20session:\x20','[WebRTC\x20Appliance]\x20Using\x20fallback\x20STUN\x20servers','delete','210186TPuqjn','readyState','[WebRTC\x20Appliance]\x20ICE\x20gathering\x20complete\x20for\x20session\x20','[WebRTC\x20Appliance]\x20ROSBridge\x20not\x20connected','split','#1a1a1a','replace','onconnectionstatechange','unsubscribe','onicecandidate','stun:stun.l.google.com:19302','peerConnection','296369jCKeWe','now','./turnCredentialsService','startsWith','394722pJbKTP','get','handleOffer',',\x20converting\x20to\x20base64...','video','msg','[WebRTC\x20Appliance]\x20ICE\x20candidate\x20added\x20for\x20session\x20','\x20connection\x20closed,\x20cleaning\x20up','12px\x20monospace','[WebRTC\x20Appliance]\x20Error\x20adding\x20ICE\x20candidate\x20for\x20session\x20','../config','forEach','OPEN','stopAllSessions','publish','onFrame','webrtc_ice_candidate','ðŸ”\x20Depth','#00ff00','\x20bytes','/image_raw','protocol','removeEventListener','data','4SxZvES','exports','connectionState','depth','add','1387379oRVizP','createAnswer','[WebRTC\x20Appliance]\x20Handling\x20message:\x20','[WebRTC\x20Appliance]\x20Error\x20processing\x20alternative\x20topic\x20message:','send','[WebRTC\x20Appliance]\x20Session\x20','closed','handleMessage','width','sensor_msgs/Image','[WebRTC\x20Appliance]\x20Successfully\x20receiving\x20data\x20on\x20','topicSessions',',\x20cleaning\x20up\x20shared\x20resources','/compressedDepth','ðŸ“¹\x20Color','ðŸ“¹\x20Processing\x20video...','\x20initialized\x20successfully','initializeSession','subscribe','setLocalDescription','stun:stun1.l.google.com:19302','/compressed','\x20sessions)','/image','webrtc_stop_session','color','message','topic','addEventListener','[WebRTC\x20Appliance]\x20Cleaned\x20up\x20session:\x20','compressedDepth','rosbridgeWs','webrtc','sin','[WebRTC\x20Appliance]\x20Service\x20initialized','unknown','wrtc','webrtc_offer','webrtc_','webrtc_init_session','getContext','12px\x20Arial','[WebRTC\x20Appliance]\x20Session\x20not\x20found:\x20','font','constructor','#666','serverWs','ðŸ¤–\x20Robot\x20Camera','72OUyAgP','[WebRTC\x20Appliance]\x20Created\x20answer','initializing','set','Waiting\x20for\x20ROS\x20image\x20data...','rosSubscriber','[WebRTC\x20Appliance]\x20Reusing\x20shared\x20video\x20source\x20for\x20topic\x20','drawLoadingPattern','#00aaff','max','[WebRTC\x20Appliance]\x20No\x20data\x20received\x20on\x20','toString','10px\x20monospace','round','handleIceCandidate','stop','size','\x20image,\x20trying\x20message\x20types:','#ffffff','[WebRTC\x20Appliance]\x20Set\x20local\x20description\x20(answer)','[WebRTC\x20Appliance]\x20Session\x20not\x20found\x20for\x20ICE\x20candidate:\x20','sensor_msgs/msg/CompressedImage','[WebRTC\x20Appliance]\x20Active\x20sessions\x20for\x20topic\x20','2SqBlUM','center','height','type','16px\x20Arial','[WebRTC\x20Appliance]\x20Error\x20sending\x20frame\x20to\x20video\x20source:','search','isDepthTopic','compressed_depth_image_transport/CompressedDepthImage','parse','fillText'];a6_0x25d8=function(){return _0x256487;};return a6_0x25d8();}const a6_0x449c69=(function(){let _0x5f2052=!![];return function(_0x37d196,_0x291e45){const _0x1fc0fa=_0x5f2052?function(){const _0x58334c=a6_0x4c99;if(_0x291e45){const _0x27f781=_0x291e45[_0x58334c(0x1e2)](_0x37d196,arguments);return _0x291e45=null,_0x27f781;}}:function(){};return _0x5f2052=![],_0x1fc0fa;};}()),a6_0x4a2f0f=a6_0x449c69(this,function(){const _0x2f8d61=a6_0x4c99;return a6_0x4a2f0f[_0x2f8d61(0x28c)]()[_0x2f8d61(0x29e)](_0x2f8d61(0x206))[_0x2f8d61(0x28c)]()[_0x2f8d61(0x27d)](a6_0x4a2f0f)[_0x2f8d61(0x29e)](_0x2f8d61(0x206));});a6_0x4a2f0f();const {RTCPeerConnection,RTCSessionDescription,RTCIceCandidate,nonstandard}=require('wrtc'),sharp=require('sharp'),config=require(a6_0x8f7223(0x23e)),DepthImageProcessor=require(a6_0x8f7223(0x216)),turnCredentialsService=require(a6_0x8f7223(0x232));class ApplianceWebRTCService{constructor(){const _0x51f4a9=a6_0x8f7223;this['activeSessions']=new Map(),this[_0x51f4a9(0x25c)]=new Map(),this[_0x51f4a9(0x1f0)]=new Map(),this[_0x51f4a9(0x270)]=null,this[_0x51f4a9(0x27f)]=null,this[_0x51f4a9(0x1e8)]=new DepthImageProcessor(),this['rtcConfig']={'iceServers':[{'urls':_0x51f4a9(0x22e)},{'urls':_0x51f4a9(0x265)}]};}[a6_0x8f7223(0x2a9)](_0x4af64a,_0xb13ec2){const _0x515890=a6_0x8f7223;this[_0x515890(0x270)]=_0x4af64a,this[_0x515890(0x27f)]=_0xb13ec2,turnCredentialsService[_0x515890(0x2a9)](config[_0x515890(0x2af)]),this[_0x515890(0x1f5)](),console[_0x515890(0x202)](_0x515890(0x273));}async[a6_0x8f7223(0x1f5)](){const _0x340f56=a6_0x8f7223;try{console[_0x340f56(0x202)]('[WebRTC\x20Appliance]\x20Updating\x20TURN\x20credentials...');const _0x464c1d=await turnCredentialsService['getIceServers']();this[_0x340f56(0x1fe)]['iceServers']=_0x464c1d,console['log'](_0x340f56(0x200));}catch(_0xbd770c){console[_0x340f56(0x2b3)](_0x340f56(0x2a5),_0xbd770c),console[_0x340f56(0x202)](_0x340f56(0x222));}}[a6_0x8f7223(0x258)](_0x48d12c){const _0x1cb6f2=a6_0x8f7223;if(!_0x48d12c['op']||!_0x48d12c['op'][_0x1cb6f2(0x233)](_0x1cb6f2(0x277)))return![];console[_0x1cb6f2(0x202)](_0x1cb6f2(0x253)+_0x48d12c['op']);switch(_0x48d12c['op']){case _0x1cb6f2(0x278):this[_0x1cb6f2(0x262)](_0x48d12c[_0x1cb6f2(0x208)],_0x48d12c[_0x1cb6f2(0x26c)]);return!![];case _0x1cb6f2(0x276):this[_0x1cb6f2(0x236)](_0x48d12c['session_id'],_0x48d12c['offer']);return!![];case _0x1cb6f2(0x244):this[_0x1cb6f2(0x28f)](_0x48d12c[_0x1cb6f2(0x208)],_0x48d12c[_0x1cb6f2(0x207)]);return!![];case _0x1cb6f2(0x269):this['stopSession'](_0x48d12c[_0x1cb6f2(0x208)]);return!![];default:console[_0x1cb6f2(0x1e3)]('[WebRTC\x20Appliance]\x20Unknown\x20operation:\x20'+_0x48d12c['op']);return![];}}[a6_0x8f7223(0x1f6)](_0x36f2ca){const _0x361b92=a6_0x8f7223;if(this[_0x361b92(0x1f0)]['has'](_0x36f2ca)){const _0x51fb91=this[_0x361b92(0x1f0)][_0x361b92(0x235)](_0x36f2ca);return _0x51fb91[_0x361b92(0x205)]++,console[_0x361b92(0x202)](_0x361b92(0x287)+_0x36f2ca+'\x20('+_0x51fb91['frameCount']+_0x361b92(0x267)),_0x51fb91;}console[_0x361b92(0x202)]('[WebRTC\x20Appliance]\x20Creating\x20new\x20shared\x20video\x20source\x20for\x20topic\x20'+_0x36f2ca);const {createCanvas:_0x475c3e}=require('canvas'),_0x1b8518=_0x475c3e(config[_0x361b92(0x271)][_0x361b92(0x238)]['width'],config[_0x361b92(0x271)][_0x361b92(0x238)][_0x361b92(0x29a)]),_0x3b8455=_0x1b8518[_0x361b92(0x279)]('2d');this[_0x361b92(0x288)](_0x1b8518,_0x3b8455);const {RTCVideoSource:_0x5a5ed5}=nonstandard,_0x158111=new _0x5a5ed5();let _0x6eee7a=0x0;const _0x48b8eb=0x3e8/config['webrtc'][_0x361b92(0x238)]['framerate'],_0xa30cfc=this['subscribeToROSTopic'](_0x36f2ca,_0x36cfef=>{const _0x21e85a=_0x361b92,_0xbf0e4d=Date[_0x21e85a(0x231)]();_0xbf0e4d-_0x6eee7a>=_0x48b8eb&&(_0x6eee7a=_0xbf0e4d,this[_0x21e85a(0x209)](_0x1b8518,_0x3b8455,_0x36cfef,_0x36f2ca,_0x158111));}),_0x44d0b5={'videoSource':_0x158111,'canvas':_0x1b8518,'rosSubscriber':_0xa30cfc,'frameCount':0x1,'topic':_0x36f2ca};return this[_0x361b92(0x1f0)][_0x361b92(0x284)](_0x36f2ca,_0x44d0b5),_0x44d0b5;}[a6_0x8f7223(0x21c)](_0x4fe2b5){const _0x1d8899=a6_0x8f7223,_0x7517e8=this[_0x1d8899(0x1f0)][_0x1d8899(0x235)](_0x4fe2b5);if(!_0x7517e8)return;_0x7517e8['frameCount']--,console[_0x1d8899(0x202)](_0x1d8899(0x20d)+_0x4fe2b5+'\x20('+_0x7517e8[_0x1d8899(0x205)]+'\x20sessions\x20remaining)'),_0x7517e8[_0x1d8899(0x205)]<=0x0&&(console[_0x1d8899(0x202)](_0x1d8899(0x211)+_0x4fe2b5+_0x1d8899(0x25d)),_0x7517e8['videoSource']&&(_0x7517e8[_0x1d8899(0x1f8)]=null),_0x7517e8[_0x1d8899(0x286)]&&_0x7517e8[_0x1d8899(0x286)][_0x1d8899(0x22c)](),this[_0x1d8899(0x1f0)][_0x1d8899(0x223)](_0x4fe2b5));}async[a6_0x8f7223(0x262)](_0x14f16f,_0x369b2a){const _0x4cffdc=a6_0x8f7223;try{console[_0x4cffdc(0x202)]('[WebRTC\x20Appliance]\x20Initializing\x20session\x20'+_0x14f16f+'\x20for\x20topic\x20'+_0x369b2a);const _0x52fd63=this['getOrCreateSharedVideoSource'](_0x369b2a),_0x4043bd=new RTCPeerConnection(this[_0x4cffdc(0x1fe)]),_0x3dc308=_0x52fd63[_0x4cffdc(0x1f8)][_0x4cffdc(0x1e1)]({'width':config['webrtc'][_0x4cffdc(0x238)][_0x4cffdc(0x259)],'height':config[_0x4cffdc(0x271)][_0x4cffdc(0x238)][_0x4cffdc(0x29a)],'framerate':config[_0x4cffdc(0x271)][_0x4cffdc(0x238)][_0x4cffdc(0x20c)]});console[_0x4cffdc(0x202)]('[WebRTC\x20Appliance]\x20Created\x20video\x20track\x20for\x20session\x20'+_0x14f16f);const {MediaStream:_0x4f1dbe}=require(_0x4cffdc(0x275)),_0x5b4b98=new _0x4f1dbe([_0x3dc308]);_0x4043bd[_0x4cffdc(0x2a7)](_0x3dc308,_0x5b4b98),this['sendFrameToVideoSource'](_0x52fd63[_0x4cffdc(0x1f8)],_0x52fd63[_0x4cffdc(0x1f2)]),_0x4043bd[_0x4cffdc(0x22d)]=_0x56c804=>{const _0x4ff049=_0x4cffdc;if(_0x56c804['candidate']&&this[_0x4ff049(0x27f)])console[_0x4ff049(0x202)](_0x4ff049(0x2ab)+_0x14f16f+':',{'type':_0x56c804[_0x4ff049(0x207)][_0x4ff049(0x29b)],'protocol':_0x56c804[_0x4ff049(0x207)][_0x4ff049(0x249)],'address':_0x56c804[_0x4ff049(0x207)]['address'],'port':_0x56c804[_0x4ff049(0x207)][_0x4ff049(0x2ac)]}),this[_0x4ff049(0x27f)][_0x4ff049(0x255)](JSON[_0x4ff049(0x1f9)]({'op':_0x4ff049(0x244),'session_id':_0x14f16f,'candidate':_0x56c804[_0x4ff049(0x207)]}));else!_0x56c804['candidate']&&console[_0x4ff049(0x202)](_0x4ff049(0x226)+_0x14f16f);},_0x4043bd[_0x4cffdc(0x22b)]=()=>{const _0x3827b2=_0x4cffdc;console[_0x3827b2(0x202)]('[WebRTC\x20Appliance]\x20Session\x20'+_0x14f16f+'\x20connection\x20state:\x20'+_0x4043bd[_0x3827b2(0x24e)]);if(_0x4043bd[_0x3827b2(0x24e)]===_0x3827b2(0x1ee))console[_0x3827b2(0x202)](_0x3827b2(0x256)+_0x14f16f+_0x3827b2(0x1e0));else{if(_0x4043bd[_0x3827b2(0x24e)]==='failed')console[_0x3827b2(0x202)](_0x3827b2(0x256)+_0x14f16f+_0x3827b2(0x215)),this[_0x3827b2(0x219)](_0x14f16f);else _0x4043bd[_0x3827b2(0x24e)]===_0x3827b2(0x257)&&(console[_0x3827b2(0x202)](_0x3827b2(0x256)+_0x14f16f+_0x3827b2(0x23b)),this['cleanupSession'](_0x14f16f));}},this[_0x4cffdc(0x1e9)][_0x4cffdc(0x284)](_0x14f16f,{'peerConnection':_0x4043bd,'topic':_0x369b2a,'videoTrack':_0x3dc308,'mediaStream':_0x5b4b98,'status':_0x4cffdc(0x283)}),!this[_0x4cffdc(0x25c)][_0x4cffdc(0x2b1)](_0x369b2a)&&this[_0x4cffdc(0x25c)][_0x4cffdc(0x284)](_0x369b2a,new Set()),this[_0x4cffdc(0x25c)]['get'](_0x369b2a)[_0x4cffdc(0x250)](_0x14f16f),console[_0x4cffdc(0x202)](_0x4cffdc(0x256)+_0x14f16f+_0x4cffdc(0x261)),console[_0x4cffdc(0x202)](_0x4cffdc(0x297)+_0x369b2a+':\x20'+this[_0x4cffdc(0x25c)][_0x4cffdc(0x235)](_0x369b2a)[_0x4cffdc(0x291)]);}catch(_0x544c33){console[_0x4cffdc(0x2b3)](_0x4cffdc(0x2ae)+_0x14f16f+':',_0x544c33),this[_0x4cffdc(0x219)](_0x14f16f);}}async[a6_0x8f7223(0x236)](_0x2cacc8,_0x1d3edf){const _0x2b09a7=a6_0x8f7223,_0x2d2476=this[_0x2b09a7(0x1e9)][_0x2b09a7(0x235)](_0x2cacc8);if(!_0x2d2476){console[_0x2b09a7(0x2b3)](_0x2b09a7(0x27b)+_0x2cacc8);return;}try{console['log']('[WebRTC\x20Appliance]\x20Processing\x20offer\x20for\x20session\x20'+_0x2cacc8),await _0x2d2476[_0x2b09a7(0x22f)][_0x2b09a7(0x2b4)](new RTCSessionDescription(_0x1d3edf)),console[_0x2b09a7(0x202)](_0x2b09a7(0x1e5));const _0x168623=await _0x2d2476[_0x2b09a7(0x22f)][_0x2b09a7(0x252)]();console[_0x2b09a7(0x202)](_0x2b09a7(0x282)),await _0x2d2476['peerConnection'][_0x2b09a7(0x264)](_0x168623),console[_0x2b09a7(0x202)](_0x2b09a7(0x294)),this[_0x2b09a7(0x27f)]&&(this['serverWs']['send'](JSON['stringify']({'op':'webrtc_answer','session_id':_0x2cacc8,'answer':_0x168623})),console['log'](_0x2b09a7(0x2a4)+_0x2cacc8));}catch(_0x4c704f){console['error'](_0x2b09a7(0x201)+_0x2cacc8+':',_0x4c704f),this[_0x2b09a7(0x219)](_0x2cacc8);}}async[a6_0x8f7223(0x28f)](_0xc4159a,_0x4e836f){const _0x1c3af8=a6_0x8f7223,_0x4054da=this[_0x1c3af8(0x1e9)]['get'](_0xc4159a);if(!_0x4054da){console[_0x1c3af8(0x2b3)](_0x1c3af8(0x295)+_0xc4159a);return;}try{await _0x4054da[_0x1c3af8(0x22f)]['addIceCandidate'](new RTCIceCandidate(_0x4e836f)),console[_0x1c3af8(0x202)](_0x1c3af8(0x23a)+_0xc4159a);}catch(_0x414fe5){console['error'](_0x1c3af8(0x23d)+_0xc4159a+':',_0x414fe5);}}[a6_0x8f7223(0x1ef)](_0x3feed3,_0x14f608){const _0x598911=a6_0x8f7223;if(!this[_0x598911(0x270)]||this[_0x598911(0x270)][_0x598911(0x225)]!==this[_0x598911(0x270)][_0x598911(0x240)])return console['error'](_0x598911(0x227)),null;console['log']('[WebRTC\x20Appliance]\x20Subscribing\x20to\x20ROS\x20topic:\x20'+_0x3feed3);const _0x377e8b=_0x3feed3['includes'](_0x598911(0x24f)),_0x4d24ab=_0x3feed3[_0x598911(0x21d)](_0x598911(0x1fb))||_0x3feed3['includes'](_0x598911(0x26f));let _0x4cb2a6=[];_0x377e8b?_0x4d24ab?_0x4cb2a6=[_0x598911(0x2b2),_0x598911(0x296),_0x598911(0x2a0),_0x598911(0x25a)]:_0x4cb2a6=[_0x598911(0x25a),'sensor_msgs/msg/Image','sensor_msgs/CompressedImage']:_0x4cb2a6=['sensor_msgs/CompressedImage',_0x598911(0x296),_0x598911(0x25a)];console[_0x598911(0x202)]('[WebRTC\x20Appliance]\x20Topic\x20'+_0x3feed3+_0x598911(0x2a6)+(_0x377e8b?_0x598911(0x24f):_0x598911(0x26a))+_0x598911(0x292),_0x4cb2a6);const _0x229e30=[];let _0x494429=![];const _0x7cdf55=_0x8cef63=>{return _0x16a143=>{const _0x5aea97=a6_0x4c99;try{const _0x460098=JSON[_0x5aea97(0x2a1)](_0x16a143[_0x5aea97(0x24b)]);_0x460098['op']===_0x5aea97(0x242)&&_0x460098[_0x5aea97(0x26c)]===_0x3feed3&&_0x460098[_0x5aea97(0x239)]&&(!_0x494429&&(console[_0x5aea97(0x202)](_0x5aea97(0x25b)+_0x3feed3+'\x20with\x20message\x20type\x20'+_0x8cef63),_0x494429=!![]),_0x14f608(_0x460098[_0x5aea97(0x239)]));}catch(_0x1e8103){console[_0x5aea97(0x2b3)](_0x5aea97(0x212),_0x1e8103);}};};for(const _0x45fbbf of _0x4cb2a6){const _0x29764c={'op':'subscribe','topic':_0x3feed3,'type':_0x45fbbf};console['log'](_0x598911(0x1eb)+_0x45fbbf),this[_0x598911(0x270)][_0x598911(0x255)](JSON[_0x598911(0x1f9)](_0x29764c));const _0x3c8585=_0x7cdf55(_0x45fbbf);this[_0x598911(0x270)]['addEventListener']('message',_0x3c8585),_0x229e30['push']({'handler':_0x3c8585,'type':_0x45fbbf});}return _0x377e8b&&_0x4d24ab&&setTimeout(()=>{const _0xb5769=_0x598911;if(!_0x494429){console[_0xb5769(0x202)](_0xb5769(0x28b)+_0x3feed3+_0xb5769(0x1f3));const _0x283249=_0x3feed3['replace'](_0xb5769(0x25e),'')[_0xb5769(0x22a)](_0xb5769(0x266),''),_0x36b487=[_0x283249+_0xb5769(0x248),_0x283249+_0xb5769(0x268),_0x283249];for(const _0x161c51 of _0x36b487){console['log'](_0xb5769(0x20f)+_0x161c51);const _0x208f46={'op':_0xb5769(0x263),'topic':_0x161c51,'type':_0xb5769(0x25a)};this[_0xb5769(0x270)][_0xb5769(0x255)](JSON[_0xb5769(0x1f9)](_0x208f46));const _0x595a9d=_0x7c6d31=>{const _0x588332=_0xb5769;try{const _0x56bad7=JSON[_0x588332(0x2a1)](_0x7c6d31[_0x588332(0x24b)]);_0x56bad7['op']===_0x588332(0x242)&&_0x56bad7[_0x588332(0x26c)]===_0x161c51&&_0x56bad7['msg']&&(console[_0x588332(0x202)](_0x588332(0x1f7)+_0x161c51+_0x588332(0x237)),_0x56bad7[_0x588332(0x239)][_0x588332(0x24b)]&&!_0x56bad7[_0x588332(0x239)]['data'][_0x588332(0x233)]('/9j/')&&_0x14f608(_0x56bad7['msg']));}catch(_0x54f04a){console['error'](_0x588332(0x254),_0x54f04a);}};this['rosbridgeWs'][_0xb5769(0x26d)](_0xb5769(0x26b),_0x595a9d),_0x229e30['push']({'handler':_0x595a9d,'type':_0xb5769(0x25a),'topic':_0x161c51});}}},0xbb8),{'unsubscribe':()=>{const _0x27a24d=_0x598911;for(const {handler:_0x230fbc,type:_0x216d32,topic:_0x1f02bd}of _0x229e30){this['rosbridgeWs'][_0x27a24d(0x24a)](_0x27a24d(0x26b),_0x230fbc),this[_0x27a24d(0x270)][_0x27a24d(0x225)]===this[_0x27a24d(0x270)][_0x27a24d(0x240)]&&this[_0x27a24d(0x270)][_0x27a24d(0x255)](JSON[_0x27a24d(0x1f9)]({'op':'unsubscribe','topic':_0x1f02bd||_0x3feed3}));}}};}['drawLoadingPattern'](_0x1e7f0b,_0xbd7ae9){const _0x5edc4e=a6_0x8f7223;_0xbd7ae9[_0x5edc4e(0x218)]=_0x5edc4e(0x229),_0xbd7ae9[_0x5edc4e(0x1ff)](0x0,0x0,_0x1e7f0b[_0x5edc4e(0x259)],_0x1e7f0b[_0x5edc4e(0x29a)]),_0xbd7ae9[_0x5edc4e(0x218)]=_0x5edc4e(0x289),_0xbd7ae9[_0x5edc4e(0x27c)]=_0x5edc4e(0x2aa),_0xbd7ae9['textAlign']=_0x5edc4e(0x299),_0xbd7ae9['fillText'](_0x5edc4e(0x280),_0x1e7f0b[_0x5edc4e(0x259)]/0x2,_0x1e7f0b[_0x5edc4e(0x29a)]/0x2-0x14),_0xbd7ae9[_0x5edc4e(0x218)]=_0x5edc4e(0x293),_0xbd7ae9[_0x5edc4e(0x27c)]=_0x5edc4e(0x29c),_0xbd7ae9[_0x5edc4e(0x2a2)](_0x5edc4e(0x285),_0x1e7f0b[_0x5edc4e(0x259)]/0x2,_0x1e7f0b[_0x5edc4e(0x29a)]/0x2+0x14);const _0x14bce2=Date[_0x5edc4e(0x231)]()/0x3e8;for(let _0xbc30b1=0x0;_0xbc30b1<0x3;_0xbc30b1++){const _0x2332ff=(Math[_0x5edc4e(0x272)](_0x14bce2*0x2+_0xbc30b1*0.5)+0x1)/0x2;_0xbd7ae9['fillStyle']=_0x5edc4e(0x213)+_0x2332ff*0.5+')',_0xbd7ae9['beginPath'](),_0xbd7ae9[_0x5edc4e(0x210)](_0x1e7f0b[_0x5edc4e(0x259)]/0x2-0x28+_0xbc30b1*0x28,_0x1e7f0b[_0x5edc4e(0x29a)]/0x2+0x3c,0x8,0x0,0x2*Math['PI']),_0xbd7ae9[_0x5edc4e(0x21b)]();}}[a6_0x8f7223(0x2ad)](_0x47f6cb,_0x242bc8){const _0x39f4be=a6_0x8f7223;try{if(!_0x47f6cb||!_0x242bc8)return;const _0x549f50=_0x242bc8['getContext']('2d'),_0x3adda6=_0x549f50[_0x39f4be(0x21e)](0x0,0x0,_0x242bc8['width'],_0x242bc8[_0x39f4be(0x29a)]),_0x1867b8=this[_0x39f4be(0x1ec)](_0x3adda6[_0x39f4be(0x24b)],_0x242bc8['width'],_0x242bc8[_0x39f4be(0x29a)]),_0x5b657b={'width':_0x242bc8[_0x39f4be(0x259)],'height':_0x242bc8['height'],'data':_0x1867b8};typeof _0x47f6cb[_0x39f4be(0x243)]===_0x39f4be(0x21a)&&_0x47f6cb[_0x39f4be(0x243)](_0x5b657b);}catch(_0x4f178d){console[_0x39f4be(0x2b3)](_0x39f4be(0x29d),_0x4f178d);}}[a6_0x8f7223(0x1ec)](_0x166946,_0x54cf0c,_0x5aacaf){const _0x525ec9=a6_0x8f7223,_0x3d02a4=_0x54cf0c*_0x5aacaf,_0x34e6ad=_0x54cf0c*_0x5aacaf/0x4,_0x44f0ed=new Uint8Array(_0x3d02a4+_0x34e6ad*0x2);let _0x4c9e3f=0x0,_0x2fba49=_0x3d02a4,_0x59d083=_0x3d02a4+_0x34e6ad;for(let _0xe226ca=0x0;_0xe226ca<_0x5aacaf;_0xe226ca++){for(let _0x30d0d0=0x0;_0x30d0d0<_0x54cf0c;_0x30d0d0++){const _0x40bf1a=(_0xe226ca*_0x54cf0c+_0x30d0d0)*0x4,_0x46c61d=_0x166946[_0x40bf1a],_0x120ee4=_0x166946[_0x40bf1a+0x1],_0x279794=_0x166946[_0x40bf1a+0x2],_0x4f41bf=Math['round'](0.299*_0x46c61d+0.587*_0x120ee4+0.114*_0x279794);_0x44f0ed[_0x4c9e3f++]=_0x4f41bf;if(_0xe226ca%0x2===0x0&&_0x30d0d0%0x2===0x0){const _0x360bc5=Math[_0x525ec9(0x28e)](-0.169*_0x46c61d-0.331*_0x120ee4+0.5*_0x279794+0x80),_0x1838ea=Math[_0x525ec9(0x28e)](0.5*_0x46c61d-0.419*_0x120ee4-0.081*_0x279794+0x80);_0x44f0ed[_0x2fba49++]=Math[_0x525ec9(0x28a)](0x0,Math['min'](0xff,_0x360bc5)),_0x44f0ed[_0x59d083++]=Math[_0x525ec9(0x28a)](0x0,Math['min'](0xff,_0x1838ea));}}}return _0x44f0ed;}async[a6_0x8f7223(0x209)](_0x1b4506,_0x46a196,_0x26e238,_0x37b91f,_0x3c1ed7){const _0x556a91=a6_0x8f7223;try{if(!_0x26e238||!_0x26e238['data'])return;Math[_0x556a91(0x1ed)]()<0.01&&console['log']('[WebRTC\x20Appliance]\x20Processing\x20image\x20data\x20for\x20topic\x20'+_0x37b91f+',\x20size:\x20'+_0x26e238[_0x556a91(0x24b)][_0x556a91(0x204)]+_0x556a91(0x247));const _0x276205=Buffer[_0x556a91(0x1e6)](_0x26e238[_0x556a91(0x24b)],_0x556a91(0x20e)),_0x414f58=this['depthProcessor'][_0x556a91(0x29f)](_0x37b91f);let _0xa18156;_0x414f58?_0xa18156=await this['depthProcessor'][_0x556a91(0x203)](_0x276205,_0x1b4506,_0x46a196,_0x37b91f):_0xa18156=await this['depthProcessor'][_0x556a91(0x220)](_0x276205,_0x1b4506,_0x46a196),_0x46a196[_0x556a91(0x1f4)](_0xa18156,0x0,0x0),_0x46a196[_0x556a91(0x218)]='rgba(0,\x200,\x200,\x200.7)',_0x46a196[_0x556a91(0x1ff)](0xa,0xa,0xdc,0x32),_0x46a196[_0x556a91(0x218)]=_0x414f58?_0x556a91(0x20a):_0x556a91(0x246),_0x46a196[_0x556a91(0x27c)]=_0x556a91(0x23c),_0x46a196[_0x556a91(0x2a2)]((_0x414f58?_0x556a91(0x245):_0x556a91(0x25f))+':\x20'+new Date()[_0x556a91(0x1fa)](),0xf,0x1c),_0x46a196[_0x556a91(0x218)]=_0x556a91(0x293),_0x46a196[_0x556a91(0x27c)]=_0x556a91(0x28d),_0x46a196[_0x556a91(0x2a2)]('Topic:\x20'+_0x37b91f[_0x556a91(0x228)]('/')[_0x556a91(0x2a8)](),0xf,0x2d),this[_0x556a91(0x2ad)](_0x3c1ed7,_0x1b4506);}catch(_0x530104){console['warn'](_0x556a91(0x1e7)+_0x37b91f+':',_0x530104['message']);_0x37b91f[_0x556a91(0x21d)](_0x556a91(0x24f))&&Math[_0x556a91(0x1ed)]()<0.1&&console[_0x556a91(0x1e3)](_0x556a91(0x2a3)+_0x37b91f['replace']('/compressedDepth','/image_raw'));_0x46a196[_0x556a91(0x218)]='#1a1a1a',_0x46a196['fillRect'](0x0,0x0,_0x1b4506[_0x556a91(0x259)],_0x1b4506[_0x556a91(0x29a)]),_0x46a196['fillStyle']='#888',_0x46a196[_0x556a91(0x27c)]=_0x556a91(0x29c),_0x46a196['textAlign']=_0x556a91(0x299);const _0x33a8bb=_0x37b91f[_0x556a91(0x21d)](_0x556a91(0x24f))?'ðŸ”\x20Processing\x20depth...':_0x556a91(0x260);_0x46a196[_0x556a91(0x2a2)](_0x33a8bb,_0x1b4506[_0x556a91(0x259)]/0x2,_0x1b4506[_0x556a91(0x29a)]/0x2),_0x46a196[_0x556a91(0x218)]=_0x556a91(0x27e),_0x46a196[_0x556a91(0x27c)]=_0x556a91(0x27a),_0x46a196['fillText'](_0x556a91(0x1fd)+_0x37b91f[_0x556a91(0x228)]('/')['pop'](),_0x1b4506['width']/0x2,_0x1b4506[_0x556a91(0x29a)]/0x2+0x19),this[_0x556a91(0x2ad)](_0x3c1ed7,_0x1b4506);}}[a6_0x8f7223(0x219)](_0x1a1b1a){const _0xd1e3c7=a6_0x8f7223,_0x2e8a72=this['activeSessions'][_0xd1e3c7(0x235)](_0x1a1b1a);if(!_0x2e8a72){console[_0xd1e3c7(0x1e3)](_0xd1e3c7(0x221)+_0x1a1b1a);return;}console[_0xd1e3c7(0x202)]('[WebRTC\x20Appliance]\x20Stopping\x20session:\x20'+_0x1a1b1a+_0xd1e3c7(0x1f1)+_0x2e8a72[_0xd1e3c7(0x26c)]);try{this['serverWs']&&this['serverWs']['readyState']===this[_0xd1e3c7(0x27f)][_0xd1e3c7(0x240)]&&this[_0xd1e3c7(0x27f)][_0xd1e3c7(0x255)](JSON[_0xd1e3c7(0x1f9)]({'op':'webrtc_stop_session','session_id':_0x1a1b1a})),_0x2e8a72['videoTrack']&&_0x2e8a72['videoTrack'][_0xd1e3c7(0x290)](),_0x2e8a72[_0xd1e3c7(0x22f)]&&_0x2e8a72['peerConnection'][_0xd1e3c7(0x21f)]();}catch(_0x411017){console[_0xd1e3c7(0x2b3)]('[WebRTC\x20Appliance]\x20Error\x20during\x20session\x20cleanup:\x20'+_0x411017);}this[_0xd1e3c7(0x214)](_0x1a1b1a);}['cleanupSession'](_0x2dfb14){const _0x2c2395=a6_0x8f7223,_0x24b6a5=this[_0x2c2395(0x1e9)][_0x2c2395(0x235)](_0x2dfb14);if(_0x24b6a5){const _0x3aaaf3=this['topicSessions']['get'](_0x24b6a5[_0x2c2395(0x26c)]);_0x3aaaf3&&(_0x3aaaf3[_0x2c2395(0x223)](_0x2dfb14),_0x3aaaf3[_0x2c2395(0x291)]===0x0&&this[_0x2c2395(0x25c)][_0x2c2395(0x223)](_0x24b6a5[_0x2c2395(0x26c)])),this[_0x2c2395(0x21c)](_0x24b6a5[_0x2c2395(0x26c)]);}this[_0x2c2395(0x1e9)][_0x2c2395(0x223)](_0x2dfb14),console[_0x2c2395(0x202)](_0x2c2395(0x26e)+_0x2dfb14);}[a6_0x8f7223(0x241)](){const _0x2e514a=a6_0x8f7223;console['log']('[WebRTC\x20Appliance]\x20Stopping\x20all\x20active\x20sessions');const _0x1ee3d0=Array['from'](this[_0x2e514a(0x1e9)]['keys']());_0x1ee3d0[_0x2e514a(0x23f)](_0x43bc60=>this[_0x2e514a(0x219)](_0x43bc60));}[a6_0x8f7223(0x1fc)](){const _0x162f9c=a6_0x8f7223,_0x82e272=[];for(const [_0x230f9d,_0x31d583]of this['activeSessions']){_0x82e272[_0x162f9c(0x1ea)]({'sessionId':_0x230f9d,'topic':_0x31d583[_0x162f9c(0x26c)],'connectionState':_0x31d583[_0x162f9c(0x22f)]?.[_0x162f9c(0x24e)]||_0x162f9c(0x274),'hasVideoTrack':!!_0x31d583[_0x162f9c(0x1e4)]});}return _0x82e272;}['getSharedVideoSources'](){const _0x2cd210=a6_0x8f7223,_0x4968e1=[];for(const [_0x3da480,_0x15e53d]of this[_0x2cd210(0x1f0)]){_0x4968e1['push']({'topic':_0x3da480,'frameCount':_0x15e53d[_0x2cd210(0x205)],'hasVideoSource':!!_0x15e53d[_0x2cd210(0x1f8)],'hasRosSubscriber':!!_0x15e53d[_0x2cd210(0x286)]});}return _0x4968e1;}}module[a6_0x8f7223(0x24d)]=new ApplianceWebRTCService();