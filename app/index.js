const a1_0x24b816=a1_0x178a;(function(_0x3b4ad5,_0x459309){const _0xaac976=a1_0x178a,_0x140e1f=_0x3b4ad5();while(!![]){try{const _0x3e5588=parseInt(_0xaac976(0x6a))/0x1+parseInt(_0xaac976(0x9d))/0x2*(parseInt(_0xaac976(0x96))/0x3)+parseInt(_0xaac976(0xe7))/0x4*(-parseInt(_0xaac976(0x123))/0x5)+parseInt(_0xaac976(0x75))/0x6*(-parseInt(_0xaac976(0xd4))/0x7)+-parseInt(_0xaac976(0xf4))/0x8*(parseInt(_0xaac976(0xee))/0x9)+parseInt(_0xaac976(0xd7))/0xa+parseInt(_0xaac976(0x8d))/0xb;if(_0x3e5588===_0x459309)break;else _0x140e1f['push'](_0x140e1f['shift']());}catch(_0x15dfe0){_0x140e1f['push'](_0x140e1f['shift']());}}}(a1_0xbdd1,0xcff67));function a1_0xbdd1(){const _0x2a76e1=['No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','Disconnected\x20from\x20server\x20(','Access-Control-Allow-Origin','use','Failed\x20to\x20ping\x20server:','estimatedSize','message','values','package://','exit','largeDataTopics','345388GBCYVU','topic','env','Registering\x20with\x20server...','toString','get_mesh','sample_skip','9CjcCvR','\x0aAPP_PASSWORD=','Connected\x20to\x20ROSBridge\x20(WebRTC)','string','throttling','/health','7500792LzrPyH','Topic\x20discovery\x20failed:','getElementsByTagName','Successfully\x20logged\x20in','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','catch','isAuthenticated','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','toLowerCase','constructor','NODE_ENV','writeFileSync','parse','Port\x20','data','/appliance/ping','search','status','getToken','Enter\x20username:\x20','loadConfig','/ros/mesh?uri=','ROSBridge\x20WebSocket\x20URL:\x20','.dae','ros2\x20pkg\x20prefix\x20','json','OPEN','ROSBridge\x20(WebRTC)\x20connection\x20error:','handleMessage','readFileSync','Loaded\x20appliance\x20identity:','trim','join','some','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','username','.mesh','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','slice','child_process','\x20in\x20use,\x20trying\x20next\x20port...','\x20->\x20','path','type','APP_USERNAME=','msg','Appliance\x20is\x20running\x20and\x20authenticated!','15HNMnTN','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','.obj','.appliance.json','[MESH]\x20Error\x20serving\x20mesh:','existsSync','strategy','action','/robot_description','urdf_param_data','845174wUxDGt','topics','PORT','service','String\x20value\x20is:\x20','[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','length','endsWith','robot\x20not\x20found','822aPaWrj','Server\x20connection\x20error:','uri','open','xmldom','match','log','Not\x20authenticated','Successfully\x20registered\x20with\x20server','getAttribute','code','listen','param_name','substring','application/json','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','connection','rosbridge','./services/TopicManager','proxyPort','totalTopics','axios','request_id','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','20354928bPEaCu','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','readyState','samplingRate','mesh_data','Authentication\x20required','name','./services/webrtcService','roslib','3glVtYr','\x20of\x20','registrationToken','unknown','prompt-sync','development','[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:','89234eiIiSb','registration_token','[URDF\x20REWRITE]\x20Rewrote\x20','login','map','/rosapi/topics','.ply','APP_PASSWORD','Environment:\x20','close','filename','.env','discoverTopics','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','stringify','reason','dotenv','robotId','post','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','./config','Ros','Login\x20failed.\x20Please\x20enter\x20credentials\x20again.','service_response','warn','wsEndpoint','Failed\x20to\x20register\x20with\x20server:','mesh','replace','Connected\x20to\x20ROSBridge\x20(main)','./services/auth','hide','/rosbridge?type=appliance&token=','Bearer\x20','Access-Control-Allow-Headers','serverUrl','header','call_service','sendStatus','publish','http','Mesh\x20file\x20not\x20found:\x20','strategies','initialize','stopAllSessions','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','\x20from\x20','[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF','getStatistics','/appliance/register','types','get_urdf_param','startsWith','Connected\x20to\x20server','utf8','77448QdMcxy','WSL\x20Appliance','config','8239840vwHywU','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','get','send','error'];a1_0xbdd1=function(){return _0x2a76e1;};return a1_0xbdd1();}function a1_0x178a(_0x3d7f10,_0x29208d){const _0x413950=a1_0xbdd1();return a1_0x178a=function(_0x2f5180,_0x591fb8){_0x2f5180=_0x2f5180-0x64;let _0xbdd145=_0x413950[_0x2f5180];return _0xbdd145;},a1_0x178a(_0x3d7f10,_0x29208d);}const a1_0x591fb8=(function(){let _0x3a84d3=!![];return function(_0x49b7a6,_0x599c32){const _0x4cbff2=_0x3a84d3?function(){if(_0x599c32){const _0x188e26=_0x599c32['apply'](_0x49b7a6,arguments);return _0x599c32=null,_0x188e26;}}:function(){};return _0x3a84d3=![],_0x4cbff2;};}()),a1_0x2f5180=a1_0x591fb8(this,function(){const _0xe9472a=a1_0x178a;return a1_0x2f5180[_0xe9472a(0xeb)]()[_0xe9472a(0x104)]('(((.+)+)+)+$')[_0xe9472a(0xeb)]()[_0xe9472a(0xfd)](a1_0x2f5180)[_0xe9472a(0x104)]('(((.+)+)+)+$');});a1_0x2f5180();const express=require('express'),config=require(a1_0x24b816(0xb1)),authService=require(a1_0x24b816(0xbb)),webrtcService=require(a1_0x24b816(0x94)),topicManager=require(a1_0x24b816(0x87)),WebSocket=require('ws'),axios=require(a1_0x24b816(0x8a)),fs=require('fs'),prompt=require(a1_0x24b816(0x9a))({'sigint':!![]}),dotenv=require(a1_0x24b816(0xad)),app=express(),port=process[a1_0x24b816(0xe9)][a1_0x24b816(0x6c)]||config[a1_0x24b816(0x86)][a1_0x24b816(0x88)],APPLIANCE_FILE=a1_0x24b816(0x127),{DOMParser,XMLSerializer}=require(a1_0x24b816(0x79)),path=require(a1_0x24b816(0x11e)),{execSync}=require(a1_0x24b816(0x11b)),APPLIANCE_BASE_URL=process[a1_0x24b816(0xe9)]['APPLIANCE_BASE_URL']||'';console['log'](a1_0x24b816(0xa5)+(process[a1_0x24b816(0xe9)][a1_0x24b816(0xfe)]||'development')),console[a1_0x24b816(0x7b)]('Backend\x20Server\x20URL:\x20'+config[a1_0x24b816(0xc0)]),console[a1_0x24b816(0x7b)](a1_0x24b816(0x10a)+config[a1_0x24b816(0x86)][a1_0x24b816(0xb6)]),console['log']('Proxy\x20listening\x20on\x20port:\x20'+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x96ebad,_0x6a4999){const _0x4b5347=a1_0x24b816;fs[_0x4b5347(0xff)](_0x4b5347(0xa8),_0x4b5347(0x120)+_0x96ebad+_0x4b5347(0xef)+_0x6a4999+'\x0a');}function reloadEnv(){const _0x3b1161=a1_0x24b816;dotenv[_0x3b1161(0xd6)]({'override':!![]}),config['credentials'][_0x3b1161(0x117)]=process[_0x3b1161(0xe9)]['APP_USERNAME'],config['credentials']['password']=process[_0x3b1161(0xe9)][_0x3b1161(0xa4)];}async function promptForCredentials(){const _0x469f46=a1_0x24b816,_0x17c7e8=prompt(_0x469f46(0x107)),_0x1ad752=prompt[_0x469f46(0xbc)]('Enter\x20password:\x20');updateEnvFile(_0x17c7e8,_0x1ad752),reloadEnv();}function loadApplianceIdentity(){const _0x29dedf=a1_0x24b816;if(fs[_0x29dedf(0x65)](APPLIANCE_FILE))try{const _0x194429=JSON['parse'](fs[_0x29dedf(0x111)](APPLIANCE_FILE,_0x29dedf(0xd3)));if(_0x194429[_0x29dedf(0xae)]&&_0x194429['registrationToken'])return robotId=_0x194429[_0x29dedf(0xae)],registrationToken=_0x194429['registrationToken'],console[_0x29dedf(0x7b)](_0x29dedf(0x112),robotId),topicManager[_0x29dedf(0x108)](_0x194429),!![];}catch(_0x386bba){console[_0x29dedf(0xdb)]('Failed\x20to\x20parse\x20appliance\x20identity\x20file:',_0x386bba);}return![];}function saveApplianceIdentity(_0x3e3810,_0x2aaeb0){const _0x56533f=a1_0x24b816;let _0x57a225={};if(fs[_0x56533f(0x65)](APPLIANCE_FILE))try{_0x57a225=JSON[_0x56533f(0x100)](fs[_0x56533f(0x111)](APPLIANCE_FILE,_0x56533f(0xd3)));}catch(_0xbda6f6){_0x57a225={};}_0x57a225[_0x56533f(0xae)]=_0x3e3810,_0x57a225[_0x56533f(0x98)]=_0x2aaeb0,fs[_0x56533f(0xff)](APPLIANCE_FILE,JSON[_0x56533f(0xab)](_0x57a225,null,0x2));}async function registerWithServer(){const _0x2b7c0b=a1_0x24b816;try{const _0x4b351f=authService[_0x2b7c0b(0x106)]();if(!_0x4b351f)throw new Error(_0x2b7c0b(0x7c));let _0x16861c,_0x1b1c21=![];while(!![]){try{robotId&&registrationToken?_0x16861c=await axios[_0x2b7c0b(0xaf)](config[_0x2b7c0b(0xc0)]+_0x2b7c0b(0xce),{'name':'WSL\x20Appliance','robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':_0x2b7c0b(0xbe)+_0x4b351f,'Content-Type':'application/json'}}):_0x16861c=await axios[_0x2b7c0b(0xaf)](config[_0x2b7c0b(0xc0)]+_0x2b7c0b(0xce),{'name':_0x2b7c0b(0xd5)},{'headers':{'Authorization':_0x2b7c0b(0xbe)+_0x4b351f,'Content-Type':_0x2b7c0b(0x83)}});break;}catch(_0x5cf89f){const _0x137d55=_0x5cf89f?.['response']?.['data']?.[_0x2b7c0b(0xdb)]||_0x5cf89f[_0x2b7c0b(0xe2)];if(!_0x1b1c21&&_0x137d55&&_0x137d55[_0x2b7c0b(0xfc)]()['includes'](_0x2b7c0b(0x74))){console['warn'](_0x2b7c0b(0x70));if(fs[_0x2b7c0b(0x65)](APPLIANCE_FILE))fs['unlinkSync'](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x1b1c21=!![];continue;}throw _0x5cf89f;}}if(!_0x16861c[_0x2b7c0b(0x102)]||!_0x16861c[_0x2b7c0b(0x102)][_0x2b7c0b(0x9e)]||!_0x16861c[_0x2b7c0b(0x102)]['id'])throw new Error(_0x2b7c0b(0x125));return registrationToken=_0x16861c[_0x2b7c0b(0x102)][_0x2b7c0b(0x9e)],robotId=_0x16861c[_0x2b7c0b(0x102)]['id'],saveApplianceIdentity(robotId,registrationToken),console['log'](_0x2b7c0b(0x7d)),!![];}catch(_0x5780ad){return console['error'](_0x2b7c0b(0xb7),_0x5780ad[_0x2b7c0b(0xe2)]),![];}}function rewriteUrdfMeshUris(_0x1e735d){const _0xfc3ef=a1_0x24b816;try{const _0x37c212=new DOMParser(),_0x210926=_0x37c212['parseFromString'](_0x1e735d,'text/xml');let _0x277bd8=0x0,_0x481b97=0x0;const _0x2d84fa=_0x210926[_0xfc3ef(0xf6)](_0xfc3ef(0xb8));for(let _0x4d7029=0x0;_0x4d7029<_0x2d84fa['length'];_0x4d7029++){const _0x5051b2=_0x2d84fa[_0x4d7029],_0x56ff4e=_0x5051b2[_0xfc3ef(0x7e)](_0xfc3ef(0xa7)),_0x1b9437=['.stl',_0xfc3ef(0x10b),_0xfc3ef(0x126),_0xfc3ef(0xa3),_0xfc3ef(0x118)],_0x310a8d=_0x1b9437[_0xfc3ef(0x115)](_0x2a24de=>_0x56ff4e[_0xfc3ef(0xfc)]()[_0xfc3ef(0x73)](_0x2a24de));if(_0x56ff4e&&_0x56ff4e[_0xfc3ef(0xd1)](_0xfc3ef(0xe4))&&_0x310a8d){_0x277bd8++;const _0x524e4b=APPLIANCE_BASE_URL+_0xfc3ef(0x109)+encodeURIComponent(_0x56ff4e);_0x5051b2['setAttribute'](_0xfc3ef(0xa7),_0x524e4b),_0x481b97++,console[_0xfc3ef(0x7b)](_0xfc3ef(0x6f)+_0x56ff4e+_0xfc3ef(0x11d)+_0x524e4b);}}_0x277bd8>0x0?console[_0xfc3ef(0x7b)](_0xfc3ef(0x9f)+_0x481b97+_0xfc3ef(0x97)+_0x277bd8+_0xfc3ef(0x8e)):console[_0xfc3ef(0x7b)](_0xfc3ef(0xcc));const _0x4d0051=new XMLSerializer();return _0x4d0051['serializeToString'](_0x210926);}catch(_0x1a48bd){return console[_0xfc3ef(0xdb)]('[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):',_0x1a48bd),_0x1e735d;}}function connectToRosbridge(){const _0x42f9a3=a1_0x24b816;try{rosbridgeWs=new WebSocket(config[_0x42f9a3(0x86)][_0x42f9a3(0xb6)]),rosbridgeWs['on']('open',()=>{const _0x2bec58=_0x42f9a3;console[_0x2bec58(0x7b)](_0x2bec58(0xba));const _0x6faa3=require(_0x2bec58(0x95)),_0x4cc04d=new _0x6faa3[(_0x2bec58(0xb2))]({'url':config[_0x2bec58(0x86)][_0x2bec58(0xb6)]});_0x4cc04d['on'](_0x2bec58(0x85),()=>{setTimeout(()=>{const _0x32ede9=a1_0x178a;topicManager[_0x32ede9(0xa9)](_0x4cc04d)[_0x32ede9(0xf9)](_0x1f5b00=>{const _0x11d0dd=_0x32ede9;console[_0x11d0dd(0xdb)](_0x11d0dd(0xf5),_0x1f5b00);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on'](_0x42f9a3(0xe2),_0xaf14af=>{const _0xd5977b=_0x42f9a3;if(serverWs&&serverWs['readyState']===WebSocket['OPEN']){let _0x31834e=_0xaf14af[_0xd5977b(0xeb)]();try{const _0x76c275=JSON[_0xd5977b(0x100)](_0x31834e);if(_0x76c275['op']===_0xd5977b(0xc4)&&_0x76c275[_0xd5977b(0xe8)]){const _0x24fcd5=topicManager[_0xd5977b(0x110)](_0x76c275);switch(_0x24fcd5[_0xd5977b(0x67)]){case _0xd5977b(0xed):return;case'webrtc_skip':return;case'forward':default:_0x31834e=JSON[_0xd5977b(0xab)](_0x24fcd5[_0xd5977b(0xe2)]);break;}}if((_0x76c275['op']===_0xd5977b(0xb4)||_0x76c275['op']===_0xd5977b(0xc2))&&(_0x76c275[_0xd5977b(0x6d)]===_0xd5977b(0xa2)||_0x76c275[_0xd5977b(0xe3)]&&_0x76c275[_0xd5977b(0xe3)][_0xd5977b(0x6b)])){console[_0xd5977b(0x7b)]('[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata');const _0x323dee=_0x76c275[_0xd5977b(0xe3)]?.['topics']||[],_0x3e3981=_0x76c275['values']?.[_0xd5977b(0xcf)]||[],_0x3d8ff5=_0x323dee[_0xd5977b(0xa1)]((_0x18438a,_0x424277)=>{const _0x5431d2=_0xd5977b,_0x1ec637=topicManager['getTopicStrategy'](_0x18438a);return{'name':_0x18438a,'type':_0x3e3981[_0x424277]||_0x5431d2(0x99),'throttling':_0x1ec637?{'isThrottled':_0x1ec637[_0x5431d2(0x66)]==='sample','strategy':_0x1ec637[_0x5431d2(0x66)],'samplingRate':_0x1ec637[_0x5431d2(0x90)],'reason':_0x1ec637[_0x5431d2(0xac)],'estimatedSize':_0x1ec637[_0x5431d2(0xe1)]}:null};});_0x76c275['values']={'topics':_0x3d8ff5[_0xd5977b(0xa1)](_0x409cbd=>_0x409cbd[_0xd5977b(0x93)]),'types':_0x3d8ff5[_0xd5977b(0xa1)](_0x10ae51=>_0x10ae51[_0xd5977b(0x11f)]),'throttling':_0x3d8ff5[_0xd5977b(0xa1)](_0x3d92c2=>_0x3d92c2[_0xd5977b(0xf2)])},_0x31834e=JSON[_0xd5977b(0xab)](_0x76c275),console[_0xd5977b(0x7b)](_0xd5977b(0xca));}if(_0x76c275['op']==='publish'&&_0x76c275[_0xd5977b(0xe8)]===_0xd5977b(0x68))try{const _0x1b6ff5=_0x76c275[_0xd5977b(0x121)][_0xd5977b(0x102)],_0x5a7c9b=rewriteUrdfMeshUris(_0x1b6ff5);_0x76c275['msg']['data']=_0x5a7c9b,_0x31834e=JSON[_0xd5977b(0xab)](_0x76c275);}catch(_0x3e0c6d){console[_0xd5977b(0xdb)](_0xd5977b(0xfb),_0x3e0c6d);}}catch(_0x5426b2){console[_0xd5977b(0xb5)](_0xd5977b(0x9c),_0x5426b2['message']);}serverWs[_0xd5977b(0xda)](_0x31834e);}}),rosbridgeWs['on']('close',()=>{const _0x19605a=_0x42f9a3;console['log'](_0x19605a(0xd8)),webrtcService[_0x19605a(0xc9)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on'](_0x42f9a3(0xdb),_0x197e62=>{const _0x2dc79f=_0x42f9a3;console[_0x2dc79f(0xdb)]('ROSBridge\x20(main)\x20connection\x20error:',_0x197e62);});}catch(_0x5dde1f){console[_0x42f9a3(0xdb)](_0x42f9a3(0x84),_0x5dde1f),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0x3ca11f=a1_0x24b816;try{rosbridgeWebRTCWs=new WebSocket(config['rosbridge'][_0x3ca11f(0xb6)]),rosbridgeWebRTCWs['on'](_0x3ca11f(0x78),()=>{const _0x8fe34b=_0x3ca11f;console[_0x8fe34b(0x7b)](_0x8fe34b(0xf0)),webrtcService[_0x8fe34b(0xc8)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on']('message',_0x1c1ec9=>{}),rosbridgeWebRTCWs['on'](_0x3ca11f(0xa6),()=>{const _0x2b5483=_0x3ca11f;console[_0x2b5483(0x7b)](_0x2b5483(0x124)),webrtcService[_0x2b5483(0xc9)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0x3ca11f(0xdb),_0x1dc12f=>{const _0x3273d4=_0x3ca11f;console[_0x3273d4(0xdb)](_0x3273d4(0x10f),_0x1dc12f);});}catch(_0x386fb7){console['error']('Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):',_0x386fb7),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x170129=a1_0x24b816;try{if(!registrationToken)throw new Error(_0x170129(0x8c));const _0x4ffe0a=config[_0x170129(0xc0)]['replace'](_0x170129(0xc5),'ws')+_0x170129(0xbd)+registrationToken;serverWs=new WebSocket(_0x4ffe0a),serverWs['on'](_0x170129(0x78),()=>{const _0x4bb4d2=_0x170129;console['log'](_0x4bb4d2(0xd2)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x4bb4d2(0x8f)]===WebSocket[_0x4bb4d2(0x10e)]&&webrtcService[_0x4bb4d2(0xc8)](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x170129(0xe2),_0x5a4332=>{const _0xb0a364=_0x170129;if(rosbridgeWs&&rosbridgeWs[_0xb0a364(0x8f)]===WebSocket[_0xb0a364(0x10e)]){let _0x407618=_0x5a4332[_0xb0a364(0xeb)]();try{const _0x21739c=JSON[_0xb0a364(0x100)](_0x407618);if(webrtcService['handleMessage'](_0x21739c))return;if(_0x21739c['op']===_0xb0a364(0xd0)&&typeof _0x21739c['param_name']===_0xb0a364(0xf1)&&_0x21739c['request_id'])try{console[_0xb0a364(0x7b)](_0xb0a364(0xaa)+_0x21739c[_0xb0a364(0x81)]);const _0x338505=execSync('ros2\x20param\x20get\x20'+_0x21739c[_0xb0a364(0x81)],{'encoding':_0xb0a364(0xd3)})[_0xb0a364(0x113)]();let _0x556952=_0x338505;_0x338505[_0xb0a364(0xd1)](_0xb0a364(0x6e))&&(_0x556952=_0x338505[_0xb0a364(0x82)]('String\x20value\x20is:\x20'[_0xb0a364(0x72)]()));_0x556952[_0xb0a364(0xd1)]('\x22')&&_0x556952[_0xb0a364(0x73)]('\x22')&&(_0x556952=_0x556952[_0xb0a364(0x11a)](0x1,-0x1));_0x556952=_0x556952['replace'](/\\n/g,'\x0a')[_0xb0a364(0xb9)](/\\"/g,'\x22');const _0x2cb61d={'op':'urdf_param_data','request_id':_0x21739c[_0xb0a364(0x8b)],'data':_0x556952};serverWs[_0xb0a364(0xda)](JSON[_0xb0a364(0xab)](_0x2cb61d)),console[_0xb0a364(0x7b)]('[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20'+_0x21739c['param_name']);return;}catch(_0x426e47){console[_0xb0a364(0xdb)](_0xb0a364(0xf8),_0x426e47);const _0x511330={'op':_0xb0a364(0x69),'request_id':_0x21739c['request_id'],'error':_0x426e47[_0xb0a364(0xe2)]};serverWs[_0xb0a364(0xda)](JSON[_0xb0a364(0xab)](_0x511330));return;}if(_0x21739c['op']===_0xb0a364(0xec)&&typeof _0x21739c[_0xb0a364(0x77)]===_0xb0a364(0xf1)&&_0x21739c[_0xb0a364(0x8b)])try{const _0x250312=_0x21739c[_0xb0a364(0x77)][_0xb0a364(0x7a)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x250312){const _0x5592c4=_0x250312[0x1],_0x38bf18=_0x250312[0x2],_0x27fd0=execSync(_0xb0a364(0x10c)+_0x5592c4,{'encoding':_0xb0a364(0xd3)})[_0xb0a364(0x113)](),_0x15145f=path[_0xb0a364(0x114)](_0x27fd0,'share',_0x5592c4,_0x38bf18);if(!fs[_0xb0a364(0x65)](_0x15145f))throw new Error(_0xb0a364(0xc6)+_0x15145f);const _0x5b966e=fs[_0xb0a364(0x111)](_0x15145f),_0x386d59={'op':_0xb0a364(0x91),'request_id':_0x21739c['request_id'],'data':_0x5b966e[_0xb0a364(0xeb)]('base64')};serverWs[_0xb0a364(0xda)](JSON['stringify'](_0x386d59)),console[_0xb0a364(0x7b)]('[MESH]\x20Successfully\x20served\x20mesh:\x20'+_0x21739c[_0xb0a364(0x77)]+_0xb0a364(0xcb)+_0x15145f);return;}}catch(_0x195fb4){console[_0xb0a364(0xdb)](_0xb0a364(0x64),_0x195fb4);const _0x510996={'op':_0xb0a364(0x91),'request_id':_0x21739c[_0xb0a364(0x8b)],'error':_0x195fb4[_0xb0a364(0xe2)]};serverWs[_0xb0a364(0xda)](JSON[_0xb0a364(0xab)](_0x510996));return;}rosbridgeWs['send'](_0x407618);}catch(_0x178788){rosbridgeWs[_0xb0a364(0xda)](_0x407618);}}}),serverWs['on'](_0x170129(0xa6),(_0x30fe69,_0x32dfec)=>{const _0x25d7f6=_0x170129;console['log'](_0x25d7f6(0xdd)+_0x30fe69+':\x20'+_0x32dfec+'),\x20attempting\x20to\x20reconnect...'),webrtcService[_0x25d7f6(0xc9)](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x170129(0xdb),_0x8d6fab=>{const _0x3d778f=_0x170129;console[_0x3d778f(0xdb)](_0x3d778f(0x76),_0x8d6fab);});}catch(_0x1c1951){console[_0x170129(0xdb)]('Failed\x20to\x20connect\x20to\x20server:',_0x1c1951),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x16b61a,_0x41b8fb,_0x17dba1)=>{const _0x380247=a1_0x24b816;if(!authService['isAuthenticated']()){console[_0x380247(0x7b)]('Attempting\x20to\x20login\x20to:',config[_0x380247(0xc0)]);const _0x1c5009=await authService[_0x380247(0xa0)]();if(!_0x1c5009)return _0x41b8fb[_0x380247(0x105)](0x191)[_0x380247(0x10d)]({'error':_0x380247(0x92)});}_0x17dba1();};app[a1_0x24b816(0xdf)]((_0x2bf535,_0x309c9f,_0x441cf2)=>{const _0x58b03c=a1_0x24b816;_0x309c9f[_0x58b03c(0xc1)](_0x58b03c(0xde),'*'),_0x309c9f[_0x58b03c(0xc1)]('Access-Control-Allow-Methods',_0x58b03c(0x71)),_0x309c9f[_0x58b03c(0xc1)](_0x58b03c(0xbf),_0x58b03c(0x119)),_0x2bf535['method']==='OPTIONS'?_0x309c9f[_0x58b03c(0xc3)](0xc8):_0x441cf2();}),app['get']('/',requireAuth,(_0x41f658,_0x4cceb)=>{const _0x1aeda1=a1_0x24b816;_0x4cceb[_0x1aeda1(0xda)](_0x1aeda1(0x122));}),app[a1_0x24b816(0xd9)](a1_0x24b816(0xf3),async(_0x457e9a,_0x4f5fa2)=>{const _0x11a97f=a1_0x24b816,_0x1b613f=authService[_0x11a97f(0xfa)](),_0x2ba0d1=webrtcService['getActiveSessions'](),_0x3b3fd0=webrtcService['getSharedVideoSources'](),_0x95898b=topicManager[_0x11a97f(0xcd)]();_0x4f5fa2[_0x11a97f(0x10d)]({'status':'ok','environment':process[_0x11a97f(0xe9)]['NODE_ENV']||_0x11a97f(0x9b),'backendUrl':config['serverUrl'],'rosbridgeUrl':config['rosbridge'][_0x11a97f(0xb6)],'proxyPort':port,'authenticated':_0x1b613f,'topicManagement':{'discovered':_0x95898b[_0x11a97f(0x89)],'strategies':_0x95898b[_0x11a97f(0xc7)],'largeDataTopics':_0x95898b[_0x11a97f(0xe6)]['length'],'largeTopicsList':_0x95898b[_0x11a97f(0xe6)]},'webrtc':{'activeSessions':_0x2ba0d1['length'],'sharedVideoSources':_0x3b3fd0[_0x11a97f(0x72)],'sessions':_0x2ba0d1,'sharedSources':_0x3b3fd0}});});const getInitialPort=()=>{const _0x449b47=a1_0x24b816;if(process[_0x449b47(0xe9)][_0x449b47(0x6c)])return parseInt(process['env'][_0x449b47(0x6c)],0xa);return config[_0x449b47(0x86)][_0x449b47(0x88)];};async function listenWithRetries(_0x90d531,_0x361883,_0x8a41b7=0xa){const _0x26449e=a1_0x24b816;let _0x48baf2=_0x361883;for(let _0x59f9fa=0x1;_0x59f9fa<=_0x8a41b7;_0x59f9fa++){try{return await new Promise((_0x19af2e,_0x21a140)=>{const _0x2605d0=a1_0x178a,_0x45e548=_0x90d531[_0x2605d0(0x80)](_0x48baf2,()=>{const _0x11c5b9=_0x2605d0;console['log'](_0x11c5b9(0x116)+_0x48baf2),_0x19af2e(_0x45e548);});_0x45e548['on'](_0x2605d0(0xdb),_0x4e0458=>{const _0x55f2d5=_0x2605d0;_0x4e0458[_0x55f2d5(0x7f)]==='EADDRINUSE'?(console['warn'](_0x55f2d5(0x101)+_0x48baf2+_0x55f2d5(0x11c)),_0x21a140(_0x4e0458)):_0x21a140(_0x4e0458);});}),_0x48baf2;}catch(_0x1c2812){_0x48baf2++;}}throw new Error(_0x26449e(0xb0)+_0x8a41b7+'\x20attempts\x20starting\x20from\x20'+_0x361883);}const startApp=async()=>{const _0x19ae09=a1_0x24b816;try{let _0xa3d2bd=await authService['login']();while(!_0xa3d2bd){console[_0x19ae09(0x7b)](_0x19ae09(0xb3)),await promptForCredentials(),_0xa3d2bd=await authService[_0x19ae09(0xa0)]();}console[_0x19ae09(0x7b)](_0x19ae09(0xf7));!loadApplianceIdentity()&&console[_0x19ae09(0x7b)](_0x19ae09(0xdc));console[_0x19ae09(0x7b)](_0x19ae09(0xea));const _0x402edd=await registerWithServer();if(!_0x402edd)throw new Error('Failed\x20to\x20register\x20with\x20server');connectToRosbridge(),connectToServer();const _0x12fca5=getInitialPort();await listenWithRetries(app,_0x12fca5,0xa);}catch(_0x4e3801){console[_0x19ae09(0xdb)]('Failed\x20to\x20start\x20application:',_0x4e3801),process[_0x19ae09(0xe5)](0x1);}};setInterval(async()=>{const _0xaef64f=a1_0x24b816;try{if(robotId){const _0x2fdbf3=authService[_0xaef64f(0x106)]();await axios[_0xaef64f(0xaf)](config[_0xaef64f(0xc0)]+_0xaef64f(0x103),{'robotId':robotId},{'headers':{'Authorization':'Bearer\x20'+_0x2fdbf3,'Content-Type':_0xaef64f(0x83)}});}}catch(_0x1ceea8){console['error'](_0xaef64f(0xe0),_0x1ceea8[_0xaef64f(0xe2)]);}},0x1388),startApp();