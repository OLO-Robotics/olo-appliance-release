const a1_0x288e87=a1_0x4302;(function(_0xe0fb3e,_0x254efd){const _0x46e320=a1_0x4302,_0x307e0d=_0xe0fb3e();while(!![]){try{const _0x86188f=parseInt(_0x46e320(0x245))/0x1*(parseInt(_0x46e320(0x26f))/0x2)+-parseInt(_0x46e320(0x262))/0x3*(-parseInt(_0x46e320(0x24e))/0x4)+parseInt(_0x46e320(0x1fc))/0x5*(parseInt(_0x46e320(0x209))/0x6)+-parseInt(_0x46e320(0x222))/0x7+-parseInt(_0x46e320(0x202))/0x8+parseInt(_0x46e320(0x1d6))/0x9*(parseInt(_0x46e320(0x254))/0xa)+-parseInt(_0x46e320(0x22f))/0xb;if(_0x86188f===_0x254efd)break;else _0x307e0d['push'](_0x307e0d['shift']());}catch(_0x48556a){_0x307e0d['push'](_0x307e0d['shift']());}}}(a1_0x33df,0x3702c));const a1_0x111f33=(function(){let _0x1d9519=!![];return function(_0x32ba1a,_0x41324f){const _0x30b14d=_0x1d9519?function(){const _0xb95d06=a1_0x4302;if(_0x41324f){const _0xb40e88=_0x41324f[_0xb95d06(0x286)](_0x32ba1a,arguments);return _0x41324f=null,_0xb40e88;}}:function(){};return _0x1d9519=![],_0x30b14d;};}()),a1_0x24c2c7=a1_0x111f33(this,function(){const _0x237607=a1_0x4302;return a1_0x24c2c7['toString']()[_0x237607(0x1f0)](_0x237607(0x216))[_0x237607(0x261)]()[_0x237607(0x279)](a1_0x24c2c7)[_0x237607(0x1f0)]('(((.+)+)+)+$');});a1_0x24c2c7();const express=require('express'),config=require('./config'),authService=require(a1_0x288e87(0x228)),webrtcService=require(a1_0x288e87(0x200)),topicManager=require(a1_0x288e87(0x25c)),WebSocket=require('ws'),axios=require(a1_0x288e87(0x28d)),fs=require('fs'),prompt=require(a1_0x288e87(0x289))({'sigint':!![]}),dotenv=require(a1_0x288e87(0x1e6)),app=express(),port=process['env'][a1_0x288e87(0x1ee)]||config[a1_0x288e87(0x22a)][a1_0x288e87(0x1f4)],APPLIANCE_FILE=a1_0x288e87(0x278),{DOMParser,XMLSerializer}=require('xmldom'),path=require(a1_0x288e87(0x1fb)),{execSync}=require(a1_0x288e87(0x260)),APPLIANCE_BASE_URL=process[a1_0x288e87(0x275)][a1_0x288e87(0x22d)]||'';console[a1_0x288e87(0x25e)]('Environment:\x20'+(process[a1_0x288e87(0x275)][a1_0x288e87(0x1fe)]||a1_0x288e87(0x23c))),console['log'](a1_0x288e87(0x1f5)+config['serverUrl']),console['log'](a1_0x288e87(0x274)+config[a1_0x288e87(0x22a)][a1_0x288e87(0x26d)]),console['log'](a1_0x288e87(0x27f)+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x22ac65,_0x340929){const _0x370dc6=a1_0x288e87;fs[_0x370dc6(0x234)](_0x370dc6(0x27b),_0x370dc6(0x22b)+_0x22ac65+_0x370dc6(0x25d)+_0x340929+'\x0a');}function reloadEnv(){const _0x141459=a1_0x288e87;dotenv[_0x141459(0x269)]({'override':!![]}),config[_0x141459(0x204)][_0x141459(0x231)]=process[_0x141459(0x275)][_0x141459(0x1ff)],config[_0x141459(0x204)][_0x141459(0x267)]=process['env'][_0x141459(0x1d4)];}async function promptForCredentials(){const _0x3e0cc0=a1_0x288e87,_0x4ee052=prompt('Enter\x20username:\x20'),_0x186582=prompt[_0x3e0cc0(0x218)](_0x3e0cc0(0x256));updateEnvFile(_0x4ee052,_0x186582),reloadEnv();}function loadApplianceIdentity(){const _0x2c1fe1=a1_0x288e87;if(fs[_0x2c1fe1(0x1de)](APPLIANCE_FILE))try{const _0x2f0011=JSON['parse'](fs[_0x2c1fe1(0x215)](APPLIANCE_FILE,_0x2c1fe1(0x282)));if(_0x2f0011['robotId']&&_0x2f0011['registrationToken'])return robotId=_0x2f0011[_0x2c1fe1(0x277)],registrationToken=_0x2f0011[_0x2c1fe1(0x237)],console[_0x2c1fe1(0x25e)](_0x2c1fe1(0x27d),robotId),topicManager[_0x2c1fe1(0x1d7)](_0x2f0011),!![];}catch(_0x8bde32){console[_0x2c1fe1(0x1d2)]('Failed\x20to\x20parse\x20appliance\x20identity\x20file:',_0x8bde32);}return![];}function a1_0x4302(_0x52ee71,_0x63fabb){const _0x1c4e82=a1_0x33df();return a1_0x4302=function(_0x24c2c7,_0x111f33){_0x24c2c7=_0x24c2c7-0x1d0;let _0x33dfb5=_0x1c4e82[_0x24c2c7];return _0x33dfb5;},a1_0x4302(_0x52ee71,_0x63fabb);}function saveApplianceIdentity(_0x4fa33d,_0x47a32d){const _0x556595=a1_0x288e87;let _0x44e572={};if(fs[_0x556595(0x1de)](APPLIANCE_FILE))try{_0x44e572=JSON[_0x556595(0x223)](fs[_0x556595(0x215)](APPLIANCE_FILE,_0x556595(0x282)));}catch(_0x224b64){_0x44e572={};}_0x44e572[_0x556595(0x277)]=_0x4fa33d,_0x44e572[_0x556595(0x237)]=_0x47a32d,fs['writeFileSync'](APPLIANCE_FILE,JSON[_0x556595(0x1f9)](_0x44e572,null,0x2));}async function registerWithServer(){const _0x5aec03=a1_0x288e87;try{const _0x17070e=authService[_0x5aec03(0x1df)]();if(!_0x17070e)throw new Error(_0x5aec03(0x217));let _0x44a225,_0x4b4ad8=![];while(!![]){try{robotId&&registrationToken?_0x44a225=await axios[_0x5aec03(0x1eb)](config[_0x5aec03(0x26c)]+_0x5aec03(0x1e8),{'name':_0x5aec03(0x294),'robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':_0x5aec03(0x21f)+_0x17070e,'Content-Type':_0x5aec03(0x241)}}):_0x44a225=await axios['post'](config['serverUrl']+'/appliance/register',{'name':_0x5aec03(0x294)},{'headers':{'Authorization':_0x5aec03(0x21f)+_0x17070e,'Content-Type':_0x5aec03(0x241)}});break;}catch(_0x574ac2){const _0x1b14bd=_0x574ac2?.[_0x5aec03(0x213)]?.['data']?.['error']||_0x574ac2[_0x5aec03(0x1e1)];if(!_0x4b4ad8&&_0x1b14bd&&_0x1b14bd['toLowerCase']()[_0x5aec03(0x20c)]('robot\x20not\x20found')){console['warn'](_0x5aec03(0x281));if(fs[_0x5aec03(0x1de)](APPLIANCE_FILE))fs[_0x5aec03(0x263)](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x4b4ad8=!![];continue;}throw _0x574ac2;}}if(!_0x44a225['data']||!_0x44a225[_0x5aec03(0x229)]['registration_token']||!_0x44a225[_0x5aec03(0x229)]['id'])throw new Error(_0x5aec03(0x1d1));return registrationToken=_0x44a225[_0x5aec03(0x229)][_0x5aec03(0x1dc)],robotId=_0x44a225['data']['id'],saveApplianceIdentity(robotId,registrationToken),console['log'](_0x5aec03(0x214)),!![];}catch(_0x45728f){return console['error'](_0x5aec03(0x24b),_0x45728f['message']),![];}}function rewriteUrdfMeshUris(_0x1f19de){const _0x1f43dd=a1_0x288e87;try{const _0x4c4492=new DOMParser(),_0x362b9f=_0x4c4492[_0x1f43dd(0x283)](_0x1f19de,_0x1f43dd(0x235));let _0x1190a0=0x0,_0x58dde7=0x0;const _0x535361=_0x362b9f['getElementsByTagName']('mesh');for(let _0x4bca97=0x0;_0x4bca97<_0x535361[_0x1f43dd(0x211)];_0x4bca97++){const _0x2257cb=_0x535361[_0x4bca97],_0x1c1670=_0x2257cb[_0x1f43dd(0x1d5)](_0x1f43dd(0x27c)),_0x1db6f8=['.stl',_0x1f43dd(0x280),_0x1f43dd(0x1ef),_0x1f43dd(0x205),_0x1f43dd(0x201)],_0x2d6e36=_0x1db6f8[_0x1f43dd(0x285)](_0x3892d9=>_0x1c1670[_0x1f43dd(0x249)]()[_0x1f43dd(0x255)](_0x3892d9));if(_0x1c1670&&_0x1c1670[_0x1f43dd(0x21c)](_0x1f43dd(0x238))&&_0x2d6e36){_0x1190a0++;const _0x495c18=APPLIANCE_BASE_URL+_0x1f43dd(0x219)+encodeURIComponent(_0x1c1670);_0x2257cb[_0x1f43dd(0x295)](_0x1f43dd(0x27c),_0x495c18),_0x58dde7++,console['log']('[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20'+_0x1c1670+'\x20->\x20'+_0x495c18);}}_0x1190a0>0x0?console[_0x1f43dd(0x25e)]('[URDF\x20REWRITE]\x20Rewrote\x20'+_0x58dde7+_0x1f43dd(0x246)+_0x1190a0+'\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)'):console[_0x1f43dd(0x25e)]('[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF');const _0x5a71cc=new XMLSerializer();return _0x5a71cc[_0x1f43dd(0x1dd)](_0x362b9f);}catch(_0x2a408d){return console['error'](_0x1f43dd(0x28b),_0x2a408d),_0x1f19de;}}function connectToRosbridge(){const _0x5d7114=a1_0x288e87;try{rosbridgeWs=new WebSocket(config[_0x5d7114(0x22a)][_0x5d7114(0x26d)]),rosbridgeWs['on']('open',()=>{const _0x5a601f=_0x5d7114;console[_0x5a601f(0x25e)](_0x5a601f(0x288));const _0x1805b2=require(_0x5a601f(0x268)),_0x3145d4=new _0x1805b2['Ros']({'url':config[_0x5a601f(0x22a)][_0x5a601f(0x26d)]});_0x3145d4['on'](_0x5a601f(0x1f3),()=>{setTimeout(()=>{topicManager['discoverTopics'](_0x3145d4)['catch'](_0x19f188=>{const _0x401115=a1_0x4302;console[_0x401115(0x1d2)]('Topic\x20discovery\x20failed:',_0x19f188);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on']('message',_0x5dbc24=>{const _0x2a673f=_0x5d7114;if(serverWs&&serverWs[_0x2a673f(0x1fa)]===WebSocket[_0x2a673f(0x272)]){let _0x3eedc8=_0x5dbc24['toString']();try{const _0x4c90aa=JSON['parse'](_0x3eedc8);if(_0x4c90aa['op']===_0x2a673f(0x1da)&&_0x4c90aa['topic']){const _0x3781cd=topicManager['handleMessage'](_0x4c90aa);switch(_0x3781cd[_0x2a673f(0x232)]){case _0x2a673f(0x25a):return;case _0x2a673f(0x1ed):return;case'forward':default:_0x3eedc8=JSON[_0x2a673f(0x1f9)](_0x3781cd[_0x2a673f(0x1e1)]);break;}}if((_0x4c90aa['op']==='service_response'||_0x4c90aa['op']==='call_service')&&(_0x4c90aa[_0x2a673f(0x20f)]===_0x2a673f(0x1db)||_0x4c90aa[_0x2a673f(0x20a)]&&_0x4c90aa['values']['topics'])){console[_0x2a673f(0x25e)]('[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata');const _0x532e35=_0x4c90aa[_0x2a673f(0x20a)]?.[_0x2a673f(0x20e)]||[],_0x45d3af=_0x4c90aa[_0x2a673f(0x20a)]?.['types']||[],_0x17a5e6=_0x532e35['map']((_0x5724b0,_0x4307e5)=>{const _0x2fa49b=_0x2a673f,_0x3b2bb4=topicManager['getTopicStrategy'](_0x5724b0);return{'name':_0x5724b0,'type':_0x45d3af[_0x4307e5]||_0x2fa49b(0x247),'throttling':_0x3b2bb4?{'isThrottled':_0x3b2bb4[_0x2fa49b(0x1e4)]===_0x2fa49b(0x252),'strategy':_0x3b2bb4[_0x2fa49b(0x1e4)],'samplingRate':_0x3b2bb4[_0x2fa49b(0x271)],'reason':_0x3b2bb4[_0x2fa49b(0x20d)],'estimatedSize':_0x3b2bb4[_0x2fa49b(0x257)]}:null};});_0x4c90aa[_0x2a673f(0x20a)]={'topics':_0x17a5e6['map'](_0x3b7c98=>_0x3b7c98[_0x2a673f(0x1f6)]),'types':_0x17a5e6[_0x2a673f(0x224)](_0x4979b7=>_0x4979b7[_0x2a673f(0x21b)]),'throttling':_0x17a5e6[_0x2a673f(0x224)](_0x1cf69c=>_0x1cf69c[_0x2a673f(0x1e7)])},_0x3eedc8=JSON[_0x2a673f(0x1f9)](_0x4c90aa),console[_0x2a673f(0x25e)](_0x2a673f(0x291));}if(_0x4c90aa['op']===_0x2a673f(0x1da)&&_0x4c90aa[_0x2a673f(0x292)]===_0x2a673f(0x1e3))try{const _0x5aef34=_0x4c90aa[_0x2a673f(0x290)][_0x2a673f(0x229)],_0x13376c=rewriteUrdfMeshUris(_0x5aef34);_0x4c90aa[_0x2a673f(0x290)][_0x2a673f(0x229)]=_0x13376c,_0x3eedc8=JSON['stringify'](_0x4c90aa);}catch(_0x49ee3a){console[_0x2a673f(0x1d2)]('[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:',_0x49ee3a);}}catch(_0xbffe8f){console[_0x2a673f(0x227)]('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0xbffe8f[_0x2a673f(0x1e1)]);}serverWs[_0x2a673f(0x25f)](_0x3eedc8);}}),rosbridgeWs['on'](_0x5d7114(0x21e),()=>{const _0x5a7f05=_0x5d7114;console['log'](_0x5a7f05(0x1e2)),webrtcService[_0x5a7f05(0x244)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on'](_0x5d7114(0x1d2),_0x19abc5=>{const _0x135e57=_0x5d7114;console[_0x135e57(0x1d2)](_0x135e57(0x1d8),_0x19abc5);});}catch(_0x611c2e){console['error'](_0x5d7114(0x25b),_0x611c2e),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0xc5b4f4=a1_0x288e87;try{rosbridgeWebRTCWs=new WebSocket(config[_0xc5b4f4(0x22a)][_0xc5b4f4(0x26d)]),rosbridgeWebRTCWs['on'](_0xc5b4f4(0x266),()=>{const _0x12f42e=_0xc5b4f4;console[_0x12f42e(0x25e)](_0x12f42e(0x24a)),webrtcService[_0x12f42e(0x1d3)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on']('message',_0x134d6f=>{}),rosbridgeWebRTCWs['on'](_0xc5b4f4(0x21e),()=>{const _0x1ebc9e=_0xc5b4f4;console[_0x1ebc9e(0x25e)]('Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...'),webrtcService[_0x1ebc9e(0x244)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0xc5b4f4(0x1d2),_0x279e9c=>{const _0x252e72=_0xc5b4f4;console[_0x252e72(0x1d2)](_0x252e72(0x1ea),_0x279e9c);});}catch(_0x4b4f5c){console[_0xc5b4f4(0x1d2)]('Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):',_0x4b4f5c),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x189e72=a1_0x288e87;try{if(!registrationToken)throw new Error(_0x189e72(0x23f));const _0x37f247=config[_0x189e72(0x26c)][_0x189e72(0x207)]('http','ws')+'/rosbridge?type=appliance&token='+registrationToken;serverWs=new WebSocket(_0x37f247),serverWs['on'](_0x189e72(0x266),()=>{const _0x1b18d0=_0x189e72;console[_0x1b18d0(0x25e)](_0x1b18d0(0x28c)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x1b18d0(0x1fa)]===WebSocket[_0x1b18d0(0x272)]&&webrtcService[_0x1b18d0(0x1d3)](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x189e72(0x1e1),_0x4e3fc3=>{const _0x50f467=_0x189e72;if(rosbridgeWs&&rosbridgeWs[_0x50f467(0x1fa)]===WebSocket[_0x50f467(0x272)]){let _0x5d1e97=_0x4e3fc3[_0x50f467(0x261)]();try{const _0x12ff16=JSON[_0x50f467(0x223)](_0x5d1e97);if(webrtcService[_0x50f467(0x259)](_0x12ff16))return;if(_0x12ff16['op']===_0x50f467(0x206)&&typeof _0x12ff16['param_name']===_0x50f467(0x265)&&_0x12ff16['request_id'])try{console[_0x50f467(0x25e)](_0x50f467(0x258)+_0x12ff16['param_name']);const _0x37b6dd=execSync(_0x50f467(0x284)+_0x12ff16[_0x50f467(0x1f2)],{'encoding':'utf8'})[_0x50f467(0x240)]();let _0x5337f6=_0x37b6dd;_0x37b6dd[_0x50f467(0x21c)](_0x50f467(0x230))&&(_0x5337f6=_0x37b6dd[_0x50f467(0x24f)](_0x50f467(0x230)[_0x50f467(0x211)]()));_0x5337f6[_0x50f467(0x21c)]('\x22')&&_0x5337f6[_0x50f467(0x255)]('\x22')&&(_0x5337f6=_0x5337f6[_0x50f467(0x221)](0x1,-0x1));_0x5337f6=_0x5337f6[_0x50f467(0x207)](/\\n/g,'\x0a')[_0x50f467(0x207)](/\\"/g,'\x22');const _0x15b8e4={'op':_0x50f467(0x1f7),'request_id':_0x12ff16[_0x50f467(0x1e0)],'data':_0x5337f6};serverWs[_0x50f467(0x25f)](JSON['stringify'](_0x15b8e4)),console[_0x50f467(0x25e)](_0x50f467(0x250)+_0x12ff16[_0x50f467(0x1f2)]);return;}catch(_0x3fda55){console[_0x50f467(0x1d2)](_0x50f467(0x1e9),_0x3fda55);const _0xfadb9d={'op':'urdf_param_data','request_id':_0x12ff16[_0x50f467(0x1e0)],'error':_0x3fda55['message']};serverWs[_0x50f467(0x25f)](JSON[_0x50f467(0x1f9)](_0xfadb9d));return;}if(_0x12ff16['op']==='get_mesh'&&typeof _0x12ff16[_0x50f467(0x1fd)]===_0x50f467(0x265)&&_0x12ff16[_0x50f467(0x1e0)])try{const _0x2d666e=_0x12ff16['uri']['match'](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x2d666e){const _0xe8b817=_0x2d666e[0x1],_0x4f8a76=_0x2d666e[0x2],_0x14da44=execSync(_0x50f467(0x23e)+_0xe8b817,{'encoding':_0x50f467(0x282)})[_0x50f467(0x240)](),_0x68aa38=path[_0x50f467(0x243)](_0x14da44,_0x50f467(0x276),_0xe8b817,_0x4f8a76);if(!fs[_0x50f467(0x1de)](_0x68aa38))throw new Error('Mesh\x20file\x20not\x20found:\x20'+_0x68aa38);const _0x15477e=fs[_0x50f467(0x215)](_0x68aa38),_0x48c14e={'op':_0x50f467(0x27e),'request_id':_0x12ff16['request_id'],'data':_0x15477e[_0x50f467(0x261)](_0x50f467(0x22c))};serverWs[_0x50f467(0x25f)](JSON[_0x50f467(0x1f9)](_0x48c14e)),console['log'](_0x50f467(0x287)+_0x12ff16[_0x50f467(0x1fd)]+_0x50f467(0x253)+_0x68aa38);return;}}catch(_0x1504f8){console['error'](_0x50f467(0x236),_0x1504f8);const _0x44445e={'op':_0x50f467(0x27e),'request_id':_0x12ff16['request_id'],'error':_0x1504f8['message']};serverWs[_0x50f467(0x25f)](JSON[_0x50f467(0x1f9)](_0x44445e));return;}rosbridgeWs['send'](_0x5d1e97);}catch(_0x1392b4){rosbridgeWs[_0x50f467(0x25f)](_0x5d1e97);}}}),serverWs['on'](_0x189e72(0x21e),(_0x12b304,_0x1150b7)=>{const _0x38e143=_0x189e72;console['log'](_0x38e143(0x1d9)+_0x12b304+':\x20'+_0x1150b7+_0x38e143(0x21a)),webrtcService['stopAllSessions'](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x189e72(0x1d2),_0x1a5a2d=>{const _0x183d0a=_0x189e72;console[_0x183d0a(0x1d2)]('Server\x20connection\x20error:',_0x1a5a2d);});}catch(_0x46fddb){console[_0x189e72(0x1d2)](_0x189e72(0x28e),_0x46fddb),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x3c44f8,_0x6d4290,_0x33c715)=>{const _0x36ee10=a1_0x288e87;if(!authService['isAuthenticated']()){console['log'](_0x36ee10(0x242),config[_0x36ee10(0x26c)]);const _0x551857=await authService[_0x36ee10(0x20b)]();if(!_0x551857)return _0x6d4290[_0x36ee10(0x23d)](0x191)[_0x36ee10(0x1d0)]({'error':'Authentication\x20required'});}_0x33c715();};app[a1_0x288e87(0x239)]((_0x4643fe,_0x16e53f,_0x4ae919)=>{const _0x465395=a1_0x288e87;_0x16e53f[_0x465395(0x233)]('Access-Control-Allow-Origin','*'),_0x16e53f[_0x465395(0x233)](_0x465395(0x24c),_0x465395(0x21d)),_0x16e53f[_0x465395(0x233)](_0x465395(0x208),_0x465395(0x1ec)),_0x4643fe[_0x465395(0x23b)]===_0x465395(0x23a)?_0x16e53f[_0x465395(0x251)](0xc8):_0x4ae919();}),app[a1_0x288e87(0x273)]('/',requireAuth,(_0x46fb3a,_0x57d01e)=>{const _0x2ac0ce=a1_0x288e87;_0x57d01e[_0x2ac0ce(0x25f)]('Appliance\x20is\x20running\x20and\x20authenticated!');}),app[a1_0x288e87(0x273)](a1_0x288e87(0x226),async(_0x3f3080,_0x82e99c)=>{const _0x50057b=a1_0x288e87,_0x117e65=authService[_0x50057b(0x1e5)](),_0xb98b69=webrtcService[_0x50057b(0x225)](),_0x178d96=webrtcService[_0x50057b(0x28f)](),_0x1d8182=topicManager['getStatistics']();_0x82e99c[_0x50057b(0x1d0)]({'status':'ok','environment':process[_0x50057b(0x275)]['NODE_ENV']||_0x50057b(0x23c),'backendUrl':config['serverUrl'],'rosbridgeUrl':config['rosbridge'][_0x50057b(0x26d)],'proxyPort':port,'authenticated':_0x117e65,'topicManagement':{'discovered':_0x1d8182[_0x50057b(0x26e)],'strategies':_0x1d8182[_0x50057b(0x26b)],'largeDataTopics':_0x1d8182[_0x50057b(0x220)]['length'],'largeTopicsList':_0x1d8182[_0x50057b(0x220)]},'webrtc':{'activeSessions':_0xb98b69['length'],'sharedVideoSources':_0x178d96[_0x50057b(0x211)],'sessions':_0xb98b69,'sharedSources':_0x178d96}});});function a1_0x33df(){const _0x4fd779=['\x20from\x20','963410lgqVQc','endsWith','Enter\x20password:\x20','estimatedSize','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','handleMessage','sample_skip','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','./services/TopicManager','\x0aAPP_PASSWORD=','log','send','child_process','toString','18OJnLNW','unlinkSync','/appliance/ping','string','open','password','roslib','config','Login\x20failed.\x20Please\x20enter\x20credentials\x20again.','strategies','serverUrl','wsEndpoint','totalTopics','242578XfDycw','Failed\x20to\x20start\x20application:','samplingRate','OPEN','get','ROSBridge\x20WebSocket\x20URL:\x20','env','share','robotId','.appliance.json','constructor','No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','.env','filename','Loaded\x20appliance\x20identity:','mesh_data','Proxy\x20listening\x20on\x20port:\x20','.dae','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','utf8','parseFromString','ros2\x20param\x20get\x20','some','apply','[MESH]\x20Successfully\x20served\x20mesh:\x20','Connected\x20to\x20ROSBridge\x20(main)','prompt-sync','\x20in\x20use,\x20trying\x20next\x20port...','[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):','Connected\x20to\x20server','axios','Failed\x20to\x20connect\x20to\x20server:','getSharedVideoSources','msg','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','topic','Failed\x20to\x20ping\x20server:','WSL\x20Appliance','setAttribute','json','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','error','initialize','APP_PASSWORD','getAttribute','27spEfnK','loadConfig','ROSBridge\x20(main)\x20connection\x20error:','Disconnected\x20from\x20server\x20(','publish','/rosapi/topics','registration_token','serializeToString','existsSync','getToken','request_id','message','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','/robot_description','strategy','isAuthenticated','dotenv','throttling','/appliance/register','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','ROSBridge\x20(WebRTC)\x20connection\x20error:','post','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','webrtc_skip','PORT','.obj','search','code','param_name','connection','proxyPort','Backend\x20Server\x20URL:\x20','name','urdf_param_data','Failed\x20to\x20register\x20with\x20server','stringify','readyState','path','10okoueV','uri','NODE_ENV','APP_USERNAME','./services/webrtcService','.mesh','2004664ZoWvwD','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','credentials','.ply','get_urdf_param','replace','Access-Control-Allow-Headers','845982MWwQEa','values','login','includes','reason','topics','service','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','length','Successfully\x20logged\x20in','response','Successfully\x20registered\x20with\x20server','readFileSync','(((.+)+)+)+$','Not\x20authenticated','hide','/ros/mesh?uri=','),\x20attempting\x20to\x20reconnect...','type','startsWith','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','close','Bearer\x20','largeDataTopics','slice','2698325tVjKmO','parse','map','getActiveSessions','/health','warn','./services/auth','data','rosbridge','APP_USERNAME=','base64','APPLIANCE_BASE_URL','exit','3018147XKADFj','String\x20value\x20is:\x20','username','action','header','writeFileSync','text/xml','[MESH]\x20Error\x20serving\x20mesh:','registrationToken','package://','use','OPTIONS','method','development','status','ros2\x20pkg\x20prefix\x20','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','trim','application/json','Attempting\x20to\x20login\x20to:','join','stopAllSessions','2FYGnTD','\x20of\x20','unknown','Port\x20','toLowerCase','Connected\x20to\x20ROSBridge\x20(WebRTC)','Failed\x20to\x20register\x20with\x20server:','Access-Control-Allow-Methods','Registering\x20with\x20server...','214776sSEguz','substring','[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','sendStatus','sample'];a1_0x33df=function(){return _0x4fd779;};return a1_0x33df();}const getInitialPort=()=>{const _0x41351b=a1_0x288e87;if(process['env'][_0x41351b(0x1ee)])return parseInt(process[_0x41351b(0x275)][_0x41351b(0x1ee)],0xa);return config[_0x41351b(0x22a)][_0x41351b(0x1f4)];};async function listenWithRetries(_0x27fcc6,_0x2f72b2,_0x562793=0xa){const _0x11609c=a1_0x288e87;let _0x4d410c=_0x2f72b2;for(let _0x5e8e98=0x1;_0x5e8e98<=_0x562793;_0x5e8e98++){try{return await new Promise((_0x30ee7c,_0xbad4ef)=>{const _0x3260c0=a1_0x4302,_0x88cacb=_0x27fcc6['listen'](_0x4d410c,()=>{const _0x4b204b=a1_0x4302;console['log'](_0x4b204b(0x203)+_0x4d410c),_0x30ee7c(_0x88cacb);});_0x88cacb['on'](_0x3260c0(0x1d2),_0x43e4dc=>{const _0x375a35=_0x3260c0;_0x43e4dc[_0x375a35(0x1f1)]==='EADDRINUSE'?(console[_0x375a35(0x227)](_0x375a35(0x248)+_0x4d410c+_0x375a35(0x28a)),_0xbad4ef(_0x43e4dc)):_0xbad4ef(_0x43e4dc);});}),_0x4d410c;}catch(_0x9e39f0){_0x4d410c++;}}throw new Error(_0x11609c(0x210)+_0x562793+'\x20attempts\x20starting\x20from\x20'+_0x2f72b2);}const startApp=async()=>{const _0x400949=a1_0x288e87;try{let _0x315657=await authService[_0x400949(0x20b)]();while(!_0x315657){console['log'](_0x400949(0x26a)),await promptForCredentials(),_0x315657=await authService[_0x400949(0x20b)]();}console['log'](_0x400949(0x212));!loadApplianceIdentity()&&console['log'](_0x400949(0x27a));console[_0x400949(0x25e)](_0x400949(0x24d));const _0x46754a=await registerWithServer();if(!_0x46754a)throw new Error(_0x400949(0x1f8));connectToRosbridge(),connectToServer();const _0x2585c5=getInitialPort();await listenWithRetries(app,_0x2585c5,0xa);}catch(_0x455883){console['error'](_0x400949(0x270),_0x455883),process[_0x400949(0x22e)](0x1);}};setInterval(async()=>{const _0x2c4c0e=a1_0x288e87;try{if(robotId){const _0x4ff328=authService['getToken']();await axios['post'](config['serverUrl']+_0x2c4c0e(0x264),{'robotId':robotId},{'headers':{'Authorization':_0x2c4c0e(0x21f)+_0x4ff328,'Content-Type':'application/json'}});}}catch(_0x46720a){console[_0x2c4c0e(0x1d2)](_0x2c4c0e(0x293),_0x46720a[_0x2c4c0e(0x1e1)]);}},0x1388),startApp();