const a1_0x1dfd4b=a1_0x324b;(function(_0x5320b6,_0x43e5a4){const _0x2e3d6e=a1_0x324b,_0xd043f5=_0x5320b6();while(!![]){try{const _0x1b534b=-parseInt(_0x2e3d6e(0x199))/0x1*(-parseInt(_0x2e3d6e(0x1c8))/0x2)+-parseInt(_0x2e3d6e(0x1bd))/0x3*(parseInt(_0x2e3d6e(0x190))/0x4)+parseInt(_0x2e3d6e(0x14a))/0x5+-parseInt(_0x2e3d6e(0x186))/0x6*(-parseInt(_0x2e3d6e(0x19c))/0x7)+parseInt(_0x2e3d6e(0x120))/0x8*(parseInt(_0x2e3d6e(0x194))/0x9)+parseInt(_0x2e3d6e(0x1d6))/0xa*(-parseInt(_0x2e3d6e(0x18f))/0xb)+-parseInt(_0x2e3d6e(0x122))/0xc*(parseInt(_0x2e3d6e(0x13a))/0xd);if(_0x1b534b===_0x43e5a4)break;else _0xd043f5['push'](_0xd043f5['shift']());}catch(_0x225ddb){_0xd043f5['push'](_0xd043f5['shift']());}}}(a1_0x1d5b,0x77f5f));const a1_0x20e830=(function(){let _0x48db3d=!![];return function(_0x490bd7,_0x59c19b){const _0x18bd46=_0x48db3d?function(){if(_0x59c19b){const _0x2207c9=_0x59c19b['apply'](_0x490bd7,arguments);return _0x59c19b=null,_0x2207c9;}}:function(){};return _0x48db3d=![],_0x18bd46;};}()),a1_0xf8fd7e=a1_0x20e830(this,function(){const _0x2a02e8=a1_0x324b;return a1_0xf8fd7e[_0x2a02e8(0x13c)]()[_0x2a02e8(0x1b0)](_0x2a02e8(0x1bf))[_0x2a02e8(0x13c)]()['constructor'](a1_0xf8fd7e)['search'](_0x2a02e8(0x1bf));});a1_0xf8fd7e();const express=require(a1_0x1dfd4b(0x1d8)),config=require('./config'),authService=require(a1_0x1dfd4b(0x1aa)),webrtcService=require(a1_0x1dfd4b(0x1d1)),topicManager=require(a1_0x1dfd4b(0x1a2)),WebSocket=require('ws'),axios=require(a1_0x1dfd4b(0x16a)),fs=require('fs'),prompt=require(a1_0x1dfd4b(0x147))({'sigint':!![]}),dotenv=require(a1_0x1dfd4b(0x198)),app=express(),port=process['env'][a1_0x1dfd4b(0x17b)]||config[a1_0x1dfd4b(0x15e)][a1_0x1dfd4b(0x180)],APPLIANCE_FILE=a1_0x1dfd4b(0x1b8),{DOMParser,XMLSerializer}=require(a1_0x1dfd4b(0x158)),path=require(a1_0x1dfd4b(0x11b)),{execSync}=require(a1_0x1dfd4b(0x1a3)),APPLIANCE_BASE_URL=process[a1_0x1dfd4b(0x153)][a1_0x1dfd4b(0x1a8)]||'';console[a1_0x1dfd4b(0x15c)]('Environment:\x20'+(process['env'][a1_0x1dfd4b(0x12d)]||a1_0x1dfd4b(0x1a6))),console['log'](a1_0x1dfd4b(0x16f)+config[a1_0x1dfd4b(0x166)]),console['log'](a1_0x1dfd4b(0x138)+config['rosbridge'][a1_0x1dfd4b(0x12f)]),console['log'](a1_0x1dfd4b(0x1b9)+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x4181e6,_0x46d0bf){const _0x15cfab=a1_0x1dfd4b;fs['writeFileSync'](_0x15cfab(0x136),'APP_USERNAME='+_0x4181e6+_0x15cfab(0x164)+_0x46d0bf+'\x0a');}function reloadEnv(){const _0x39b315=a1_0x1dfd4b;dotenv[_0x39b315(0x174)]({'override':!![]}),config[_0x39b315(0x1a5)][_0x39b315(0x192)]=process[_0x39b315(0x153)][_0x39b315(0x19d)],config['credentials'][_0x39b315(0x132)]=process[_0x39b315(0x153)][_0x39b315(0x19a)];}async function promptForCredentials(){const _0x19566b=a1_0x1dfd4b,_0x5eba4f=prompt(_0x19566b(0x134)),_0x32166f=prompt[_0x19566b(0x17d)]('Enter\x20password:\x20');updateEnvFile(_0x5eba4f,_0x32166f),reloadEnv();}function loadApplianceIdentity(){const _0x53a5ec=a1_0x1dfd4b;if(fs[_0x53a5ec(0x148)](APPLIANCE_FILE))try{const _0x12083b=JSON[_0x53a5ec(0x18c)](fs['readFileSync'](APPLIANCE_FILE,'utf8'));if(_0x12083b[_0x53a5ec(0x14b)]&&_0x12083b['registrationToken'])return robotId=_0x12083b[_0x53a5ec(0x14b)],registrationToken=_0x12083b[_0x53a5ec(0x165)],console['log'](_0x53a5ec(0x188),robotId),topicManager[_0x53a5ec(0x17f)](_0x12083b),!![];}catch(_0x45d755){console[_0x53a5ec(0x160)](_0x53a5ec(0x184),_0x45d755);}return![];}function saveApplianceIdentity(_0x567ffe,_0x2a35d4){const _0x334a41=a1_0x1dfd4b;let _0x122b84={};if(fs[_0x334a41(0x148)](APPLIANCE_FILE))try{_0x122b84=JSON['parse'](fs[_0x334a41(0x1d0)](APPLIANCE_FILE,'utf8'));}catch(_0x4a60a8){_0x122b84={};}_0x122b84[_0x334a41(0x14b)]=_0x567ffe,_0x122b84[_0x334a41(0x165)]=_0x2a35d4,fs[_0x334a41(0x140)](APPLIANCE_FILE,JSON[_0x334a41(0x163)](_0x122b84,null,0x2));}async function registerWithServer(){const _0x4573ff=a1_0x1dfd4b;try{const _0x394e88=authService['getToken']();if(!_0x394e88)throw new Error(_0x4573ff(0x1a9));let _0x5c95a6,_0x5c0423=![];while(!![]){try{robotId&&registrationToken?_0x5c95a6=await axios[_0x4573ff(0x1ce)](config['serverUrl']+_0x4573ff(0x195),{'name':_0x4573ff(0x1bc),'robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':'Bearer\x20'+_0x394e88,'Content-Type':_0x4573ff(0x1cf)}}):_0x5c95a6=await axios[_0x4573ff(0x1ce)](config['serverUrl']+_0x4573ff(0x195),{'name':_0x4573ff(0x1bc)},{'headers':{'Authorization':_0x4573ff(0x183)+_0x394e88,'Content-Type':'application/json'}});break;}catch(_0x1aaae8){const _0x34fe53=_0x1aaae8?.[_0x4573ff(0x152)]?.[_0x4573ff(0x146)]?.[_0x4573ff(0x160)]||_0x1aaae8[_0x4573ff(0x119)];if(!_0x5c0423&&_0x34fe53&&_0x34fe53[_0x4573ff(0x126)]()[_0x4573ff(0x150)]('robot\x20not\x20found')){console[_0x4573ff(0x19e)](_0x4573ff(0x1c4));if(fs[_0x4573ff(0x148)](APPLIANCE_FILE))fs[_0x4573ff(0x155)](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x5c0423=!![];continue;}throw _0x1aaae8;}}if(!_0x5c95a6[_0x4573ff(0x146)]||!_0x5c95a6[_0x4573ff(0x146)][_0x4573ff(0x1b7)]||!_0x5c95a6['data']['id'])throw new Error('Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server');return registrationToken=_0x5c95a6[_0x4573ff(0x146)][_0x4573ff(0x1b7)],robotId=_0x5c95a6[_0x4573ff(0x146)]['id'],saveApplianceIdentity(robotId,registrationToken),console[_0x4573ff(0x15c)](_0x4573ff(0x142)),!![];}catch(_0x417152){return console['error'](_0x4573ff(0x162),_0x417152[_0x4573ff(0x119)]),![];}}function a1_0x324b(_0xdd411c,_0x3a12c7){const _0xc16545=a1_0x1d5b();return a1_0x324b=function(_0xf8fd7e,_0x20e830){_0xf8fd7e=_0xf8fd7e-0x115;let _0x1d5b38=_0xc16545[_0xf8fd7e];return _0x1d5b38;},a1_0x324b(_0xdd411c,_0x3a12c7);}function rewriteUrdfMeshUris(_0x556e5b){const _0x5295b6=a1_0x1dfd4b;try{const _0x308194=new DOMParser(),_0x5913c2=_0x308194[_0x5295b6(0x16e)](_0x556e5b,_0x5295b6(0x154));let _0x19431f=0x0,_0x946c6b=0x0;const _0x271aa1=_0x5913c2['getElementsByTagName']('mesh');for(let _0x5222bd=0x0;_0x5222bd<_0x271aa1['length'];_0x5222bd++){const _0x199651=_0x271aa1[_0x5222bd],_0x2d72de=_0x199651[_0x5295b6(0x18b)](_0x5295b6(0x129)),_0x51979c=['.stl',_0x5295b6(0x1d5),'.obj',_0x5295b6(0x1ca),_0x5295b6(0x18e)],_0x1a7429=_0x51979c[_0x5295b6(0x177)](_0x112386=>_0x2d72de[_0x5295b6(0x126)]()[_0x5295b6(0x1c7)](_0x112386));if(_0x2d72de&&_0x2d72de[_0x5295b6(0x18d)](_0x5295b6(0x123))&&_0x1a7429){_0x19431f++;const _0x16a439=APPLIANCE_BASE_URL+_0x5295b6(0x1a4)+encodeURIComponent(_0x2d72de);_0x199651[_0x5295b6(0x1d2)](_0x5295b6(0x129),_0x16a439),_0x946c6b++,console[_0x5295b6(0x15c)](_0x5295b6(0x151)+_0x2d72de+_0x5295b6(0x1a7)+_0x16a439);}}_0x19431f>0x0?console['log'](_0x5295b6(0x11c)+_0x946c6b+'\x20of\x20'+_0x19431f+_0x5295b6(0x178)):console[_0x5295b6(0x15c)]('[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF');const _0x323f00=new XMLSerializer();return _0x323f00[_0x5295b6(0x13d)](_0x5913c2);}catch(_0x20ff36){return console[_0x5295b6(0x160)](_0x5295b6(0x159),_0x20ff36),_0x556e5b;}}function connectToRosbridge(){const _0x5306fc=a1_0x1dfd4b;try{rosbridgeWs=new WebSocket(config['rosbridge'][_0x5306fc(0x12f)]),rosbridgeWs['on']('open',()=>{const _0x271395=_0x5306fc;console[_0x271395(0x15c)]('Connected\x20to\x20ROSBridge\x20(main)');const _0x13f928=require(_0x271395(0x144)),_0x48023c=new _0x13f928[(_0x271395(0x1cb))]({'url':config[_0x271395(0x15e)][_0x271395(0x12f)]});_0x48023c['on'](_0x271395(0x11a),()=>{setTimeout(()=>{const _0x4e03ad=a1_0x324b;topicManager[_0x4e03ad(0x12c)](_0x48023c)[_0x4e03ad(0x1a0)](_0x3f0148=>{const _0x2bcb23=_0x4e03ad;console['error'](_0x2bcb23(0x1d4),_0x3f0148);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on'](_0x5306fc(0x119),_0x33a111=>{const _0x2f0784=_0x5306fc;if(serverWs&&serverWs[_0x2f0784(0x189)]===WebSocket['OPEN']){let _0x4e091c=_0x33a111[_0x2f0784(0x13c)]();try{const _0x54e3ba=JSON[_0x2f0784(0x18c)](_0x4e091c);if(_0x54e3ba['op']===_0x2f0784(0x15b)&&_0x54e3ba['topic']){const _0x41ea09=topicManager[_0x2f0784(0x14c)](_0x54e3ba);switch(_0x41ea09[_0x2f0784(0x1b2)]){case _0x2f0784(0x1b1):return;case _0x2f0784(0x1c9):return;case'forward':default:_0x4e091c=JSON[_0x2f0784(0x163)](_0x41ea09[_0x2f0784(0x119)]);break;}}if((_0x54e3ba['op']===_0x2f0784(0x181)||_0x54e3ba['op']==='call_service')&&(_0x54e3ba[_0x2f0784(0x11d)]===_0x2f0784(0x128)||_0x54e3ba[_0x2f0784(0x17c)]&&_0x54e3ba[_0x2f0784(0x17c)][_0x2f0784(0x1b3)])){console[_0x2f0784(0x15c)](_0x2f0784(0x17e));const _0x2efdcd=_0x54e3ba[_0x2f0784(0x17c)]?.[_0x2f0784(0x1b3)]||[],_0x9d6484=_0x54e3ba[_0x2f0784(0x17c)]?.[_0x2f0784(0x14f)]||[],_0x3d28bf=_0x2efdcd[_0x2f0784(0x13f)]((_0x52a1fa,_0x18462d)=>{const _0x158246=_0x2f0784,_0xee4a70=topicManager[_0x158246(0x193)](_0x52a1fa);return{'name':_0x52a1fa,'type':_0x9d6484[_0x18462d]||_0x158246(0x1cc),'throttling':_0xee4a70?{'isThrottled':_0xee4a70['strategy']===_0x158246(0x170),'strategy':_0xee4a70['strategy'],'samplingRate':_0xee4a70['samplingRate'],'reason':_0xee4a70[_0x158246(0x139)],'estimatedSize':_0xee4a70['estimatedSize']}:null};});_0x54e3ba[_0x2f0784(0x17c)]={'topics':_0x3d28bf[_0x2f0784(0x13f)](_0x391feb=>_0x391feb[_0x2f0784(0x135)]),'types':_0x3d28bf[_0x2f0784(0x13f)](_0x1b3418=>_0x1b3418['type']),'throttling':_0x3d28bf[_0x2f0784(0x13f)](_0x1899a1=>_0x1899a1[_0x2f0784(0x167)])},_0x4e091c=JSON[_0x2f0784(0x163)](_0x54e3ba),console[_0x2f0784(0x15c)](_0x2f0784(0x1c6));}if(_0x54e3ba['op']===_0x2f0784(0x15b)&&_0x54e3ba['topic']===_0x2f0784(0x1ac))try{const _0x29c536=_0x54e3ba['msg']['data'],_0x12f918=rewriteUrdfMeshUris(_0x29c536);_0x54e3ba['msg'][_0x2f0784(0x146)]=_0x12f918,_0x4e091c=JSON[_0x2f0784(0x163)](_0x54e3ba);}catch(_0x4194b4){console[_0x2f0784(0x160)](_0x2f0784(0x19f),_0x4194b4);}}catch(_0x6a8b5d){console[_0x2f0784(0x19e)]('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0x6a8b5d[_0x2f0784(0x119)]);}serverWs[_0x2f0784(0x182)](_0x4e091c);}}),rosbridgeWs['on'](_0x5306fc(0x173),()=>{const _0x10af7c=_0x5306fc;console[_0x10af7c(0x15c)](_0x10af7c(0x1a1)),webrtcService[_0x10af7c(0x16d)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on']('error',_0x380335=>{const _0x3b7192=_0x5306fc;console['error'](_0x3b7192(0x1cd),_0x380335);});}catch(_0x5b99a0){console[_0x5306fc(0x160)](_0x5306fc(0x12b),_0x5b99a0),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0xe5ab48=a1_0x1dfd4b;try{rosbridgeWebRTCWs=new WebSocket(config['rosbridge'][_0xe5ab48(0x12f)]),rosbridgeWebRTCWs['on'](_0xe5ab48(0x1d3),()=>{const _0x52c9b3=_0xe5ab48;console[_0x52c9b3(0x15c)]('Connected\x20to\x20ROSBridge\x20(WebRTC)'),webrtcService[_0x52c9b3(0x185)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on'](_0xe5ab48(0x119),_0x3b7e92=>{}),rosbridgeWebRTCWs['on']('close',()=>{const _0x2a9c2c=_0xe5ab48;console[_0x2a9c2c(0x15c)](_0x2a9c2c(0x130)),webrtcService[_0x2a9c2c(0x16d)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0xe5ab48(0x160),_0xd1da5b=>{const _0x21a7e3=_0xe5ab48;console[_0x21a7e3(0x160)](_0x21a7e3(0x171),_0xd1da5b);});}catch(_0x5d9f6c){console[_0xe5ab48(0x160)](_0xe5ab48(0x1af),_0x5d9f6c),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x28ebb1=a1_0x1dfd4b;try{if(!registrationToken)throw new Error('Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.');const _0x47dd22=config[_0x28ebb1(0x166)][_0x28ebb1(0x175)](_0x28ebb1(0x125),'ws')+_0x28ebb1(0x121)+registrationToken;serverWs=new WebSocket(_0x47dd22),serverWs['on']('open',()=>{const _0x3f40eb=_0x28ebb1;console['log'](_0x3f40eb(0x172)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs['readyState']===WebSocket[_0x3f40eb(0x127)]&&webrtcService[_0x3f40eb(0x185)](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x28ebb1(0x119),_0x539504=>{const _0x372bb3=_0x28ebb1;if(rosbridgeWs&&rosbridgeWs['readyState']===WebSocket[_0x372bb3(0x127)]){let _0x513a16=_0x539504[_0x372bb3(0x13c)]();try{const _0x5e8bb0=JSON['parse'](_0x513a16);if(webrtcService['handleMessage'](_0x5e8bb0))return;if(_0x5e8bb0['op']==='get_urdf_param'&&typeof _0x5e8bb0[_0x372bb3(0x116)]===_0x372bb3(0x13e)&&_0x5e8bb0['request_id'])try{console[_0x372bb3(0x15c)](_0x372bb3(0x1c1)+_0x5e8bb0[_0x372bb3(0x116)]);const _0x3d43d7=execSync(_0x372bb3(0x131)+_0x5e8bb0['param_name'],{'encoding':_0x372bb3(0x176)})[_0x372bb3(0x161)]();let _0x3efdab=_0x3d43d7;_0x3d43d7[_0x372bb3(0x18d)]('String\x20value\x20is:\x20')&&(_0x3efdab=_0x3d43d7[_0x372bb3(0x1b5)](_0x372bb3(0x197)[_0x372bb3(0x141)]()));_0x3efdab[_0x372bb3(0x18d)]('\x22')&&_0x3efdab['endsWith']('\x22')&&(_0x3efdab=_0x3efdab[_0x372bb3(0x149)](0x1,-0x1));_0x3efdab=_0x3efdab[_0x372bb3(0x175)](/\\n/g,'\x0a')[_0x372bb3(0x175)](/\\"/g,'\x22');const _0x41397a={'op':_0x372bb3(0x14d),'request_id':_0x5e8bb0[_0x372bb3(0x12e)],'data':_0x3efdab};serverWs[_0x372bb3(0x182)](JSON[_0x372bb3(0x163)](_0x41397a)),console[_0x372bb3(0x15c)](_0x372bb3(0x1ad)+_0x5e8bb0['param_name']);return;}catch(_0x42a5dd){console[_0x372bb3(0x160)](_0x372bb3(0x11e),_0x42a5dd);const _0x11a5ec={'op':_0x372bb3(0x14d),'request_id':_0x5e8bb0['request_id'],'error':_0x42a5dd[_0x372bb3(0x119)]};serverWs[_0x372bb3(0x182)](JSON[_0x372bb3(0x163)](_0x11a5ec));return;}if(_0x5e8bb0['op']===_0x372bb3(0x1be)&&typeof _0x5e8bb0[_0x372bb3(0x1b4)]===_0x372bb3(0x13e)&&_0x5e8bb0['request_id'])try{const _0x44feac=_0x5e8bb0['uri'][_0x372bb3(0x137)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x44feac){const _0x3a7354=_0x44feac[0x1],_0x5e32b1=_0x44feac[0x2],_0x2ed507=execSync(_0x372bb3(0x157)+_0x3a7354,{'encoding':_0x372bb3(0x176)})[_0x372bb3(0x161)](),_0x3a113c=path[_0x372bb3(0x15a)](_0x2ed507,_0x372bb3(0x133),_0x3a7354,_0x5e32b1);if(!fs['existsSync'](_0x3a113c))throw new Error(_0x372bb3(0x1da)+_0x3a113c);const _0x4036ff=fs[_0x372bb3(0x1d0)](_0x3a113c),_0x54190d={'op':_0x372bb3(0x1ab),'request_id':_0x5e8bb0[_0x372bb3(0x12e)],'data':_0x4036ff[_0x372bb3(0x13c)](_0x372bb3(0x179))};serverWs['send'](JSON[_0x372bb3(0x163)](_0x54190d)),console[_0x372bb3(0x15c)](_0x372bb3(0x196)+_0x5e8bb0[_0x372bb3(0x1b4)]+'\x20from\x20'+_0x3a113c);return;}}catch(_0x5407cb){console['error'](_0x372bb3(0x143),_0x5407cb);const _0x4c83b4={'op':_0x372bb3(0x1ab),'request_id':_0x5e8bb0[_0x372bb3(0x12e)],'error':_0x5407cb[_0x372bb3(0x119)]};serverWs['send'](JSON[_0x372bb3(0x163)](_0x4c83b4));return;}rosbridgeWs['send'](_0x513a16);}catch(_0x179edc){rosbridgeWs[_0x372bb3(0x182)](_0x513a16);}}}),serverWs['on'](_0x28ebb1(0x173),(_0x4117f2,_0x3b68e4)=>{const _0x343418=_0x28ebb1;console[_0x343418(0x15c)](_0x343418(0x115)+_0x4117f2+':\x20'+_0x3b68e4+'),\x20attempting\x20to\x20reconnect...'),webrtcService[_0x343418(0x16d)](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x28ebb1(0x160),_0x4888bc=>{const _0x265d76=_0x28ebb1;console['error'](_0x265d76(0x1db),_0x4888bc);});}catch(_0x46d6d3){console[_0x28ebb1(0x160)]('Failed\x20to\x20connect\x20to\x20server:',_0x46d6d3),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x31a4f3,_0x2239e8,_0x4f7121)=>{const _0x4339e9=a1_0x1dfd4b;if(!authService[_0x4339e9(0x124)]()){console[_0x4339e9(0x15c)]('Attempting\x20to\x20login\x20to:',config[_0x4339e9(0x166)]);const _0x1e86a1=await authService['login']();if(!_0x1e86a1)return _0x2239e8[_0x4339e9(0x1ba)](0x191)[_0x4339e9(0x1bb)]({'error':_0x4339e9(0x15f)});}_0x4f7121();};app[a1_0x1dfd4b(0x16b)]((_0x2584d1,_0x18e110,_0x7065e3)=>{const _0x8b3eca=a1_0x1dfd4b;_0x18e110[_0x8b3eca(0x168)]('Access-Control-Allow-Origin','*'),_0x18e110[_0x8b3eca(0x168)](_0x8b3eca(0x1ae),_0x8b3eca(0x191)),_0x18e110['header']('Access-Control-Allow-Headers',_0x8b3eca(0x15d)),_0x2584d1[_0x8b3eca(0x1b6)]===_0x8b3eca(0x169)?_0x18e110[_0x8b3eca(0x1c2)](0xc8):_0x7065e3();}),app['get']('/',requireAuth,(_0x132417,_0x597bfa)=>{const _0x4973fe=a1_0x1dfd4b;_0x597bfa['send'](_0x4973fe(0x11f));}),app[a1_0x1dfd4b(0x118)]('/health',async(_0x14b772,_0x33a39d)=>{const _0x1126de=a1_0x1dfd4b,_0x350e2c=authService[_0x1126de(0x124)](),_0xe101cc=webrtcService['getActiveSessions'](),_0x460807=webrtcService['getSharedVideoSources'](),_0x57c74c=topicManager[_0x1126de(0x16c)]();_0x33a39d[_0x1126de(0x1bb)]({'status':'ok','environment':process[_0x1126de(0x153)]['NODE_ENV']||'development','backendUrl':config['serverUrl'],'rosbridgeUrl':config[_0x1126de(0x15e)][_0x1126de(0x12f)],'proxyPort':port,'authenticated':_0x350e2c,'topicManagement':{'discovered':_0x57c74c[_0x1126de(0x13b)],'strategies':_0x57c74c[_0x1126de(0x14e)],'largeDataTopics':_0x57c74c[_0x1126de(0x117)]['length'],'largeTopicsList':_0x57c74c[_0x1126de(0x117)]},'webrtc':{'activeSessions':_0xe101cc[_0x1126de(0x141)],'sharedVideoSources':_0x460807[_0x1126de(0x141)],'sessions':_0xe101cc,'sharedSources':_0x460807}});});const getInitialPort=()=>{const _0x1e0819=a1_0x1dfd4b;if(process['env']['PORT'])return parseInt(process['env'][_0x1e0819(0x17b)],0xa);return config[_0x1e0819(0x15e)][_0x1e0819(0x180)];};function a1_0x1d5b(){const _0x1d59cc=['[MESH]\x20Successfully\x20served\x20mesh:\x20','String\x20value\x20is:\x20','dotenv','1tHHLwK','APP_PASSWORD','Failed\x20to\x20start\x20application:','587083smGpwj','APP_USERNAME','warn','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','catch','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','./services/TopicManager','child_process','/ros/mesh?uri=','credentials','development','\x20->\x20','APPLIANCE_BASE_URL','Not\x20authenticated','./services/auth','mesh_data','/robot_description','[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','Access-Control-Allow-Methods','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','search','sample_skip','action','topics','uri','substring','method','registration_token','.appliance.json','Proxy\x20listening\x20on\x20port:\x20','status','json','WSL\x20Appliance','3NHwHeA','get_mesh','(((.+)+)+)+$','\x20attempts\x20starting\x20from\x20','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','sendStatus','Successfully\x20logged\x20in','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','\x20in\x20use,\x20trying\x20next\x20port...','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','endsWith','532402egzckE','webrtc_skip','.ply','Ros','unknown','ROSBridge\x20(main)\x20connection\x20error:','post','application/json','readFileSync','./services/webrtcService','setAttribute','open','Topic\x20discovery\x20failed:','.dae','281570IKugzm','/appliance/ping','express','exit','Mesh\x20file\x20not\x20found:\x20','Server\x20connection\x20error:','Disconnected\x20from\x20server\x20(','param_name','largeDataTopics','get','message','connection','path','[URDF\x20REWRITE]\x20Rewrote\x20','service','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','Appliance\x20is\x20running\x20and\x20authenticated!','7248328lJFcVX','/rosbridge?type=appliance&token=','56712SZeWQL','package://','isAuthenticated','http','toLowerCase','OPEN','/rosapi/topics','filename','Failed\x20to\x20register\x20with\x20server','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','discoverTopics','NODE_ENV','request_id','wsEndpoint','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','ros2\x20param\x20get\x20','password','share','Enter\x20username:\x20','name','.env','match','ROSBridge\x20WebSocket\x20URL:\x20','reason','2080gNnHnW','totalTopics','toString','serializeToString','string','map','writeFileSync','length','Successfully\x20registered\x20with\x20server','[MESH]\x20Error\x20serving\x20mesh:','roslib','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','data','prompt-sync','existsSync','slice','4694975zCsNiU','robotId','handleMessage','urdf_param_data','strategies','types','includes','[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20','response','env','text/xml','unlinkSync','Port\x20','ros2\x20pkg\x20prefix\x20','xmldom','[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):','join','publish','log','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','rosbridge','Authentication\x20required','error','trim','Failed\x20to\x20register\x20with\x20server:','stringify','\x0aAPP_PASSWORD=','registrationToken','serverUrl','throttling','header','OPTIONS','axios','use','getStatistics','stopAllSessions','parseFromString','Backend\x20Server\x20URL:\x20','sample','ROSBridge\x20(WebRTC)\x20connection\x20error:','Connected\x20to\x20server','close','config','replace','utf8','some','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','base64','Failed\x20to\x20ping\x20server:','PORT','values','hide','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','loadConfig','proxyPort','service_response','send','Bearer\x20','Failed\x20to\x20parse\x20appliance\x20identity\x20file:','initialize','18ryoKhW','login','Loaded\x20appliance\x20identity:','readyState','Registering\x20with\x20server...','getAttribute','parse','startsWith','.mesh','330oeeLAd','1082460vmgBpX','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','username','getTopicStrategy','9lzLntd','/appliance/register'];a1_0x1d5b=function(){return _0x1d59cc;};return a1_0x1d5b();}async function listenWithRetries(_0x15d8b1,_0xf24e3f,_0x23329f=0xa){const _0x2a1dee=a1_0x1dfd4b;let _0x56efa2=_0xf24e3f;for(let _0x44c2b9=0x1;_0x44c2b9<=_0x23329f;_0x44c2b9++){try{return await new Promise((_0x5cb853,_0x1534a4)=>{const _0x36704c=a1_0x324b,_0x44a29d=_0x15d8b1['listen'](_0x56efa2,()=>{const _0x3d170e=a1_0x324b;console[_0x3d170e(0x15c)](_0x3d170e(0x145)+_0x56efa2),_0x5cb853(_0x44a29d);});_0x44a29d['on'](_0x36704c(0x160),_0x53c406=>{const _0x59e4f5=_0x36704c;_0x53c406['code']==='EADDRINUSE'?(console[_0x59e4f5(0x19e)](_0x59e4f5(0x156)+_0x56efa2+_0x59e4f5(0x1c5)),_0x1534a4(_0x53c406)):_0x1534a4(_0x53c406);});}),_0x56efa2;}catch(_0x1919c9){_0x56efa2++;}}throw new Error('Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20'+_0x23329f+_0x2a1dee(0x1c0)+_0xf24e3f);}const startApp=async()=>{const _0x35c72a=a1_0x1dfd4b;try{let _0x597149=await authService[_0x35c72a(0x187)]();while(!_0x597149){console[_0x35c72a(0x15c)]('Login\x20failed.\x20Please\x20enter\x20credentials\x20again.'),await promptForCredentials(),_0x597149=await authService['login']();}console[_0x35c72a(0x15c)](_0x35c72a(0x1c3));!loadApplianceIdentity()&&console[_0x35c72a(0x15c)]('No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.');console['log'](_0x35c72a(0x18a));const _0x44137c=await registerWithServer();if(!_0x44137c)throw new Error(_0x35c72a(0x12a));connectToRosbridge(),connectToServer();const _0x33ffc6=getInitialPort();await listenWithRetries(app,_0x33ffc6,0xa);}catch(_0x1ce4c0){console[_0x35c72a(0x160)](_0x35c72a(0x19b),_0x1ce4c0),process[_0x35c72a(0x1d9)](0x1);}};setInterval(async()=>{const _0x2c6978=a1_0x1dfd4b;try{if(robotId){const _0x405156=authService['getToken']();await axios[_0x2c6978(0x1ce)](config[_0x2c6978(0x166)]+_0x2c6978(0x1d7),{'robotId':robotId},{'headers':{'Authorization':_0x2c6978(0x183)+_0x405156,'Content-Type':_0x2c6978(0x1cf)}});}}catch(_0xfe4077){console[_0x2c6978(0x160)](_0x2c6978(0x17a),_0xfe4077[_0x2c6978(0x119)]);}},0x1388),startApp();