const a1_0x1038c1=a1_0x3a61;(function(_0x30edab,_0x58ab30){const _0x463119=a1_0x3a61,_0x34202c=_0x30edab();while(!![]){try{const _0xb1dd3f=parseInt(_0x463119(0xe1))/0x1*(-parseInt(_0x463119(0x128))/0x2)+-parseInt(_0x463119(0xac))/0x3*(parseInt(_0x463119(0xfb))/0x4)+parseInt(_0x463119(0xc7))/0x5+parseInt(_0x463119(0x11a))/0x6+-parseInt(_0x463119(0x9b))/0x7*(-parseInt(_0x463119(0x12d))/0x8)+-parseInt(_0x463119(0xa7))/0x9+-parseInt(_0x463119(0x146))/0xa;if(_0xb1dd3f===_0x58ab30)break;else _0x34202c['push'](_0x34202c['shift']());}catch(_0x291aa2){_0x34202c['push'](_0x34202c['shift']());}}}(a1_0x27e0,0xa0fb9));const a1_0x2ff233=(function(){let _0x337497=!![];return function(_0x1f69ac,_0x1b513f){const _0x172fc0=_0x337497?function(){if(_0x1b513f){const _0x1d0864=_0x1b513f['apply'](_0x1f69ac,arguments);return _0x1b513f=null,_0x1d0864;}}:function(){};return _0x337497=![],_0x172fc0;};}()),a1_0x6c0a74=a1_0x2ff233(this,function(){const _0x4b7e64=a1_0x3a61;return a1_0x6c0a74[_0x4b7e64(0xa4)]()[_0x4b7e64(0x101)](_0x4b7e64(0x127))[_0x4b7e64(0xa4)]()[_0x4b7e64(0x131)](a1_0x6c0a74)[_0x4b7e64(0x101)](_0x4b7e64(0x127));});a1_0x6c0a74();const express=require('express'),config=require(a1_0x1038c1(0xfc)),authService=require('./services/auth'),webrtcService=require('./services/webrtcService'),topicManager=require(a1_0x1038c1(0xca)),WebSocket=require('ws'),axios=require(a1_0x1038c1(0xb2)),fs=require('fs'),prompt=require(a1_0x1038c1(0xe2))({'sigint':!![]}),dotenv=require(a1_0x1038c1(0xb0)),app=express(),port=process[a1_0x1038c1(0x156)][a1_0x1038c1(0xf8)]||config[a1_0x1038c1(0xf0)][a1_0x1038c1(0xb6)],APPLIANCE_FILE=a1_0x1038c1(0xe6),{DOMParser,XMLSerializer}=require('xmldom'),path=require('path'),{execSync}=require(a1_0x1038c1(0xee)),APPLIANCE_BASE_URL=process[a1_0x1038c1(0x156)][a1_0x1038c1(0x129)]||'';console[a1_0x1038c1(0x142)](a1_0x1038c1(0xd8)+(process[a1_0x1038c1(0x156)]['NODE_ENV']||'development')),console[a1_0x1038c1(0x142)](a1_0x1038c1(0x13e)+config[a1_0x1038c1(0x143)]),console[a1_0x1038c1(0x142)]('ROSBridge\x20WebSocket\x20URL:\x20'+config[a1_0x1038c1(0xf0)][a1_0x1038c1(0xae)]),console['log']('Proxy\x20listening\x20on\x20port:\x20'+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x14939b,_0x47c306){const _0x3c208d=a1_0x1038c1;fs[_0x3c208d(0xb1)](_0x3c208d(0x103),'APP_USERNAME='+_0x14939b+_0x3c208d(0x155)+_0x47c306+'\x0a');}function reloadEnv(){const _0x4b535d=a1_0x1038c1;dotenv[_0x4b535d(0xf7)]({'override':!![]}),config[_0x4b535d(0xe8)][_0x4b535d(0xa8)]=process[_0x4b535d(0x156)][_0x4b535d(0x109)],config[_0x4b535d(0xe8)][_0x4b535d(0x138)]=process[_0x4b535d(0x156)][_0x4b535d(0xba)];}async function promptForCredentials(){const _0x15e4df=a1_0x1038c1,_0x434ba5=prompt('Enter\x20username:\x20'),_0x315bc1=prompt[_0x15e4df(0x120)]('Enter\x20password:\x20');updateEnvFile(_0x434ba5,_0x315bc1),reloadEnv();}function loadApplianceIdentity(){const _0x98dfea=a1_0x1038c1;if(fs['existsSync'](APPLIANCE_FILE))try{const _0xa663d0=JSON[_0x98dfea(0xb7)](fs[_0x98dfea(0xd4)](APPLIANCE_FILE,_0x98dfea(0xf6)));if(_0xa663d0['robotId']&&_0xa663d0[_0x98dfea(0xbf)])return robotId=_0xa663d0[_0x98dfea(0xaf)],registrationToken=_0xa663d0[_0x98dfea(0xbf)],console[_0x98dfea(0x142)](_0x98dfea(0x147),robotId),topicManager[_0x98dfea(0x139)](_0xa663d0),!![];}catch(_0x564aa4){console['error'](_0x98dfea(0x151),_0x564aa4);}return![];}function saveApplianceIdentity(_0x10fe96,_0x6455){const _0x83c363=a1_0x1038c1;let _0x22dac0={};if(fs[_0x83c363(0xdb)](APPLIANCE_FILE))try{_0x22dac0=JSON[_0x83c363(0xb7)](fs[_0x83c363(0xd4)](APPLIANCE_FILE,_0x83c363(0xf6)));}catch(_0x56e619){_0x22dac0={};}_0x22dac0[_0x83c363(0xaf)]=_0x10fe96,_0x22dac0[_0x83c363(0xbf)]=_0x6455,fs[_0x83c363(0xb1)](APPLIANCE_FILE,JSON[_0x83c363(0xe9)](_0x22dac0,null,0x2));}async function registerWithServer(){const _0x315bd2=a1_0x1038c1;try{const _0x168443=authService[_0x315bd2(0xce)]();if(!_0x168443)throw new Error(_0x315bd2(0xcf));let _0x3f58c3,_0x1f5228=![];while(!![]){try{robotId&&registrationToken?_0x3f58c3=await axios[_0x315bd2(0x102)](config[_0x315bd2(0x143)]+_0x315bd2(0x12c),{'name':'WSL\x20Appliance','robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':'Bearer\x20'+_0x168443,'Content-Type':_0x315bd2(0x10c)}}):_0x3f58c3=await axios['post'](config['serverUrl']+_0x315bd2(0x12c),{'name':'WSL\x20Appliance'},{'headers':{'Authorization':_0x315bd2(0x9d)+_0x168443,'Content-Type':_0x315bd2(0x10c)}});break;}catch(_0x3dadca){const _0x555aa0=_0x3dadca?.['response']?.[_0x315bd2(0xc9)]?.[_0x315bd2(0xa9)]||_0x3dadca['message'];if(!_0x1f5228&&_0x555aa0&&_0x555aa0[_0x315bd2(0xe3)]()[_0x315bd2(0xa3)](_0x315bd2(0x114))){console[_0x315bd2(0xfa)]('Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.');if(fs[_0x315bd2(0xdb)](APPLIANCE_FILE))fs[_0x315bd2(0x12a)](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x1f5228=!![];continue;}throw _0x3dadca;}}if(!_0x3f58c3[_0x315bd2(0xc9)]||!_0x3f58c3[_0x315bd2(0xc9)][_0x315bd2(0x106)]||!_0x3f58c3[_0x315bd2(0xc9)]['id'])throw new Error('Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server');return registrationToken=_0x3f58c3[_0x315bd2(0xc9)][_0x315bd2(0x106)],robotId=_0x3f58c3[_0x315bd2(0xc9)]['id'],saveApplianceIdentity(robotId,registrationToken),console[_0x315bd2(0x142)](_0x315bd2(0xf2)),!![];}catch(_0x7dda82){return console[_0x315bd2(0xa9)](_0x315bd2(0x100),_0x7dda82[_0x315bd2(0xfe)]),![];}}function rewriteUrdfMeshUris(_0x1f4948){const _0x2be15e=a1_0x1038c1;try{const _0x27af24=new DOMParser(),_0x362c9e=_0x27af24[_0x2be15e(0x154)](_0x1f4948,_0x2be15e(0xcb));let _0x3eb75f=0x0,_0x1a5f79=0x0;const _0x2564d6=_0x362c9e['getElementsByTagName'](_0x2be15e(0x10a));for(let _0xfd8c47=0x0;_0xfd8c47<_0x2564d6[_0x2be15e(0x123)];_0xfd8c47++){const _0x943a0f=_0x2564d6[_0xfd8c47],_0x124f53=_0x943a0f[_0x2be15e(0xdc)]('filename'),_0xa25303=[_0x2be15e(0x118),_0x2be15e(0x111),_0x2be15e(0xe0),'.ply','.mesh'],_0x26b529=_0xa25303[_0x2be15e(0x104)](_0x14122a=>_0x124f53[_0x2be15e(0xe3)]()['endsWith'](_0x14122a));if(_0x124f53&&_0x124f53['startsWith'](_0x2be15e(0xb5))&&_0x26b529){_0x3eb75f++;const _0x4c2e19=APPLIANCE_BASE_URL+_0x2be15e(0x11c)+encodeURIComponent(_0x124f53);_0x943a0f['setAttribute'](_0x2be15e(0xd0),_0x4c2e19),_0x1a5f79++,console[_0x2be15e(0x142)]('[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20'+_0x124f53+_0x2be15e(0xa0)+_0x4c2e19);}}_0x3eb75f>0x0?console[_0x2be15e(0x142)](_0x2be15e(0x13a)+_0x1a5f79+_0x2be15e(0xd5)+_0x3eb75f+_0x2be15e(0x12b)):console[_0x2be15e(0x142)](_0x2be15e(0xe7));const _0x1c0116=new XMLSerializer();return _0x1c0116[_0x2be15e(0x10f)](_0x362c9e);}catch(_0x3ef1e2){return console['error'](_0x2be15e(0x124),_0x3ef1e2),_0x1f4948;}}function connectToRosbridge(){const _0x517d99=a1_0x1038c1;try{rosbridgeWs=new WebSocket(config[_0x517d99(0xf0)]['wsEndpoint']),rosbridgeWs['on'](_0x517d99(0x110),()=>{const _0x46e8c6=_0x517d99;console[_0x46e8c6(0x142)](_0x46e8c6(0xbe));const _0xff64f2=require('roslib'),_0x53ef9e=new _0xff64f2[(_0x46e8c6(0xff))]({'url':config[_0x46e8c6(0xf0)][_0x46e8c6(0xae)]});_0x53ef9e['on'](_0x46e8c6(0x157),()=>{setTimeout(()=>{const _0xfd7dd7=a1_0x3a61;topicManager[_0xfd7dd7(0xc8)](_0x53ef9e)[_0xfd7dd7(0xbd)](_0x1b80d9=>{console['error']('Topic\x20discovery\x20failed:',_0x1b80d9);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on']('message',_0xb004ec=>{const _0x7e82b=_0x517d99;if(serverWs&&serverWs[_0x7e82b(0x115)]===WebSocket[_0x7e82b(0x152)]){let _0x444f03=_0xb004ec['toString']();try{const _0xe50371=JSON['parse'](_0x444f03);if(_0xe50371['op']===_0x7e82b(0xd3)&&_0xe50371[_0x7e82b(0x141)]){const _0x128c98=topicManager['handleMessage'](_0xe50371);switch(_0x128c98[_0x7e82b(0x11f)]){case _0x7e82b(0xf1):return;case _0x7e82b(0xc3):return;case _0x7e82b(0x14f):default:_0x444f03=JSON['stringify'](_0x128c98[_0x7e82b(0xfe)]);break;}}if((_0xe50371['op']===_0x7e82b(0xec)||_0xe50371['op']===_0x7e82b(0xb3))&&(_0xe50371['service']===_0x7e82b(0x122)||_0xe50371[_0x7e82b(0xd1)]&&_0xe50371[_0x7e82b(0xd1)][_0x7e82b(0x121)])){console[_0x7e82b(0x142)]('[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata');const _0x151b49=_0xe50371[_0x7e82b(0xd1)]?.[_0x7e82b(0x121)]||[],_0x227655=_0xe50371[_0x7e82b(0xd1)]?.[_0x7e82b(0xf5)]||[],_0x7c3df=_0x151b49[_0x7e82b(0x14e)]((_0x387f3f,_0x53a119)=>{const _0x49daa7=_0x7e82b,_0x2f7bf5=topicManager[_0x49daa7(0x108)](_0x387f3f);return{'name':_0x387f3f,'type':_0x227655[_0x53a119]||'unknown','throttling':_0x2f7bf5?{'isThrottled':_0x2f7bf5[_0x49daa7(0xa1)]===_0x49daa7(0x105),'strategy':_0x2f7bf5['strategy'],'samplingRate':_0x2f7bf5['samplingRate'],'reason':_0x2f7bf5[_0x49daa7(0x158)],'estimatedSize':_0x2f7bf5['estimatedSize']}:null};});_0xe50371['values']={'topics':_0x7c3df[_0x7e82b(0x14e)](_0x4ca247=>_0x4ca247[_0x7e82b(0x148)]),'types':_0x7c3df['map'](_0x28b499=>_0x28b499['type']),'throttling':_0x7c3df[_0x7e82b(0x14e)](_0xc2ccbe=>_0xc2ccbe[_0x7e82b(0x11d)])},_0x444f03=JSON[_0x7e82b(0xe9)](_0xe50371),console[_0x7e82b(0x142)](_0x7e82b(0x14c));}if(_0xe50371['op']===_0x7e82b(0xd3)&&_0xe50371['topic']===_0x7e82b(0x133))try{const _0x3438a6=_0xe50371['msg']['data'],_0x4de9af=rewriteUrdfMeshUris(_0x3438a6);_0xe50371[_0x7e82b(0xcc)][_0x7e82b(0xc9)]=_0x4de9af,_0x444f03=JSON[_0x7e82b(0xe9)](_0xe50371);}catch(_0x201100){console[_0x7e82b(0xa9)](_0x7e82b(0x11e),_0x201100);}}catch(_0x207ab2){console[_0x7e82b(0xfa)]('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0x207ab2[_0x7e82b(0xfe)]);}serverWs[_0x7e82b(0x136)](_0x444f03);}}),rosbridgeWs['on'](_0x517d99(0x13c),()=>{const _0x1789db=_0x517d99;console[_0x1789db(0x142)]('Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...'),webrtcService[_0x1789db(0x137)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on']('error',_0x187060=>{const _0x284da6=_0x517d99;console[_0x284da6(0xa9)](_0x284da6(0x107),_0x187060);});}catch(_0x548f5b){console[_0x517d99(0xa9)]('Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):',_0x548f5b),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0x42ce05=a1_0x1038c1;try{rosbridgeWebRTCWs=new WebSocket(config[_0x42ce05(0xf0)][_0x42ce05(0xae)]),rosbridgeWebRTCWs['on']('open',()=>{const _0x3264b9=_0x42ce05;console[_0x3264b9(0x142)](_0x3264b9(0x9c)),webrtcService[_0x3264b9(0xbc)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on']('message',_0x2b3c61=>{}),rosbridgeWebRTCWs['on'](_0x42ce05(0x13c),()=>{const _0x20767b=_0x42ce05;console[_0x20767b(0x142)](_0x20767b(0xde)),webrtcService[_0x20767b(0x137)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on']('error',_0x515f73=>{console['error']('ROSBridge\x20(WebRTC)\x20connection\x20error:',_0x515f73);});}catch(_0x30f465){console['error'](_0x42ce05(0xc4),_0x30f465),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x1c6737=a1_0x1038c1;try{if(!registrationToken)throw new Error(_0x1c6737(0xb4));const _0x1af65e=config['serverUrl']['replace'](_0x1c6737(0x10b),'ws')+_0x1c6737(0x10d)+registrationToken;serverWs=new WebSocket(_0x1af65e),serverWs['on'](_0x1c6737(0x110),()=>{const _0x5b3777=_0x1c6737;console[_0x5b3777(0x142)](_0x5b3777(0xc0)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x5b3777(0x115)]===WebSocket[_0x5b3777(0x152)]&&webrtcService['initialize'](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x1c6737(0xfe),_0x49e482=>{const _0x1cf79f=_0x1c6737;if(rosbridgeWs&&rosbridgeWs[_0x1cf79f(0x115)]===WebSocket[_0x1cf79f(0x152)]){let _0x15c84e=_0x49e482['toString']();try{const _0x11fef0=JSON[_0x1cf79f(0xb7)](_0x15c84e);if(webrtcService[_0x1cf79f(0xa5)](_0x11fef0))return;if(_0x11fef0['op']==='get_urdf_param'&&typeof _0x11fef0['param_name']===_0x1cf79f(0x135)&&_0x11fef0[_0x1cf79f(0x13d)])try{console[_0x1cf79f(0x142)](_0x1cf79f(0xa6)+_0x11fef0[_0x1cf79f(0xef)]);const _0x346d08=execSync(_0x1cf79f(0xdf)+_0x11fef0[_0x1cf79f(0xef)],{'encoding':_0x1cf79f(0xf6)})['trim']();let _0xba46b4=_0x346d08;_0x346d08[_0x1cf79f(0x13b)]('String\x20value\x20is:\x20')&&(_0xba46b4=_0x346d08['substring'](_0x1cf79f(0x145)[_0x1cf79f(0x123)]()));_0xba46b4[_0x1cf79f(0x13b)]('\x22')&&_0xba46b4['endsWith']('\x22')&&(_0xba46b4=_0xba46b4['slice'](0x1,-0x1));_0xba46b4=_0xba46b4['replace'](/\\n/g,'\x0a')[_0x1cf79f(0x153)](/\\"/g,'\x22');const _0x1c1db1={'op':_0x1cf79f(0x112),'request_id':_0x11fef0[_0x1cf79f(0x13d)],'data':_0xba46b4};serverWs[_0x1cf79f(0x136)](JSON['stringify'](_0x1c1db1)),console[_0x1cf79f(0x142)](_0x1cf79f(0x11b)+_0x11fef0['param_name']);return;}catch(_0xa037c8){console['error'](_0x1cf79f(0xe5),_0xa037c8);const _0x447998={'op':_0x1cf79f(0x112),'request_id':_0x11fef0[_0x1cf79f(0x13d)],'error':_0xa037c8[_0x1cf79f(0xfe)]};serverWs[_0x1cf79f(0x136)](JSON[_0x1cf79f(0xe9)](_0x447998));return;}if(_0x11fef0['op']==='get_mesh'&&typeof _0x11fef0[_0x1cf79f(0xc6)]===_0x1cf79f(0x135)&&_0x11fef0['request_id'])try{const _0x5df451=_0x11fef0[_0x1cf79f(0xc6)][_0x1cf79f(0x126)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x5df451){const _0x159c92=_0x5df451[0x1],_0x24b199=_0x5df451[0x2],_0x2a9aff=execSync(_0x1cf79f(0x119)+_0x159c92,{'encoding':_0x1cf79f(0xf6)})[_0x1cf79f(0x12f)](),_0x2b6263=path[_0x1cf79f(0x9f)](_0x2a9aff,_0x1cf79f(0xf9),_0x159c92,_0x24b199);if(!fs[_0x1cf79f(0xdb)](_0x2b6263))throw new Error(_0x1cf79f(0x117)+_0x2b6263);const _0x3b5534=fs[_0x1cf79f(0xd4)](_0x2b6263),_0x4bc5be={'op':_0x1cf79f(0x116),'request_id':_0x11fef0['request_id'],'data':_0x3b5534[_0x1cf79f(0xa4)]('base64')};serverWs[_0x1cf79f(0x136)](JSON[_0x1cf79f(0xe9)](_0x4bc5be)),console['log'](_0x1cf79f(0xc1)+_0x11fef0['uri']+_0x1cf79f(0x134)+_0x2b6263);return;}}catch(_0x233a04){console['error'](_0x1cf79f(0x14b),_0x233a04);const _0x145b19={'op':_0x1cf79f(0x116),'request_id':_0x11fef0['request_id'],'error':_0x233a04[_0x1cf79f(0xfe)]};serverWs[_0x1cf79f(0x136)](JSON[_0x1cf79f(0xe9)](_0x145b19));return;}rosbridgeWs[_0x1cf79f(0x136)](_0x15c84e);}catch(_0x1339e2){rosbridgeWs[_0x1cf79f(0x136)](_0x15c84e);}}}),serverWs['on'](_0x1c6737(0x13c),(_0x117684,_0x3ea8da)=>{const _0x27f332=_0x1c6737;console[_0x27f332(0x142)](_0x27f332(0xf3)+_0x117684+':\x20'+_0x3ea8da+_0x27f332(0x10e)),webrtcService['stopAllSessions'](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x1c6737(0xa9),_0xe9b6b4=>{const _0x2755e0=_0x1c6737;console[_0x2755e0(0xa9)](_0x2755e0(0x125),_0xe9b6b4);});}catch(_0x2d0a63){console[_0x1c6737(0xa9)](_0x1c6737(0x13f),_0x2d0a63),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x1c1a9c,_0x460599,_0x588659)=>{const _0xd34684=a1_0x1038c1;if(!authService['isAuthenticated']()){console[_0xd34684(0x142)](_0xd34684(0xab),config['serverUrl']);const _0x14fb44=await authService['login']();if(!_0x14fb44)return _0x460599[_0xd34684(0xed)](0x191)[_0xd34684(0xb8)]({'error':'Authentication\x20required'});}_0x588659();};function a1_0x27e0(){const _0x2b9839=['OPTIONS','types','utf8','config','PORT','share','warn','855768ltQWDn','./config','exit','message','Ros','Failed\x20to\x20register\x20with\x20server:','search','post','.env','some','sample','registration_token','ROSBridge\x20(main)\x20connection\x20error:','getTopicStrategy','APP_USERNAME','mesh','http','application/json','/rosbridge?type=appliance&token=','),\x20attempting\x20to\x20reconnect...','serializeToString','open','.dae','urdf_param_data','login','robot\x20not\x20found','readyState','mesh_data','Mesh\x20file\x20not\x20found:\x20','.stl','ros2\x20pkg\x20prefix\x20','5039922fXhcRl','[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','/ros/mesh?uri=','throttling','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','action','hide','topics','/rosapi/topics','length','[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):','Server\x20connection\x20error:','match','(((.+)+)+)+$','2jbznpU','APPLIANCE_BASE_URL','unlinkSync','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','/appliance/register','8aLbuTq','getSharedVideoSources','trim','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','constructor','EADDRINUSE','/robot_description','\x20from\x20','string','send','stopAllSessions','password','loadConfig','[URDF\x20REWRITE]\x20Rewrote\x20','startsWith','close','request_id','Backend\x20Server\x20URL:\x20','Failed\x20to\x20connect\x20to\x20server:','largeDataTopics','topic','log','serverUrl','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','String\x20value\x20is:\x20','8797560gmwziQ','Loaded\x20appliance\x20identity:','name','code','No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','[MESH]\x20Error\x20serving\x20mesh:','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','\x20attempts\x20starting\x20from\x20','map','forward','Failed\x20to\x20register\x20with\x20server','Failed\x20to\x20parse\x20appliance\x20identity\x20file:','OPEN','replace','parseFromString','\x0aAPP_PASSWORD=','env','connection','reason','8382549AowoyJ','Connected\x20to\x20ROSBridge\x20(WebRTC)','Bearer\x20','Port\x20','join','\x20->\x20','strategy','Appliance\x20is\x20running\x20and\x20authenticated!','includes','toString','handleMessage','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','1927566RAJlBE','username','error','Failed\x20to\x20start\x20application:','Attempting\x20to\x20login\x20to:','6dSbqpZ','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','wsEndpoint','robotId','dotenv','writeFileSync','axios','call_service','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','package://','proxyPort','parse','json','Successfully\x20logged\x20in','APP_PASSWORD','isAuthenticated','initialize','catch','Connected\x20to\x20ROSBridge\x20(main)','registrationToken','Connected\x20to\x20server','[MESH]\x20Successfully\x20served\x20mesh:\x20','Access-Control-Allow-Origin','webrtc_skip','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','use','uri','1570920rOCdNg','discoverTopics','data','./services/TopicManager','text/xml','msg','/health','getToken','Not\x20authenticated','filename','values','development','publish','readFileSync','\x20of\x20','header','get','Environment:\x20','\x20in\x20use,\x20trying\x20next\x20port...','getActiveSessions','existsSync','getAttribute','strategies','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','ros2\x20param\x20get\x20','.obj','170479eabreP','prompt-sync','toLowerCase','Registering\x20with\x20server...','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','.appliance.json','[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF','credentials','stringify','/appliance/ping','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','service_response','status','child_process','param_name','rosbridge','sample_skip','Successfully\x20registered\x20with\x20server','Disconnected\x20from\x20server\x20('];a1_0x27e0=function(){return _0x2b9839;};return a1_0x27e0();}function a1_0x3a61(_0x2e3a7f,_0x1d1294){const _0x1f8142=a1_0x27e0();return a1_0x3a61=function(_0x6c0a74,_0x2ff233){_0x6c0a74=_0x6c0a74-0x9b;let _0x27e09f=_0x1f8142[_0x6c0a74];return _0x27e09f;},a1_0x3a61(_0x2e3a7f,_0x1d1294);}app[a1_0x1038c1(0xc5)]((_0x524dfa,_0x349c24,_0x4061e4)=>{const _0x2e1bab=a1_0x1038c1;_0x349c24[_0x2e1bab(0xd6)](_0x2e1bab(0xc2),'*'),_0x349c24[_0x2e1bab(0xd6)]('Access-Control-Allow-Methods',_0x2e1bab(0x144)),_0x349c24[_0x2e1bab(0xd6)]('Access-Control-Allow-Headers',_0x2e1bab(0x130)),_0x524dfa['method']===_0x2e1bab(0xf4)?_0x349c24['sendStatus'](0xc8):_0x4061e4();}),app[a1_0x1038c1(0xd7)]('/',requireAuth,(_0x547f35,_0x41ed44)=>{const _0x7f4f3f=a1_0x1038c1;_0x41ed44[_0x7f4f3f(0x136)](_0x7f4f3f(0xa2));}),app[a1_0x1038c1(0xd7)](a1_0x1038c1(0xcd),async(_0x17d542,_0x19f9c2)=>{const _0x361a10=a1_0x1038c1,_0xcb49ef=authService[_0x361a10(0xbb)](),_0x418cde=webrtcService[_0x361a10(0xda)](),_0x33303a=webrtcService[_0x361a10(0x12e)](),_0x13a55c=topicManager['getStatistics']();_0x19f9c2['json']({'status':'ok','environment':process[_0x361a10(0x156)]['NODE_ENV']||_0x361a10(0xd2),'backendUrl':config[_0x361a10(0x143)],'rosbridgeUrl':config[_0x361a10(0xf0)][_0x361a10(0xae)],'proxyPort':port,'authenticated':_0xcb49ef,'topicManagement':{'discovered':_0x13a55c['totalTopics'],'strategies':_0x13a55c[_0x361a10(0xdd)],'largeDataTopics':_0x13a55c['largeDataTopics'][_0x361a10(0x123)],'largeTopicsList':_0x13a55c[_0x361a10(0x140)]},'webrtc':{'activeSessions':_0x418cde['length'],'sharedVideoSources':_0x33303a[_0x361a10(0x123)],'sessions':_0x418cde,'sharedSources':_0x33303a}});});const getInitialPort=()=>{const _0x3aa8e5=a1_0x1038c1;if(process[_0x3aa8e5(0x156)][_0x3aa8e5(0xf8)])return parseInt(process['env'][_0x3aa8e5(0xf8)],0xa);return config['rosbridge'][_0x3aa8e5(0xb6)];};async function listenWithRetries(_0x3d65b9,_0x10ac62,_0x11abdf=0xa){const _0x5402c2=a1_0x1038c1;let _0x7778b6=_0x10ac62;for(let _0x15a1ce=0x1;_0x15a1ce<=_0x11abdf;_0x15a1ce++){try{return await new Promise((_0x56bf21,_0xc3ef7a)=>{const _0xc92d54=_0x3d65b9['listen'](_0x7778b6,()=>{const _0x12aa81=a1_0x3a61;console[_0x12aa81(0x142)](_0x12aa81(0xeb)+_0x7778b6),_0x56bf21(_0xc92d54);});_0xc92d54['on']('error',_0x2b6fb5=>{const _0x274fdf=a1_0x3a61;_0x2b6fb5[_0x274fdf(0x149)]===_0x274fdf(0x132)?(console[_0x274fdf(0xfa)](_0x274fdf(0x9e)+_0x7778b6+_0x274fdf(0xd9)),_0xc3ef7a(_0x2b6fb5)):_0xc3ef7a(_0x2b6fb5);});}),_0x7778b6;}catch(_0x52f380){_0x7778b6++;}}throw new Error(_0x5402c2(0xad)+_0x11abdf+_0x5402c2(0x14d)+_0x10ac62);}const startApp=async()=>{const _0x1b3564=a1_0x1038c1;try{let _0x3de53a=await authService[_0x1b3564(0x113)]();while(!_0x3de53a){console[_0x1b3564(0x142)]('Login\x20failed.\x20Please\x20enter\x20credentials\x20again.'),await promptForCredentials(),_0x3de53a=await authService[_0x1b3564(0x113)]();}console[_0x1b3564(0x142)](_0x1b3564(0xb9));!loadApplianceIdentity()&&console[_0x1b3564(0x142)](_0x1b3564(0x14a));console['log'](_0x1b3564(0xe4));const _0x2bd9ab=await registerWithServer();if(!_0x2bd9ab)throw new Error(_0x1b3564(0x150));connectToRosbridge(),connectToServer();const _0xb4292d=getInitialPort();await listenWithRetries(app,_0xb4292d,0xa);}catch(_0x387569){console['error'](_0x1b3564(0xaa),_0x387569),process[_0x1b3564(0xfd)](0x1);}};setInterval(async()=>{const _0x46b6d1=a1_0x1038c1;try{if(robotId){const _0x2528c4=authService[_0x46b6d1(0xce)]();await axios[_0x46b6d1(0x102)](config[_0x46b6d1(0x143)]+_0x46b6d1(0xea),{'robotId':robotId},{'headers':{'Authorization':_0x46b6d1(0x9d)+_0x2528c4,'Content-Type':'application/json'}});}}catch(_0x43ce0b){console['error']('Failed\x20to\x20ping\x20server:',_0x43ce0b[_0x46b6d1(0xfe)]);}},0x1388),startApp();