const a1_0x20ca4f=a1_0x227b;(function(_0x3bcc36,_0x30aff6){const _0x4cf394=a1_0x227b,_0x487d41=_0x3bcc36();while(!![]){try{const _0x3daa8e=parseInt(_0x4cf394(0x1ca))/0x1*(parseInt(_0x4cf394(0x160))/0x2)+parseInt(_0x4cf394(0x1d5))/0x3+parseInt(_0x4cf394(0x194))/0x4*(-parseInt(_0x4cf394(0x170))/0x5)+parseInt(_0x4cf394(0x1dc))/0x6+-parseInt(_0x4cf394(0x163))/0x7+parseInt(_0x4cf394(0x1b8))/0x8+parseInt(_0x4cf394(0x1e2))/0x9*(parseInt(_0x4cf394(0x1e6))/0xa);if(_0x3daa8e===_0x30aff6)break;else _0x487d41['push'](_0x487d41['shift']());}catch(_0x45257e){_0x487d41['push'](_0x487d41['shift']());}}}(a1_0x4020,0x7e730));function a1_0x4020(){const _0x595ae7=['90LjhSRM','log','readyState','serializeToString','Access-Control-Allow-Headers','Port\x20','APP_PASSWORD','serverUrl','getToken','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','writeFileSync','filename','./config','\x20from\x20','response','string','reason','/appliance/register','env','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','getTopicStrategy','EADDRINUSE','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','Topic\x20discovery\x20failed:','values','Registering\x20with\x20server...','Attempting\x20to\x20login\x20to:','loadConfig','credentials','.obj','strategy','Environment:\x20','length','search','startsWith','Failed\x20to\x20parse\x20appliance\x20identity\x20file:','[MESH]\x20Successfully\x20served\x20mesh:\x20','xmldom','Backend\x20Server\x20URL:\x20','initialize','/appliance/ping','endsWith','(((.+)+)+)+$','warn','OPTIONS','open','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','config','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','includes','rosbridge','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','use','robotId','unknown','readFileSync','Not\x20authenticated','Access-Control-Allow-Origin','service','get','\x20in\x20use,\x20trying\x20next\x20port...','utf8','ROSBridge\x20WebSocket\x20URL:\x20','getSharedVideoSources','1006132TqdYjw','request_id','.dae','2606653FKDGLj','strategies','Loaded\x20appliance\x20identity:','WSL\x20Appliance','code','largeDataTopics','estimatedSize','uri','registrationToken','send','slice','ROSBridge\x20(WebRTC)\x20connection\x20error:','Proxy\x20listening\x20on\x20port:\x20','1546235kZMtbY','\x20->\x20','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','topics','Connected\x20to\x20ROSBridge\x20(WebRTC)','share','/health','Bearer\x20','password','Failed\x20to\x20start\x20application:','existsSync','\x0aAPP_PASSWORD=','ros2\x20pkg\x20prefix\x20','sample_skip','isAuthenticated','header','param_name','),\x20attempting\x20to\x20reconnect...','match','post','text/xml','ros2\x20param\x20get\x20','totalTopics','\x20of\x20','ROSBridge\x20(main)\x20connection\x20error:','exit','PORT','replace','[MESH]\x20Error\x20serving\x20mesh:','json','APP_USERNAME=','express','topic','username','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','login','8dQugOG','connection','throttling','Login\x20failed.\x20Please\x20enter\x20credentials\x20again.','Authentication\x20required','[URDF\x20REWRITE]\x20Rewrote\x20','types','close','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','method','msg','Failed\x20to\x20connect\x20to\x20server:','toLowerCase','String\x20value\x20is:\x20','message','path','forward','publish','catch','join','application/json','name','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','registration_token','Access-Control-Allow-Methods','action','[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:','Enter\x20password:\x20','urdf_param_data','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','discoverTopics','hide','constructor','base64','status','339912sjRWak','[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20','sample','mesh_data','getAttribute','[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','data','/ros/mesh?uri=','trim','toString','APP_USERNAME','./services/TopicManager','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','get_urdf_param','child_process','http','handleMessage','1ZYsjBw','.env','getElementsByTagName','error','type','.stl','.ply','getStatistics','Ros','Successfully\x20logged\x20in','NODE_ENV','1620702EvwWvf','wsEndpoint','substring','[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):','Mesh\x20file\x20not\x20found:\x20','/rosapi/topics','stopAllSessions','1516926mspoii','APPLIANCE_BASE_URL','map','parse','stringify','listen','170199kIaLvM','.mesh','OPEN','parseFromString'];a1_0x4020=function(){return _0x595ae7;};return a1_0x4020();}const a1_0x1c0bbb=(function(){let _0x573020=!![];return function(_0x58863e,_0x27259f){const _0x179156=_0x573020?function(){if(_0x27259f){const _0x253726=_0x27259f['apply'](_0x58863e,arguments);return _0x27259f=null,_0x253726;}}:function(){};return _0x573020=![],_0x179156;};}()),a1_0x1a4f23=a1_0x1c0bbb(this,function(){const _0x5dd4cb=a1_0x227b;return a1_0x1a4f23['toString']()[_0x5dd4cb(0x207)](_0x5dd4cb(0x210))[_0x5dd4cb(0x1c2)]()[_0x5dd4cb(0x1b5)](a1_0x1a4f23)['search'](_0x5dd4cb(0x210));});a1_0x1a4f23();const express=require(a1_0x20ca4f(0x18f)),config=require(a1_0x20ca4f(0x1f2)),authService=require('./services/auth'),webrtcService=require('./services/webrtcService'),topicManager=require(a1_0x20ca4f(0x1c4)),WebSocket=require('ws'),axios=require('axios'),fs=require('fs'),prompt=require('prompt-sync')({'sigint':!![]}),dotenv=require('dotenv'),app=express(),port=process[a1_0x20ca4f(0x1f8)][a1_0x20ca4f(0x18a)]||config[a1_0x20ca4f(0x219)]['proxyPort'],APPLIANCE_FILE='.appliance.json',{DOMParser,XMLSerializer}=require(a1_0x20ca4f(0x20b)),path=require(a1_0x20ca4f(0x1a3)),{execSync}=require(a1_0x20ca4f(0x1c7)),APPLIANCE_BASE_URL=process[a1_0x20ca4f(0x1f8)][a1_0x20ca4f(0x1dd)]||'';console[a1_0x20ca4f(0x1e7)](a1_0x20ca4f(0x205)+(process[a1_0x20ca4f(0x1f8)]['NODE_ENV']||'development')),console[a1_0x20ca4f(0x1e7)](a1_0x20ca4f(0x20c)+config[a1_0x20ca4f(0x1ed)]),console['log'](a1_0x20ca4f(0x15e)+config['rosbridge'][a1_0x20ca4f(0x1d6)]),console['log'](a1_0x20ca4f(0x16f)+port);function a1_0x227b(_0x204829,_0x286a62){const _0x1397c2=a1_0x4020();return a1_0x227b=function(_0x1a4f23,_0x1c0bbb){_0x1a4f23=_0x1a4f23-0x158;let _0x4020a3=_0x1397c2[_0x1a4f23];return _0x4020a3;},a1_0x227b(_0x204829,_0x286a62);}let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x42439b,_0x48cf99){const _0x210958=a1_0x20ca4f;fs['writeFileSync'](_0x210958(0x1cb),_0x210958(0x18e)+_0x42439b+_0x210958(0x17b)+_0x48cf99+'\x0a');}function reloadEnv(){const _0x482a66=a1_0x20ca4f;dotenv[_0x482a66(0x216)]({'override':!![]}),config[_0x482a66(0x202)][_0x482a66(0x191)]=process[_0x482a66(0x1f8)][_0x482a66(0x1c3)],config[_0x482a66(0x202)][_0x482a66(0x178)]=process[_0x482a66(0x1f8)][_0x482a66(0x1ec)];}async function promptForCredentials(){const _0x3e66d1=a1_0x20ca4f,_0x190337=prompt('Enter\x20username:\x20'),_0x489e46=prompt[_0x3e66d1(0x1b4)](_0x3e66d1(0x1b0));updateEnvFile(_0x190337,_0x489e46),reloadEnv();}function loadApplianceIdentity(){const _0x9874e1=a1_0x20ca4f;if(fs['existsSync'](APPLIANCE_FILE))try{const _0x3abdee=JSON['parse'](fs['readFileSync'](APPLIANCE_FILE,_0x9874e1(0x15d)));if(_0x3abdee[_0x9874e1(0x21c)]&&_0x3abdee[_0x9874e1(0x16b)])return robotId=_0x3abdee[_0x9874e1(0x21c)],registrationToken=_0x3abdee[_0x9874e1(0x16b)],console[_0x9874e1(0x1e7)](_0x9874e1(0x165),robotId),topicManager[_0x9874e1(0x201)](_0x3abdee),!![];}catch(_0x1a3798){console[_0x9874e1(0x1cd)](_0x9874e1(0x209),_0x1a3798);}return![];}function saveApplianceIdentity(_0x1a5bcf,_0x8756ae){const _0x53659d=a1_0x20ca4f;let _0x52e93c={};if(fs[_0x53659d(0x17a)](APPLIANCE_FILE))try{_0x52e93c=JSON[_0x53659d(0x1df)](fs[_0x53659d(0x21e)](APPLIANCE_FILE,'utf8'));}catch(_0x2f639d){_0x52e93c={};}_0x52e93c[_0x53659d(0x21c)]=_0x1a5bcf,_0x52e93c['registrationToken']=_0x8756ae,fs[_0x53659d(0x1f0)](APPLIANCE_FILE,JSON[_0x53659d(0x1e0)](_0x52e93c,null,0x2));}async function registerWithServer(){const _0x382c2d=a1_0x20ca4f;try{const _0x132f36=authService[_0x382c2d(0x1ee)]();if(!_0x132f36)throw new Error(_0x382c2d(0x158));let _0x269879,_0x297dba=![];while(!![]){try{robotId&&registrationToken?_0x269879=await axios[_0x382c2d(0x183)](config[_0x382c2d(0x1ed)]+_0x382c2d(0x1f7),{'name':_0x382c2d(0x166),'robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':_0x382c2d(0x177)+_0x132f36,'Content-Type':_0x382c2d(0x1a8)}}):_0x269879=await axios['post'](config[_0x382c2d(0x1ed)]+_0x382c2d(0x1f7),{'name':_0x382c2d(0x166)},{'headers':{'Authorization':_0x382c2d(0x177)+_0x132f36,'Content-Type':'application/json'}});break;}catch(_0x54bdcc){const _0x4d4fa4=_0x54bdcc?.[_0x382c2d(0x1f4)]?.['data']?.[_0x382c2d(0x1cd)]||_0x54bdcc['message'];if(!_0x297dba&&_0x4d4fa4&&_0x4d4fa4[_0x382c2d(0x1a0)]()[_0x382c2d(0x218)]('robot\x20not\x20found')){console[_0x382c2d(0x211)](_0x382c2d(0x1f9));if(fs[_0x382c2d(0x17a)](APPLIANCE_FILE))fs['unlinkSync'](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x297dba=!![];continue;}throw _0x54bdcc;}}if(!_0x269879[_0x382c2d(0x1bf)]||!_0x269879[_0x382c2d(0x1bf)][_0x382c2d(0x1ac)]||!_0x269879[_0x382c2d(0x1bf)]['id'])throw new Error(_0x382c2d(0x1c5));return registrationToken=_0x269879[_0x382c2d(0x1bf)][_0x382c2d(0x1ac)],robotId=_0x269879[_0x382c2d(0x1bf)]['id'],saveApplianceIdentity(robotId,registrationToken),console['log']('Successfully\x20registered\x20with\x20server'),!![];}catch(_0x4d3454){return console[_0x382c2d(0x1cd)]('Failed\x20to\x20register\x20with\x20server:',_0x4d3454[_0x382c2d(0x1a2)]),![];}}function rewriteUrdfMeshUris(_0x19e753){const _0x520dae=a1_0x20ca4f;try{const _0x358d3e=new DOMParser(),_0x31b479=_0x358d3e[_0x520dae(0x1e5)](_0x19e753,_0x520dae(0x184));let _0x47db05=0x0,_0x467253=0x0;const _0x3d8b8f=_0x31b479[_0x520dae(0x1cc)]('mesh');for(let _0x56d68f=0x0;_0x56d68f<_0x3d8b8f[_0x520dae(0x206)];_0x56d68f++){const _0x225600=_0x3d8b8f[_0x56d68f],_0x37cf0b=_0x225600[_0x520dae(0x1bc)](_0x520dae(0x1f1)),_0x20ce74=[_0x520dae(0x1cf),_0x520dae(0x162),_0x520dae(0x203),_0x520dae(0x1d0),_0x520dae(0x1e3)],_0x512686=_0x20ce74['some'](_0x202635=>_0x37cf0b['toLowerCase']()[_0x520dae(0x20f)](_0x202635));if(_0x37cf0b&&_0x37cf0b[_0x520dae(0x208)]('package://')&&_0x512686){_0x47db05++;const _0x2fd447=APPLIANCE_BASE_URL+_0x520dae(0x1c0)+encodeURIComponent(_0x37cf0b);_0x225600['setAttribute'](_0x520dae(0x1f1),_0x2fd447),_0x467253++,console['log'](_0x520dae(0x1b9)+_0x37cf0b+_0x520dae(0x171)+_0x2fd447);}}_0x47db05>0x0?console[_0x520dae(0x1e7)](_0x520dae(0x199)+_0x467253+_0x520dae(0x187)+_0x47db05+_0x520dae(0x172)):console[_0x520dae(0x1e7)]('[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF');const _0x3aa8c4=new XMLSerializer();return _0x3aa8c4[_0x520dae(0x1e9)](_0x31b479);}catch(_0x1c46fb){return console[_0x520dae(0x1cd)](_0x520dae(0x1d8),_0x1c46fb),_0x19e753;}}function connectToRosbridge(){const _0x369737=a1_0x20ca4f;try{rosbridgeWs=new WebSocket(config[_0x369737(0x219)][_0x369737(0x1d6)]),rosbridgeWs['on']('open',()=>{const _0x3bf652=_0x369737;console[_0x3bf652(0x1e7)]('Connected\x20to\x20ROSBridge\x20(main)');const _0x11266a=require('roslib'),_0x546db4=new _0x11266a[(_0x3bf652(0x1d2))]({'url':config[_0x3bf652(0x219)]['wsEndpoint']});_0x546db4['on'](_0x3bf652(0x195),()=>{setTimeout(()=>{const _0x1a5ed3=a1_0x227b;topicManager[_0x1a5ed3(0x1b3)](_0x546db4)[_0x1a5ed3(0x1a6)](_0xe7db37=>{const _0x1b0dc9=_0x1a5ed3;console[_0x1b0dc9(0x1cd)](_0x1b0dc9(0x1fd),_0xe7db37);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on']('message',_0x10c171=>{const _0x2c11c8=_0x369737;if(serverWs&&serverWs[_0x2c11c8(0x1e8)]===WebSocket[_0x2c11c8(0x1e4)]){let _0x4cd024=_0x10c171[_0x2c11c8(0x1c2)]();try{const _0x2b8b5f=JSON[_0x2c11c8(0x1df)](_0x4cd024);if(_0x2b8b5f['op']===_0x2c11c8(0x1a5)&&_0x2b8b5f[_0x2c11c8(0x190)]){const _0x4ce78f=topicManager[_0x2c11c8(0x1c9)](_0x2b8b5f);switch(_0x4ce78f[_0x2c11c8(0x1ae)]){case _0x2c11c8(0x17d):return;case'webrtc_skip':return;case _0x2c11c8(0x1a4):default:_0x4cd024=JSON[_0x2c11c8(0x1e0)](_0x4ce78f[_0x2c11c8(0x1a2)]);break;}}if((_0x2b8b5f['op']==='service_response'||_0x2b8b5f['op']==='call_service')&&(_0x2b8b5f[_0x2c11c8(0x15a)]===_0x2c11c8(0x1da)||_0x2b8b5f['values']&&_0x2b8b5f['values'][_0x2c11c8(0x173)])){console['log'](_0x2c11c8(0x214));const _0x51d59f=_0x2b8b5f[_0x2c11c8(0x1fe)]?.['topics']||[],_0x54238c=_0x2b8b5f[_0x2c11c8(0x1fe)]?.[_0x2c11c8(0x19a)]||[],_0x67be7f=_0x51d59f[_0x2c11c8(0x1de)]((_0x435683,_0x6ebac0)=>{const _0x1fbe08=_0x2c11c8,_0x461090=topicManager[_0x1fbe08(0x1fa)](_0x435683);return{'name':_0x435683,'type':_0x54238c[_0x6ebac0]||_0x1fbe08(0x21d),'throttling':_0x461090?{'isThrottled':_0x461090[_0x1fbe08(0x204)]===_0x1fbe08(0x1ba),'strategy':_0x461090['strategy'],'samplingRate':_0x461090['samplingRate'],'reason':_0x461090[_0x1fbe08(0x1f6)],'estimatedSize':_0x461090[_0x1fbe08(0x169)]}:null};});_0x2b8b5f['values']={'topics':_0x67be7f[_0x2c11c8(0x1de)](_0x2eff6e=>_0x2eff6e[_0x2c11c8(0x1a9)]),'types':_0x67be7f['map'](_0x335857=>_0x335857[_0x2c11c8(0x1ce)]),'throttling':_0x67be7f[_0x2c11c8(0x1de)](_0x10232b=>_0x10232b[_0x2c11c8(0x196)])},_0x4cd024=JSON[_0x2c11c8(0x1e0)](_0x2b8b5f),console['log'](_0x2c11c8(0x1b2));}if(_0x2b8b5f['op']===_0x2c11c8(0x1a5)&&_0x2b8b5f[_0x2c11c8(0x190)]==='/robot_description')try{const _0x1f19d7=_0x2b8b5f['msg'][_0x2c11c8(0x1bf)],_0x1ccb5d=rewriteUrdfMeshUris(_0x1f19d7);_0x2b8b5f[_0x2c11c8(0x19e)][_0x2c11c8(0x1bf)]=_0x1ccb5d,_0x4cd024=JSON[_0x2c11c8(0x1e0)](_0x2b8b5f);}catch(_0xb0b481){console[_0x2c11c8(0x1cd)](_0x2c11c8(0x19c),_0xb0b481);}}catch(_0x44b88c){console[_0x2c11c8(0x211)](_0x2c11c8(0x1af),_0x44b88c[_0x2c11c8(0x1a2)]);}serverWs[_0x2c11c8(0x16c)](_0x4cd024);}}),rosbridgeWs['on'](_0x369737(0x19b),()=>{const _0x526a3a=_0x369737;console[_0x526a3a(0x1e7)](_0x526a3a(0x21a)),webrtcService['stopAllSessions'](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on']('error',_0x321a99=>{const _0x540fbf=_0x369737;console[_0x540fbf(0x1cd)](_0x540fbf(0x188),_0x321a99);});}catch(_0x11f9a5){console[_0x369737(0x1cd)](_0x369737(0x215),_0x11f9a5),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0x3bf7d0=a1_0x20ca4f;try{rosbridgeWebRTCWs=new WebSocket(config[_0x3bf7d0(0x219)]['wsEndpoint']),rosbridgeWebRTCWs['on'](_0x3bf7d0(0x213),()=>{const _0x3bdd22=_0x3bf7d0;console[_0x3bdd22(0x1e7)](_0x3bdd22(0x174)),webrtcService[_0x3bdd22(0x20d)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on']('message',_0x4476f1=>{}),rosbridgeWebRTCWs['on'](_0x3bf7d0(0x19b),()=>{const _0x1a4da7=_0x3bf7d0;console[_0x1a4da7(0x1e7)](_0x1a4da7(0x192)),webrtcService['stopAllSessions'](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0x3bf7d0(0x1cd),_0x212435=>{const _0x5bc613=_0x3bf7d0;console['error'](_0x5bc613(0x16e),_0x212435);});}catch(_0x3ea3f6){console['error']('Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):',_0x3ea3f6),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x765313=a1_0x20ca4f;try{if(!registrationToken)throw new Error(_0x765313(0x1fc));const _0x2db6f5=config[_0x765313(0x1ed)]['replace'](_0x765313(0x1c8),'ws')+'/rosbridge?type=appliance&token='+registrationToken;serverWs=new WebSocket(_0x2db6f5),serverWs['on'](_0x765313(0x213),()=>{const _0x174365=_0x765313;console[_0x174365(0x1e7)]('Connected\x20to\x20server'),rosbridgeWebRTCWs&&rosbridgeWebRTCWs['readyState']===WebSocket[_0x174365(0x1e4)]&&webrtcService[_0x174365(0x20d)](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x765313(0x1a2),_0x3a19b5=>{const _0x4aa1ea=_0x765313;if(rosbridgeWs&&rosbridgeWs[_0x4aa1ea(0x1e8)]===WebSocket['OPEN']){let _0x2c6b97=_0x3a19b5[_0x4aa1ea(0x1c2)]();try{const _0x27fce2=JSON[_0x4aa1ea(0x1df)](_0x2c6b97);if(webrtcService['handleMessage'](_0x27fce2))return;if(_0x27fce2['op']===_0x4aa1ea(0x1c6)&&typeof _0x27fce2['param_name']===_0x4aa1ea(0x1f5)&&_0x27fce2[_0x4aa1ea(0x161)])try{console[_0x4aa1ea(0x1e7)]('[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20'+_0x27fce2[_0x4aa1ea(0x180)]);const _0x28b3b4=execSync(_0x4aa1ea(0x185)+_0x27fce2[_0x4aa1ea(0x180)],{'encoding':_0x4aa1ea(0x15d)})[_0x4aa1ea(0x1c1)]();let _0x42b777=_0x28b3b4;_0x28b3b4['startsWith'](_0x4aa1ea(0x1a1))&&(_0x42b777=_0x28b3b4[_0x4aa1ea(0x1d7)](_0x4aa1ea(0x1a1)[_0x4aa1ea(0x206)]()));_0x42b777['startsWith']('\x22')&&_0x42b777['endsWith']('\x22')&&(_0x42b777=_0x42b777[_0x4aa1ea(0x16d)](0x1,-0x1));_0x42b777=_0x42b777[_0x4aa1ea(0x18b)](/\\n/g,'\x0a')[_0x4aa1ea(0x18b)](/\\"/g,'\x22');const _0xb03646={'op':'urdf_param_data','request_id':_0x27fce2['request_id'],'data':_0x42b777};serverWs[_0x4aa1ea(0x16c)](JSON[_0x4aa1ea(0x1e0)](_0xb03646)),console[_0x4aa1ea(0x1e7)](_0x4aa1ea(0x1bd)+_0x27fce2[_0x4aa1ea(0x180)]);return;}catch(_0x1478ec){console[_0x4aa1ea(0x1cd)](_0x4aa1ea(0x1aa),_0x1478ec);const _0x417b65={'op':_0x4aa1ea(0x1b1),'request_id':_0x27fce2[_0x4aa1ea(0x161)],'error':_0x1478ec['message']};serverWs[_0x4aa1ea(0x16c)](JSON['stringify'](_0x417b65));return;}if(_0x27fce2['op']==='get_mesh'&&typeof _0x27fce2[_0x4aa1ea(0x16a)]==='string'&&_0x27fce2[_0x4aa1ea(0x161)])try{const _0x620e7e=_0x27fce2[_0x4aa1ea(0x16a)][_0x4aa1ea(0x182)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x620e7e){const _0x2f8f72=_0x620e7e[0x1],_0x107f6f=_0x620e7e[0x2],_0xb0b5f4=execSync(_0x4aa1ea(0x17c)+_0x2f8f72,{'encoding':_0x4aa1ea(0x15d)})[_0x4aa1ea(0x1c1)](),_0x27d3d0=path[_0x4aa1ea(0x1a7)](_0xb0b5f4,_0x4aa1ea(0x175),_0x2f8f72,_0x107f6f);if(!fs[_0x4aa1ea(0x17a)](_0x27d3d0))throw new Error(_0x4aa1ea(0x1d9)+_0x27d3d0);const _0x5b23dc=fs[_0x4aa1ea(0x21e)](_0x27d3d0),_0x1c706d={'op':_0x4aa1ea(0x1bb),'request_id':_0x27fce2[_0x4aa1ea(0x161)],'data':_0x5b23dc['toString'](_0x4aa1ea(0x1b6))};serverWs['send'](JSON[_0x4aa1ea(0x1e0)](_0x1c706d)),console[_0x4aa1ea(0x1e7)](_0x4aa1ea(0x20a)+_0x27fce2[_0x4aa1ea(0x16a)]+_0x4aa1ea(0x1f3)+_0x27d3d0);return;}}catch(_0x45cdac){console['error'](_0x4aa1ea(0x18c),_0x45cdac);const _0x1bbaf2={'op':_0x4aa1ea(0x1bb),'request_id':_0x27fce2[_0x4aa1ea(0x161)],'error':_0x45cdac[_0x4aa1ea(0x1a2)]};serverWs[_0x4aa1ea(0x16c)](JSON[_0x4aa1ea(0x1e0)](_0x1bbaf2));return;}rosbridgeWs[_0x4aa1ea(0x16c)](_0x2c6b97);}catch(_0xdeeafe){rosbridgeWs[_0x4aa1ea(0x16c)](_0x2c6b97);}}}),serverWs['on'](_0x765313(0x19b),(_0x3e8dcc,_0x4963ad)=>{const _0x56d659=_0x765313;console[_0x56d659(0x1e7)]('Disconnected\x20from\x20server\x20('+_0x3e8dcc+':\x20'+_0x4963ad+_0x56d659(0x181)),webrtcService[_0x56d659(0x1db)](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x765313(0x1cd),_0x51e54f=>{const _0x2d5bdb=_0x765313;console[_0x2d5bdb(0x1cd)]('Server\x20connection\x20error:',_0x51e54f);});}catch(_0x4405ed){console[_0x765313(0x1cd)](_0x765313(0x19f),_0x4405ed),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x17c505,_0x5960f3,_0x476473)=>{const _0x43b602=a1_0x20ca4f;if(!authService['isAuthenticated']()){console[_0x43b602(0x1e7)](_0x43b602(0x200),config[_0x43b602(0x1ed)]);const _0x5c7fd8=await authService['login']();if(!_0x5c7fd8)return _0x5960f3[_0x43b602(0x1b7)](0x191)[_0x43b602(0x18d)]({'error':_0x43b602(0x198)});}_0x476473();};app[a1_0x20ca4f(0x21b)]((_0x40bf0a,_0x3d4786,_0x367921)=>{const _0x25be66=a1_0x20ca4f;_0x3d4786[_0x25be66(0x17f)](_0x25be66(0x159),'*'),_0x3d4786[_0x25be66(0x17f)](_0x25be66(0x1ad),_0x25be66(0x217)),_0x3d4786[_0x25be66(0x17f)](_0x25be66(0x1ea),_0x25be66(0x1ef)),_0x40bf0a[_0x25be66(0x19d)]===_0x25be66(0x212)?_0x3d4786['sendStatus'](0xc8):_0x367921();}),app[a1_0x20ca4f(0x15b)]('/',requireAuth,(_0x597048,_0x20d3d7)=>{const _0x58682f=a1_0x20ca4f;_0x20d3d7[_0x58682f(0x16c)]('Appliance\x20is\x20running\x20and\x20authenticated!');}),app[a1_0x20ca4f(0x15b)](a1_0x20ca4f(0x176),async(_0x100e24,_0x3c8774)=>{const _0x564c59=a1_0x20ca4f,_0x2e2c7a=authService[_0x564c59(0x17e)](),_0x1af828=webrtcService['getActiveSessions'](),_0x554789=webrtcService[_0x564c59(0x15f)](),_0x2c65a1=topicManager[_0x564c59(0x1d1)]();_0x3c8774[_0x564c59(0x18d)]({'status':'ok','environment':process[_0x564c59(0x1f8)][_0x564c59(0x1d4)]||'development','backendUrl':config[_0x564c59(0x1ed)],'rosbridgeUrl':config[_0x564c59(0x219)][_0x564c59(0x1d6)],'proxyPort':port,'authenticated':_0x2e2c7a,'topicManagement':{'discovered':_0x2c65a1[_0x564c59(0x186)],'strategies':_0x2c65a1[_0x564c59(0x164)],'largeDataTopics':_0x2c65a1[_0x564c59(0x168)][_0x564c59(0x206)],'largeTopicsList':_0x2c65a1[_0x564c59(0x168)]},'webrtc':{'activeSessions':_0x1af828['length'],'sharedVideoSources':_0x554789['length'],'sessions':_0x1af828,'sharedSources':_0x554789}});});const getInitialPort=()=>{const _0x361dc3=a1_0x20ca4f;if(process[_0x361dc3(0x1f8)][_0x361dc3(0x18a)])return parseInt(process[_0x361dc3(0x1f8)][_0x361dc3(0x18a)],0xa);return config[_0x361dc3(0x219)]['proxyPort'];};async function listenWithRetries(_0x3e4c78,_0x2850c9,_0x82c8b4=0xa){let _0x12edd3=_0x2850c9;for(let _0x47164b=0x1;_0x47164b<=_0x82c8b4;_0x47164b++){try{return await new Promise((_0xe4bc37,_0x1eae2a)=>{const _0x4e1533=a1_0x227b,_0x224ca3=_0x3e4c78[_0x4e1533(0x1e1)](_0x12edd3,()=>{const _0x2f793e=_0x4e1533;console[_0x2f793e(0x1e7)](_0x2f793e(0x1be)+_0x12edd3),_0xe4bc37(_0x224ca3);});_0x224ca3['on']('error',_0x4ba336=>{const _0x153547=_0x4e1533;_0x4ba336[_0x153547(0x167)]===_0x153547(0x1fb)?(console['warn'](_0x153547(0x1eb)+_0x12edd3+_0x153547(0x15c)),_0x1eae2a(_0x4ba336)):_0x1eae2a(_0x4ba336);});}),_0x12edd3;}catch(_0x3f7b38){_0x12edd3++;}}throw new Error('Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20'+_0x82c8b4+'\x20attempts\x20starting\x20from\x20'+_0x2850c9);}const startApp=async()=>{const _0x529dac=a1_0x20ca4f;try{let _0xbba5ef=await authService[_0x529dac(0x193)]();while(!_0xbba5ef){console[_0x529dac(0x1e7)](_0x529dac(0x197)),await promptForCredentials(),_0xbba5ef=await authService[_0x529dac(0x193)]();}console[_0x529dac(0x1e7)](_0x529dac(0x1d3));!loadApplianceIdentity()&&console[_0x529dac(0x1e7)](_0x529dac(0x1ab));console[_0x529dac(0x1e7)](_0x529dac(0x1ff));const _0x2a1453=await registerWithServer();if(!_0x2a1453)throw new Error('Failed\x20to\x20register\x20with\x20server');connectToRosbridge(),connectToServer();const _0x46d9f4=getInitialPort();await listenWithRetries(app,_0x46d9f4,0xa);}catch(_0x1d7749){console[_0x529dac(0x1cd)](_0x529dac(0x179),_0x1d7749),process[_0x529dac(0x189)](0x1);}};setInterval(async()=>{const _0x25b71f=a1_0x20ca4f;try{if(robotId){const _0x40bf02=authService[_0x25b71f(0x1ee)]();await axios[_0x25b71f(0x183)](config['serverUrl']+_0x25b71f(0x20e),{'robotId':robotId},{'headers':{'Authorization':_0x25b71f(0x177)+_0x40bf02,'Content-Type':_0x25b71f(0x1a8)}});}}catch(_0x34efcf){console['error']('Failed\x20to\x20ping\x20server:',_0x34efcf[_0x25b71f(0x1a2)]);}},0x1388),startApp();