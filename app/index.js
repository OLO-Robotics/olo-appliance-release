const a1_0x1dac64=a1_0x5c6a;(function(_0x48d192,_0x4bce0b){const _0x7d7c07=a1_0x5c6a,_0x503e23=_0x48d192();while(!![]){try{const _0x533270=parseInt(_0x7d7c07(0x1bb))/0x1*(-parseInt(_0x7d7c07(0x1b2))/0x2)+-parseInt(_0x7d7c07(0x18f))/0x3+parseInt(_0x7d7c07(0x1f5))/0x4+-parseInt(_0x7d7c07(0x179))/0x5+parseInt(_0x7d7c07(0x1c2))/0x6*(-parseInt(_0x7d7c07(0x13c))/0x7)+-parseInt(_0x7d7c07(0x169))/0x8+parseInt(_0x7d7c07(0x15e))/0x9;if(_0x533270===_0x4bce0b)break;else _0x503e23['push'](_0x503e23['shift']());}catch(_0x556d12){_0x503e23['push'](_0x503e23['shift']());}}}(a1_0x7278,0xe015d));const a1_0x26ba14=(function(){let _0x5468a0=!![];return function(_0x1caa9f,_0x3aa67c){const _0x21e473=_0x5468a0?function(){const _0xc0332e=a1_0x5c6a;if(_0x3aa67c){const _0x1cff2c=_0x3aa67c[_0xc0332e(0x1dd)](_0x1caa9f,arguments);return _0x3aa67c=null,_0x1cff2c;}}:function(){};return _0x5468a0=![],_0x21e473;};}()),a1_0x42afd0=a1_0x26ba14(this,function(){const _0xc9f40a=a1_0x5c6a;return a1_0x42afd0[_0xc9f40a(0x1e8)]()[_0xc9f40a(0x1c5)](_0xc9f40a(0x1b6))[_0xc9f40a(0x1e8)]()[_0xc9f40a(0x16a)](a1_0x42afd0)['search']('(((.+)+)+)+$');});a1_0x42afd0();const express=require(a1_0x1dac64(0x182)),config=require(a1_0x1dac64(0x1f0)),authService=require(a1_0x1dac64(0x13f)),webrtcService=require(a1_0x1dac64(0x1c3)),topicManager=require(a1_0x1dac64(0x1ca)),WebSocket=require('ws'),axios=require('axios'),fs=require('fs'),prompt=require('prompt-sync')({'sigint':!![]}),dotenv=require(a1_0x1dac64(0x1b8)),app=express(),port=process[a1_0x1dac64(0x1e5)]['PORT']||config['rosbridge']['proxyPort'],APPLIANCE_FILE=a1_0x1dac64(0x19e),{DOMParser,XMLSerializer}=require('xmldom'),path=require(a1_0x1dac64(0x1a3)),{execSync}=require('child_process'),APPLIANCE_BASE_URL=process[a1_0x1dac64(0x1e5)][a1_0x1dac64(0x1d2)]||'';console['log']('Environment:\x20'+(process[a1_0x1dac64(0x1e5)][a1_0x1dac64(0x17f)]||a1_0x1dac64(0x1ad))),console[a1_0x1dac64(0x1c1)](a1_0x1dac64(0x1e4)+config[a1_0x1dac64(0x1e0)]),console[a1_0x1dac64(0x1c1)](a1_0x1dac64(0x151)+config[a1_0x1dac64(0x1da)]['wsEndpoint']),console['log'](a1_0x1dac64(0x15d)+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function a1_0x7278(){const _0x327c82=['values','ROSBridge\x20WebSocket\x20URL:\x20','open','substring','Enter\x20password:\x20','Failed\x20to\x20ping\x20server:','initialize','OPTIONS','largeDataTopics','toLowerCase','mesh_data','string','APP_USERNAME','Proxy\x20listening\x20on\x20port:\x20','31401207CbsuXS','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','ROSBridge\x20(main)\x20connection\x20error:','stopAllSessions','Failed\x20to\x20parse\x20appliance\x20identity\x20file:','discoverTopics','utf8','Mesh\x20file\x20not\x20found:\x20','base64','sendStatus','.mesh','2635600comXHw','constructor','map','text/xml','[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20','webrtc_skip','/rosapi/topics','service','password','trim','APP_USERNAME=','login','publish','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF','APP_PASSWORD','8490090pJEQzj','handleMessage','post','forward','registration_token','application/json','NODE_ENV','.env','sample_skip','express','getActiveSessions','credentials','get','unlinkSync','writeFileSync','/health','totalTopics','[MESH]\x20Successfully\x20served\x20mesh:\x20','Enter\x20username:\x20','topics','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','get_mesh','4929672kFLXoT','/robot_description','registrationToken','match','Login\x20failed.\x20Please\x20enter\x20credentials\x20again.','wsEndpoint','endsWith','stringify','Disconnected\x20from\x20server\x20(','hide','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','readyState','topic','EADDRINUSE','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','.appliance.json','filename','action','urdf_param_data','call_service','path','.ply','getToken','unknown','use','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','throttling','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','proxyPort','Failed\x20to\x20register\x20with\x20server:','development','status','message','http','service_response','4vwzGpT','[MESH]\x20Error\x20serving\x20mesh:','send','serializeToString','(((.+)+)+)+$','Not\x20authenticated','dotenv','.dae','readFileSync','200186cSjGlP','/appliance/register','code','length','Successfully\x20logged\x20in','\x20in\x20use,\x20trying\x20next\x20port...','log','150QTsVTB','./services/webrtcService','type','search','OPEN','[URDF\x20REWRITE]\x20Rewrote\x20','loadConfig','samplingRate','./services/TopicManager','uri','sample','Access-Control-Allow-Headers','username','Access-Control-Allow-Origin','Topic\x20discovery\x20failed:','PORT','APPLIANCE_BASE_URL','ros2\x20param\x20get\x20','strategy','some','Connected\x20to\x20ROSBridge\x20(WebRTC)','Ros','roslib','method','rosbridge','estimatedSize','Successfully\x20registered\x20with\x20server','apply','parse','[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','serverUrl','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','WSL\x20Appliance','Failed\x20to\x20connect\x20to\x20server:','Backend\x20Server\x20URL:\x20','env','setAttribute','listen','toString','msg','data','replace','catch','reason','param_name','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','./config','exit','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):','/rosbridge?type=appliance&token=','6124476LPWkwx','Appliance\x20is\x20running\x20and\x20authenticated!','Port\x20','ros2\x20pkg\x20prefix\x20','slice','\x0aAPP_PASSWORD=','Registering\x20with\x20server...','existsSync','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','json','\x20from\x20','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','\x20attempts\x20starting\x20from\x20','No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','8743ZVqDne','error','.obj','./services/auth','getStatistics','name','startsWith','warn','getElementsByTagName','close','.stl','request_id','Failed\x20to\x20register\x20with\x20server','robotId','join','Bearer\x20','/appliance/ping','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','isAuthenticated','robot\x20not\x20found'];a1_0x7278=function(){return _0x327c82;};return a1_0x7278();}function updateEnvFile(_0x2a3719,_0x38c264){const _0x3a3a39=a1_0x1dac64;fs[_0x3a3a39(0x187)](_0x3a3a39(0x180),_0x3a3a39(0x173)+_0x2a3719+_0x3a3a39(0x1fa)+_0x38c264+'\x0a');}function reloadEnv(){const _0x18b43c=a1_0x1dac64;dotenv['config']({'override':!![]}),config[_0x18b43c(0x184)][_0x18b43c(0x1ce)]=process[_0x18b43c(0x1e5)][_0x18b43c(0x15c)],config[_0x18b43c(0x184)][_0x18b43c(0x171)]=process[_0x18b43c(0x1e5)][_0x18b43c(0x178)];}async function promptForCredentials(){const _0x2eacde=a1_0x1dac64,_0x25ebda=prompt(_0x2eacde(0x18b)),_0x319a25=prompt[_0x2eacde(0x198)](_0x2eacde(0x154));updateEnvFile(_0x25ebda,_0x319a25),reloadEnv();}function loadApplianceIdentity(){const _0x2f7968=a1_0x1dac64;if(fs['existsSync'](APPLIANCE_FILE))try{const _0x93431c=JSON[_0x2f7968(0x1de)](fs[_0x2f7968(0x1ba)](APPLIANCE_FILE,'utf8'));if(_0x93431c[_0x2f7968(0x149)]&&_0x93431c[_0x2f7968(0x191)])return robotId=_0x93431c[_0x2f7968(0x149)],registrationToken=_0x93431c[_0x2f7968(0x191)],console[_0x2f7968(0x1c1)]('Loaded\x20appliance\x20identity:',robotId),topicManager[_0x2f7968(0x1c8)](_0x93431c),!![];}catch(_0xb46807){console[_0x2f7968(0x13d)](_0x2f7968(0x162),_0xb46807);}return![];}function saveApplianceIdentity(_0x59a65b,_0x61302b){const _0x1e1b94=a1_0x1dac64;let _0x110d36={};if(fs[_0x1e1b94(0x1fc)](APPLIANCE_FILE))try{_0x110d36=JSON[_0x1e1b94(0x1de)](fs[_0x1e1b94(0x1ba)](APPLIANCE_FILE,_0x1e1b94(0x164)));}catch(_0xa62ebf){_0x110d36={};}_0x110d36['robotId']=_0x59a65b,_0x110d36[_0x1e1b94(0x191)]=_0x61302b,fs[_0x1e1b94(0x187)](APPLIANCE_FILE,JSON[_0x1e1b94(0x196)](_0x110d36,null,0x2));}async function registerWithServer(){const _0x115a9e=a1_0x1dac64;try{const _0x1a8c79=authService[_0x115a9e(0x1a5)]();if(!_0x1a8c79)throw new Error(_0x115a9e(0x1b7));let _0x1fffa4,_0x289b56=![];while(!![]){try{robotId&&registrationToken?_0x1fffa4=await axios['post'](config[_0x115a9e(0x1e0)]+'/appliance/register',{'name':'WSL\x20Appliance','robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':'Bearer\x20'+_0x1a8c79,'Content-Type':_0x115a9e(0x17e)}}):_0x1fffa4=await axios[_0x115a9e(0x17b)](config[_0x115a9e(0x1e0)]+_0x115a9e(0x1bc),{'name':_0x115a9e(0x1e2)},{'headers':{'Authorization':_0x115a9e(0x14b)+_0x1a8c79,'Content-Type':_0x115a9e(0x17e)}});break;}catch(_0x1c9007){const _0x4571e7=_0x1c9007?.['response']?.[_0x115a9e(0x1ea)]?.[_0x115a9e(0x13d)]||_0x1c9007[_0x115a9e(0x1af)];if(!_0x289b56&&_0x4571e7&&_0x4571e7['toLowerCase']()['includes'](_0x115a9e(0x14f))){console[_0x115a9e(0x143)](_0x115a9e(0x1aa));if(fs['existsSync'](APPLIANCE_FILE))fs[_0x115a9e(0x186)](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x289b56=!![];continue;}throw _0x1c9007;}}if(!_0x1fffa4[_0x115a9e(0x1ea)]||!_0x1fffa4[_0x115a9e(0x1ea)][_0x115a9e(0x17d)]||!_0x1fffa4[_0x115a9e(0x1ea)]['id'])throw new Error(_0x115a9e(0x139));return registrationToken=_0x1fffa4[_0x115a9e(0x1ea)][_0x115a9e(0x17d)],robotId=_0x1fffa4['data']['id'],saveApplianceIdentity(robotId,registrationToken),console[_0x115a9e(0x1c1)](_0x115a9e(0x1dc)),!![];}catch(_0x3fc270){return console['error'](_0x115a9e(0x1ac),_0x3fc270[_0x115a9e(0x1af)]),![];}}function rewriteUrdfMeshUris(_0xf288c){const _0x3611f1=a1_0x1dac64;try{const _0x264a68=new DOMParser(),_0x546d7d=_0x264a68['parseFromString'](_0xf288c,_0x3611f1(0x16c));let _0x454e49=0x0,_0x2ff157=0x0;const _0x2c2fd6=_0x546d7d[_0x3611f1(0x144)]('mesh');for(let _0x4879e0=0x0;_0x4879e0<_0x2c2fd6[_0x3611f1(0x1be)];_0x4879e0++){const _0x38b643=_0x2c2fd6[_0x4879e0],_0x2278f6=_0x38b643['getAttribute'](_0x3611f1(0x19f)),_0x4b3622=[_0x3611f1(0x146),_0x3611f1(0x1b9),_0x3611f1(0x13e),_0x3611f1(0x1a4),_0x3611f1(0x168)],_0x54f5c5=_0x4b3622[_0x3611f1(0x1d5)](_0x5d7fe5=>_0x2278f6[_0x3611f1(0x159)]()[_0x3611f1(0x195)](_0x5d7fe5));if(_0x2278f6&&_0x2278f6[_0x3611f1(0x142)]('package://')&&_0x54f5c5){_0x454e49++;const _0x2bf49d=APPLIANCE_BASE_URL+'/ros/mesh?uri='+encodeURIComponent(_0x2278f6);_0x38b643[_0x3611f1(0x1e6)](_0x3611f1(0x19f),_0x2bf49d),_0x2ff157++,console['log'](_0x3611f1(0x16d)+_0x2278f6+'\x20->\x20'+_0x2bf49d);}}_0x454e49>0x0?console['log'](_0x3611f1(0x1c7)+_0x2ff157+'\x20of\x20'+_0x454e49+_0x3611f1(0x1a8)):console[_0x3611f1(0x1c1)](_0x3611f1(0x177));const _0x9de32b=new XMLSerializer();return _0x9de32b[_0x3611f1(0x1b5)](_0x546d7d);}catch(_0x2637da){return console[_0x3611f1(0x13d)](_0x3611f1(0x1f3),_0x2637da),_0xf288c;}}function connectToRosbridge(){const _0x1ebd36=a1_0x1dac64;try{rosbridgeWs=new WebSocket(config[_0x1ebd36(0x1da)]['wsEndpoint']),rosbridgeWs['on']('open',()=>{const _0x2c3c9e=_0x1ebd36;console['log']('Connected\x20to\x20ROSBridge\x20(main)');const _0x2c4524=require(_0x2c3c9e(0x1d8)),_0x386d9d=new _0x2c4524[(_0x2c3c9e(0x1d7))]({'url':config[_0x2c3c9e(0x1da)]['wsEndpoint']});_0x386d9d['on']('connection',()=>{setTimeout(()=>{const _0xb2f3df=a1_0x5c6a;topicManager[_0xb2f3df(0x163)](_0x386d9d)[_0xb2f3df(0x1ec)](_0x3d5912=>{const _0x2e7ec1=_0xb2f3df;console[_0x2e7ec1(0x13d)](_0x2e7ec1(0x1d0),_0x3d5912);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on'](_0x1ebd36(0x1af),_0x487f8e=>{const _0x647fb2=_0x1ebd36;if(serverWs&&serverWs[_0x647fb2(0x19a)]===WebSocket[_0x647fb2(0x1c6)]){let _0x5c2da3=_0x487f8e[_0x647fb2(0x1e8)]();try{const _0x9b81a9=JSON[_0x647fb2(0x1de)](_0x5c2da3);if(_0x9b81a9['op']===_0x647fb2(0x175)&&_0x9b81a9[_0x647fb2(0x19b)]){const _0x559ad1=topicManager[_0x647fb2(0x17a)](_0x9b81a9);switch(_0x559ad1[_0x647fb2(0x1a0)]){case _0x647fb2(0x181):return;case _0x647fb2(0x16e):return;case _0x647fb2(0x17c):default:_0x5c2da3=JSON[_0x647fb2(0x196)](_0x559ad1['message']);break;}}if((_0x9b81a9['op']===_0x647fb2(0x1b1)||_0x9b81a9['op']===_0x647fb2(0x1a2))&&(_0x9b81a9[_0x647fb2(0x170)]===_0x647fb2(0x16f)||_0x9b81a9[_0x647fb2(0x150)]&&_0x9b81a9[_0x647fb2(0x150)][_0x647fb2(0x18c)])){console[_0x647fb2(0x1c1)](_0x647fb2(0x14d));const _0x2066ce=_0x9b81a9[_0x647fb2(0x150)]?.[_0x647fb2(0x18c)]||[],_0x27e2b3=_0x9b81a9['values']?.['types']||[],_0x43d27d=_0x2066ce[_0x647fb2(0x16b)]((_0x261ec7,_0x15917b)=>{const _0x29fe56=_0x647fb2,_0x2ee489=topicManager['getTopicStrategy'](_0x261ec7);return{'name':_0x261ec7,'type':_0x27e2b3[_0x15917b]||_0x29fe56(0x1a6),'throttling':_0x2ee489?{'isThrottled':_0x2ee489['strategy']===_0x29fe56(0x1cc),'strategy':_0x2ee489[_0x29fe56(0x1d4)],'samplingRate':_0x2ee489[_0x29fe56(0x1c9)],'reason':_0x2ee489[_0x29fe56(0x1ed)],'estimatedSize':_0x2ee489[_0x29fe56(0x1db)]}:null};});_0x9b81a9[_0x647fb2(0x150)]={'topics':_0x43d27d[_0x647fb2(0x16b)](_0x5d77fb=>_0x5d77fb[_0x647fb2(0x141)]),'types':_0x43d27d[_0x647fb2(0x16b)](_0x354e2b=>_0x354e2b[_0x647fb2(0x1c4)]),'throttling':_0x43d27d['map'](_0x5d8c90=>_0x5d8c90[_0x647fb2(0x1a9)])},_0x5c2da3=JSON[_0x647fb2(0x196)](_0x9b81a9),console[_0x647fb2(0x1c1)](_0x647fb2(0x15f));}if(_0x9b81a9['op']===_0x647fb2(0x175)&&_0x9b81a9[_0x647fb2(0x19b)]===_0x647fb2(0x190))try{const _0x18098a=_0x9b81a9[_0x647fb2(0x1e9)][_0x647fb2(0x1ea)],_0x44dde1=rewriteUrdfMeshUris(_0x18098a);_0x9b81a9['msg'][_0x647fb2(0x1ea)]=_0x44dde1,_0x5c2da3=JSON['stringify'](_0x9b81a9);}catch(_0x1f0932){console[_0x647fb2(0x13d)](_0x647fb2(0x136),_0x1f0932);}}catch(_0x56f4ba){console[_0x647fb2(0x143)]('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0x56f4ba[_0x647fb2(0x1af)]);}serverWs['send'](_0x5c2da3);}}),rosbridgeWs['on'](_0x1ebd36(0x145),()=>{const _0x47adff=_0x1ebd36;console['log'](_0x47adff(0x18d)),webrtcService[_0x47adff(0x161)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on']('error',_0x44898f=>{const _0x53488c=_0x1ebd36;console['error'](_0x53488c(0x160),_0x44898f);});}catch(_0x35bd39){console[_0x1ebd36(0x13d)](_0x1ebd36(0x19d),_0x35bd39),setTimeout(connectToRosbridge,0x1388);}}function a1_0x5c6a(_0x39d7d6,_0x4fa4a5){const _0x46a7fd=a1_0x7278();return a1_0x5c6a=function(_0x42afd0,_0x26ba14){_0x42afd0=_0x42afd0-0x136;let _0x7278d2=_0x46a7fd[_0x42afd0];return _0x7278d2;},a1_0x5c6a(_0x39d7d6,_0x4fa4a5);}function connectToRosbridgeWebRTC(){const _0x17422a=a1_0x1dac64;try{rosbridgeWebRTCWs=new WebSocket(config[_0x17422a(0x1da)][_0x17422a(0x194)]),rosbridgeWebRTCWs['on'](_0x17422a(0x152),()=>{const _0xf5d47e=_0x17422a;console[_0xf5d47e(0x1c1)](_0xf5d47e(0x1d6)),webrtcService[_0xf5d47e(0x156)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on']('message',_0x5bc262=>{}),rosbridgeWebRTCWs['on']('close',()=>{const _0x7bf835=_0x17422a;console['log']('Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...'),webrtcService[_0x7bf835(0x161)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0x17422a(0x13d),_0x24220a=>{console['error']('ROSBridge\x20(WebRTC)\x20connection\x20error:',_0x24220a);});}catch(_0x447279){console[_0x17422a(0x13d)](_0x17422a(0x1e1),_0x447279),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x29efc2=a1_0x1dac64;try{if(!registrationToken)throw new Error('Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.');const _0x28437e=config[_0x29efc2(0x1e0)]['replace'](_0x29efc2(0x1b0),'ws')+_0x29efc2(0x1f4)+registrationToken;serverWs=new WebSocket(_0x28437e),serverWs['on'](_0x29efc2(0x152),()=>{const _0x210f4e=_0x29efc2;console[_0x210f4e(0x1c1)]('Connected\x20to\x20server'),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x210f4e(0x19a)]===WebSocket[_0x210f4e(0x1c6)]&&webrtcService['initialize'](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x29efc2(0x1af),_0x489ef1=>{const _0x5ac6f4=_0x29efc2;if(rosbridgeWs&&rosbridgeWs[_0x5ac6f4(0x19a)]===WebSocket['OPEN']){let _0xbef71e=_0x489ef1['toString']();try{const _0x521ab7=JSON[_0x5ac6f4(0x1de)](_0xbef71e);if(webrtcService[_0x5ac6f4(0x17a)](_0x521ab7))return;if(_0x521ab7['op']==='get_urdf_param'&&typeof _0x521ab7['param_name']==='string'&&_0x521ab7['request_id'])try{console[_0x5ac6f4(0x1c1)]('[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20'+_0x521ab7[_0x5ac6f4(0x1ee)]);const _0x34962d=execSync(_0x5ac6f4(0x1d3)+_0x521ab7[_0x5ac6f4(0x1ee)],{'encoding':_0x5ac6f4(0x164)})[_0x5ac6f4(0x172)]();let _0x4671ab=_0x34962d;_0x34962d['startsWith']('String\x20value\x20is:\x20')&&(_0x4671ab=_0x34962d[_0x5ac6f4(0x153)]('String\x20value\x20is:\x20'['length']()));_0x4671ab[_0x5ac6f4(0x142)]('\x22')&&_0x4671ab[_0x5ac6f4(0x195)]('\x22')&&(_0x4671ab=_0x4671ab[_0x5ac6f4(0x1f9)](0x1,-0x1));_0x4671ab=_0x4671ab['replace'](/\\n/g,'\x0a')[_0x5ac6f4(0x1eb)](/\\"/g,'\x22');const _0x3c1ad1={'op':'urdf_param_data','request_id':_0x521ab7[_0x5ac6f4(0x147)],'data':_0x4671ab};serverWs[_0x5ac6f4(0x1b4)](JSON['stringify'](_0x3c1ad1)),console[_0x5ac6f4(0x1c1)](_0x5ac6f4(0x1df)+_0x521ab7[_0x5ac6f4(0x1ee)]);return;}catch(_0x3ed07c){console[_0x5ac6f4(0x13d)](_0x5ac6f4(0x1ef),_0x3ed07c);const _0x1dbdeb={'op':_0x5ac6f4(0x1a1),'request_id':_0x521ab7[_0x5ac6f4(0x147)],'error':_0x3ed07c[_0x5ac6f4(0x1af)]};serverWs['send'](JSON[_0x5ac6f4(0x196)](_0x1dbdeb));return;}if(_0x521ab7['op']===_0x5ac6f4(0x18e)&&typeof _0x521ab7[_0x5ac6f4(0x1cb)]===_0x5ac6f4(0x15b)&&_0x521ab7[_0x5ac6f4(0x147)])try{const _0x514a69=_0x521ab7[_0x5ac6f4(0x1cb)][_0x5ac6f4(0x192)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x514a69){const _0x1be2b6=_0x514a69[0x1],_0x5a6a7f=_0x514a69[0x2],_0x5dd49a=execSync(_0x5ac6f4(0x1f8)+_0x1be2b6,{'encoding':_0x5ac6f4(0x164)})[_0x5ac6f4(0x172)](),_0x3defd9=path[_0x5ac6f4(0x14a)](_0x5dd49a,'share',_0x1be2b6,_0x5a6a7f);if(!fs[_0x5ac6f4(0x1fc)](_0x3defd9))throw new Error(_0x5ac6f4(0x165)+_0x3defd9);const _0x781dd1=fs[_0x5ac6f4(0x1ba)](_0x3defd9),_0x2067f6={'op':_0x5ac6f4(0x15a),'request_id':_0x521ab7[_0x5ac6f4(0x147)],'data':_0x781dd1[_0x5ac6f4(0x1e8)](_0x5ac6f4(0x166))};serverWs[_0x5ac6f4(0x1b4)](JSON[_0x5ac6f4(0x196)](_0x2067f6)),console['log'](_0x5ac6f4(0x18a)+_0x521ab7['uri']+_0x5ac6f4(0x138)+_0x3defd9);return;}}catch(_0x27233){console[_0x5ac6f4(0x13d)](_0x5ac6f4(0x1b3),_0x27233);const _0x3b578b={'op':'mesh_data','request_id':_0x521ab7[_0x5ac6f4(0x147)],'error':_0x27233['message']};serverWs[_0x5ac6f4(0x1b4)](JSON[_0x5ac6f4(0x196)](_0x3b578b));return;}rosbridgeWs[_0x5ac6f4(0x1b4)](_0xbef71e);}catch(_0x29c232){rosbridgeWs[_0x5ac6f4(0x1b4)](_0xbef71e);}}}),serverWs['on'](_0x29efc2(0x145),(_0x4efaaa,_0x4141e9)=>{const _0x5a00ac=_0x29efc2;console[_0x5a00ac(0x1c1)](_0x5a00ac(0x197)+_0x4efaaa+':\x20'+_0x4141e9+'),\x20attempting\x20to\x20reconnect...'),webrtcService[_0x5a00ac(0x161)](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x29efc2(0x13d),_0x575e7e=>{console['error']('Server\x20connection\x20error:',_0x575e7e);});}catch(_0x356753){console[_0x29efc2(0x13d)](_0x29efc2(0x1e3),_0x356753),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x27b1fd,_0x3307f9,_0x373c1d)=>{const _0xe09e75=a1_0x1dac64;if(!authService['isAuthenticated']()){console[_0xe09e75(0x1c1)]('Attempting\x20to\x20login\x20to:',config['serverUrl']);const _0x13b267=await authService[_0xe09e75(0x174)]();if(!_0x13b267)return _0x3307f9[_0xe09e75(0x1ae)](0x191)['json']({'error':'Authentication\x20required'});}_0x373c1d();};app[a1_0x1dac64(0x1a7)]((_0x15f769,_0x58f843,_0x3a57fe)=>{const _0x5e4063=a1_0x1dac64;_0x58f843['header'](_0x5e4063(0x1cf),'*'),_0x58f843['header']('Access-Control-Allow-Methods',_0x5e4063(0x176)),_0x58f843['header'](_0x5e4063(0x1cd),_0x5e4063(0x1f2)),_0x15f769[_0x5e4063(0x1d9)]===_0x5e4063(0x157)?_0x58f843[_0x5e4063(0x167)](0xc8):_0x3a57fe();}),app[a1_0x1dac64(0x185)]('/',requireAuth,(_0x5dee3d,_0x56c23c)=>{const _0x50064f=a1_0x1dac64;_0x56c23c[_0x50064f(0x1b4)](_0x50064f(0x1f6));}),app[a1_0x1dac64(0x185)](a1_0x1dac64(0x188),async(_0x192746,_0x39aa7e)=>{const _0xfa179e=a1_0x1dac64,_0x28e56e=authService[_0xfa179e(0x14e)](),_0x45f1c1=webrtcService[_0xfa179e(0x183)](),_0x5b664a=webrtcService['getSharedVideoSources'](),_0x20e100=topicManager[_0xfa179e(0x140)]();_0x39aa7e[_0xfa179e(0x137)]({'status':'ok','environment':process[_0xfa179e(0x1e5)][_0xfa179e(0x17f)]||_0xfa179e(0x1ad),'backendUrl':config[_0xfa179e(0x1e0)],'rosbridgeUrl':config[_0xfa179e(0x1da)][_0xfa179e(0x194)],'proxyPort':port,'authenticated':_0x28e56e,'topicManagement':{'discovered':_0x20e100[_0xfa179e(0x189)],'strategies':_0x20e100['strategies'],'largeDataTopics':_0x20e100['largeDataTopics'][_0xfa179e(0x1be)],'largeTopicsList':_0x20e100[_0xfa179e(0x158)]},'webrtc':{'activeSessions':_0x45f1c1[_0xfa179e(0x1be)],'sharedVideoSources':_0x5b664a[_0xfa179e(0x1be)],'sessions':_0x45f1c1,'sharedSources':_0x5b664a}});});const getInitialPort=()=>{const _0x2221e7=a1_0x1dac64;if(process[_0x2221e7(0x1e5)][_0x2221e7(0x1d1)])return parseInt(process[_0x2221e7(0x1e5)][_0x2221e7(0x1d1)],0xa);return config[_0x2221e7(0x1da)][_0x2221e7(0x1ab)];};async function listenWithRetries(_0x2a7995,_0x53b915,_0x55695f=0xa){const _0x340c57=a1_0x1dac64;let _0x400329=_0x53b915;for(let _0x16a9ff=0x1;_0x16a9ff<=_0x55695f;_0x16a9ff++){try{return await new Promise((_0x8f426b,_0x3969da)=>{const _0x4dec21=a1_0x5c6a,_0xfd788c=_0x2a7995[_0x4dec21(0x1e7)](_0x400329,()=>{const _0x3ce085=_0x4dec21;console[_0x3ce085(0x1c1)]('Appliance\x20server\x20started\x20successfully\x20on\x20port\x20'+_0x400329),_0x8f426b(_0xfd788c);});_0xfd788c['on']('error',_0xc34617=>{const _0x2a0812=_0x4dec21;_0xc34617[_0x2a0812(0x1bd)]===_0x2a0812(0x19c)?(console[_0x2a0812(0x143)](_0x2a0812(0x1f7)+_0x400329+_0x2a0812(0x1c0)),_0x3969da(_0xc34617)):_0x3969da(_0xc34617);});}),_0x400329;}catch(_0x44413f){_0x400329++;}}throw new Error(_0x340c57(0x199)+_0x55695f+_0x340c57(0x13a)+_0x53b915);}const startApp=async()=>{const _0x363469=a1_0x1dac64;try{let _0x1a4cc6=await authService[_0x363469(0x174)]();while(!_0x1a4cc6){console[_0x363469(0x1c1)](_0x363469(0x193)),await promptForCredentials(),_0x1a4cc6=await authService[_0x363469(0x174)]();}console[_0x363469(0x1c1)](_0x363469(0x1bf));!loadApplianceIdentity()&&console[_0x363469(0x1c1)](_0x363469(0x13b));console['log'](_0x363469(0x1fb));const _0x6ff74=await registerWithServer();if(!_0x6ff74)throw new Error(_0x363469(0x148));connectToRosbridge(),connectToServer();const _0x38a1ab=getInitialPort();await listenWithRetries(app,_0x38a1ab,0xa);}catch(_0xad6557){console[_0x363469(0x13d)]('Failed\x20to\x20start\x20application:',_0xad6557),process[_0x363469(0x1f1)](0x1);}};setInterval(async()=>{const _0x4ab313=a1_0x1dac64;try{if(robotId){const _0x135c42=authService['getToken']();await axios['post'](config[_0x4ab313(0x1e0)]+_0x4ab313(0x14c),{'robotId':robotId},{'headers':{'Authorization':'Bearer\x20'+_0x135c42,'Content-Type':_0x4ab313(0x17e)}});}}catch(_0x448ad3){console['error'](_0x4ab313(0x155),_0x448ad3['message']);}},0x1388),startApp();