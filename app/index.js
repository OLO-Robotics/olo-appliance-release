const a1_0x3bc2a1=a1_0x3a36;(function(_0x3038bc,_0x20edb2){const _0x41478e=a1_0x3a36,_0xfe5f57=_0x3038bc();while(!![]){try{const _0x2f33b5=-parseInt(_0x41478e(0x1f3))/0x1*(parseInt(_0x41478e(0x206))/0x2)+-parseInt(_0x41478e(0x19a))/0x3*(parseInt(_0x41478e(0x1bb))/0x4)+parseInt(_0x41478e(0x207))/0x5+-parseInt(_0x41478e(0x14d))/0x6*(-parseInt(_0x41478e(0x15b))/0x7)+parseInt(_0x41478e(0x18d))/0x8+-parseInt(_0x41478e(0x1c2))/0x9*(parseInt(_0x41478e(0x174))/0xa)+parseInt(_0x41478e(0x14a))/0xb*(parseInt(_0x41478e(0x1fa))/0xc);if(_0x2f33b5===_0x20edb2)break;else _0xfe5f57['push'](_0xfe5f57['shift']());}catch(_0xb48c36){_0xfe5f57['push'](_0xfe5f57['shift']());}}}(a1_0x4b38,0x78c3e));const a1_0x2279f8=(function(){let _0x403918=!![];return function(_0x1e2dfa,_0x5f443d){const _0xf02527=_0x403918?function(){const _0x38ce11=a1_0x3a36;if(_0x5f443d){const _0x233432=_0x5f443d[_0x38ce11(0x188)](_0x1e2dfa,arguments);return _0x5f443d=null,_0x233432;}}:function(){};return _0x403918=![],_0xf02527;};}()),a1_0x25cd68=a1_0x2279f8(this,function(){const _0x483161=a1_0x3a36;return a1_0x25cd68[_0x483161(0x1ac)]()['search'](_0x483161(0x20f))[_0x483161(0x1ac)]()['constructor'](a1_0x25cd68)[_0x483161(0x190)]('(((.+)+)+)+$');});a1_0x25cd68();const dotenv=require(a1_0x3bc2a1(0x1b9));dotenv[a1_0x3bc2a1(0x1e3)]();const express=require(a1_0x3bc2a1(0x183)),config=require(a1_0x3bc2a1(0x16a));process[a1_0x3bc2a1(0x212)][a1_0x3bc2a1(0x18b)]&&process[a1_0x3bc2a1(0x212)][a1_0x3bc2a1(0x1d9)]&&(config[a1_0x3bc2a1(0x214)][a1_0x3bc2a1(0x171)]=process[a1_0x3bc2a1(0x212)][a1_0x3bc2a1(0x18b)],config[a1_0x3bc2a1(0x214)][a1_0x3bc2a1(0x192)]=process['env'][a1_0x3bc2a1(0x1d9)],console['log'](a1_0x3bc2a1(0x1db)));const authService=require(a1_0x3bc2a1(0x1cd)),webrtcService=require(a1_0x3bc2a1(0x157)),topicManager=require(a1_0x3bc2a1(0x205)),WebSocket=require('ws'),axios=require(a1_0x3bc2a1(0x1b0)),fs=require('fs'),prompt=require(a1_0x3bc2a1(0x180))({'sigint':!![]}),app=express(),port=process[a1_0x3bc2a1(0x212)]['PORT']||config[a1_0x3bc2a1(0x1f9)][a1_0x3bc2a1(0x1a3)],APPLIANCE_FILE='.appliance.json',{DOMParser,XMLSerializer}=require('xmldom'),path=require(a1_0x3bc2a1(0x1a6)),{execSync}=require(a1_0x3bc2a1(0x15a)),APPLIANCE_BASE_URL=process[a1_0x3bc2a1(0x212)][a1_0x3bc2a1(0x1f2)]||'';console['log'](a1_0x3bc2a1(0x1df)+(process['env'][a1_0x3bc2a1(0x1c0)]||'development')),console['log'](a1_0x3bc2a1(0x151)+config[a1_0x3bc2a1(0x1b7)]),console[a1_0x3bc2a1(0x1ca)](a1_0x3bc2a1(0x178)+config[a1_0x3bc2a1(0x1f9)][a1_0x3bc2a1(0x14c)]),console[a1_0x3bc2a1(0x1ca)](a1_0x3bc2a1(0x1e4)+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x1aa12e,_0x381971){const _0x24dc08=a1_0x3bc2a1;fs[_0x24dc08(0x1b5)](_0x24dc08(0x1a9),_0x24dc08(0x199)+_0x1aa12e+'\x0aAPP_PASSWORD='+_0x381971+'\x0a');}function a1_0x4b38(){const _0x15dbde=['parse','\x20attempts\x20starting\x20from\x20','listen','Connected\x20to\x20server','existsSync','totalTopics','send','unknown','.dae','APP_PASSWORD','Failed\x20to\x20register\x20with\x20server','Initial\x20credentials\x20loaded\x20from\x20environment','application/json','Enter\x20username:\x20','[URDF\x20REWRITE]\x20Rewrote\x20','Environment:\x20','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:','PORT','config','Proxy\x20listening\x20on\x20port:\x20','get','replace','Access-Control-Allow-Headers','ros2\x20param\x20get\x20','largeDataTopics','Login\x20failed.\x20Please\x20enter\x20credentials\x20again.','isAuthenticated','Appliance\x20is\x20running\x20and\x20authenticated!','stopAllSessions','publish','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','APPLIANCE_BASE_URL','69183aQKpwD','Registering\x20with\x20server...','sample','SET','exit','startsWith','rosbridge','206736fXQRJm','code','webrtc_skip','topic','type','String\x20value\x20is:\x20','Disconnected\x20from\x20server\x20(','Mesh\x20file\x20not\x20found:\x20','warn','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','OPTIONS','./services/TopicManager','12QlblGX','2087200dFmRVr','header','login','roslib','msg','Failed\x20to\x20parse\x20appliance\x20identity\x20file:','string','Attempting\x20to\x20login\x20to:','(((.+)+)+)+$','mesh','estimatedSize','env','Topic\x20discovery\x20failed:','credentials','OPEN','reason','EADDRINUSE','hide','Not\x20authenticated','385alCFQU','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','wsEndpoint','456gZzgJG','/robot_description','WSL\x20Appliance','join','Backend\x20Server\x20URL:\x20','Bearer\x20','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','Successfully\x20registered\x20with\x20server','getToken','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','./services/webrtcService','Ros','Enter\x20password:\x20','child_process','28357qBwJiG','sendStatus','mesh_data','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','stringify','utf8','robot\x20not\x20found','initialize','text/xml','action','urdf_param_data','[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20','trim','Port\x20','registrationToken','./config','handleMessage','Loaded\x20appliance\x20identity:','open','\x20in\x20use,\x20trying\x20next\x20port...','),\x20attempting\x20to\x20reconnect...','robotId','username','service_response','Failed\x20to\x20register\x20with\x20server:','13510RMTEAv','.stl','getTopicStrategy','request_id','ROSBridge\x20WebSocket\x20URL:\x20','close','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','connection','ROSBridge\x20(main)\x20connection\x20error:','getSharedVideoSources','readFileSync','.mesh','prompt-sync','uri','NOT\x20SET','express','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','message','discoverTopics','/appliance/register','apply','get_mesh','values','APP_USERNAME','samplingRate','4242984yhLCLb','package://','response','search','Server\x20connection\x20error:','password','error','json','use','strategy','/ros/mesh?uri=','filename','APP_USERNAME=','3iBAgot','Authentication\x20required','param_name','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','\x20from\x20','method','length','[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF','proxyPort','getElementsByTagName','Connected\x20to\x20ROSBridge\x20(main)','path','ROSBridge\x20(WebRTC)\x20connection\x20error:','call_service','.env','[MESH]\x20Error\x20serving\x20mesh:','post','toString','toLowerCase','Please\x20run:\x20./setup.sh\x20reconfigure','name','axios','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','data','\x20->\x20','development','writeFileSync','catch','serverUrl','Loaded\x20credentials:','dotenv','endsWith','223624MaHqbl','slice','readyState','getActiveSessions','some','NODE_ENV','/rosbridge?type=appliance&token=','5949FnZilN','unlinkSync','topics','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','production','serializeToString','status','includes','log','map','match','./services/auth','sample_skip','getStatistics'];a1_0x4b38=function(){return _0x15dbde;};return a1_0x4b38();}function reloadEnv(){const _0x4570d7=a1_0x3bc2a1;dotenv[_0x4570d7(0x1e3)]({'override':!![]}),config['credentials'][_0x4570d7(0x171)]=process[_0x4570d7(0x212)][_0x4570d7(0x18b)],config['credentials'][_0x4570d7(0x192)]=process[_0x4570d7(0x212)]['APP_PASSWORD'],console[_0x4570d7(0x1ca)](_0x4570d7(0x1b8),{'username':config[_0x4570d7(0x214)]['username']?_0x4570d7(0x1f6):_0x4570d7(0x182),'password':config['credentials'][_0x4570d7(0x192)]?_0x4570d7(0x1f6):'NOT\x20SET'});}async function promptForCredentials(){const _0x3ba3e1=a1_0x3bc2a1;process['env']['NODE_ENV']===_0x3ba3e1(0x1c6)&&(console[_0x3ba3e1(0x193)]('Production\x20mode:\x20Credentials\x20must\x20be\x20provided\x20in\x20.env\x20file'),console[_0x3ba3e1(0x193)](_0x3ba3e1(0x1ae)),process[_0x3ba3e1(0x1f7)](0x1));const _0x92afa6=prompt(_0x3ba3e1(0x1dd)),_0x1ea2a8=prompt[_0x3ba3e1(0x148)](_0x3ba3e1(0x159));updateEnvFile(_0x92afa6,_0x1ea2a8),reloadEnv();}function loadApplianceIdentity(){const _0x36294e=a1_0x3bc2a1;if(fs[_0x36294e(0x1d4)](APPLIANCE_FILE))try{const _0x58f9ad=JSON[_0x36294e(0x1d0)](fs['readFileSync'](APPLIANCE_FILE,'utf8'));if(_0x58f9ad[_0x36294e(0x170)]&&_0x58f9ad['registrationToken'])return robotId=_0x58f9ad['robotId'],registrationToken=_0x58f9ad['registrationToken'],console[_0x36294e(0x1ca)](_0x36294e(0x16c),robotId),topicManager['loadConfig'](_0x58f9ad),!![];}catch(_0x66badd){console[_0x36294e(0x193)](_0x36294e(0x20c),_0x66badd);}return![];}function saveApplianceIdentity(_0x2fe2c7,_0x5c61f8){const _0xef8756=a1_0x3bc2a1;let _0x38abcd={};if(fs['existsSync'](APPLIANCE_FILE))try{_0x38abcd=JSON['parse'](fs['readFileSync'](APPLIANCE_FILE,'utf8'));}catch(_0x461065){_0x38abcd={};}_0x38abcd[_0xef8756(0x170)]=_0x2fe2c7,_0x38abcd[_0xef8756(0x169)]=_0x5c61f8,fs[_0xef8756(0x1b5)](APPLIANCE_FILE,JSON[_0xef8756(0x15f)](_0x38abcd,null,0x2));}async function registerWithServer(){const _0x262bbd=a1_0x3bc2a1;try{const _0x1cff87=authService[_0x262bbd(0x155)]();if(!_0x1cff87)throw new Error(_0x262bbd(0x149));let _0x3cc7b7,_0x3ff6b1=![];while(!![]){try{robotId&&registrationToken?_0x3cc7b7=await axios[_0x262bbd(0x1ab)](config[_0x262bbd(0x1b7)]+_0x262bbd(0x187),{'name':_0x262bbd(0x14f),'robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':_0x262bbd(0x152)+_0x1cff87,'Content-Type':_0x262bbd(0x1dc)}}):_0x3cc7b7=await axios[_0x262bbd(0x1ab)](config['serverUrl']+_0x262bbd(0x187),{'name':_0x262bbd(0x14f)},{'headers':{'Authorization':_0x262bbd(0x152)+_0x1cff87,'Content-Type':_0x262bbd(0x1dc)}});break;}catch(_0x116299){const _0x29d041=_0x116299?.[_0x262bbd(0x18f)]?.['data']?.[_0x262bbd(0x193)]||_0x116299['message'];if(!_0x3ff6b1&&_0x29d041&&_0x29d041[_0x262bbd(0x1ad)]()[_0x262bbd(0x1c9)](_0x262bbd(0x161))){console[_0x262bbd(0x202)](_0x262bbd(0x14b));if(fs[_0x262bbd(0x1d4)](APPLIANCE_FILE))fs[_0x262bbd(0x1c3)](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x3ff6b1=!![];continue;}throw _0x116299;}}if(!_0x3cc7b7[_0x262bbd(0x1b2)]||!_0x3cc7b7[_0x262bbd(0x1b2)]['registration_token']||!_0x3cc7b7[_0x262bbd(0x1b2)]['id'])throw new Error(_0x262bbd(0x1c5));return registrationToken=_0x3cc7b7['data']['registration_token'],robotId=_0x3cc7b7[_0x262bbd(0x1b2)]['id'],saveApplianceIdentity(robotId,registrationToken),console['log'](_0x262bbd(0x154)),!![];}catch(_0x5d63db){return console[_0x262bbd(0x193)](_0x262bbd(0x173),_0x5d63db[_0x262bbd(0x185)]),![];}}function rewriteUrdfMeshUris(_0x562324){const _0x1166e4=a1_0x3bc2a1;try{const _0x10f184=new DOMParser(),_0x5e3007=_0x10f184['parseFromString'](_0x562324,_0x1166e4(0x163));let _0x1a1046=0x0,_0x3b8f63=0x0;const _0x492d0f=_0x5e3007[_0x1166e4(0x1a4)](_0x1166e4(0x210));for(let _0x54e205=0x0;_0x54e205<_0x492d0f[_0x1166e4(0x1a1)];_0x54e205++){const _0x2dda7f=_0x492d0f[_0x54e205],_0x56498b=_0x2dda7f['getAttribute'](_0x1166e4(0x198)),_0x4209ac=[_0x1166e4(0x175),_0x1166e4(0x1d8),'.obj','.ply',_0x1166e4(0x17f)],_0x5499fd=_0x4209ac[_0x1166e4(0x1bf)](_0x39f8cf=>_0x56498b[_0x1166e4(0x1ad)]()[_0x1166e4(0x1ba)](_0x39f8cf));if(_0x56498b&&_0x56498b[_0x1166e4(0x1f8)](_0x1166e4(0x18e))&&_0x5499fd){_0x1a1046++;const _0x939da2=APPLIANCE_BASE_URL+_0x1166e4(0x197)+encodeURIComponent(_0x56498b);_0x2dda7f['setAttribute']('filename',_0x939da2),_0x3b8f63++,console[_0x1166e4(0x1ca)](_0x1166e4(0x166)+_0x56498b+_0x1166e4(0x1b3)+_0x939da2);}}_0x1a1046>0x0?console[_0x1166e4(0x1ca)](_0x1166e4(0x1de)+_0x3b8f63+'\x20of\x20'+_0x1a1046+'\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)'):console['log'](_0x1166e4(0x1a2));const _0x384c85=new XMLSerializer();return _0x384c85[_0x1166e4(0x1c7)](_0x5e3007);}catch(_0x1990e){return console['error']('[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):',_0x1990e),_0x562324;}}function connectToRosbridge(){const _0x53fa51=a1_0x3bc2a1;try{rosbridgeWs=new WebSocket(config['rosbridge']['wsEndpoint']),rosbridgeWs['on'](_0x53fa51(0x16d),()=>{const _0x5c9067=_0x53fa51;console[_0x5c9067(0x1ca)](_0x5c9067(0x1a5));const _0x37a6d8=require(_0x5c9067(0x20a)),_0x9a7b5d=new _0x37a6d8[(_0x5c9067(0x158))]({'url':config['rosbridge']['wsEndpoint']});_0x9a7b5d['on'](_0x5c9067(0x17b),()=>{setTimeout(()=>{const _0x43832c=a1_0x3a36;topicManager[_0x43832c(0x186)](_0x9a7b5d)[_0x43832c(0x1b6)](_0x922a6f=>{const _0x38afc3=_0x43832c;console[_0x38afc3(0x193)](_0x38afc3(0x213),_0x922a6f);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on']('message',_0x234cab=>{const _0x30ad45=_0x53fa51;if(serverWs&&serverWs[_0x30ad45(0x1bd)]===WebSocket[_0x30ad45(0x215)]){let _0x1a96e9=_0x234cab['toString']();try{const _0xe5740c=JSON[_0x30ad45(0x1d0)](_0x1a96e9);if(_0xe5740c['op']===_0x30ad45(0x1ee)&&_0xe5740c[_0x30ad45(0x1fd)]){const _0x3671f0=topicManager['handleMessage'](_0xe5740c);switch(_0x3671f0[_0x30ad45(0x164)]){case _0x30ad45(0x1ce):return;case _0x30ad45(0x1fc):return;case'forward':default:_0x1a96e9=JSON[_0x30ad45(0x15f)](_0x3671f0['message']);break;}}if((_0xe5740c['op']===_0x30ad45(0x172)||_0xe5740c['op']===_0x30ad45(0x1a8))&&(_0xe5740c['service']==='/rosapi/topics'||_0xe5740c[_0x30ad45(0x18a)]&&_0xe5740c[_0x30ad45(0x18a)]['topics'])){console[_0x30ad45(0x1ca)](_0x30ad45(0x1f0));const _0x19e543=_0xe5740c[_0x30ad45(0x18a)]?.[_0x30ad45(0x1c4)]||[],_0x174c8b=_0xe5740c[_0x30ad45(0x18a)]?.['types']||[],_0xd7f33e=_0x19e543['map']((_0x59cb7,_0x12e913)=>{const _0x542a02=_0x30ad45,_0x42df2b=topicManager[_0x542a02(0x176)](_0x59cb7);return{'name':_0x59cb7,'type':_0x174c8b[_0x12e913]||_0x542a02(0x1d7),'throttling':_0x42df2b?{'isThrottled':_0x42df2b['strategy']===_0x542a02(0x1f5),'strategy':_0x42df2b[_0x542a02(0x196)],'samplingRate':_0x42df2b[_0x542a02(0x18c)],'reason':_0x42df2b[_0x542a02(0x216)],'estimatedSize':_0x42df2b[_0x542a02(0x211)]}:null};});_0xe5740c[_0x30ad45(0x18a)]={'topics':_0xd7f33e[_0x30ad45(0x1cb)](_0x4d07ed=>_0x4d07ed[_0x30ad45(0x1af)]),'types':_0xd7f33e[_0x30ad45(0x1cb)](_0x2ccbc9=>_0x2ccbc9[_0x30ad45(0x1fe)]),'throttling':_0xd7f33e[_0x30ad45(0x1cb)](_0x375d87=>_0x375d87['throttling'])},_0x1a96e9=JSON['stringify'](_0xe5740c),console[_0x30ad45(0x1ca)]('[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client');}if(_0xe5740c['op']===_0x30ad45(0x1ee)&&_0xe5740c['topic']===_0x30ad45(0x14e))try{const _0x578dc5=_0xe5740c[_0x30ad45(0x20b)][_0x30ad45(0x1b2)],_0x5246a2=rewriteUrdfMeshUris(_0x578dc5);_0xe5740c[_0x30ad45(0x20b)][_0x30ad45(0x1b2)]=_0x5246a2,_0x1a96e9=JSON['stringify'](_0xe5740c);}catch(_0x465ec4){console[_0x30ad45(0x193)](_0x30ad45(0x1b1),_0x465ec4);}}catch(_0x7e5723){console[_0x30ad45(0x202)](_0x30ad45(0x1e1),_0x7e5723[_0x30ad45(0x185)]);}serverWs['send'](_0x1a96e9);}}),rosbridgeWs['on'](_0x53fa51(0x179),()=>{const _0x5a5674=_0x53fa51;console[_0x5a5674(0x1ca)](_0x5a5674(0x1f1)),webrtcService[_0x5a5674(0x1ed)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on']('error',_0x14dda0=>{const _0xc7ddd7=_0x53fa51;console['error'](_0xc7ddd7(0x17c),_0x14dda0);});}catch(_0x51cb63){console[_0x53fa51(0x193)](_0x53fa51(0x1ef),_0x51cb63),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0x4200c8=a1_0x3bc2a1;try{rosbridgeWebRTCWs=new WebSocket(config[_0x4200c8(0x1f9)][_0x4200c8(0x14c)]),rosbridgeWebRTCWs['on']('open',()=>{const _0x596a5=_0x4200c8;console[_0x596a5(0x1ca)]('Connected\x20to\x20ROSBridge\x20(WebRTC)'),webrtcService[_0x596a5(0x162)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on'](_0x4200c8(0x185),_0x1a205f=>{}),rosbridgeWebRTCWs['on'](_0x4200c8(0x179),()=>{const _0x12f05c=_0x4200c8;console[_0x12f05c(0x1ca)](_0x12f05c(0x19d)),webrtcService[_0x12f05c(0x1ed)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0x4200c8(0x193),_0x5c0a9e=>{const _0x3947e6=_0x4200c8;console[_0x3947e6(0x193)](_0x3947e6(0x1a7),_0x5c0a9e);});}catch(_0x2d33b2){console[_0x4200c8(0x193)](_0x4200c8(0x184),_0x2d33b2),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x2ccd1b=a1_0x3bc2a1;try{if(!registrationToken)throw new Error(_0x2ccd1b(0x153));const _0x2e9aff=config[_0x2ccd1b(0x1b7)]['replace']('http','ws')+_0x2ccd1b(0x1c1)+registrationToken;serverWs=new WebSocket(_0x2e9aff),serverWs['on'](_0x2ccd1b(0x16d),()=>{const _0x2ff6b1=_0x2ccd1b;console[_0x2ff6b1(0x1ca)](_0x2ff6b1(0x1d3)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x2ff6b1(0x1bd)]===WebSocket[_0x2ff6b1(0x215)]&&webrtcService['initialize'](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0x2ccd1b(0x185),_0xc8cf4f=>{const _0x22dd45=_0x2ccd1b;if(rosbridgeWs&&rosbridgeWs[_0x22dd45(0x1bd)]===WebSocket[_0x22dd45(0x215)]){let _0xf3f3f7=_0xc8cf4f[_0x22dd45(0x1ac)]();try{const _0x262717=JSON['parse'](_0xf3f3f7);if(webrtcService[_0x22dd45(0x16b)](_0x262717))return;if(_0x262717['op']==='get_urdf_param'&&typeof _0x262717['param_name']===_0x22dd45(0x20d)&&_0x262717[_0x22dd45(0x177)])try{console[_0x22dd45(0x1ca)](_0x22dd45(0x15e)+_0x262717['param_name']);const _0x11e43b=execSync(_0x22dd45(0x1e8)+_0x262717[_0x22dd45(0x19c)],{'encoding':'utf8'})[_0x22dd45(0x167)]();let _0xbe9054=_0x11e43b;_0x11e43b['startsWith'](_0x22dd45(0x1ff))&&(_0xbe9054=_0x11e43b['substring'](_0x22dd45(0x1ff)[_0x22dd45(0x1a1)]()));_0xbe9054[_0x22dd45(0x1f8)]('\x22')&&_0xbe9054[_0x22dd45(0x1ba)]('\x22')&&(_0xbe9054=_0xbe9054[_0x22dd45(0x1bc)](0x1,-0x1));_0xbe9054=_0xbe9054[_0x22dd45(0x1e6)](/\\n/g,'\x0a')[_0x22dd45(0x1e6)](/\\"/g,'\x22');const _0x88e44e={'op':_0x22dd45(0x165),'request_id':_0x262717['request_id'],'data':_0xbe9054};serverWs[_0x22dd45(0x1d6)](JSON[_0x22dd45(0x15f)](_0x88e44e)),console[_0x22dd45(0x1ca)]('[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20'+_0x262717[_0x22dd45(0x19c)]);return;}catch(_0x28e2c7){console[_0x22dd45(0x193)]('[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:',_0x28e2c7);const _0x5e0018={'op':_0x22dd45(0x165),'request_id':_0x262717[_0x22dd45(0x177)],'error':_0x28e2c7[_0x22dd45(0x185)]};serverWs[_0x22dd45(0x1d6)](JSON[_0x22dd45(0x15f)](_0x5e0018));return;}if(_0x262717['op']===_0x22dd45(0x189)&&typeof _0x262717[_0x22dd45(0x181)]===_0x22dd45(0x20d)&&_0x262717['request_id'])try{const _0x4f8f2b=_0x262717[_0x22dd45(0x181)][_0x22dd45(0x1cc)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x4f8f2b){const _0x44ef0a=_0x4f8f2b[0x1],_0xb03f63=_0x4f8f2b[0x2],_0x3f18e1=execSync('ros2\x20pkg\x20prefix\x20'+_0x44ef0a,{'encoding':_0x22dd45(0x160)})[_0x22dd45(0x167)](),_0x3d7317=path[_0x22dd45(0x150)](_0x3f18e1,'share',_0x44ef0a,_0xb03f63);if(!fs['existsSync'](_0x3d7317))throw new Error(_0x22dd45(0x201)+_0x3d7317);const _0x51b1a9=fs[_0x22dd45(0x17e)](_0x3d7317),_0x5441f2={'op':_0x22dd45(0x15d),'request_id':_0x262717[_0x22dd45(0x177)],'data':_0x51b1a9[_0x22dd45(0x1ac)]('base64')};serverWs['send'](JSON['stringify'](_0x5441f2)),console[_0x22dd45(0x1ca)]('[MESH]\x20Successfully\x20served\x20mesh:\x20'+_0x262717['uri']+_0x22dd45(0x19f)+_0x3d7317);return;}}catch(_0x386515){console[_0x22dd45(0x193)](_0x22dd45(0x1aa),_0x386515);const _0x92f82e={'op':'mesh_data','request_id':_0x262717[_0x22dd45(0x177)],'error':_0x386515[_0x22dd45(0x185)]};serverWs[_0x22dd45(0x1d6)](JSON['stringify'](_0x92f82e));return;}rosbridgeWs[_0x22dd45(0x1d6)](_0xf3f3f7);}catch(_0x18bfa7){rosbridgeWs[_0x22dd45(0x1d6)](_0xf3f3f7);}}}),serverWs['on'](_0x2ccd1b(0x179),(_0x54bd47,_0x25f1ca)=>{const _0x5afee6=_0x2ccd1b;console[_0x5afee6(0x1ca)](_0x5afee6(0x200)+_0x54bd47+':\x20'+_0x25f1ca+_0x5afee6(0x16f)),webrtcService[_0x5afee6(0x1ed)](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x2ccd1b(0x193),_0x1aeace=>{const _0x29e28c=_0x2ccd1b;console[_0x29e28c(0x193)](_0x29e28c(0x191),_0x1aeace);});}catch(_0x7a2fba){console[_0x2ccd1b(0x193)]('Failed\x20to\x20connect\x20to\x20server:',_0x7a2fba),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x468ef5,_0x2f137d,_0x4b187b)=>{const _0x5b06ed=a1_0x3bc2a1;if(!authService['isAuthenticated']()){console[_0x5b06ed(0x1ca)](_0x5b06ed(0x20e),config[_0x5b06ed(0x1b7)]);const _0x47de71=await authService[_0x5b06ed(0x209)]();if(!_0x47de71)return _0x2f137d[_0x5b06ed(0x1c8)](0x191)[_0x5b06ed(0x194)]({'error':_0x5b06ed(0x19b)});}_0x4b187b();};app[a1_0x3bc2a1(0x195)]((_0xa750ab,_0x3e6558,_0x1d9acc)=>{const _0x5a08f7=a1_0x3bc2a1;_0x3e6558[_0x5a08f7(0x208)]('Access-Control-Allow-Origin','*'),_0x3e6558[_0x5a08f7(0x208)]('Access-Control-Allow-Methods',_0x5a08f7(0x203)),_0x3e6558[_0x5a08f7(0x208)](_0x5a08f7(0x1e7),_0x5a08f7(0x1e0)),_0xa750ab[_0x5a08f7(0x1a0)]===_0x5a08f7(0x204)?_0x3e6558[_0x5a08f7(0x15c)](0xc8):_0x1d9acc();}),app[a1_0x3bc2a1(0x1e5)]('/',requireAuth,(_0x38dca6,_0x2d143b)=>{const _0x4464c3=a1_0x3bc2a1;_0x2d143b[_0x4464c3(0x1d6)](_0x4464c3(0x1ec));}),app[a1_0x3bc2a1(0x1e5)]('/health',async(_0x3ed24f,_0x50fc58)=>{const _0x54ac88=a1_0x3bc2a1,_0x511cbe=authService[_0x54ac88(0x1eb)](),_0x49ade3=webrtcService[_0x54ac88(0x1be)](),_0x58e436=webrtcService[_0x54ac88(0x17d)](),_0x1315ce=topicManager[_0x54ac88(0x1cf)]();_0x50fc58[_0x54ac88(0x194)]({'status':'ok','environment':process[_0x54ac88(0x212)][_0x54ac88(0x1c0)]||_0x54ac88(0x1b4),'backendUrl':config[_0x54ac88(0x1b7)],'rosbridgeUrl':config[_0x54ac88(0x1f9)][_0x54ac88(0x14c)],'proxyPort':port,'authenticated':_0x511cbe,'topicManagement':{'discovered':_0x1315ce[_0x54ac88(0x1d5)],'strategies':_0x1315ce['strategies'],'largeDataTopics':_0x1315ce[_0x54ac88(0x1e9)][_0x54ac88(0x1a1)],'largeTopicsList':_0x1315ce[_0x54ac88(0x1e9)]},'webrtc':{'activeSessions':_0x49ade3[_0x54ac88(0x1a1)],'sharedVideoSources':_0x58e436[_0x54ac88(0x1a1)],'sessions':_0x49ade3,'sharedSources':_0x58e436}});});const getInitialPort=()=>{const _0x3acb29=a1_0x3bc2a1;if(process[_0x3acb29(0x212)][_0x3acb29(0x1e2)])return parseInt(process[_0x3acb29(0x212)][_0x3acb29(0x1e2)],0xa);return config[_0x3acb29(0x1f9)][_0x3acb29(0x1a3)];};function a1_0x3a36(_0x282f3a,_0x3f6762){const _0x212c20=a1_0x4b38();return a1_0x3a36=function(_0x25cd68,_0x2279f8){_0x25cd68=_0x25cd68-0x148;let _0x4b388e=_0x212c20[_0x25cd68];return _0x4b388e;},a1_0x3a36(_0x282f3a,_0x3f6762);}async function listenWithRetries(_0x1e2da4,_0x597802,_0x5c0004=0xa){const _0x38f9a3=a1_0x3bc2a1;let _0x419eb6=_0x597802;for(let _0xdb4cb4=0x1;_0xdb4cb4<=_0x5c0004;_0xdb4cb4++){try{return await new Promise((_0x2b0c92,_0x8fef7e)=>{const _0x1621e9=a1_0x3a36,_0x5f23bc=_0x1e2da4[_0x1621e9(0x1d2)](_0x419eb6,()=>{const _0xc10e2c=_0x1621e9;console[_0xc10e2c(0x1ca)](_0xc10e2c(0x156)+_0x419eb6),_0x2b0c92(_0x5f23bc);});_0x5f23bc['on'](_0x1621e9(0x193),_0xa1f7c2=>{const _0x14b092=_0x1621e9;_0xa1f7c2[_0x14b092(0x1fb)]===_0x14b092(0x217)?(console[_0x14b092(0x202)](_0x14b092(0x168)+_0x419eb6+_0x14b092(0x16e)),_0x8fef7e(_0xa1f7c2)):_0x8fef7e(_0xa1f7c2);});}),_0x419eb6;}catch(_0x34e412){_0x419eb6++;}}throw new Error(_0x38f9a3(0x17a)+_0x5c0004+_0x38f9a3(0x1d1)+_0x597802);}const startApp=async()=>{const _0x425ccb=a1_0x3bc2a1;try{reloadEnv();let _0x8f8d64=await authService['login']();while(!_0x8f8d64){console[_0x425ccb(0x1ca)](_0x425ccb(0x1ea)),await promptForCredentials(),_0x8f8d64=await authService[_0x425ccb(0x209)]();}console[_0x425ccb(0x1ca)]('Successfully\x20logged\x20in');!loadApplianceIdentity()&&console['log'](_0x425ccb(0x19e));console[_0x425ccb(0x1ca)](_0x425ccb(0x1f4));const _0x234fa8=await registerWithServer();if(!_0x234fa8)throw new Error(_0x425ccb(0x1da));connectToRosbridge(),connectToServer();const _0x149354=getInitialPort();await listenWithRetries(app,_0x149354,0xa);}catch(_0x599940){console[_0x425ccb(0x193)]('Failed\x20to\x20start\x20application:',_0x599940),process[_0x425ccb(0x1f7)](0x1);}};setInterval(async()=>{const _0x11d302=a1_0x3bc2a1;try{if(robotId){const _0xfa812a=authService[_0x11d302(0x155)]();await axios[_0x11d302(0x1ab)](config[_0x11d302(0x1b7)]+'/appliance/ping',{'robotId':robotId},{'headers':{'Authorization':_0x11d302(0x152)+_0xfa812a,'Content-Type':_0x11d302(0x1dc)}});}}catch(_0x2a11d){console['error']('Failed\x20to\x20ping\x20server:',_0x2a11d['message']);}},0x1388),startApp();