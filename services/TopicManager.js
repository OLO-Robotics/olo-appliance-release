const a4_0x17b32e=a4_0x2606;(function(_0x2a8894,_0x43b938){const _0x21948c=a4_0x2606,_0x49ca2b=_0x2a8894();while(!![]){try{const _0xb670ce=-parseInt(_0x21948c(0x1c9))/0x1*(parseInt(_0x21948c(0x223))/0x2)+parseInt(_0x21948c(0x202))/0x3+parseInt(_0x21948c(0x221))/0x4+parseInt(_0x21948c(0x1ce))/0x5+-parseInt(_0x21948c(0x1e6))/0x6+-parseInt(_0x21948c(0x218))/0x7*(-parseInt(_0x21948c(0x1fb))/0x8)+-parseInt(_0x21948c(0x214))/0x9;if(_0xb670ce===_0x43b938)break;else _0x49ca2b['push'](_0x49ca2b['shift']());}catch(_0x290087){_0x49ca2b['push'](_0x49ca2b['shift']());}}}(a4_0x5518,0x3ecab));function a4_0x2606(_0xcc747e,_0x1294f4){const _0x337ecc=a4_0x5518();return a4_0x2606=function(_0x3c2ffc,_0xe9a946){_0x3c2ffc=_0x3c2ffc-0x1c6;let _0x55183f=_0x337ecc[_0x3c2ffc];return _0x55183f;},a4_0x2606(_0xcc747e,_0x1294f4);}const a4_0xe9a946=(function(){let _0x5db52c=!![];return function(_0x2e40d6,_0x24e1f9){const _0x7ecdb9=_0x5db52c?function(){const _0x17ee68=a4_0x2606;if(_0x24e1f9){const _0x10f934=_0x24e1f9[_0x17ee68(0x1f7)](_0x2e40d6,arguments);return _0x24e1f9=null,_0x10f934;}}:function(){};return _0x5db52c=![],_0x7ecdb9;};}()),a4_0x3c2ffc=a4_0xe9a946(this,function(){const _0x162eb1=a4_0x2606;return a4_0x3c2ffc['toString']()['search']('(((.+)+)+)+$')['toString']()[_0x162eb1(0x1f4)](a4_0x3c2ffc)[_0x162eb1(0x1fc)](_0x162eb1(0x1e7));});a4_0x3c2ffc();function a4_0x5518(){const _0xc674b6=['2678ifrGlT','log','name','[TopicManager]\x20Loaded\x20configuration:','[TopicManager]\x20Strategies:','1784860yYlZjL','depth_points','shouldUseWebRTC','test','size','isLargeData','determineTopicStrategy','get','normal_size','topicHandling','topic','maxFrequency','isLargeDataTopic','throttleFrequencies','child_process','image_raw','error','[TopicManager]\x20Topic\x20discovery\x20completed','reason','getTopics','replace','sensor_msgs/msg/LaserScan','filter','PointCloud2','2885766xaMmlE','(((.+)+)+)+$','handleMessage','point','topics','[TopicManager]\x20Initialised','estimatedSize','laser_scan_throttled','loadConfig','strategy','exports','webrtc_only','\x20topics','getTopicStrategy','constructor','points','defaultLargeDataStrategy','apply','sensor_msgs/msg/CompressedImage','discoveryInProgress','parseStrategyConfig','24sITkIj','search','forward','forEach','pattern_configured','webrtc_skip','getManagedTopics','917511cOxoyH','throttle','point_cloud','large_data_throttled','Image','set','estimateTopicSize','[TopicManager]\x20Found\x20','scan','sensor_msgs/msg/PointCloud2','lastMessageTimes','includes','topicStrategies','webrtc','[TopicManager]\x20Error\x20getting\x20topics:','strategiesConfig','throttle_skip','sensor_msgs/msg/Image','2846907LoBqYe','map','analyzeTopicStrategy','types','15197lqnllW','cloud','split','length','from','type','config','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','largeDataThreshold','1979820QmlkHi','compressed','82LMWzOi','isCameraTopic','entries','image'];a4_0x5518=function(){return _0xc674b6;};return a4_0x5518();}const {execSync}=require(a4_0x17b32e(0x1dc));class TopicManager{constructor(){const _0x5519a3=a4_0x17b32e;this['topicStrategies']=new Map(),this[_0x5519a3(0x20c)]=new Map(),this[_0x5519a3(0x1f9)]=![],this[_0x5519a3(0x21e)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x5519a3(0x1f1),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x5519a3(0x1ca)](_0x5519a3(0x1eb));}[a4_0x17b32e(0x1ee)](_0x149bd7){const _0x31011d=a4_0x17b32e;if(_0x149bd7[_0x31011d(0x1d7)]){const _0x42a07e=_0x149bd7[_0x31011d(0x1d7)];_0x42a07e[_0x31011d(0x220)]&&(this['config']['largeDataThreshold']=_0x42a07e[_0x31011d(0x220)]),_0x42a07e['defaultLargeDataStrategy']&&(this['config'][_0x31011d(0x1f6)]=_0x42a07e[_0x31011d(0x1f6)]),_0x42a07e['strategies']&&(this[_0x31011d(0x21e)][_0x31011d(0x211)]={..._0x42a07e['strategies']}),_0x42a07e[_0x31011d(0x1db)]&&(this[_0x31011d(0x21e)][_0x31011d(0x1db)]={...this[_0x31011d(0x21e)][_0x31011d(0x1db)],..._0x42a07e[_0x31011d(0x1db)]}),console[_0x31011d(0x1ca)](_0x31011d(0x1cc),this[_0x31011d(0x21e)]);}}async['discoverTopics'](_0x1beacd){const _0x4e83b5=a4_0x17b32e;if(this[_0x4e83b5(0x1f9)]||!_0x1beacd)return;this[_0x4e83b5(0x1f9)]=!![],console[_0x4e83b5(0x1ca)]('[TopicManager]\x20Starting\x20topic\x20discovery...');try{await new Promise((_0x22c267,_0xd8f8ba)=>{const _0x21350e=_0x4e83b5;_0x1beacd[_0x21350e(0x1e1)](_0x2303ba=>{const _0x5418f2=_0x21350e,_0x5c5871=_0x2303ba[_0x5418f2(0x1ea)]['map']((_0x377b17,_0x1762cc)=>({'name':_0x377b17,'type':_0x2303ba[_0x5418f2(0x217)][_0x1762cc]}));console[_0x5418f2(0x1ca)](_0x5418f2(0x209)+_0x5c5871[_0x5418f2(0x21b)]+_0x5418f2(0x1f2));for(const _0x53aa76 of _0x5c5871){this[_0x5418f2(0x216)](_0x53aa76);}console[_0x5418f2(0x1ca)](_0x5418f2(0x1df)),console[_0x5418f2(0x1ca)](_0x5418f2(0x1cd),Array['from'](this[_0x5418f2(0x20e)]['entries']())),_0x22c267();},_0x25268f=>{const _0x62598a=_0x21350e;console[_0x62598a(0x1de)](_0x62598a(0x210),_0x25268f),_0xd8f8ba(_0x25268f);});});}catch(_0x57caf3){console[_0x4e83b5(0x1de)]('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x57caf3);}finally{this[_0x4e83b5(0x1f9)]=![];}}[a4_0x17b32e(0x216)](_0x5153d8){const _0x54cd77=a4_0x17b32e,_0x1eca69=this[_0x54cd77(0x1d4)](_0x5153d8);this[_0x54cd77(0x20e)][_0x54cd77(0x207)](_0x5153d8['name'],{'type':_0x5153d8[_0x54cd77(0x21d)],'strategy':_0x1eca69[_0x54cd77(0x21d)],'reason':_0x1eca69[_0x54cd77(0x1e0)],'maxFrequency':_0x1eca69[_0x54cd77(0x1d9)],'isLargeData':_0x1eca69[_0x54cd77(0x1d3)],'estimatedSize':_0x1eca69[_0x54cd77(0x1ec)]}),console[_0x54cd77(0x1ca)]('[TopicManager]\x20Topic\x20'+_0x5153d8[_0x54cd77(0x1cb)]+':\x20'+_0x1eca69[_0x54cd77(0x21d)]+'\x20('+_0x1eca69['reason']+')');}[a4_0x17b32e(0x1d4)](_0x2d959a){const _0x36da2d=a4_0x17b32e;if(this['config'][_0x36da2d(0x211)][_0x2d959a[_0x36da2d(0x1cb)]]){const _0x234cbf=this[_0x36da2d(0x21e)]['strategiesConfig'][_0x2d959a['name']];return this[_0x36da2d(0x1fa)](_0x234cbf,'user_configured');}for(const [_0x211dcd,_0x1f587b]of Object[_0x36da2d(0x1c7)](this[_0x36da2d(0x21e)]['strategiesConfig'])){if(_0x2d959a[_0x36da2d(0x1cb)]['includes'](_0x211dcd[_0x36da2d(0x1e2)]('/','')))return this[_0x36da2d(0x1fa)](_0x1f587b,_0x36da2d(0x1ff));}if(this[_0x36da2d(0x1c6)](_0x2d959a[_0x36da2d(0x1cb)],_0x2d959a[_0x36da2d(0x21d)])){const _0x2feb09=this[_0x36da2d(0x208)](_0x2d959a[_0x36da2d(0x1cb)],_0x2d959a[_0x36da2d(0x21d)]);return{'type':_0x36da2d(0x20f),'reason':'video_webrtc_streaming','isLargeData':!![],'estimatedSize':_0x2feb09,'maxFrequency':null};}const _0x59a0a1=this[_0x36da2d(0x1da)](_0x2d959a[_0x36da2d(0x1cb)],_0x2d959a[_0x36da2d(0x21d)]),_0x2ac452=this['estimateTopicSize'](_0x2d959a[_0x36da2d(0x1cb)],_0x2d959a[_0x36da2d(0x21d)]);if(_0x59a0a1||_0x2ac452>this[_0x36da2d(0x21e)]['largeDataThreshold']){let _0x2a3fc0=this[_0x36da2d(0x21e)]['throttleFrequencies'][_0x2d959a['type']]||0xa,_0x363727=_0x36da2d(0x205);if(_0x2d959a['type'][_0x36da2d(0x20d)](_0x36da2d(0x1e5))||_0x2d959a[_0x36da2d(0x1cb)][_0x36da2d(0x20d)]('points'))_0x2a3fc0=this[_0x36da2d(0x21e)]['throttleFrequencies'][_0x2d959a[_0x36da2d(0x21d)]]||0x5,_0x363727='point_cloud_throttled';else{if(_0x2d959a[_0x36da2d(0x21d)]['includes']('LaserScan')||_0x2d959a[_0x36da2d(0x1cb)][_0x36da2d(0x20d)](_0x36da2d(0x20a)))_0x2a3fc0=this['config'][_0x36da2d(0x1db)][_0x2d959a['type']]||0xf,_0x363727=_0x36da2d(0x1ed);else _0x2d959a[_0x36da2d(0x21d)][_0x36da2d(0x20d)](_0x36da2d(0x206))&&(_0x2a3fc0=this[_0x36da2d(0x21e)][_0x36da2d(0x1db)][_0x2d959a[_0x36da2d(0x21d)]]||0xa,_0x363727='image_throttled');}return{'type':_0x36da2d(0x203),'reason':_0x363727,'isLargeData':!![],'estimatedSize':_0x2ac452,'maxFrequency':_0x2a3fc0};}return{'type':'websocket','reason':_0x36da2d(0x1d6),'isLargeData':![],'estimatedSize':_0x2ac452,'maxFrequency':null};}[a4_0x17b32e(0x1fa)](_0x280c2b,_0x37e8c4){const _0x103581=a4_0x17b32e;if(_0x280c2b['includes'](':')){const [_0x50cdd8,_0x30e2ed]=_0x280c2b[_0x103581(0x21a)](':');return{'type':_0x50cdd8,'reason':_0x37e8c4,'isLargeData':!![],'maxFrequency':_0x50cdd8===_0x103581(0x203)?parseFloat(_0x30e2ed):null,'estimatedSize':this['config']['largeDataThreshold']+0x1};}return{'type':_0x280c2b,'reason':_0x37e8c4,'isLargeData':_0x280c2b!=='websocket','maxFrequency':null,'estimatedSize':this[_0x103581(0x21e)][_0x103581(0x220)]+0x1};}['isLargeDataTopic'](_0x4ee24a,_0x456ed8){const _0x19a88f=a4_0x17b32e,_0x14912d=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x32af06=[_0x19a88f(0x20b),_0x19a88f(0x213),'sensor_msgs/msg/LaserScan',_0x19a88f(0x1f8)];return _0x14912d['some'](_0x59a5b2=>_0x59a5b2[_0x19a88f(0x1d1)](_0x4ee24a))||_0x32af06[_0x19a88f(0x20d)](_0x456ed8);}[a4_0x17b32e(0x1c6)](_0x5a5ef0,_0x103a4d=''){const _0x132fc7=a4_0x17b32e,_0x30ab7f=['sensor_msgs/msg/Image',_0x132fc7(0x1f8)];if(_0x30ab7f['includes'](_0x103a4d))return!_0x5a5ef0[_0x132fc7(0x20d)](_0x132fc7(0x1f5))&&!_0x5a5ef0['includes'](_0x132fc7(0x204))&&!_0x5a5ef0[_0x132fc7(0x20d)]('depth_points');return(_0x5a5ef0['includes']('image')||_0x5a5ef0[_0x132fc7(0x20d)](_0x132fc7(0x222)))&&!_0x5a5ef0[_0x132fc7(0x20d)](_0x132fc7(0x1f5))&&!_0x5a5ef0['includes'](_0x132fc7(0x204))&&!_0x5a5ef0[_0x132fc7(0x20d)](_0x132fc7(0x1cf));}[a4_0x17b32e(0x208)](_0x4dbe96,_0x3579e8){const _0x49ab8b=a4_0x17b32e,_0x12d38f={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x12d38f[_0x3579e8])return _0x12d38f[_0x3579e8];if(_0x4dbe96[_0x49ab8b(0x20d)](_0x49ab8b(0x1e9))||_0x4dbe96[_0x49ab8b(0x20d)](_0x49ab8b(0x219)))return 0x190*0x400;if(_0x4dbe96[_0x49ab8b(0x20d)](_0x49ab8b(0x1dd)))return 0x12c*0x400;if(_0x4dbe96[_0x49ab8b(0x20d)](_0x49ab8b(0x222)))return 0x32*0x400;return 0x400;}[a4_0x17b32e(0x1e8)](_0x3d809f){const _0x969530=a4_0x17b32e;let _0x3746bb=this[_0x969530(0x20e)][_0x969530(0x1d5)](_0x3d809f[_0x969530(0x1d8)]);if(!_0x3746bb){console[_0x969530(0x1ca)](_0x969530(0x21f)+_0x3d809f['topic']);let _0xe8fe46='unknown';if(_0x3d809f[_0x969530(0x1d8)][_0x969530(0x20d)](_0x969530(0x1c8))&&_0x3d809f['topic'][_0x969530(0x20d)](_0x969530(0x222)))_0xe8fe46=_0x969530(0x1f8);else{if(_0x3d809f['topic'][_0x969530(0x20d)]('image'))_0xe8fe46=_0x969530(0x213);else{if(_0x3d809f[_0x969530(0x1d8)][_0x969530(0x20d)](_0x969530(0x1e9))||_0x3d809f[_0x969530(0x1d8)]['includes'](_0x969530(0x219)))_0xe8fe46=_0x969530(0x20b);else _0x3d809f[_0x969530(0x1d8)]['includes'](_0x969530(0x20a))&&(_0xe8fe46=_0x969530(0x1e3));}}const _0x2706ab={'name':_0x3d809f[_0x969530(0x1d8)],'type':_0xe8fe46};this['analyzeTopicStrategy'](_0x2706ab),_0x3746bb=this[_0x969530(0x20e)][_0x969530(0x1d5)](_0x3d809f[_0x969530(0x1d8)]);}if(!_0x3746bb)return{'action':_0x969530(0x1fd),'message':_0x3d809f};switch(_0x3746bb[_0x969530(0x1ef)]){case _0x969530(0x203):return this['shouldThrottle'](_0x3d809f[_0x969530(0x1d8)],_0x3746bb['maxFrequency'])?{'action':'forward','message':_0x3d809f}:{'action':_0x969530(0x212)};case _0x969530(0x20f):return{'action':_0x969530(0x200)};case'websocket':default:return{'action':_0x969530(0x1fd),'message':_0x3d809f};}}['shouldThrottle'](_0x2d2c62,_0x249994){const _0x16c8b6=a4_0x17b32e;if(!_0x249994)return!![];const _0x45935f=Date['now'](),_0x2ef2d5=0x3e8/_0x249994;!this['lastMessageTimes']['has'](_0x2d2c62)&&this[_0x16c8b6(0x20c)][_0x16c8b6(0x207)](_0x2d2c62,0x0);const _0x27814d=this[_0x16c8b6(0x20c)][_0x16c8b6(0x1d5)](_0x2d2c62),_0x5f27cd=_0x45935f-_0x27814d;if(_0x5f27cd>=_0x2ef2d5)return this[_0x16c8b6(0x20c)][_0x16c8b6(0x207)](_0x2d2c62,_0x45935f),!![];return![];}[a4_0x17b32e(0x1f3)](_0x1350c3){const _0x1f5b34=a4_0x17b32e;return this[_0x1f5b34(0x20e)][_0x1f5b34(0x1d5)](_0x1350c3);}[a4_0x17b32e(0x201)](){const _0x37f09d=a4_0x17b32e;return Array[_0x37f09d(0x21c)](this[_0x37f09d(0x20e)][_0x37f09d(0x1c7)]())[_0x37f09d(0x215)](([_0x2245d6,_0x2452b2])=>({'topic':_0x2245d6,..._0x2452b2}));}[a4_0x17b32e(0x1d0)](_0x47c4b0){const _0x34e2f1=a4_0x17b32e,_0x4c5553=this['topicStrategies'][_0x34e2f1(0x1d5)](_0x47c4b0);return _0x4c5553?.[_0x34e2f1(0x1ef)]==='webrtc_only';}['getStatistics'](){const _0x551001=a4_0x17b32e,_0x4d00b9={};return this[_0x551001(0x20e)][_0x551001(0x1fe)]((_0x293054,_0x30d8a5)=>{const _0x1d48df=_0x551001;!_0x4d00b9[_0x293054[_0x1d48df(0x1ef)]]&&(_0x4d00b9[_0x293054[_0x1d48df(0x1ef)]]=0x0),_0x4d00b9[_0x293054['strategy']]++;}),{'totalTopics':this[_0x551001(0x20e)][_0x551001(0x1d2)],'strategies':_0x4d00b9,'largeDataTopics':Array[_0x551001(0x21c)](this[_0x551001(0x20e)]['entries']())[_0x551001(0x1e4)](([_0xd867f4,_0x5ec0d9])=>_0x5ec0d9[_0x551001(0x1d3)])[_0x551001(0x215)](([_0x4cb71c,_0x16e69e])=>_0x4cb71c)};}}module[a4_0x17b32e(0x1f0)]=new TopicManager();