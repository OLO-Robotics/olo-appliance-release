const a4_0x298c01=a4_0x31f4;(function(_0x2dc13f,_0x46a6eb){const _0xfeabff=a4_0x31f4,_0xed1461=_0x2dc13f();while(!![]){try{const _0x9cfaca=-parseInt(_0xfeabff(0x22f))/0x1*(parseInt(_0xfeabff(0x1ed))/0x2)+-parseInt(_0xfeabff(0x215))/0x3*(parseInt(_0xfeabff(0x1f0))/0x4)+-parseInt(_0xfeabff(0x1ff))/0x5+-parseInt(_0xfeabff(0x22e))/0x6+parseInt(_0xfeabff(0x218))/0x7+parseInt(_0xfeabff(0x22c))/0x8+parseInt(_0xfeabff(0x23d))/0x9;if(_0x9cfaca===_0x46a6eb)break;else _0xed1461['push'](_0xed1461['shift']());}catch(_0x3ca341){_0xed1461['push'](_0xed1461['shift']());}}}(a4_0x327d,0xd6e08));function a4_0x31f4(_0x3f45b5,_0x23e2ea){const _0x66c77=a4_0x327d();return a4_0x31f4=function(_0x521575,_0x151603){_0x521575=_0x521575-0x1e7;let _0x327d3c=_0x66c77[_0x521575];return _0x327d3c;},a4_0x31f4(_0x3f45b5,_0x23e2ea);}const a4_0x151603=(function(){let _0x351e0b=!![];return function(_0x416af9,_0x36efdd){const _0x3a737d=_0x351e0b?function(){if(_0x36efdd){const _0x1e8c78=_0x36efdd['apply'](_0x416af9,arguments);return _0x36efdd=null,_0x1e8c78;}}:function(){};return _0x351e0b=![],_0x3a737d;};}()),a4_0x521575=a4_0x151603(this,function(){const _0x34d809=a4_0x31f4;return a4_0x521575['toString']()[_0x34d809(0x216)](_0x34d809(0x20f))[_0x34d809(0x1fd)]()['constructor'](a4_0x521575)[_0x34d809(0x216)](_0x34d809(0x20f));});a4_0x521575();function a4_0x327d(){const _0x241d76=['isLargeData','1624000UsGsum','split','points','user_configured','discoveryInProgress','throttle_skip','parseStrategyConfig','size','compressed','determineTopicStrategy','[TopicManager]\x20Loaded\x20configuration:','\x20topics','video_webrtc_streaming','log','getTopics','defaultLargeDataStrategy','(((.+)+)+)+$','sensor_msgs/msg/Image','normal_size','discoverTopics','reason','point_cloud','159549RiEAug','search','loadConfig','9383416pomRRb','largeDataThreshold','shouldThrottle','map','handleMessage','topics','maxFrequency','[TopicManager]\x20Topic\x20discovery\x20completed','topic','forEach','throttle','pattern_configured','analyzeTopicStrategy','scan','type','filter','sensor_msgs/msg/CompressedImage','unknown','isLargeDataTopic','point_cloud_throttled','11508024vxskbF','from','5651952cKmHUG','1YwfNGe','websocket','includes','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','sensor_msgs/msg/LaserScan','length','Image','forward','replace','getTopicStrategy','lastMessageTimes','topicStrategies','topicHandling','shouldUseWebRTC','12623607kcKjER','[TopicManager]\x20Initialised','strategiesConfig','image_throttled','config','child_process','now','webrtc_only','webrtc','sensor_msgs/msg/PointCloud2','getManagedTopics','some','image','throttleFrequencies','strategy','point','2261150BGlyeq','entries','estimateTopicSize','68eQImSD','[TopicManager]\x20Found\x20','exports','error','isCameraTopic','strategies','name','[TopicManager]\x20Topic\x20discovery\x20failed:','set','depth_points','types','get','LaserScan','toString'];a4_0x327d=function(){return _0x241d76;};return a4_0x327d();}const {execSync}=require(a4_0x298c01(0x242));class TopicManager{constructor(){const _0xc414e9=a4_0x298c01;this[_0xc414e9(0x23a)]=new Map(),this['lastMessageTimes']=new Map(),this[_0xc414e9(0x203)]=![],this[_0xc414e9(0x241)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0xc414e9(0x20c)](_0xc414e9(0x23e));}[a4_0x298c01(0x217)](_0x2272a9){const _0x3abfa4=a4_0x298c01;if(_0x2272a9['topicHandling']){const _0x31670e=_0x2272a9[_0x3abfa4(0x23b)];_0x31670e[_0x3abfa4(0x219)]&&(this[_0x3abfa4(0x241)]['largeDataThreshold']=_0x31670e[_0x3abfa4(0x219)]),_0x31670e[_0x3abfa4(0x20e)]&&(this[_0x3abfa4(0x241)]['defaultLargeDataStrategy']=_0x31670e[_0x3abfa4(0x20e)]),_0x31670e[_0x3abfa4(0x1f5)]&&(this[_0x3abfa4(0x241)][_0x3abfa4(0x23f)]={..._0x31670e['strategies']}),_0x31670e[_0x3abfa4(0x1ea)]&&(this[_0x3abfa4(0x241)]['throttleFrequencies']={...this[_0x3abfa4(0x241)]['throttleFrequencies'],..._0x31670e[_0x3abfa4(0x1ea)]}),console[_0x3abfa4(0x20c)](_0x3abfa4(0x209),this[_0x3abfa4(0x241)]);}}async[a4_0x298c01(0x212)](_0x362262){const _0xecc212=a4_0x298c01;if(this['discoveryInProgress']||!_0x362262)return;this['discoveryInProgress']=!![],console[_0xecc212(0x20c)]('[TopicManager]\x20Starting\x20topic\x20discovery...');try{await new Promise((_0x1a4927,_0x19ec08)=>{const _0x133cda=_0xecc212;_0x362262[_0x133cda(0x20d)](_0x27e120=>{const _0x19374d=_0x133cda,_0x26d394=_0x27e120[_0x19374d(0x21d)][_0x19374d(0x21b)]((_0x465d11,_0x15e319)=>({'name':_0x465d11,'type':_0x27e120[_0x19374d(0x1fa)][_0x15e319]}));console['log'](_0x19374d(0x1f1)+_0x26d394[_0x19374d(0x234)]+_0x19374d(0x20a));for(const _0x32a6e5 of _0x26d394){this[_0x19374d(0x224)](_0x32a6e5);}console[_0x19374d(0x20c)](_0x19374d(0x21f)),console[_0x19374d(0x20c)]('[TopicManager]\x20Strategies:',Array[_0x19374d(0x22d)](this[_0x19374d(0x23a)][_0x19374d(0x1ee)]())),_0x1a4927();},_0x3d1c25=>{const _0x3efee9=_0x133cda;console[_0x3efee9(0x1f3)]('[TopicManager]\x20Error\x20getting\x20topics:',_0x3d1c25),_0x19ec08(_0x3d1c25);});});}catch(_0x276385){console[_0xecc212(0x1f3)](_0xecc212(0x1f7),_0x276385);}finally{this[_0xecc212(0x203)]=![];}}[a4_0x298c01(0x224)](_0x2d5602){const _0x4992bb=a4_0x298c01,_0x28cef6=this[_0x4992bb(0x208)](_0x2d5602);this[_0x4992bb(0x23a)][_0x4992bb(0x1f8)](_0x2d5602[_0x4992bb(0x1f6)],{'type':_0x2d5602[_0x4992bb(0x226)],'strategy':_0x28cef6[_0x4992bb(0x226)],'reason':_0x28cef6[_0x4992bb(0x213)],'maxFrequency':_0x28cef6[_0x4992bb(0x21e)],'isLargeData':_0x28cef6[_0x4992bb(0x1fe)],'estimatedSize':_0x28cef6['estimatedSize']}),console['log']('[TopicManager]\x20Topic\x20'+_0x2d5602[_0x4992bb(0x1f6)]+':\x20'+_0x28cef6[_0x4992bb(0x226)]+'\x20('+_0x28cef6[_0x4992bb(0x213)]+')');}[a4_0x298c01(0x208)](_0x32883e){const _0x5348dc=a4_0x298c01;if(this[_0x5348dc(0x241)]['strategiesConfig'][_0x32883e[_0x5348dc(0x1f6)]]){const _0x58bae8=this[_0x5348dc(0x241)]['strategiesConfig'][_0x32883e[_0x5348dc(0x1f6)]];return this[_0x5348dc(0x205)](_0x58bae8,_0x5348dc(0x202));}for(const [_0x3518b1,_0x5ee6a8]of Object['entries'](this['config'][_0x5348dc(0x23f)])){if(_0x32883e[_0x5348dc(0x1f6)][_0x5348dc(0x231)](_0x3518b1[_0x5348dc(0x237)]('/','')))return this['parseStrategyConfig'](_0x5ee6a8,_0x5348dc(0x223));}if(this[_0x5348dc(0x1f4)](_0x32883e[_0x5348dc(0x1f6)],_0x32883e[_0x5348dc(0x226)])){const _0x35678e=this['estimateTopicSize'](_0x32883e['name'],_0x32883e[_0x5348dc(0x226)]);return{'type':_0x5348dc(0x245),'reason':_0x5348dc(0x20b),'isLargeData':!![],'estimatedSize':_0x35678e,'maxFrequency':null};}const _0x3fcabd=this[_0x5348dc(0x22a)](_0x32883e['name'],_0x32883e[_0x5348dc(0x226)]),_0x597c24=this['estimateTopicSize'](_0x32883e[_0x5348dc(0x1f6)],_0x32883e['type']);if(_0x3fcabd||_0x597c24>this['config'][_0x5348dc(0x219)]){let _0x2e70f3=this[_0x5348dc(0x241)][_0x5348dc(0x1ea)][_0x32883e[_0x5348dc(0x226)]]||0xa,_0x2e9487='large_data_throttled';if(_0x32883e[_0x5348dc(0x226)][_0x5348dc(0x231)]('PointCloud2')||_0x32883e['name']['includes'](_0x5348dc(0x201)))_0x2e70f3=this[_0x5348dc(0x241)][_0x5348dc(0x1ea)][_0x32883e[_0x5348dc(0x226)]]||0x5,_0x2e9487=_0x5348dc(0x22b);else{if(_0x32883e['type'][_0x5348dc(0x231)](_0x5348dc(0x1fc))||_0x32883e['name'][_0x5348dc(0x231)](_0x5348dc(0x225)))_0x2e70f3=this[_0x5348dc(0x241)][_0x5348dc(0x1ea)][_0x32883e[_0x5348dc(0x226)]]||0xf,_0x2e9487='laser_scan_throttled';else _0x32883e[_0x5348dc(0x226)][_0x5348dc(0x231)](_0x5348dc(0x235))&&(_0x2e70f3=this[_0x5348dc(0x241)][_0x5348dc(0x1ea)][_0x32883e['type']]||0xa,_0x2e9487=_0x5348dc(0x240));}return{'type':_0x5348dc(0x222),'reason':_0x2e9487,'isLargeData':!![],'estimatedSize':_0x597c24,'maxFrequency':_0x2e70f3};}return{'type':_0x5348dc(0x230),'reason':_0x5348dc(0x211),'isLargeData':![],'estimatedSize':_0x597c24,'maxFrequency':null};}[a4_0x298c01(0x205)](_0x3c14bc,_0x34f2b3){const _0x5249a7=a4_0x298c01;if(_0x3c14bc[_0x5249a7(0x231)](':')){const [_0x49c3a0,_0x43e337]=_0x3c14bc[_0x5249a7(0x200)](':');return{'type':_0x49c3a0,'reason':_0x34f2b3,'isLargeData':!![],'maxFrequency':_0x49c3a0===_0x5249a7(0x222)?parseFloat(_0x43e337):null,'estimatedSize':this[_0x5249a7(0x241)]['largeDataThreshold']+0x1};}return{'type':_0x3c14bc,'reason':_0x34f2b3,'isLargeData':_0x3c14bc!==_0x5249a7(0x230),'maxFrequency':null,'estimatedSize':this[_0x5249a7(0x241)][_0x5249a7(0x219)]+0x1};}[a4_0x298c01(0x22a)](_0x58299c,_0x44c605){const _0x5d2cc1=a4_0x298c01,_0x426ec9=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x516a91=[_0x5d2cc1(0x246),'sensor_msgs/msg/Image',_0x5d2cc1(0x233),'sensor_msgs/msg/CompressedImage'];return _0x426ec9[_0x5d2cc1(0x1e8)](_0x309295=>_0x309295['test'](_0x58299c))||_0x516a91['includes'](_0x44c605);}['isCameraTopic'](_0x23173c,_0x1c5d35=''){const _0x419075=a4_0x298c01,_0x22cba9=['sensor_msgs/msg/Image',_0x419075(0x228)];if(_0x22cba9[_0x419075(0x231)](_0x1c5d35))return!_0x23173c[_0x419075(0x231)]('points')&&!_0x23173c[_0x419075(0x231)](_0x419075(0x214))&&!_0x23173c[_0x419075(0x231)](_0x419075(0x1f9));return(_0x23173c['includes'](_0x419075(0x1e9))||_0x23173c[_0x419075(0x231)](_0x419075(0x207)))&&!_0x23173c[_0x419075(0x231)]('points')&&!_0x23173c[_0x419075(0x231)](_0x419075(0x214))&&!_0x23173c[_0x419075(0x231)](_0x419075(0x1f9));}[a4_0x298c01(0x1ef)](_0x27f181,_0x3e5d59){const _0x373fd2=a4_0x298c01,_0x508b4a={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x508b4a[_0x3e5d59])return _0x508b4a[_0x3e5d59];if(_0x27f181[_0x373fd2(0x231)](_0x373fd2(0x1ec))||_0x27f181[_0x373fd2(0x231)]('cloud'))return 0x190*0x400;if(_0x27f181[_0x373fd2(0x231)]('image_raw'))return 0x12c*0x400;if(_0x27f181[_0x373fd2(0x231)](_0x373fd2(0x207)))return 0x32*0x400;return 0x400;}[a4_0x298c01(0x21c)](_0xcd745a){const _0x6e9bf0=a4_0x298c01;let _0x21cc47=this[_0x6e9bf0(0x23a)][_0x6e9bf0(0x1fb)](_0xcd745a[_0x6e9bf0(0x220)]);if(!_0x21cc47){console[_0x6e9bf0(0x20c)](_0x6e9bf0(0x232)+_0xcd745a[_0x6e9bf0(0x220)]);let _0x37fbb5=_0x6e9bf0(0x229);if(_0xcd745a['topic'][_0x6e9bf0(0x231)](_0x6e9bf0(0x1e9))&&_0xcd745a[_0x6e9bf0(0x220)][_0x6e9bf0(0x231)](_0x6e9bf0(0x207)))_0x37fbb5=_0x6e9bf0(0x228);else{if(_0xcd745a[_0x6e9bf0(0x220)][_0x6e9bf0(0x231)](_0x6e9bf0(0x1e9)))_0x37fbb5=_0x6e9bf0(0x210);else{if(_0xcd745a[_0x6e9bf0(0x220)]['includes'](_0x6e9bf0(0x1ec))||_0xcd745a[_0x6e9bf0(0x220)][_0x6e9bf0(0x231)]('cloud'))_0x37fbb5=_0x6e9bf0(0x246);else _0xcd745a[_0x6e9bf0(0x220)][_0x6e9bf0(0x231)](_0x6e9bf0(0x225))&&(_0x37fbb5=_0x6e9bf0(0x233));}}const _0x33ed81={'name':_0xcd745a['topic'],'type':_0x37fbb5};this[_0x6e9bf0(0x224)](_0x33ed81),_0x21cc47=this[_0x6e9bf0(0x23a)][_0x6e9bf0(0x1fb)](_0xcd745a[_0x6e9bf0(0x220)]);}if(!_0x21cc47)return{'action':_0x6e9bf0(0x236),'message':_0xcd745a};switch(_0x21cc47['strategy']){case _0x6e9bf0(0x222):return this[_0x6e9bf0(0x21a)](_0xcd745a['topic'],_0x21cc47['maxFrequency'])?{'action':_0x6e9bf0(0x236),'message':_0xcd745a}:{'action':_0x6e9bf0(0x204)};case _0x6e9bf0(0x245):return{'action':'webrtc_skip'};case _0x6e9bf0(0x230):default:return{'action':_0x6e9bf0(0x236),'message':_0xcd745a};}}['shouldThrottle'](_0x385d97,_0x264742){const _0x4ad24d=a4_0x298c01;if(!_0x264742)return!![];const _0x3f2081=Date[_0x4ad24d(0x243)](),_0xbc5926=0x3e8/_0x264742;!this[_0x4ad24d(0x239)]['has'](_0x385d97)&&this[_0x4ad24d(0x239)][_0x4ad24d(0x1f8)](_0x385d97,0x0);const _0x29124b=this[_0x4ad24d(0x239)][_0x4ad24d(0x1fb)](_0x385d97),_0x1a89ce=_0x3f2081-_0x29124b;if(_0x1a89ce>=_0xbc5926)return this[_0x4ad24d(0x239)][_0x4ad24d(0x1f8)](_0x385d97,_0x3f2081),!![];return![];}[a4_0x298c01(0x238)](_0x1da586){const _0x1d03a3=a4_0x298c01;return this[_0x1d03a3(0x23a)]['get'](_0x1da586);}[a4_0x298c01(0x1e7)](){const _0x5cbcd3=a4_0x298c01;return Array[_0x5cbcd3(0x22d)](this['topicStrategies']['entries']())[_0x5cbcd3(0x21b)](([_0x44eeda,_0x18e56e])=>({'topic':_0x44eeda,..._0x18e56e}));}[a4_0x298c01(0x23c)](_0x285013){const _0x2df831=a4_0x298c01,_0xab3c15=this[_0x2df831(0x23a)]['get'](_0x285013);return _0xab3c15?.[_0x2df831(0x1eb)]===_0x2df831(0x244);}['getStatistics'](){const _0x188b62=a4_0x298c01,_0x1e2484={};return this[_0x188b62(0x23a)][_0x188b62(0x221)]((_0x197288,_0x29566f)=>{const _0x3a22c7=_0x188b62;!_0x1e2484[_0x197288['strategy']]&&(_0x1e2484[_0x197288[_0x3a22c7(0x1eb)]]=0x0),_0x1e2484[_0x197288[_0x3a22c7(0x1eb)]]++;}),{'totalTopics':this[_0x188b62(0x23a)][_0x188b62(0x206)],'strategies':_0x1e2484,'largeDataTopics':Array[_0x188b62(0x22d)](this['topicStrategies'][_0x188b62(0x1ee)]())[_0x188b62(0x227)](([_0x34c195,_0x157b29])=>_0x157b29['isLargeData'])[_0x188b62(0x21b)](([_0x5bca44,_0xa422bb])=>_0x5bca44)};}}module[a4_0x298c01(0x1f2)]=new TopicManager();