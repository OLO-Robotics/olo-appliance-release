const a4_0x34b47f=a4_0x1234;(function(_0xfe2d17,_0xdebcf4){const _0x297a62=a4_0x1234,_0x23a660=_0xfe2d17();while(!![]){try{const _0x9f923e=-parseInt(_0x297a62(0xa4))/0x1*(-parseInt(_0x297a62(0xc9))/0x2)+parseInt(_0x297a62(0xaa))/0x3*(parseInt(_0x297a62(0xa3))/0x4)+-parseInt(_0x297a62(0x79))/0x5+-parseInt(_0x297a62(0xa0))/0x6+parseInt(_0x297a62(0x92))/0x7*(-parseInt(_0x297a62(0x75))/0x8)+parseInt(_0x297a62(0xb2))/0x9*(parseInt(_0x297a62(0xbe))/0xa)+-parseInt(_0x297a62(0x78))/0xb*(-parseInt(_0x297a62(0xca))/0xc);if(_0x9f923e===_0xdebcf4)break;else _0x23a660['push'](_0x23a660['shift']());}catch(_0x32e0e0){_0x23a660['push'](_0x23a660['shift']());}}}(a4_0x1fdb,0x52602));const a4_0x5999ee=(function(){let _0x462cda=!![];return function(_0x4cce58,_0x15e6ce){const _0x3ebe17=_0x462cda?function(){const _0x49171d=a4_0x1234;if(_0x15e6ce){const _0xa19d62=_0x15e6ce[_0x49171d(0x98)](_0x4cce58,arguments);return _0x15e6ce=null,_0xa19d62;}}:function(){};return _0x462cda=![],_0x3ebe17;};}()),a4_0x4126d0=a4_0x5999ee(this,function(){const _0x10f06d=a4_0x1234;return a4_0x4126d0[_0x10f06d(0x7e)]()[_0x10f06d(0xb0)]('(((.+)+)+)+$')['toString']()[_0x10f06d(0xb9)](a4_0x4126d0)[_0x10f06d(0xb0)](_0x10f06d(0xd0));});a4_0x4126d0();function a4_0x1fdb(){const _0x5c7dce=['getTopicStrategy','(((.+)+)+)+$','log','forward','[TopicManager]\x20Initialised','[TopicManager]\x20Topic\x20discovery\x20completed','loadConfig','analyzeTopicStrategy','websocket','from','split','laser_scan_throttled','get','8YgOZhJ','topic','[TopicManager]\x20Found\x20','561YZmCIg','946170hMzJfe','throttle','Image','topicHandling','set','toString','normal_size','point','type','[TopicManager]\x20Topic\x20discovery\x20failed:','discoveryInProgress','child_process','point_cloud','filter','map','scan','sensor_msgs/msg/Image','strategies','webrtc','image','webrtc_only','[TopicManager]\x20Strategies:','shouldUseWebRTC','throttle_skip','topics','2994334iMrxjU','strategiesConfig','user_configured','types','cloud','isCameraTopic','apply','strategy','pattern_configured','isLargeDataTopic','config','sensor_msgs/msg/LaserScan','getManagedTopics','throttleFrequencies','3384936BaFQdZ','error','depth_points','32ZSEogs','401GocKJA','maxFrequency','image_throttled','entries','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','[TopicManager]\x20Loaded\x20configuration:','1344JIkAKS','test','shouldThrottle','largeDataThreshold','estimateTopicSize','discoverTopics','search','parseStrategyConfig','9WUlxHM','lastMessageTimes','determineTopicStrategy','name','sensor_msgs/msg/CompressedImage','now','handleMessage','constructor','[TopicManager]\x20Error\x20getting\x20topics:','replace','topicStrategies','points','3121060tsiHnW','isLargeData','has','size','defaultLargeDataStrategy','\x20topics','includes','video_webrtc_streaming','webrtc_skip','sensor_msgs/msg/PointCloud2','length','3268EhcfMq','128856SiJvfk','reason','some','getTopics','compressed'];a4_0x1fdb=function(){return _0x5c7dce;};return a4_0x1fdb();}function a4_0x1234(_0x145808,_0x5a3195){const _0x3b70f4=a4_0x1fdb();return a4_0x1234=function(_0x4126d0,_0x5999ee){_0x4126d0=_0x4126d0-0x70;let _0x1fdb21=_0x3b70f4[_0x4126d0];return _0x1fdb21;},a4_0x1234(_0x145808,_0x5a3195);}const {execSync}=require(a4_0x34b47f(0x84));class TopicManager{constructor(){const _0x4c3b71=a4_0x34b47f;this[_0x4c3b71(0xbc)]=new Map(),this[_0x4c3b71(0xb3)]=new Map(),this[_0x4c3b71(0x83)]=![],this[_0x4c3b71(0x9c)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x4c3b71(0xd1)](_0x4c3b71(0xd3));}[a4_0x34b47f(0xd5)](_0x5c02e1){const _0x465ee5=a4_0x34b47f;if(_0x5c02e1['topicHandling']){const _0x3f7830=_0x5c02e1[_0x465ee5(0x7c)];_0x3f7830[_0x465ee5(0xad)]&&(this['config']['largeDataThreshold']=_0x3f7830[_0x465ee5(0xad)]),_0x3f7830['defaultLargeDataStrategy']&&(this[_0x465ee5(0x9c)][_0x465ee5(0xc2)]=_0x3f7830[_0x465ee5(0xc2)]),_0x3f7830[_0x465ee5(0x8a)]&&(this[_0x465ee5(0x9c)][_0x465ee5(0x93)]={..._0x3f7830[_0x465ee5(0x8a)]}),_0x3f7830[_0x465ee5(0x9f)]&&(this[_0x465ee5(0x9c)][_0x465ee5(0x9f)]={...this[_0x465ee5(0x9c)][_0x465ee5(0x9f)],..._0x3f7830['throttleFrequencies']}),console[_0x465ee5(0xd1)](_0x465ee5(0xa9),this['config']);}}async[a4_0x34b47f(0xaf)](_0x24d4a4){const _0x32fbc4=a4_0x34b47f;if(this[_0x32fbc4(0x83)]||!_0x24d4a4)return;this[_0x32fbc4(0x83)]=!![],console['log']('[TopicManager]\x20Starting\x20topic\x20discovery...');try{await new Promise((_0x14e991,_0x30ea87)=>{const _0x21b255=_0x32fbc4;_0x24d4a4[_0x21b255(0xcd)](_0x3ae63d=>{const _0x245df5=_0x21b255,_0x3416d9=_0x3ae63d[_0x245df5(0x91)][_0x245df5(0x87)]((_0x4a92d,_0x1e2aba)=>({'name':_0x4a92d,'type':_0x3ae63d[_0x245df5(0x95)][_0x1e2aba]}));console[_0x245df5(0xd1)](_0x245df5(0x77)+_0x3416d9[_0x245df5(0xc8)]+_0x245df5(0xc3));for(const _0x50015a of _0x3416d9){this[_0x245df5(0xd6)](_0x50015a);}console[_0x245df5(0xd1)](_0x245df5(0xd4)),console[_0x245df5(0xd1)](_0x245df5(0x8e),Array[_0x245df5(0x71)](this[_0x245df5(0xbc)][_0x245df5(0xa7)]())),_0x14e991();},_0x3c8ab9=>{const _0x12d9f9=_0x21b255;console[_0x12d9f9(0xa1)](_0x12d9f9(0xba),_0x3c8ab9),_0x30ea87(_0x3c8ab9);});});}catch(_0x2c847c){console[_0x32fbc4(0xa1)](_0x32fbc4(0x82),_0x2c847c);}finally{this[_0x32fbc4(0x83)]=![];}}['analyzeTopicStrategy'](_0x30be37){const _0x4aaf2e=a4_0x34b47f,_0x900e4=this[_0x4aaf2e(0xb4)](_0x30be37);this[_0x4aaf2e(0xbc)][_0x4aaf2e(0x7d)](_0x30be37['name'],{'type':_0x30be37[_0x4aaf2e(0x81)],'strategy':_0x900e4[_0x4aaf2e(0x81)],'reason':_0x900e4[_0x4aaf2e(0xcb)],'maxFrequency':_0x900e4[_0x4aaf2e(0xa5)],'isLargeData':_0x900e4['isLargeData'],'estimatedSize':_0x900e4['estimatedSize']}),console[_0x4aaf2e(0xd1)]('[TopicManager]\x20Topic\x20'+_0x30be37[_0x4aaf2e(0xb5)]+':\x20'+_0x900e4[_0x4aaf2e(0x81)]+'\x20('+_0x900e4[_0x4aaf2e(0xcb)]+')');}[a4_0x34b47f(0xb4)](_0x18816a){const _0x4db7c6=a4_0x34b47f;if(this[_0x4db7c6(0x9c)][_0x4db7c6(0x93)][_0x18816a[_0x4db7c6(0xb5)]]){const _0x1f8125=this[_0x4db7c6(0x9c)][_0x4db7c6(0x93)][_0x18816a[_0x4db7c6(0xb5)]];return this['parseStrategyConfig'](_0x1f8125,_0x4db7c6(0x94));}for(const [_0x4bf8c6,_0x406ad2]of Object[_0x4db7c6(0xa7)](this[_0x4db7c6(0x9c)]['strategiesConfig'])){if(_0x18816a[_0x4db7c6(0xb5)][_0x4db7c6(0xc4)](_0x4bf8c6[_0x4db7c6(0xbb)]('/','')))return this[_0x4db7c6(0xb1)](_0x406ad2,_0x4db7c6(0x9a));}if(this['isCameraTopic'](_0x18816a[_0x4db7c6(0xb5)],_0x18816a[_0x4db7c6(0x81)])){const _0x3db310=this[_0x4db7c6(0xae)](_0x18816a[_0x4db7c6(0xb5)],_0x18816a[_0x4db7c6(0x81)]);return{'type':_0x4db7c6(0x8b),'reason':_0x4db7c6(0xc5),'isLargeData':!![],'estimatedSize':_0x3db310,'maxFrequency':null};}const _0x39a96d=this[_0x4db7c6(0x9b)](_0x18816a[_0x4db7c6(0xb5)],_0x18816a[_0x4db7c6(0x81)]),_0x288d81=this['estimateTopicSize'](_0x18816a[_0x4db7c6(0xb5)],_0x18816a[_0x4db7c6(0x81)]);if(_0x39a96d||_0x288d81>this['config'][_0x4db7c6(0xad)]){let _0x2788dc=this[_0x4db7c6(0x9c)]['throttleFrequencies'][_0x18816a[_0x4db7c6(0x81)]]||0xa,_0x1a9e6c='large_data_throttled';if(_0x18816a[_0x4db7c6(0x81)][_0x4db7c6(0xc4)]('PointCloud2')||_0x18816a[_0x4db7c6(0xb5)][_0x4db7c6(0xc4)]('points'))_0x2788dc=this[_0x4db7c6(0x9c)]['throttleFrequencies'][_0x18816a['type']]||0x5,_0x1a9e6c='point_cloud_throttled';else{if(_0x18816a[_0x4db7c6(0x81)][_0x4db7c6(0xc4)]('LaserScan')||_0x18816a[_0x4db7c6(0xb5)]['includes'](_0x4db7c6(0x88)))_0x2788dc=this[_0x4db7c6(0x9c)][_0x4db7c6(0x9f)][_0x18816a[_0x4db7c6(0x81)]]||0xf,_0x1a9e6c=_0x4db7c6(0x73);else _0x18816a[_0x4db7c6(0x81)][_0x4db7c6(0xc4)](_0x4db7c6(0x7b))&&(_0x2788dc=this[_0x4db7c6(0x9c)][_0x4db7c6(0x9f)][_0x18816a['type']]||0xa,_0x1a9e6c=_0x4db7c6(0xa6));}return{'type':'throttle','reason':_0x1a9e6c,'isLargeData':!![],'estimatedSize':_0x288d81,'maxFrequency':_0x2788dc};}return{'type':_0x4db7c6(0x70),'reason':_0x4db7c6(0x7f),'isLargeData':![],'estimatedSize':_0x288d81,'maxFrequency':null};}[a4_0x34b47f(0xb1)](_0x2e6e28,_0x14f315){const _0x218eb8=a4_0x34b47f;if(_0x2e6e28['includes'](':')){const [_0x13f603,_0x17a8fa]=_0x2e6e28[_0x218eb8(0x72)](':');return{'type':_0x13f603,'reason':_0x14f315,'isLargeData':!![],'maxFrequency':_0x13f603===_0x218eb8(0x7a)?parseFloat(_0x17a8fa):null,'estimatedSize':this['config'][_0x218eb8(0xad)]+0x1};}return{'type':_0x2e6e28,'reason':_0x14f315,'isLargeData':_0x2e6e28!==_0x218eb8(0x70),'maxFrequency':null,'estimatedSize':this[_0x218eb8(0x9c)][_0x218eb8(0xad)]+0x1};}[a4_0x34b47f(0x9b)](_0x19a794,_0x2db73a){const _0x524f31=a4_0x34b47f,_0x18e4b1=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x58b85a=[_0x524f31(0xc7),_0x524f31(0x89),_0x524f31(0x9d),_0x524f31(0xb6)];return _0x18e4b1[_0x524f31(0xcc)](_0x528592=>_0x528592[_0x524f31(0xab)](_0x19a794))||_0x58b85a['includes'](_0x2db73a);}[a4_0x34b47f(0x97)](_0x252535,_0x4384f8=''){const _0x74bb5e=a4_0x34b47f,_0xf0b01b=[_0x74bb5e(0x89),_0x74bb5e(0xb6)];if(_0xf0b01b[_0x74bb5e(0xc4)](_0x4384f8))return!_0x252535['includes'](_0x74bb5e(0xbd))&&!_0x252535[_0x74bb5e(0xc4)](_0x74bb5e(0x85))&&!_0x252535['includes'](_0x74bb5e(0xa2));return(_0x252535[_0x74bb5e(0xc4)](_0x74bb5e(0x8c))||_0x252535[_0x74bb5e(0xc4)](_0x74bb5e(0xce)))&&!_0x252535[_0x74bb5e(0xc4)]('points')&&!_0x252535[_0x74bb5e(0xc4)](_0x74bb5e(0x85))&&!_0x252535[_0x74bb5e(0xc4)](_0x74bb5e(0xa2));}[a4_0x34b47f(0xae)](_0x165e64,_0x30c54b){const _0xa7248a=a4_0x34b47f,_0x263751={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x263751[_0x30c54b])return _0x263751[_0x30c54b];if(_0x165e64[_0xa7248a(0xc4)]('point')||_0x165e64[_0xa7248a(0xc4)](_0xa7248a(0x96)))return 0x190*0x400;if(_0x165e64[_0xa7248a(0xc4)]('image_raw'))return 0x12c*0x400;if(_0x165e64['includes'](_0xa7248a(0xce)))return 0x32*0x400;return 0x400;}[a4_0x34b47f(0xb8)](_0x208b1e){const _0x109807=a4_0x34b47f;let _0x555384=this['topicStrategies'][_0x109807(0x74)](_0x208b1e[_0x109807(0x76)]);if(!_0x555384){console[_0x109807(0xd1)](_0x109807(0xa8)+_0x208b1e[_0x109807(0x76)]);let _0x308a04='unknown';if(_0x208b1e[_0x109807(0x76)]['includes']('image')&&_0x208b1e['topic'][_0x109807(0xc4)](_0x109807(0xce)))_0x308a04=_0x109807(0xb6);else{if(_0x208b1e['topic'][_0x109807(0xc4)](_0x109807(0x8c)))_0x308a04=_0x109807(0x89);else{if(_0x208b1e[_0x109807(0x76)][_0x109807(0xc4)](_0x109807(0x80))||_0x208b1e[_0x109807(0x76)]['includes'](_0x109807(0x96)))_0x308a04='sensor_msgs/msg/PointCloud2';else _0x208b1e['topic'][_0x109807(0xc4)]('scan')&&(_0x308a04='sensor_msgs/msg/LaserScan');}}const _0x49924e={'name':_0x208b1e[_0x109807(0x76)],'type':_0x308a04};this[_0x109807(0xd6)](_0x49924e),_0x555384=this['topicStrategies'][_0x109807(0x74)](_0x208b1e[_0x109807(0x76)]);}if(!_0x555384)return{'action':_0x109807(0xd2),'message':_0x208b1e};switch(_0x555384[_0x109807(0x99)]){case _0x109807(0x7a):return this[_0x109807(0xac)](_0x208b1e['topic'],_0x555384[_0x109807(0xa5)])?{'action':_0x109807(0xd2),'message':_0x208b1e}:{'action':_0x109807(0x90)};case _0x109807(0x8b):return{'action':_0x109807(0xc6)};case _0x109807(0x70):default:return{'action':_0x109807(0xd2),'message':_0x208b1e};}}['shouldThrottle'](_0x3f17bb,_0x16092f){const _0x31c537=a4_0x34b47f;if(!_0x16092f)return!![];const _0x33a93d=Date[_0x31c537(0xb7)](),_0x2455a9=0x3e8/_0x16092f;!this[_0x31c537(0xb3)][_0x31c537(0xc0)](_0x3f17bb)&&this[_0x31c537(0xb3)][_0x31c537(0x7d)](_0x3f17bb,0x0);const _0x46f0bc=this[_0x31c537(0xb3)][_0x31c537(0x74)](_0x3f17bb),_0x5e7e11=_0x33a93d-_0x46f0bc;if(_0x5e7e11>=_0x2455a9)return this['lastMessageTimes'][_0x31c537(0x7d)](_0x3f17bb,_0x33a93d),!![];return![];}[a4_0x34b47f(0xcf)](_0x1c2bb7){const _0x242c87=a4_0x34b47f;return this[_0x242c87(0xbc)][_0x242c87(0x74)](_0x1c2bb7);}[a4_0x34b47f(0x9e)](){const _0x278482=a4_0x34b47f;return Array[_0x278482(0x71)](this[_0x278482(0xbc)]['entries']())[_0x278482(0x87)](([_0x544a75,_0x3c3e35])=>({'topic':_0x544a75,..._0x3c3e35}));}[a4_0x34b47f(0x8f)](_0x5ad1db){const _0x10675b=a4_0x34b47f,_0x1a9884=this[_0x10675b(0xbc)][_0x10675b(0x74)](_0x5ad1db);return _0x1a9884?.[_0x10675b(0x99)]===_0x10675b(0x8d);}['getStatistics'](){const _0x2d8821=a4_0x34b47f,_0x464a7f={};return this['topicStrategies']['forEach']((_0x2e354c,_0x1f7fdd)=>{const _0x482392=a4_0x1234;!_0x464a7f[_0x2e354c['strategy']]&&(_0x464a7f[_0x2e354c['strategy']]=0x0),_0x464a7f[_0x2e354c[_0x482392(0x99)]]++;}),{'totalTopics':this['topicStrategies'][_0x2d8821(0xc1)],'strategies':_0x464a7f,'largeDataTopics':Array[_0x2d8821(0x71)](this['topicStrategies']['entries']())[_0x2d8821(0x86)](([_0x266326,_0x3d707a])=>_0x3d707a[_0x2d8821(0xbf)])[_0x2d8821(0x87)](([_0x2237da,_0x15b91a])=>_0x2237da)};}}module['exports']=new TopicManager();