const a4_0x58b2a8=a4_0x3487;function a4_0x537d(){const _0x188d5d=['config','[TopicManager]\x20Strategies:','shouldThrottle','has','PointCloud2','topicHandling','error','point_cloud','replace','sensor_msgs/msg/Image','LaserScan','[TopicManager]\x20Topic\x20discovery\x20failed:','video_webrtc_streaming','throttleFrequencies','websocket','test','compressed','pattern_configured','getTopicStrategy','sensor_msgs/msg/LaserScan','maxFrequency','split','user_configured','defaultLargeDataStrategy','point','strategies','points','estimateTopicSize','5yhMgYo','webrtc','set','reason','webrtc_only','872eMMXtA','size','topic','[TopicManager]\x20Found\x20','[TopicManager]\x20Topic\x20','largeDataThreshold','shouldUseWebRTC','isLargeDataTopic','discoverTopics','image','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20','entries','parseStrategyConfig','141471MCIyfH','getTopics','isCameraTopic','Image','get','isLargeData','[TopicManager]\x20Initialised','analyzeTopicStrategy','log','4437503nhAMpO','topicStrategies','loadConfig','webrtc_skip','includes','109332TQFBfG','depth_points','large_data_throttled','map','toString','image_throttled','(((.+)+)+)+$','length','sensor_msgs/msg/PointCloud2','name','point_cloud_throttled','unknown','throttle','discoveryInProgress','lastMessageTimes','3437470WpHjxe','constructor','child_process','determineTopicStrategy','30gOJSBB','strategy','filter','forward','forEach','search','sensor_msgs/msg/CompressedImage','2454012jGLxdC','12247NztsJx','estimatedSize','from','[TopicManager]\x20Starting\x20topic\x20discovery...','type','scan','1734088hHjtwL','strategiesConfig','handleMessage','some','cloud'];a4_0x537d=function(){return _0x188d5d;};return a4_0x537d();}(function(_0x4d1302,_0x717609){const _0x3c50af=a4_0x3487,_0x3487ee=_0x4d1302();while(!![]){try{const _0x4b0b34=parseInt(_0x3c50af(0x206))/0x1+parseInt(_0x3c50af(0x20c))/0x2+-parseInt(_0x3c50af(0x1fe))/0x3*(parseInt(_0x3c50af(0x1eb))/0x4)+-parseInt(_0x3c50af(0x1cb))/0x5*(parseInt(_0x3c50af(0x205))/0x6)+-parseInt(_0x3c50af(0x1e6))/0x7+-parseInt(_0x3c50af(0x1d0))/0x8*(-parseInt(_0x3c50af(0x1dd))/0x9)+-parseInt(_0x3c50af(0x1fa))/0xa;if(_0x4b0b34===_0x717609)break;else _0x3487ee['push'](_0x3487ee['shift']());}catch(_0x252a97){_0x3487ee['push'](_0x3487ee['shift']());}}}(a4_0x537d,0xe3b2e));function a4_0x3487(_0x22121e,_0x1f41d1){const _0x4c3f74=a4_0x537d();return a4_0x3487=function(_0x5cb94f,_0xcc8ec9){_0x5cb94f=_0x5cb94f-0x1b2;let _0x537d03=_0x4c3f74[_0x5cb94f];return _0x537d03;},a4_0x3487(_0x22121e,_0x1f41d1);}const a4_0xcc8ec9=(function(){let _0x123b1e=!![];return function(_0x3c5485,_0x365f27){const _0x442faa=_0x123b1e?function(){if(_0x365f27){const _0x291b7a=_0x365f27['apply'](_0x3c5485,arguments);return _0x365f27=null,_0x291b7a;}}:function(){};return _0x123b1e=![],_0x442faa;};}()),a4_0x5cb94f=a4_0xcc8ec9(this,function(){const _0x216303=a4_0x3487;return a4_0x5cb94f[_0x216303(0x1ef)]()[_0x216303(0x203)](_0x216303(0x1f1))['toString']()[_0x216303(0x1fb)](a4_0x5cb94f)[_0x216303(0x203)]('(((.+)+)+)+$');});a4_0x5cb94f();const {execSync}=require(a4_0x58b2a8(0x1fc));class TopicManager{constructor(){const _0x26bfc6=a4_0x58b2a8;this[_0x26bfc6(0x1e7)]=new Map(),this[_0x26bfc6(0x1f9)]=new Map(),this[_0x26bfc6(0x1f8)]=![],this[_0x26bfc6(0x211)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x26bfc6(0x1cf),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x26bfc6(0x1e5)](_0x26bfc6(0x1e3));}[a4_0x58b2a8(0x1e8)](_0x524718){const _0xa17f1f=a4_0x58b2a8;if(_0x524718[_0xa17f1f(0x1b4)]){const _0x18d0b9=_0x524718[_0xa17f1f(0x1b4)];_0x18d0b9[_0xa17f1f(0x1d5)]&&(this[_0xa17f1f(0x211)][_0xa17f1f(0x1d5)]=_0x18d0b9[_0xa17f1f(0x1d5)]),_0x18d0b9['defaultLargeDataStrategy']&&(this['config']['defaultLargeDataStrategy']=_0x18d0b9[_0xa17f1f(0x1c6)]),_0x18d0b9[_0xa17f1f(0x1c8)]&&(this[_0xa17f1f(0x211)][_0xa17f1f(0x20d)]={..._0x18d0b9['strategies']}),_0x18d0b9[_0xa17f1f(0x1bc)]&&(this[_0xa17f1f(0x211)][_0xa17f1f(0x1bc)]={...this[_0xa17f1f(0x211)]['throttleFrequencies'],..._0x18d0b9[_0xa17f1f(0x1bc)]}),console['log']('[TopicManager]\x20Loaded\x20configuration:',this[_0xa17f1f(0x211)]);}}async[a4_0x58b2a8(0x1d8)](_0x141c2b){const _0x47ebb7=a4_0x58b2a8;if(this[_0x47ebb7(0x1f8)]||!_0x141c2b)return;this[_0x47ebb7(0x1f8)]=!![],console[_0x47ebb7(0x1e5)](_0x47ebb7(0x209));try{await new Promise((_0x5b9fc7,_0x534836)=>{const _0x49a4a6=_0x47ebb7;_0x141c2b[_0x49a4a6(0x1de)](_0x3cf211=>{const _0x35c6b1=_0x49a4a6,_0x1f3b36=_0x3cf211['topics'][_0x35c6b1(0x1ee)]((_0x10e19e,_0x1d3ef5)=>({'name':_0x10e19e,'type':_0x3cf211['types'][_0x1d3ef5]}));console[_0x35c6b1(0x1e5)](_0x35c6b1(0x1d3)+_0x1f3b36[_0x35c6b1(0x1f2)]+'\x20topics');for(const _0x383383 of _0x1f3b36){this['analyzeTopicStrategy'](_0x383383);}console[_0x35c6b1(0x1e5)]('[TopicManager]\x20Topic\x20discovery\x20completed'),console[_0x35c6b1(0x1e5)](_0x35c6b1(0x212),Array[_0x35c6b1(0x208)](this[_0x35c6b1(0x1e7)][_0x35c6b1(0x1db)]())),_0x5b9fc7();},_0x5b5f59=>{const _0x57cc8f=_0x49a4a6;console[_0x57cc8f(0x1b5)]('[TopicManager]\x20Error\x20getting\x20topics:',_0x5b5f59),_0x534836(_0x5b5f59);});});}catch(_0x436385){console[_0x47ebb7(0x1b5)](_0x47ebb7(0x1ba),_0x436385);}finally{this[_0x47ebb7(0x1f8)]=![];}}[a4_0x58b2a8(0x1e4)](_0x10a882){const _0x19f5be=a4_0x58b2a8,_0x139b97=this[_0x19f5be(0x1fd)](_0x10a882);this[_0x19f5be(0x1e7)][_0x19f5be(0x1cd)](_0x10a882['name'],{'type':_0x10a882[_0x19f5be(0x20a)],'strategy':_0x139b97[_0x19f5be(0x20a)],'reason':_0x139b97[_0x19f5be(0x1ce)],'maxFrequency':_0x139b97['maxFrequency'],'isLargeData':_0x139b97[_0x19f5be(0x1e2)],'estimatedSize':_0x139b97[_0x19f5be(0x207)]}),console['log'](_0x19f5be(0x1d4)+_0x10a882[_0x19f5be(0x1f4)]+':\x20'+_0x139b97[_0x19f5be(0x20a)]+'\x20('+_0x139b97['reason']+')');}[a4_0x58b2a8(0x1fd)](_0x36ec55){const _0x3fa59b=a4_0x58b2a8;if(this['config'][_0x3fa59b(0x20d)][_0x36ec55['name']]){const _0x36c69c=this['config'][_0x3fa59b(0x20d)][_0x36ec55[_0x3fa59b(0x1f4)]];return this[_0x3fa59b(0x1dc)](_0x36c69c,_0x3fa59b(0x1c5));}for(const [_0xd9668f,_0x4c40bc]of Object['entries'](this[_0x3fa59b(0x211)]['strategiesConfig'])){if(_0x36ec55['name'][_0x3fa59b(0x1ea)](_0xd9668f[_0x3fa59b(0x1b7)]('/','')))return this[_0x3fa59b(0x1dc)](_0x4c40bc,_0x3fa59b(0x1c0));}if(this[_0x3fa59b(0x1df)](_0x36ec55[_0x3fa59b(0x1f4)],_0x36ec55[_0x3fa59b(0x20a)])){const _0x276ae9=this[_0x3fa59b(0x1ca)](_0x36ec55[_0x3fa59b(0x1f4)],_0x36ec55[_0x3fa59b(0x20a)]);return{'type':_0x3fa59b(0x1cc),'reason':_0x3fa59b(0x1bb),'isLargeData':!![],'estimatedSize':_0x276ae9,'maxFrequency':null};}const _0x1432a7=this[_0x3fa59b(0x1d7)](_0x36ec55[_0x3fa59b(0x1f4)],_0x36ec55[_0x3fa59b(0x20a)]),_0x761fba=this['estimateTopicSize'](_0x36ec55[_0x3fa59b(0x1f4)],_0x36ec55[_0x3fa59b(0x20a)]);if(_0x1432a7||_0x761fba>this[_0x3fa59b(0x211)][_0x3fa59b(0x1d5)]){let _0x161922=this[_0x3fa59b(0x211)]['throttleFrequencies'][_0x36ec55[_0x3fa59b(0x20a)]]||0xa,_0x198a05=_0x3fa59b(0x1ed);if(_0x36ec55[_0x3fa59b(0x20a)][_0x3fa59b(0x1ea)](_0x3fa59b(0x1b3))||_0x36ec55[_0x3fa59b(0x1f4)][_0x3fa59b(0x1ea)](_0x3fa59b(0x1c9)))_0x161922=this['config'][_0x3fa59b(0x1bc)][_0x36ec55['type']]||0x5,_0x198a05=_0x3fa59b(0x1f5);else{if(_0x36ec55[_0x3fa59b(0x20a)][_0x3fa59b(0x1ea)](_0x3fa59b(0x1b9))||_0x36ec55[_0x3fa59b(0x1f4)][_0x3fa59b(0x1ea)](_0x3fa59b(0x20b)))_0x161922=this[_0x3fa59b(0x211)][_0x3fa59b(0x1bc)][_0x36ec55['type']]||0xf,_0x198a05='laser_scan_throttled';else _0x36ec55[_0x3fa59b(0x20a)][_0x3fa59b(0x1ea)](_0x3fa59b(0x1e0))&&(_0x161922=this[_0x3fa59b(0x211)][_0x3fa59b(0x1bc)][_0x36ec55[_0x3fa59b(0x20a)]]||0xa,_0x198a05=_0x3fa59b(0x1f0));}return{'type':_0x3fa59b(0x1f7),'reason':_0x198a05,'isLargeData':!![],'estimatedSize':_0x761fba,'maxFrequency':_0x161922};}return{'type':'websocket','reason':'normal_size','isLargeData':![],'estimatedSize':_0x761fba,'maxFrequency':null};}['parseStrategyConfig'](_0x5134bc,_0x4739e5){const _0x39cdb0=a4_0x58b2a8;if(_0x5134bc[_0x39cdb0(0x1ea)](':')){const [_0x3a6685,_0x7b2cdf]=_0x5134bc[_0x39cdb0(0x1c4)](':');return{'type':_0x3a6685,'reason':_0x4739e5,'isLargeData':!![],'maxFrequency':_0x3a6685===_0x39cdb0(0x1f7)?parseFloat(_0x7b2cdf):null,'estimatedSize':this[_0x39cdb0(0x211)][_0x39cdb0(0x1d5)]+0x1};}return{'type':_0x5134bc,'reason':_0x4739e5,'isLargeData':_0x5134bc!=='websocket','maxFrequency':null,'estimatedSize':this[_0x39cdb0(0x211)][_0x39cdb0(0x1d5)]+0x1};}[a4_0x58b2a8(0x1d7)](_0x516184,_0x3fba1e){const _0x256e76=a4_0x58b2a8,_0x40e20a=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x7354cc=[_0x256e76(0x1f3),_0x256e76(0x1b8),_0x256e76(0x1c2),_0x256e76(0x204)];return _0x40e20a[_0x256e76(0x20f)](_0x435f98=>_0x435f98[_0x256e76(0x1be)](_0x516184))||_0x7354cc[_0x256e76(0x1ea)](_0x3fba1e);}[a4_0x58b2a8(0x1df)](_0x2dc4fb,_0x5c19a8=''){const _0x5e8342=a4_0x58b2a8,_0x1459c5=[_0x5e8342(0x1b8),_0x5e8342(0x204)];if(_0x1459c5[_0x5e8342(0x1ea)](_0x5c19a8))return!_0x2dc4fb[_0x5e8342(0x1ea)](_0x5e8342(0x1c9))&&!_0x2dc4fb['includes'](_0x5e8342(0x1b6))&&!_0x2dc4fb[_0x5e8342(0x1ea)]('depth_points');return(_0x2dc4fb['includes'](_0x5e8342(0x1d9))||_0x2dc4fb[_0x5e8342(0x1ea)]('compressed'))&&!_0x2dc4fb['includes']('points')&&!_0x2dc4fb['includes'](_0x5e8342(0x1b6))&&!_0x2dc4fb[_0x5e8342(0x1ea)](_0x5e8342(0x1ec));}[a4_0x58b2a8(0x1ca)](_0x1916a2,_0x5b23d3){const _0x1643e4=a4_0x58b2a8,_0x2e24a4={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x2e24a4[_0x5b23d3])return _0x2e24a4[_0x5b23d3];if(_0x1916a2[_0x1643e4(0x1ea)](_0x1643e4(0x1c7))||_0x1916a2[_0x1643e4(0x1ea)](_0x1643e4(0x210)))return 0x190*0x400;if(_0x1916a2[_0x1643e4(0x1ea)]('image_raw'))return 0x12c*0x400;if(_0x1916a2[_0x1643e4(0x1ea)](_0x1643e4(0x1bf)))return 0x32*0x400;return 0x400;}[a4_0x58b2a8(0x20e)](_0x116c73){const _0x264c01=a4_0x58b2a8;let _0x19a468=this[_0x264c01(0x1e7)]['get'](_0x116c73[_0x264c01(0x1d2)]);if(!_0x19a468){console['log'](_0x264c01(0x1da)+_0x116c73[_0x264c01(0x1d2)]);let _0xb0a3c2=_0x264c01(0x1f6);if(_0x116c73[_0x264c01(0x1d2)][_0x264c01(0x1ea)]('image')&&_0x116c73['topic'][_0x264c01(0x1ea)](_0x264c01(0x1bf)))_0xb0a3c2=_0x264c01(0x204);else{if(_0x116c73[_0x264c01(0x1d2)][_0x264c01(0x1ea)](_0x264c01(0x1d9)))_0xb0a3c2=_0x264c01(0x1b8);else{if(_0x116c73[_0x264c01(0x1d2)][_0x264c01(0x1ea)](_0x264c01(0x1c7))||_0x116c73[_0x264c01(0x1d2)][_0x264c01(0x1ea)](_0x264c01(0x210)))_0xb0a3c2=_0x264c01(0x1f3);else _0x116c73[_0x264c01(0x1d2)]['includes']('scan')&&(_0xb0a3c2=_0x264c01(0x1c2));}}const _0x4e5520={'name':_0x116c73['topic'],'type':_0xb0a3c2};this[_0x264c01(0x1e4)](_0x4e5520),_0x19a468=this['topicStrategies'][_0x264c01(0x1e1)](_0x116c73[_0x264c01(0x1d2)]);}if(!_0x19a468)return{'action':_0x264c01(0x201),'message':_0x116c73};switch(_0x19a468[_0x264c01(0x1ff)]){case _0x264c01(0x1f7):return this[_0x264c01(0x213)](_0x116c73[_0x264c01(0x1d2)],_0x19a468[_0x264c01(0x1c3)])?{'action':'forward','message':_0x116c73}:{'action':'throttle_skip'};case _0x264c01(0x1cc):return{'action':_0x264c01(0x1e9)};case _0x264c01(0x1bd):default:return{'action':_0x264c01(0x201),'message':_0x116c73};}}['shouldThrottle'](_0x180069,_0x32070b){const _0x3fbf82=a4_0x58b2a8;if(!_0x32070b)return!![];const _0x4aae8b=Date['now'](),_0x2d2c31=0x3e8/_0x32070b;!this[_0x3fbf82(0x1f9)][_0x3fbf82(0x1b2)](_0x180069)&&this[_0x3fbf82(0x1f9)][_0x3fbf82(0x1cd)](_0x180069,0x0);const _0x5ec5e5=this[_0x3fbf82(0x1f9)][_0x3fbf82(0x1e1)](_0x180069),_0x42acf2=_0x4aae8b-_0x5ec5e5;if(_0x42acf2>=_0x2d2c31)return this['lastMessageTimes'][_0x3fbf82(0x1cd)](_0x180069,_0x4aae8b),!![];return![];}[a4_0x58b2a8(0x1c1)](_0x4d67de){const _0x14325d=a4_0x58b2a8;return this[_0x14325d(0x1e7)]['get'](_0x4d67de);}['getManagedTopics'](){const _0x450fe7=a4_0x58b2a8;return Array[_0x450fe7(0x208)](this[_0x450fe7(0x1e7)][_0x450fe7(0x1db)]())[_0x450fe7(0x1ee)](([_0x65298e,_0xee6f4d])=>({'topic':_0x65298e,..._0xee6f4d}));}[a4_0x58b2a8(0x1d6)](_0x313ef3){const _0x112e91=a4_0x58b2a8,_0x42ef42=this[_0x112e91(0x1e7)]['get'](_0x313ef3);return _0x42ef42?.[_0x112e91(0x1ff)]===_0x112e91(0x1cf);}['getStatistics'](){const _0x319043=a4_0x58b2a8,_0x543f73={};return this['topicStrategies'][_0x319043(0x202)]((_0x53262d,_0x15e56b)=>{const _0xc49e39=_0x319043;!_0x543f73[_0x53262d[_0xc49e39(0x1ff)]]&&(_0x543f73[_0x53262d[_0xc49e39(0x1ff)]]=0x0),_0x543f73[_0x53262d[_0xc49e39(0x1ff)]]++;}),{'totalTopics':this['topicStrategies'][_0x319043(0x1d1)],'strategies':_0x543f73,'largeDataTopics':Array[_0x319043(0x208)](this[_0x319043(0x1e7)][_0x319043(0x1db)]())[_0x319043(0x200)](([_0x11da21,_0x280b7f])=>_0x280b7f[_0x319043(0x1e2)])[_0x319043(0x1ee)](([_0x3c3b48,_0x4cbebc])=>_0x3c3b48)};}}module['exports']=new TopicManager();