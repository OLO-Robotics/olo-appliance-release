const a4_0x51e59d=a4_0x3888;(function(_0x5db515,_0xfc2628){const _0x520e87=a4_0x3888,_0x56a507=_0x5db515();while(!![]){try{const _0x18beb1=-parseInt(_0x520e87(0xae))/0x1*(parseInt(_0x520e87(0xc8))/0x2)+parseInt(_0x520e87(0xce))/0x3*(parseInt(_0x520e87(0x8b))/0x4)+parseInt(_0x520e87(0xb4))/0x5+parseInt(_0x520e87(0xcc))/0x6+parseInt(_0x520e87(0xd2))/0x7+parseInt(_0x520e87(0x81))/0x8*(parseInt(_0x520e87(0xaa))/0x9)+-parseInt(_0x520e87(0xb3))/0xa;if(_0x18beb1===_0xfc2628)break;else _0x56a507['push'](_0x56a507['shift']());}catch(_0x31c026){_0x56a507['push'](_0x56a507['shift']());}}}(a4_0x56e5,0xafdac));const a4_0x38fb50=(function(){let _0x3ebf0b=!![];return function(_0x3eae75,_0x53493f){const _0x345651=_0x3ebf0b?function(){const _0x59ed3e=a4_0x3888;if(_0x53493f){const _0x5a7fbf=_0x53493f[_0x59ed3e(0x83)](_0x3eae75,arguments);return _0x53493f=null,_0x5a7fbf;}}:function(){};return _0x3ebf0b=![],_0x345651;};}()),a4_0x13db3a=a4_0x38fb50(this,function(){const _0x5e3dc0=a4_0x3888;return a4_0x13db3a['toString']()['search'](_0x5e3dc0(0x90))[_0x5e3dc0(0xd1)]()[_0x5e3dc0(0x99)](a4_0x13db3a)['search']('(((.+)+)+)+$');});a4_0x13db3a();function a4_0x3888(_0x4b40f4,_0x20abbc){const _0x148ff1=a4_0x56e5();return a4_0x3888=function(_0x13db3a,_0x38fb50){_0x13db3a=_0x13db3a-0x7a;let _0x56e59e=_0x148ff1[_0x13db3a];return _0x56e59e;},a4_0x3888(_0x4b40f4,_0x20abbc);}const {execSync}=require(a4_0x51e59d(0xb2));function a4_0x56e5(){const _0x377081=['9XufMaV','video_webrtc_streaming','size','maxFrequency','169wSsndz','topicStrategies','filter','image','child_process','33222870cJVjRR','3477155kkhzsa','cloud','[TopicManager]\x20Starting\x20topic\x20discovery...','parseStrategyConfig','some','webrtc_only','scan','throttle_skip','isCameraTopic','replace','pattern_configured','[TopicManager]\x20Topic\x20discovery\x20completed','throttle','topicHandling','split','includes','webrtc_skip','image_raw','topic','websocket','1768yLmlyd','\x20topics','type','set','3441942FORFhr','log','6DCebqZ','defaultLargeDataStrategy','shouldThrottle','toString','8068039RQDLEv','throttleFrequencies','get','discoveryInProgress','reason','test','estimatedSize','[TopicManager]\x20Error\x20getting\x20topics:','large_data_throttled','points','sensor_msgs/msg/LaserScan','strategy','[TopicManager]\x20Topic\x20discovery\x20failed:','largeDataThreshold','discoverTopics','lastMessageTimes','[TopicManager]\x20Found\x20','isLargeDataTopic','map','estimateTopicSize','8629312rStJwK','length','apply','image_throttled','strategies','sensor_msgs/msg/CompressedImage','config','[TopicManager]\x20Loaded\x20configuration:','[TopicManager]\x20Strategies:','error','1383308ARZLvm','has','types','depth_points','forEach','(((.+)+)+)+$','topics','point_cloud_throttled','name','sensor_msgs/msg/PointCloud2','compressed','point_cloud','LaserScan','[TopicManager]\x20Initialised','constructor','webrtc','entries','sensor_msgs/msg/Image','strategiesConfig','determineTopicStrategy','forward','from','analyzeTopicStrategy','getTopics','isLargeData','point','now','getManagedTopics','PointCloud2','exports','[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20'];a4_0x56e5=function(){return _0x377081;};return a4_0x56e5();}class TopicManager{constructor(){const _0x4c3701=a4_0x51e59d;this['topicStrategies']=new Map(),this[_0x4c3701(0x7c)]=new Map(),this[_0x4c3701(0xd5)]=![],this['config']={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x4c3701(0xcd)](_0x4c3701(0x98));}['loadConfig'](_0x1859c0){const _0x35dc85=a4_0x51e59d;if(_0x1859c0[_0x35dc85(0xc1)]){const _0x21fdfe=_0x1859c0[_0x35dc85(0xc1)];_0x21fdfe[_0x35dc85(0x7a)]&&(this['config'][_0x35dc85(0x7a)]=_0x21fdfe[_0x35dc85(0x7a)]),_0x21fdfe[_0x35dc85(0xcf)]&&(this[_0x35dc85(0x87)][_0x35dc85(0xcf)]=_0x21fdfe[_0x35dc85(0xcf)]),_0x21fdfe[_0x35dc85(0x85)]&&(this[_0x35dc85(0x87)][_0x35dc85(0x9d)]={..._0x21fdfe['strategies']}),_0x21fdfe[_0x35dc85(0xd3)]&&(this[_0x35dc85(0x87)]['throttleFrequencies']={...this[_0x35dc85(0x87)][_0x35dc85(0xd3)],..._0x21fdfe[_0x35dc85(0xd3)]}),console['log'](_0x35dc85(0x88),this[_0x35dc85(0x87)]);}}async[a4_0x51e59d(0x7b)](_0x36cbce){const _0xae3ab7=a4_0x51e59d;if(this[_0xae3ab7(0xd5)]||!_0x36cbce)return;this[_0xae3ab7(0xd5)]=!![],console['log'](_0xae3ab7(0xb6));try{await new Promise((_0x560f29,_0x4547d3)=>{const _0x19e01b=_0xae3ab7;_0x36cbce[_0x19e01b(0xa2)](_0x3a6baf=>{const _0x18181b=_0x19e01b,_0x8d2129=_0x3a6baf[_0x18181b(0x91)]['map']((_0x49717c,_0x36ee15)=>({'name':_0x49717c,'type':_0x3a6baf[_0x18181b(0x8d)][_0x36ee15]}));console[_0x18181b(0xcd)](_0x18181b(0x7d)+_0x8d2129[_0x18181b(0x82)]+_0x18181b(0xc9));for(const _0x32639c of _0x8d2129){this[_0x18181b(0xa1)](_0x32639c);}console[_0x18181b(0xcd)](_0x18181b(0xbf)),console[_0x18181b(0xcd)](_0x18181b(0x89),Array[_0x18181b(0xa0)](this[_0x18181b(0xaf)][_0x18181b(0x9b)]())),_0x560f29();},_0x140b44=>{const _0x33d512=_0x19e01b;console[_0x33d512(0x8a)](_0x33d512(0xd9),_0x140b44),_0x4547d3(_0x140b44);});});}catch(_0x5bfe38){console['error'](_0xae3ab7(0xde),_0x5bfe38);}finally{this[_0xae3ab7(0xd5)]=![];}}[a4_0x51e59d(0xa1)](_0x964290){const _0x35bca0=a4_0x51e59d,_0x1e9e5a=this[_0x35bca0(0x9e)](_0x964290);this[_0x35bca0(0xaf)][_0x35bca0(0xcb)](_0x964290[_0x35bca0(0x93)],{'type':_0x964290[_0x35bca0(0xca)],'strategy':_0x1e9e5a[_0x35bca0(0xca)],'reason':_0x1e9e5a[_0x35bca0(0xd6)],'maxFrequency':_0x1e9e5a[_0x35bca0(0xad)],'isLargeData':_0x1e9e5a[_0x35bca0(0xa3)],'estimatedSize':_0x1e9e5a[_0x35bca0(0xd8)]}),console['log']('[TopicManager]\x20Topic\x20'+_0x964290[_0x35bca0(0x93)]+':\x20'+_0x1e9e5a[_0x35bca0(0xca)]+'\x20('+_0x1e9e5a[_0x35bca0(0xd6)]+')');}[a4_0x51e59d(0x9e)](_0x1d7f85){const _0x23f1c1=a4_0x51e59d;if(this['config'][_0x23f1c1(0x9d)][_0x1d7f85[_0x23f1c1(0x93)]]){const _0x22192f=this['config']['strategiesConfig'][_0x1d7f85['name']];return this[_0x23f1c1(0xb7)](_0x22192f,'user_configured');}for(const [_0x54d659,_0x35ea4b]of Object[_0x23f1c1(0x9b)](this['config'][_0x23f1c1(0x9d)])){if(_0x1d7f85[_0x23f1c1(0x93)][_0x23f1c1(0xc3)](_0x54d659[_0x23f1c1(0xbd)]('/','')))return this[_0x23f1c1(0xb7)](_0x35ea4b,_0x23f1c1(0xbe));}if(this['isCameraTopic'](_0x1d7f85['name'],_0x1d7f85['type'])){const _0x30bf75=this[_0x23f1c1(0x80)](_0x1d7f85['name'],_0x1d7f85[_0x23f1c1(0xca)]);return{'type':_0x23f1c1(0x9a),'reason':_0x23f1c1(0xab),'isLargeData':!![],'estimatedSize':_0x30bf75,'maxFrequency':null};}const _0x28d56e=this[_0x23f1c1(0x7e)](_0x1d7f85[_0x23f1c1(0x93)],_0x1d7f85[_0x23f1c1(0xca)]),_0x3f9fa4=this[_0x23f1c1(0x80)](_0x1d7f85[_0x23f1c1(0x93)],_0x1d7f85[_0x23f1c1(0xca)]);if(_0x28d56e||_0x3f9fa4>this[_0x23f1c1(0x87)][_0x23f1c1(0x7a)]){let _0xcf45b=this[_0x23f1c1(0x87)][_0x23f1c1(0xd3)][_0x1d7f85[_0x23f1c1(0xca)]]||0xa,_0x52eb57=_0x23f1c1(0xda);if(_0x1d7f85[_0x23f1c1(0xca)][_0x23f1c1(0xc3)](_0x23f1c1(0xa7))||_0x1d7f85[_0x23f1c1(0x93)][_0x23f1c1(0xc3)](_0x23f1c1(0xdb)))_0xcf45b=this[_0x23f1c1(0x87)][_0x23f1c1(0xd3)][_0x1d7f85[_0x23f1c1(0xca)]]||0x5,_0x52eb57=_0x23f1c1(0x92);else{if(_0x1d7f85['type'][_0x23f1c1(0xc3)](_0x23f1c1(0x97))||_0x1d7f85[_0x23f1c1(0x93)][_0x23f1c1(0xc3)]('scan'))_0xcf45b=this['config'][_0x23f1c1(0xd3)][_0x1d7f85[_0x23f1c1(0xca)]]||0xf,_0x52eb57='laser_scan_throttled';else _0x1d7f85[_0x23f1c1(0xca)][_0x23f1c1(0xc3)]('Image')&&(_0xcf45b=this[_0x23f1c1(0x87)][_0x23f1c1(0xd3)][_0x1d7f85[_0x23f1c1(0xca)]]||0xa,_0x52eb57=_0x23f1c1(0x84));}return{'type':_0x23f1c1(0xc0),'reason':_0x52eb57,'isLargeData':!![],'estimatedSize':_0x3f9fa4,'maxFrequency':_0xcf45b};}return{'type':_0x23f1c1(0xc7),'reason':'normal_size','isLargeData':![],'estimatedSize':_0x3f9fa4,'maxFrequency':null};}['parseStrategyConfig'](_0x4b1306,_0x4dff60){const _0x506ec8=a4_0x51e59d;if(_0x4b1306['includes'](':')){const [_0x3ef206,_0x341201]=_0x4b1306[_0x506ec8(0xc2)](':');return{'type':_0x3ef206,'reason':_0x4dff60,'isLargeData':!![],'maxFrequency':_0x3ef206===_0x506ec8(0xc0)?parseFloat(_0x341201):null,'estimatedSize':this[_0x506ec8(0x87)][_0x506ec8(0x7a)]+0x1};}return{'type':_0x4b1306,'reason':_0x4dff60,'isLargeData':_0x4b1306!==_0x506ec8(0xc7),'maxFrequency':null,'estimatedSize':this[_0x506ec8(0x87)]['largeDataThreshold']+0x1};}[a4_0x51e59d(0x7e)](_0x377823,_0x3f457f){const _0x3bc3b1=a4_0x51e59d,_0x4ab2e1=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x5ab443=['sensor_msgs/msg/PointCloud2',_0x3bc3b1(0x9c),_0x3bc3b1(0xdc),_0x3bc3b1(0x86)];return _0x4ab2e1[_0x3bc3b1(0xb8)](_0x12744d=>_0x12744d[_0x3bc3b1(0xd7)](_0x377823))||_0x5ab443[_0x3bc3b1(0xc3)](_0x3f457f);}[a4_0x51e59d(0xbc)](_0x9ddc82,_0x2452bd=''){const _0x1692db=a4_0x51e59d,_0x26829b=[_0x1692db(0x9c),'sensor_msgs/msg/CompressedImage'];if(_0x26829b[_0x1692db(0xc3)](_0x2452bd))return!_0x9ddc82['includes'](_0x1692db(0xdb))&&!_0x9ddc82[_0x1692db(0xc3)](_0x1692db(0x96))&&!_0x9ddc82[_0x1692db(0xc3)](_0x1692db(0x8e));return(_0x9ddc82[_0x1692db(0xc3)](_0x1692db(0xb1))||_0x9ddc82['includes']('compressed'))&&!_0x9ddc82[_0x1692db(0xc3)](_0x1692db(0xdb))&&!_0x9ddc82[_0x1692db(0xc3)](_0x1692db(0x96))&&!_0x9ddc82[_0x1692db(0xc3)](_0x1692db(0x8e));}[a4_0x51e59d(0x80)](_0x14f887,_0x1717b8){const _0x31eebf=a4_0x51e59d,_0x23230a={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x23230a[_0x1717b8])return _0x23230a[_0x1717b8];if(_0x14f887[_0x31eebf(0xc3)]('point')||_0x14f887['includes'](_0x31eebf(0xb5)))return 0x190*0x400;if(_0x14f887[_0x31eebf(0xc3)](_0x31eebf(0xc5)))return 0x12c*0x400;if(_0x14f887[_0x31eebf(0xc3)](_0x31eebf(0x95)))return 0x32*0x400;return 0x400;}['handleMessage'](_0x4a2d94){const _0x25fc9e=a4_0x51e59d;let _0x3735c6=this[_0x25fc9e(0xaf)][_0x25fc9e(0xd4)](_0x4a2d94['topic']);if(!_0x3735c6){console['log'](_0x25fc9e(0xa9)+_0x4a2d94['topic']);let _0x45a6a7='unknown';if(_0x4a2d94['topic'][_0x25fc9e(0xc3)](_0x25fc9e(0xb1))&&_0x4a2d94[_0x25fc9e(0xc6)][_0x25fc9e(0xc3)]('compressed'))_0x45a6a7=_0x25fc9e(0x86);else{if(_0x4a2d94[_0x25fc9e(0xc6)][_0x25fc9e(0xc3)](_0x25fc9e(0xb1)))_0x45a6a7=_0x25fc9e(0x9c);else{if(_0x4a2d94['topic'][_0x25fc9e(0xc3)](_0x25fc9e(0xa4))||_0x4a2d94[_0x25fc9e(0xc6)]['includes']('cloud'))_0x45a6a7=_0x25fc9e(0x94);else _0x4a2d94[_0x25fc9e(0xc6)][_0x25fc9e(0xc3)](_0x25fc9e(0xba))&&(_0x45a6a7=_0x25fc9e(0xdc));}}const _0x2910a3={'name':_0x4a2d94['topic'],'type':_0x45a6a7};this['analyzeTopicStrategy'](_0x2910a3),_0x3735c6=this[_0x25fc9e(0xaf)][_0x25fc9e(0xd4)](_0x4a2d94[_0x25fc9e(0xc6)]);}if(!_0x3735c6)return{'action':'forward','message':_0x4a2d94};switch(_0x3735c6[_0x25fc9e(0xdd)]){case'throttle':return this[_0x25fc9e(0xd0)](_0x4a2d94[_0x25fc9e(0xc6)],_0x3735c6[_0x25fc9e(0xad)])?{'action':_0x25fc9e(0x9f),'message':_0x4a2d94}:{'action':_0x25fc9e(0xbb)};case _0x25fc9e(0x9a):return{'action':_0x25fc9e(0xc4)};case _0x25fc9e(0xc7):default:return{'action':_0x25fc9e(0x9f),'message':_0x4a2d94};}}[a4_0x51e59d(0xd0)](_0x5624ad,_0x346a63){const _0x554c03=a4_0x51e59d;if(!_0x346a63)return!![];const _0x5b165a=Date[_0x554c03(0xa5)](),_0x409942=0x3e8/_0x346a63;!this[_0x554c03(0x7c)][_0x554c03(0x8c)](_0x5624ad)&&this[_0x554c03(0x7c)][_0x554c03(0xcb)](_0x5624ad,0x0);const _0x43e760=this[_0x554c03(0x7c)][_0x554c03(0xd4)](_0x5624ad),_0x7013b0=_0x5b165a-_0x43e760;if(_0x7013b0>=_0x409942)return this[_0x554c03(0x7c)]['set'](_0x5624ad,_0x5b165a),!![];return![];}['getTopicStrategy'](_0xb81ad4){const _0xc3a306=a4_0x51e59d;return this[_0xc3a306(0xaf)]['get'](_0xb81ad4);}[a4_0x51e59d(0xa6)](){const _0x267d4b=a4_0x51e59d;return Array[_0x267d4b(0xa0)](this['topicStrategies'][_0x267d4b(0x9b)]())[_0x267d4b(0x7f)](([_0x373112,_0x45b469])=>({'topic':_0x373112,..._0x45b469}));}['shouldUseWebRTC'](_0xb45ea){const _0x985826=a4_0x51e59d,_0x330fd2=this['topicStrategies']['get'](_0xb45ea);return _0x330fd2?.[_0x985826(0xdd)]===_0x985826(0xb9);}['getStatistics'](){const _0x5bee71=a4_0x51e59d,_0x2b3e0e={};return this[_0x5bee71(0xaf)][_0x5bee71(0x8f)]((_0x588b2b,_0x3bac85)=>{const _0x226c46=_0x5bee71;!_0x2b3e0e[_0x588b2b['strategy']]&&(_0x2b3e0e[_0x588b2b[_0x226c46(0xdd)]]=0x0),_0x2b3e0e[_0x588b2b[_0x226c46(0xdd)]]++;}),{'totalTopics':this[_0x5bee71(0xaf)][_0x5bee71(0xac)],'strategies':_0x2b3e0e,'largeDataTopics':Array[_0x5bee71(0xa0)](this[_0x5bee71(0xaf)][_0x5bee71(0x9b)]())[_0x5bee71(0xb0)](([_0x5979f0,_0x5c297e])=>_0x5c297e['isLargeData'])[_0x5bee71(0x7f)](([_0x3870fa,_0x1d63cf])=>_0x3870fa)};}}module[a4_0x51e59d(0xa8)]=new TopicManager();