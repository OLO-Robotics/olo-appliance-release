const a4_0x20c42f=a4_0x13d6;(function(_0x17b09e,_0x4b9fee){const _0x1acb86=a4_0x13d6,_0x47441a=_0x17b09e();while(!![]){try{const _0x1a143b=parseInt(_0x1acb86(0x1b4))/0x1+parseInt(_0x1acb86(0x1df))/0x2*(-parseInt(_0x1acb86(0x201))/0x3)+-parseInt(_0x1acb86(0x1ea))/0x4*(-parseInt(_0x1acb86(0x1c5))/0x5)+-parseInt(_0x1acb86(0x1de))/0x6*(-parseInt(_0x1acb86(0x1ee))/0x7)+parseInt(_0x1acb86(0x1da))/0x8*(-parseInt(_0x1acb86(0x1c4))/0x9)+parseInt(_0x1acb86(0x1b9))/0xa*(parseInt(_0x1acb86(0x1ec))/0xb)+-parseInt(_0x1acb86(0x1d6))/0xc*(-parseInt(_0x1acb86(0x1b8))/0xd);if(_0x1a143b===_0x4b9fee)break;else _0x47441a['push'](_0x47441a['shift']());}catch(_0x47219a){_0x47441a['push'](_0x47441a['shift']());}}}(a4_0x20b0,0x7fcce));function a4_0x20b0(){const _0x5692f9=['isCameraTopic','getTopics','reason','length','laser_scan_throttled','cloud','image','topics','discoveryInProgress','from','throttle','child_process','sensor_msgs/msg/PointCloud2','3ALlbJX','forEach','image_raw','webrtc','discoverTopics','get','websocket','set','handleMessage','strategies','throttleFrequencies','includes','forward','defaultLargeDataStrategy','(((.+)+)+)+$','large_data_throttled','search','sensor_msgs/msg/LaserScan','Image','sensor_msgs/msg/Image','point','\x20topics','31218vafQcj','map','name','strategy','1937CMBPnV','2410690lsJWki','log','shouldThrottle','largeDataThreshold','strategiesConfig','isLargeData','getManagedTopics','compressed','toString','size','parseStrategyConfig','9KIIsDC','3968000grDzHU','throttle_skip','depth_points','maxFrequency','estimatedSize','exports','config','getTopicStrategy','point_cloud','determineTopicStrategy','topic','isLargeDataTopic','image_throttled','point_cloud_throttled','analyzeTopicStrategy','lastMessageTimes','shouldUseWebRTC','1200NIRaWm','PointCloud2','webrtc_skip','LaserScan','5890544iaswTn','[TopicManager]\x20Found\x20','type','entries','6zhaBfq','1166002eYFPqB','has','webrtc_only','constructor','topicHandling','[TopicManager]\x20Starting\x20topic\x20discovery...','filter','[TopicManager]\x20Topic\x20discovery\x20failed:','estimateTopicSize','types','points','4nWzJGB','split','11ipYruT','pattern_configured','5334014mjAkJh','sensor_msgs/msg/CompressedImage','[TopicManager]\x20Strategies:','scan','topicStrategies','replace'];a4_0x20b0=function(){return _0x5692f9;};return a4_0x20b0();}const a4_0x2a41e4=(function(){let _0x214d25=!![];return function(_0x4fbb33,_0x442733){const _0x664e49=_0x214d25?function(){if(_0x442733){const _0x192f9f=_0x442733['apply'](_0x4fbb33,arguments);return _0x442733=null,_0x192f9f;}}:function(){};return _0x214d25=![],_0x664e49;};}()),a4_0x336cd4=a4_0x2a41e4(this,function(){const _0x2b891e=a4_0x13d6;return a4_0x336cd4[_0x2b891e(0x1c1)]()[_0x2b891e(0x1ae)](_0x2b891e(0x1ac))[_0x2b891e(0x1c1)]()[_0x2b891e(0x1e2)](a4_0x336cd4)[_0x2b891e(0x1ae)](_0x2b891e(0x1ac));});a4_0x336cd4();function a4_0x13d6(_0x5b087a,_0x2d6d0a){const _0x164c59=a4_0x20b0();return a4_0x13d6=function(_0x336cd4,_0x2a41e4){_0x336cd4=_0x336cd4-0x1ac;let _0x20b06e=_0x164c59[_0x336cd4];return _0x20b06e;},a4_0x13d6(_0x5b087a,_0x2d6d0a);}const {execSync}=require(a4_0x20c42f(0x1ff));class TopicManager{constructor(){const _0x3d62ff=a4_0x20c42f;this['topicStrategies']=new Map(),this[_0x3d62ff(0x1d4)]=new Map(),this[_0x3d62ff(0x1fc)]=![],this[_0x3d62ff(0x1cb)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':'webrtc_only','throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x3d62ff(0x1ba)]('[TopicManager]\x20Initialised');}['loadConfig'](_0x14c892){const _0x3b0e85=a4_0x20c42f;if(_0x14c892[_0x3b0e85(0x1e3)]){const _0x1a1f03=_0x14c892[_0x3b0e85(0x1e3)];_0x1a1f03['largeDataThreshold']&&(this[_0x3b0e85(0x1cb)][_0x3b0e85(0x1bc)]=_0x1a1f03[_0x3b0e85(0x1bc)]),_0x1a1f03[_0x3b0e85(0x20e)]&&(this[_0x3b0e85(0x1cb)][_0x3b0e85(0x20e)]=_0x1a1f03['defaultLargeDataStrategy']),_0x1a1f03['strategies']&&(this[_0x3b0e85(0x1cb)][_0x3b0e85(0x1bd)]={..._0x1a1f03[_0x3b0e85(0x20a)]}),_0x1a1f03['throttleFrequencies']&&(this[_0x3b0e85(0x1cb)]['throttleFrequencies']={...this[_0x3b0e85(0x1cb)][_0x3b0e85(0x20b)],..._0x1a1f03[_0x3b0e85(0x20b)]}),console['log']('[TopicManager]\x20Loaded\x20configuration:',this['config']);}}async[a4_0x20c42f(0x205)](_0x161d8e){const _0x587ee9=a4_0x20c42f;if(this[_0x587ee9(0x1fc)]||!_0x161d8e)return;this[_0x587ee9(0x1fc)]=!![],console[_0x587ee9(0x1ba)](_0x587ee9(0x1e4));try{await new Promise((_0x1664e1,_0x4af944)=>{const _0x1c7d78=_0x587ee9;_0x161d8e[_0x1c7d78(0x1f5)](_0x14d507=>{const _0x42fbd5=_0x1c7d78,_0x5e6e3e=_0x14d507[_0x42fbd5(0x1fb)]['map']((_0x479482,_0x482b94)=>({'name':_0x479482,'type':_0x14d507[_0x42fbd5(0x1e8)][_0x482b94]}));console[_0x42fbd5(0x1ba)](_0x42fbd5(0x1db)+_0x5e6e3e[_0x42fbd5(0x1f7)]+_0x42fbd5(0x1b3));for(const _0x3abf1d of _0x5e6e3e){this[_0x42fbd5(0x1d3)](_0x3abf1d);}console[_0x42fbd5(0x1ba)]('[TopicManager]\x20Topic\x20discovery\x20completed'),console[_0x42fbd5(0x1ba)](_0x42fbd5(0x1f0),Array[_0x42fbd5(0x1fd)](this[_0x42fbd5(0x1f2)][_0x42fbd5(0x1dd)]())),_0x1664e1();},_0x36fb99=>{console['error']('[TopicManager]\x20Error\x20getting\x20topics:',_0x36fb99),_0x4af944(_0x36fb99);});});}catch(_0x4316de){console['error'](_0x587ee9(0x1e6),_0x4316de);}finally{this[_0x587ee9(0x1fc)]=![];}}[a4_0x20c42f(0x1d3)](_0x250a31){const _0x2626cf=a4_0x20c42f,_0x1708f9=this[_0x2626cf(0x1ce)](_0x250a31);this[_0x2626cf(0x1f2)][_0x2626cf(0x208)](_0x250a31['name'],{'type':_0x250a31[_0x2626cf(0x1dc)],'strategy':_0x1708f9['type'],'reason':_0x1708f9[_0x2626cf(0x1f6)],'maxFrequency':_0x1708f9[_0x2626cf(0x1c8)],'isLargeData':_0x1708f9['isLargeData'],'estimatedSize':_0x1708f9[_0x2626cf(0x1c9)]}),console[_0x2626cf(0x1ba)]('[TopicManager]\x20Topic\x20'+_0x250a31[_0x2626cf(0x1b6)]+':\x20'+_0x1708f9[_0x2626cf(0x1dc)]+'\x20('+_0x1708f9[_0x2626cf(0x1f6)]+')');}[a4_0x20c42f(0x1ce)](_0x202785){const _0x181e63=a4_0x20c42f;if(this[_0x181e63(0x1cb)][_0x181e63(0x1bd)][_0x202785[_0x181e63(0x1b6)]]){const _0x2c8944=this[_0x181e63(0x1cb)][_0x181e63(0x1bd)][_0x202785[_0x181e63(0x1b6)]];return this['parseStrategyConfig'](_0x2c8944,'user_configured');}for(const [_0x370c69,_0xe2c7bb]of Object[_0x181e63(0x1dd)](this['config'][_0x181e63(0x1bd)])){if(_0x202785[_0x181e63(0x1b6)][_0x181e63(0x20c)](_0x370c69[_0x181e63(0x1f3)]('/','')))return this[_0x181e63(0x1c3)](_0xe2c7bb,_0x181e63(0x1ed));}if(this[_0x181e63(0x1f4)](_0x202785[_0x181e63(0x1b6)],_0x202785[_0x181e63(0x1dc)])){const _0x147e55=this[_0x181e63(0x1e7)](_0x202785[_0x181e63(0x1b6)],_0x202785['type']);return{'type':_0x181e63(0x204),'reason':'video_webrtc_streaming','isLargeData':!![],'estimatedSize':_0x147e55,'maxFrequency':null};}const _0x1f0189=this[_0x181e63(0x1d0)](_0x202785[_0x181e63(0x1b6)],_0x202785[_0x181e63(0x1dc)]),_0x1f08e4=this[_0x181e63(0x1e7)](_0x202785[_0x181e63(0x1b6)],_0x202785[_0x181e63(0x1dc)]);if(_0x1f0189||_0x1f08e4>this[_0x181e63(0x1cb)][_0x181e63(0x1bc)]){let _0x3662ec=this[_0x181e63(0x1cb)][_0x181e63(0x20b)][_0x202785['type']]||0xa,_0x5d0296=_0x181e63(0x1ad);if(_0x202785[_0x181e63(0x1dc)][_0x181e63(0x20c)](_0x181e63(0x1d7))||_0x202785[_0x181e63(0x1b6)][_0x181e63(0x20c)](_0x181e63(0x1e9)))_0x3662ec=this[_0x181e63(0x1cb)][_0x181e63(0x20b)][_0x202785[_0x181e63(0x1dc)]]||0x5,_0x5d0296=_0x181e63(0x1d2);else{if(_0x202785['type'][_0x181e63(0x20c)](_0x181e63(0x1d9))||_0x202785['name'][_0x181e63(0x20c)](_0x181e63(0x1f1)))_0x3662ec=this['config'][_0x181e63(0x20b)][_0x202785[_0x181e63(0x1dc)]]||0xf,_0x5d0296=_0x181e63(0x1f8);else _0x202785[_0x181e63(0x1dc)][_0x181e63(0x20c)](_0x181e63(0x1b0))&&(_0x3662ec=this[_0x181e63(0x1cb)]['throttleFrequencies'][_0x202785[_0x181e63(0x1dc)]]||0xa,_0x5d0296=_0x181e63(0x1d1));}return{'type':'throttle','reason':_0x5d0296,'isLargeData':!![],'estimatedSize':_0x1f08e4,'maxFrequency':_0x3662ec};}return{'type':'websocket','reason':'normal_size','isLargeData':![],'estimatedSize':_0x1f08e4,'maxFrequency':null};}[a4_0x20c42f(0x1c3)](_0x2de1e7,_0x15405c){const _0x359627=a4_0x20c42f;if(_0x2de1e7[_0x359627(0x20c)](':')){const [_0xfff1b3,_0x49b60b]=_0x2de1e7[_0x359627(0x1eb)](':');return{'type':_0xfff1b3,'reason':_0x15405c,'isLargeData':!![],'maxFrequency':_0xfff1b3==='throttle'?parseFloat(_0x49b60b):null,'estimatedSize':this[_0x359627(0x1cb)][_0x359627(0x1bc)]+0x1};}return{'type':_0x2de1e7,'reason':_0x15405c,'isLargeData':_0x2de1e7!==_0x359627(0x207),'maxFrequency':null,'estimatedSize':this[_0x359627(0x1cb)]['largeDataThreshold']+0x1};}[a4_0x20c42f(0x1d0)](_0x2ee5df,_0x39ca2f){const _0x340690=a4_0x20c42f,_0x4b782a=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x529ef7=[_0x340690(0x200),_0x340690(0x1b1),'sensor_msgs/msg/LaserScan',_0x340690(0x1ef)];return _0x4b782a['some'](_0x307733=>_0x307733['test'](_0x2ee5df))||_0x529ef7[_0x340690(0x20c)](_0x39ca2f);}[a4_0x20c42f(0x1f4)](_0x3e43e1,_0x592053=''){const _0x30cf52=a4_0x20c42f,_0x3d90be=[_0x30cf52(0x1b1),_0x30cf52(0x1ef)];if(_0x3d90be[_0x30cf52(0x20c)](_0x592053))return!_0x3e43e1['includes'](_0x30cf52(0x1e9))&&!_0x3e43e1[_0x30cf52(0x20c)](_0x30cf52(0x1cd))&&!_0x3e43e1['includes'](_0x30cf52(0x1c7));return(_0x3e43e1[_0x30cf52(0x20c)](_0x30cf52(0x1fa))||_0x3e43e1[_0x30cf52(0x20c)](_0x30cf52(0x1c0)))&&!_0x3e43e1[_0x30cf52(0x20c)](_0x30cf52(0x1e9))&&!_0x3e43e1[_0x30cf52(0x20c)](_0x30cf52(0x1cd))&&!_0x3e43e1[_0x30cf52(0x20c)](_0x30cf52(0x1c7));}[a4_0x20c42f(0x1e7)](_0x4f54fb,_0x3b1dde){const _0x152807=a4_0x20c42f,_0x1dde8e={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x1dde8e[_0x3b1dde])return _0x1dde8e[_0x3b1dde];if(_0x4f54fb[_0x152807(0x20c)](_0x152807(0x1b2))||_0x4f54fb[_0x152807(0x20c)](_0x152807(0x1f9)))return 0x190*0x400;if(_0x4f54fb['includes'](_0x152807(0x203)))return 0x12c*0x400;if(_0x4f54fb['includes'](_0x152807(0x1c0)))return 0x32*0x400;return 0x400;}[a4_0x20c42f(0x209)](_0x2ffecc){const _0x26151a=a4_0x20c42f;let _0x17c315=this[_0x26151a(0x1f2)][_0x26151a(0x206)](_0x2ffecc[_0x26151a(0x1cf)]);if(!_0x17c315){console[_0x26151a(0x1ba)]('[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20'+_0x2ffecc[_0x26151a(0x1cf)]);let _0x1c2e4b='unknown';if(_0x2ffecc[_0x26151a(0x1cf)][_0x26151a(0x20c)](_0x26151a(0x1fa))&&_0x2ffecc['topic'][_0x26151a(0x20c)](_0x26151a(0x1c0)))_0x1c2e4b='sensor_msgs/msg/CompressedImage';else{if(_0x2ffecc[_0x26151a(0x1cf)][_0x26151a(0x20c)](_0x26151a(0x1fa)))_0x1c2e4b='sensor_msgs/msg/Image';else{if(_0x2ffecc[_0x26151a(0x1cf)]['includes'](_0x26151a(0x1b2))||_0x2ffecc['topic'][_0x26151a(0x20c)](_0x26151a(0x1f9)))_0x1c2e4b='sensor_msgs/msg/PointCloud2';else _0x2ffecc[_0x26151a(0x1cf)]['includes'](_0x26151a(0x1f1))&&(_0x1c2e4b=_0x26151a(0x1af));}}const _0x2c7cd8={'name':_0x2ffecc[_0x26151a(0x1cf)],'type':_0x1c2e4b};this['analyzeTopicStrategy'](_0x2c7cd8),_0x17c315=this[_0x26151a(0x1f2)][_0x26151a(0x206)](_0x2ffecc['topic']);}if(!_0x17c315)return{'action':_0x26151a(0x20d),'message':_0x2ffecc};switch(_0x17c315[_0x26151a(0x1b7)]){case _0x26151a(0x1fe):return this[_0x26151a(0x1bb)](_0x2ffecc['topic'],_0x17c315['maxFrequency'])?{'action':_0x26151a(0x20d),'message':_0x2ffecc}:{'action':_0x26151a(0x1c6)};case'webrtc':return{'action':_0x26151a(0x1d8)};case'websocket':default:return{'action':'forward','message':_0x2ffecc};}}[a4_0x20c42f(0x1bb)](_0x35a536,_0x3665f6){const _0x35acba=a4_0x20c42f;if(!_0x3665f6)return!![];const _0x326720=Date['now'](),_0x5287bc=0x3e8/_0x3665f6;!this[_0x35acba(0x1d4)][_0x35acba(0x1e0)](_0x35a536)&&this['lastMessageTimes'][_0x35acba(0x208)](_0x35a536,0x0);const _0xe50556=this[_0x35acba(0x1d4)][_0x35acba(0x206)](_0x35a536),_0x4b3d7e=_0x326720-_0xe50556;if(_0x4b3d7e>=_0x5287bc)return this[_0x35acba(0x1d4)][_0x35acba(0x208)](_0x35a536,_0x326720),!![];return![];}[a4_0x20c42f(0x1cc)](_0x1696aa){return this['topicStrategies']['get'](_0x1696aa);}[a4_0x20c42f(0x1bf)](){const _0x2a61c2=a4_0x20c42f;return Array[_0x2a61c2(0x1fd)](this[_0x2a61c2(0x1f2)][_0x2a61c2(0x1dd)]())['map'](([_0x5b7318,_0x33f185])=>({'topic':_0x5b7318,..._0x33f185}));}[a4_0x20c42f(0x1d5)](_0x513f6e){const _0x5a91cb=a4_0x20c42f,_0x20a26c=this[_0x5a91cb(0x1f2)][_0x5a91cb(0x206)](_0x513f6e);return _0x20a26c?.[_0x5a91cb(0x1b7)]===_0x5a91cb(0x1e1);}['getStatistics'](){const _0x4f6ecc=a4_0x20c42f,_0x5b1402={};return this[_0x4f6ecc(0x1f2)][_0x4f6ecc(0x202)]((_0x49769d,_0x1c8d7d)=>{const _0x32c4c1=_0x4f6ecc;!_0x5b1402[_0x49769d[_0x32c4c1(0x1b7)]]&&(_0x5b1402[_0x49769d['strategy']]=0x0),_0x5b1402[_0x49769d[_0x32c4c1(0x1b7)]]++;}),{'totalTopics':this[_0x4f6ecc(0x1f2)][_0x4f6ecc(0x1c2)],'strategies':_0x5b1402,'largeDataTopics':Array[_0x4f6ecc(0x1fd)](this[_0x4f6ecc(0x1f2)][_0x4f6ecc(0x1dd)]())[_0x4f6ecc(0x1e5)](([_0xf047c8,_0x450cc9])=>_0x450cc9[_0x4f6ecc(0x1be)])[_0x4f6ecc(0x1b5)](([_0x3bf4b6,_0x343f5d])=>_0x3bf4b6)};}}module[a4_0x20c42f(0x1ca)]=new TopicManager();