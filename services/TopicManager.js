const a4_0x508c77=a4_0x5211;function a4_0x2fbc(){const _0x596175=['name','cloud','getManagedTopics','from','isCameraTopic','replace','set','user_configured','strategies','image_raw','analyzeTopicStrategy','[TopicManager]\x20Initialised','child_process','websocket','exports','1099LDNaxj','points','compressed','9UzesSZ','sensor_msgs/msg/PointCloud2','sensor_msgs/msg/CompressedImage','[TopicManager]\x20Error\x20getting\x20topics:','2321178zGJfoj','topicStrategies','topics','200400xSztDg','types','image','discoveryInProgress','PointCloud2','log','topicHandling','map','now','estimateTopicSize','constructor','entries','toString','getStatistics','18484213CwDPin','get','strategy','largeDataThreshold','topic','video_webrtc_streaming','isLargeDataTopic','throttle_skip','832088haBFbh','sensor_msgs/msg/LaserScan','8315arTIVK','filter','loadConfig','scan','shouldUseWebRTC','9686590KYueXK','point_cloud','includes','test','depth_points','determineTopicStrategy','getTopicStrategy','normal_size','pattern_configured','defaultLargeDataStrategy','size','webrtc','[TopicManager]\x20Topic\x20discovery\x20completed','throttleFrequencies','type','shouldThrottle','[TopicManager]\x20Strategies:','parseStrategyConfig','some','[TopicManager]\x20Topic\x20','sensor_msgs/msg/Image','apply','[TopicManager]\x20Starting\x20topic\x20discovery...','unknown','webrtc_only','length','search','isLargeData','reason','lastMessageTimes','getTopics','43904yYHSSZ','4QHMupj','LaserScan','config','strategiesConfig','error','4050eAaoOH','discoverTopics','(((.+)+)+)+$','point','throttle','maxFrequency','[TopicManager]\x20Found\x20'];a4_0x2fbc=function(){return _0x596175;};return a4_0x2fbc();}(function(_0x4dd3c2,_0x53d716){const _0x29253b=a4_0x5211,_0x486b49=_0x4dd3c2();while(!![]){try{const _0x258ef6=-parseInt(_0x29253b(0x1fe))/0x1*(parseInt(_0x29253b(0x223))/0x2)+parseInt(_0x29253b(0x220))/0x3+-parseInt(_0x29253b(0x1d7))/0x4+-parseInt(_0x29253b(0x1d9))/0x5*(parseInt(_0x29253b(0x203))/0x6)+-parseInt(_0x29253b(0x219))/0x7*(-parseInt(_0x29253b(0x1fd))/0x8)+parseInt(_0x29253b(0x21c))/0x9*(-parseInt(_0x29253b(0x1de))/0xa)+parseInt(_0x29253b(0x231))/0xb;if(_0x258ef6===_0x53d716)break;else _0x486b49['push'](_0x486b49['shift']());}catch(_0x1161ff){_0x486b49['push'](_0x486b49['shift']());}}}(a4_0x2fbc,0x96527));function a4_0x5211(_0x429753,_0x210641){const _0x4d8d52=a4_0x2fbc();return a4_0x5211=function(_0x44ec7a,_0x372327){_0x44ec7a=_0x44ec7a-0x1d0;let _0x2fbc2f=_0x4d8d52[_0x44ec7a];return _0x2fbc2f;},a4_0x5211(_0x429753,_0x210641);}const a4_0x372327=(function(){let _0x2761c1=!![];return function(_0x434124,_0x1aeb72){const _0x10725e=_0x2761c1?function(){const _0x4be964=a4_0x5211;if(_0x1aeb72){const _0x388b25=_0x1aeb72[_0x4be964(0x1f3)](_0x434124,arguments);return _0x1aeb72=null,_0x388b25;}}:function(){};return _0x2761c1=![],_0x10725e;};}()),a4_0x44ec7a=a4_0x372327(this,function(){const _0x1b93a9=a4_0x5211;return a4_0x44ec7a[_0x1b93a9(0x22f)]()['search'](_0x1b93a9(0x205))['toString']()[_0x1b93a9(0x22d)](a4_0x44ec7a)[_0x1b93a9(0x1f8)](_0x1b93a9(0x205));});a4_0x44ec7a();const {execSync}=require(a4_0x508c77(0x216));class TopicManager{constructor(){const _0x426ecc=a4_0x508c77;this[_0x426ecc(0x221)]=new Map(),this[_0x426ecc(0x1fb)]=new Map(),this[_0x426ecc(0x226)]=![],this[_0x426ecc(0x200)]={'largeDataThreshold':0x64*0x400,'defaultLargeDataStrategy':_0x426ecc(0x1f6),'throttleFrequencies':{'sensor_msgs/msg/PointCloud2':0x5,'sensor_msgs/msg/LaserScan':0xf},'strategiesConfig':{}},console[_0x426ecc(0x228)](_0x426ecc(0x215));}[a4_0x508c77(0x1db)](_0x30b204){const _0x24658e=a4_0x508c77;if(_0x30b204['topicHandling']){const _0x1e6605=_0x30b204[_0x24658e(0x229)];_0x1e6605[_0x24658e(0x1d2)]&&(this[_0x24658e(0x200)]['largeDataThreshold']=_0x1e6605[_0x24658e(0x1d2)]),_0x1e6605[_0x24658e(0x1e7)]&&(this[_0x24658e(0x200)]['defaultLargeDataStrategy']=_0x1e6605[_0x24658e(0x1e7)]),_0x1e6605[_0x24658e(0x212)]&&(this[_0x24658e(0x200)][_0x24658e(0x201)]={..._0x1e6605['strategies']}),_0x1e6605['throttleFrequencies']&&(this[_0x24658e(0x200)]['throttleFrequencies']={...this['config']['throttleFrequencies'],..._0x1e6605[_0x24658e(0x1eb)]}),console[_0x24658e(0x228)]('[TopicManager]\x20Loaded\x20configuration:',this[_0x24658e(0x200)]);}}async[a4_0x508c77(0x204)](_0x38d2b2){const _0x290831=a4_0x508c77;if(this[_0x290831(0x226)]||!_0x38d2b2)return;this[_0x290831(0x226)]=!![],console[_0x290831(0x228)](_0x290831(0x1f4));try{await new Promise((_0x5993d4,_0x48a92c)=>{const _0x285023=_0x290831;_0x38d2b2[_0x285023(0x1fc)](_0x58ae12=>{const _0x511a24=_0x285023,_0x3d0d4a=_0x58ae12[_0x511a24(0x222)][_0x511a24(0x22a)]((_0x5b17f4,_0x273e97)=>({'name':_0x5b17f4,'type':_0x58ae12[_0x511a24(0x224)][_0x273e97]}));console['log'](_0x511a24(0x209)+_0x3d0d4a[_0x511a24(0x1f7)]+'\x20topics');for(const _0x4b0eb3 of _0x3d0d4a){this[_0x511a24(0x214)](_0x4b0eb3);}console[_0x511a24(0x228)](_0x511a24(0x1ea)),console[_0x511a24(0x228)](_0x511a24(0x1ee),Array[_0x511a24(0x20d)](this[_0x511a24(0x221)][_0x511a24(0x22e)]())),_0x5993d4();},_0x29c35b=>{const _0x3b2f23=_0x285023;console[_0x3b2f23(0x202)](_0x3b2f23(0x21f),_0x29c35b),_0x48a92c(_0x29c35b);});});}catch(_0x519d66){console['error']('[TopicManager]\x20Topic\x20discovery\x20failed:',_0x519d66);}finally{this[_0x290831(0x226)]=![];}}[a4_0x508c77(0x214)](_0x2022c1){const _0x22fd35=a4_0x508c77,_0x2226a6=this[_0x22fd35(0x1e3)](_0x2022c1);this[_0x22fd35(0x221)]['set'](_0x2022c1['name'],{'type':_0x2022c1['type'],'strategy':_0x2226a6[_0x22fd35(0x1ec)],'reason':_0x2226a6[_0x22fd35(0x1fa)],'maxFrequency':_0x2226a6[_0x22fd35(0x208)],'isLargeData':_0x2226a6[_0x22fd35(0x1f9)],'estimatedSize':_0x2226a6['estimatedSize']}),console[_0x22fd35(0x228)](_0x22fd35(0x1f1)+_0x2022c1['name']+':\x20'+_0x2226a6[_0x22fd35(0x1ec)]+'\x20('+_0x2226a6[_0x22fd35(0x1fa)]+')');}[a4_0x508c77(0x1e3)](_0x4355cf){const _0x12f145=a4_0x508c77;if(this[_0x12f145(0x200)]['strategiesConfig'][_0x4355cf['name']]){const _0x40b924=this['config'][_0x12f145(0x201)][_0x4355cf['name']];return this[_0x12f145(0x1ef)](_0x40b924,_0x12f145(0x211));}for(const [_0x473ff3,_0x3587a8]of Object[_0x12f145(0x22e)](this[_0x12f145(0x200)][_0x12f145(0x201)])){if(_0x4355cf[_0x12f145(0x20a)][_0x12f145(0x1e0)](_0x473ff3[_0x12f145(0x20f)]('/','')))return this[_0x12f145(0x1ef)](_0x3587a8,_0x12f145(0x1e6));}if(this['isCameraTopic'](_0x4355cf[_0x12f145(0x20a)],_0x4355cf['type'])){const _0x553b72=this[_0x12f145(0x22c)](_0x4355cf[_0x12f145(0x20a)],_0x4355cf[_0x12f145(0x1ec)]);return{'type':_0x12f145(0x1e9),'reason':_0x12f145(0x1d4),'isLargeData':!![],'estimatedSize':_0x553b72,'maxFrequency':null};}const _0x3db9c8=this['isLargeDataTopic'](_0x4355cf[_0x12f145(0x20a)],_0x4355cf[_0x12f145(0x1ec)]),_0x20ba4b=this[_0x12f145(0x22c)](_0x4355cf[_0x12f145(0x20a)],_0x4355cf[_0x12f145(0x1ec)]);if(_0x3db9c8||_0x20ba4b>this[_0x12f145(0x200)][_0x12f145(0x1d2)]){let _0x207377=this[_0x12f145(0x200)][_0x12f145(0x1eb)][_0x4355cf['type']]||0xa,_0x12f171='large_data_throttled';if(_0x4355cf[_0x12f145(0x1ec)][_0x12f145(0x1e0)](_0x12f145(0x227))||_0x4355cf['name'][_0x12f145(0x1e0)](_0x12f145(0x21a)))_0x207377=this['config'][_0x12f145(0x1eb)][_0x4355cf[_0x12f145(0x1ec)]]||0x5,_0x12f171='point_cloud_throttled';else{if(_0x4355cf[_0x12f145(0x1ec)][_0x12f145(0x1e0)](_0x12f145(0x1ff))||_0x4355cf[_0x12f145(0x20a)][_0x12f145(0x1e0)](_0x12f145(0x1dc)))_0x207377=this[_0x12f145(0x200)][_0x12f145(0x1eb)][_0x4355cf[_0x12f145(0x1ec)]]||0xf,_0x12f171='laser_scan_throttled';else _0x4355cf[_0x12f145(0x1ec)]['includes']('Image')&&(_0x207377=this[_0x12f145(0x200)][_0x12f145(0x1eb)][_0x4355cf['type']]||0xa,_0x12f171='image_throttled');}return{'type':_0x12f145(0x207),'reason':_0x12f171,'isLargeData':!![],'estimatedSize':_0x20ba4b,'maxFrequency':_0x207377};}return{'type':'websocket','reason':_0x12f145(0x1e5),'isLargeData':![],'estimatedSize':_0x20ba4b,'maxFrequency':null};}[a4_0x508c77(0x1ef)](_0x3fdc95,_0x3fb291){const _0x24b10e=a4_0x508c77;if(_0x3fdc95[_0x24b10e(0x1e0)](':')){const [_0x354e82,_0x4c51a5]=_0x3fdc95['split'](':');return{'type':_0x354e82,'reason':_0x3fb291,'isLargeData':!![],'maxFrequency':_0x354e82===_0x24b10e(0x207)?parseFloat(_0x4c51a5):null,'estimatedSize':this[_0x24b10e(0x200)][_0x24b10e(0x1d2)]+0x1};}return{'type':_0x3fdc95,'reason':_0x3fb291,'isLargeData':_0x3fdc95!==_0x24b10e(0x217),'maxFrequency':null,'estimatedSize':this['config'][_0x24b10e(0x1d2)]+0x1};}[a4_0x508c77(0x1d5)](_0x4e7b88,_0x5975b9){const _0x39ccd9=a4_0x508c77,_0x1ef756=[/point_cloud/i,/points/i,/depth.*image/i,/.*pointcloud/i,/laser.*scan/i,/scan/i,/camera.*image_raw/i,/lidar/i],_0x1a3065=[_0x39ccd9(0x21d),_0x39ccd9(0x1f2),'sensor_msgs/msg/LaserScan','sensor_msgs/msg/CompressedImage'];return _0x1ef756[_0x39ccd9(0x1f0)](_0x28bfae=>_0x28bfae[_0x39ccd9(0x1e1)](_0x4e7b88))||_0x1a3065[_0x39ccd9(0x1e0)](_0x5975b9);}[a4_0x508c77(0x20e)](_0x3c3f89,_0x1ec651=''){const _0x215258=a4_0x508c77,_0x194acc=[_0x215258(0x1f2),_0x215258(0x21e)];if(_0x194acc['includes'](_0x1ec651))return!_0x3c3f89[_0x215258(0x1e0)]('points')&&!_0x3c3f89[_0x215258(0x1e0)]('point_cloud')&&!_0x3c3f89['includes']('depth_points');return(_0x3c3f89[_0x215258(0x1e0)](_0x215258(0x225))||_0x3c3f89[_0x215258(0x1e0)](_0x215258(0x21b)))&&!_0x3c3f89[_0x215258(0x1e0)]('points')&&!_0x3c3f89[_0x215258(0x1e0)](_0x215258(0x1df))&&!_0x3c3f89[_0x215258(0x1e0)](_0x215258(0x1e2));}[a4_0x508c77(0x22c)](_0x5b3a1a,_0x4f5300){const _0x32ea9c=a4_0x508c77,_0x3fdbcb={'sensor_msgs/msg/PointCloud2':0x1f4*0x400,'sensor_msgs/msg/Image':0x12c*0x400,'sensor_msgs/msg/CompressedImage':0x32*0x400,'sensor_msgs/msg/LaserScan':0x14*0x400};if(_0x3fdbcb[_0x4f5300])return _0x3fdbcb[_0x4f5300];if(_0x5b3a1a['includes'](_0x32ea9c(0x206))||_0x5b3a1a[_0x32ea9c(0x1e0)](_0x32ea9c(0x20b)))return 0x190*0x400;if(_0x5b3a1a[_0x32ea9c(0x1e0)](_0x32ea9c(0x213)))return 0x12c*0x400;if(_0x5b3a1a[_0x32ea9c(0x1e0)](_0x32ea9c(0x21b)))return 0x32*0x400;return 0x400;}['handleMessage'](_0x1f9ba5){const _0x1f663a=a4_0x508c77;let _0x41f01b=this['topicStrategies'][_0x1f663a(0x1d0)](_0x1f9ba5[_0x1f663a(0x1d3)]);if(!_0x41f01b){console[_0x1f663a(0x228)]('[TopicManager]\x20Discovering\x20new\x20topic\x20at\x20runtime:\x20'+_0x1f9ba5[_0x1f663a(0x1d3)]);let _0x470ee8=_0x1f663a(0x1f5);if(_0x1f9ba5[_0x1f663a(0x1d3)]['includes'](_0x1f663a(0x225))&&_0x1f9ba5[_0x1f663a(0x1d3)][_0x1f663a(0x1e0)](_0x1f663a(0x21b)))_0x470ee8='sensor_msgs/msg/CompressedImage';else{if(_0x1f9ba5[_0x1f663a(0x1d3)]['includes'](_0x1f663a(0x225)))_0x470ee8=_0x1f663a(0x1f2);else{if(_0x1f9ba5['topic'][_0x1f663a(0x1e0)](_0x1f663a(0x206))||_0x1f9ba5[_0x1f663a(0x1d3)][_0x1f663a(0x1e0)](_0x1f663a(0x20b)))_0x470ee8=_0x1f663a(0x21d);else _0x1f9ba5[_0x1f663a(0x1d3)][_0x1f663a(0x1e0)]('scan')&&(_0x470ee8=_0x1f663a(0x1d8));}}const _0x3a647c={'name':_0x1f9ba5[_0x1f663a(0x1d3)],'type':_0x470ee8};this['analyzeTopicStrategy'](_0x3a647c),_0x41f01b=this[_0x1f663a(0x221)][_0x1f663a(0x1d0)](_0x1f9ba5[_0x1f663a(0x1d3)]);}if(!_0x41f01b)return{'action':'forward','message':_0x1f9ba5};switch(_0x41f01b[_0x1f663a(0x1d1)]){case _0x1f663a(0x207):return this[_0x1f663a(0x1ed)](_0x1f9ba5[_0x1f663a(0x1d3)],_0x41f01b[_0x1f663a(0x208)])?{'action':'forward','message':_0x1f9ba5}:{'action':_0x1f663a(0x1d6)};case _0x1f663a(0x1e9):return{'action':'webrtc_skip'};case'websocket':default:return{'action':'forward','message':_0x1f9ba5};}}[a4_0x508c77(0x1ed)](_0x3245c7,_0x44581b){const _0x3f3a1e=a4_0x508c77;if(!_0x44581b)return!![];const _0x2fe4cd=Date[_0x3f3a1e(0x22b)](),_0x11fe3a=0x3e8/_0x44581b;!this[_0x3f3a1e(0x1fb)]['has'](_0x3245c7)&&this[_0x3f3a1e(0x1fb)][_0x3f3a1e(0x210)](_0x3245c7,0x0);const _0x1a7c50=this[_0x3f3a1e(0x1fb)][_0x3f3a1e(0x1d0)](_0x3245c7),_0x1e0b10=_0x2fe4cd-_0x1a7c50;if(_0x1e0b10>=_0x11fe3a)return this['lastMessageTimes']['set'](_0x3245c7,_0x2fe4cd),!![];return![];}[a4_0x508c77(0x1e4)](_0x3935e3){return this['topicStrategies']['get'](_0x3935e3);}[a4_0x508c77(0x20c)](){const _0x23eb2c=a4_0x508c77;return Array[_0x23eb2c(0x20d)](this['topicStrategies'][_0x23eb2c(0x22e)]())[_0x23eb2c(0x22a)](([_0x1c38a0,_0x52e38e])=>({'topic':_0x1c38a0,..._0x52e38e}));}[a4_0x508c77(0x1dd)](_0x2a414b){const _0x11c0d1=a4_0x508c77,_0x18be9e=this['topicStrategies']['get'](_0x2a414b);return _0x18be9e?.[_0x11c0d1(0x1d1)]===_0x11c0d1(0x1f6);}[a4_0x508c77(0x230)](){const _0x20e50b=a4_0x508c77,_0x3c81d3={};return this['topicStrategies']['forEach']((_0x56bde1,_0x412d5d)=>{const _0x2422f7=a4_0x5211;!_0x3c81d3[_0x56bde1['strategy']]&&(_0x3c81d3[_0x56bde1[_0x2422f7(0x1d1)]]=0x0),_0x3c81d3[_0x56bde1[_0x2422f7(0x1d1)]]++;}),{'totalTopics':this[_0x20e50b(0x221)][_0x20e50b(0x1e8)],'strategies':_0x3c81d3,'largeDataTopics':Array[_0x20e50b(0x20d)](this[_0x20e50b(0x221)][_0x20e50b(0x22e)]())[_0x20e50b(0x1da)](([_0x4d5f04,_0x1f34e5])=>_0x1f34e5[_0x20e50b(0x1f9)])[_0x20e50b(0x22a)](([_0x34f67a,_0x3ff6bd])=>_0x34f67a)};}}module[a4_0x508c77(0x218)]=new TopicManager();