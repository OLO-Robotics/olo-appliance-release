function a6_0x5682(){const _0x510832=['getSharedVideoSources','round','[WebRTC\x20Appliance]\x20Using\x20fallback\x20STUN\x20servers','164nTXAYl','getIceServers','\x20for\x20topic:\x20','framerate','constructor','[WebRTC\x20Appliance]\x20Failed\x20to\x20process\x20frame\x20for\x20topic\x20','stun:stun.l.google.com:19302','message','[WebRTC\x20Appliance]\x20Active\x20sessions\x20for\x20topic\x20','sensor_msgs/Image','[WebRTC\x20Appliance]\x20Error\x20sending\x20frame\x20to\x20video\x20source:','ðŸ“¹\x20Processing\x20video...','(((.+)+)+)+$','/compressed','connectionState','\x20connection\x20failed,\x20stopping\x20session','rosbridgeWs','rtcConfig','sensor_msgs/CompressedImage','[WebRTC\x20Appliance]\x20Session\x20','topic','has','#00aaff','iceServers','topicSessions','stopSession','center','unknown','toLocaleTimeString','[WebRTC\x20Appliance]\x20Processing\x20image\x20data\x20for\x20topic\x20','send','handleIceCandidate','releaseSharedVideoSource','sharedVideoSources','Waiting\x20for\x20ROS\x20image\x20data...','[WebRTC\x20Appliance]\x20Set\x20remote\x20description\x20(offer)','base64','[WebRTC\x20Appliance]\x20ICE\x20gathering\x20complete\x20for\x20session\x20','set','pop','addEventListener','compressedDepth','[WebRTC\x20Appliance]\x20Session\x20not\x20found\x20for\x20ICE\x20candidate:\x20','webrtc_init_session','16326eIBmSd','376046QDXRVN','updateTurnCredentials','#ffffff','[WebRTC\x20Appliance]\x20Stopping\x20all\x20active\x20sessions','[WebRTC\x20Appliance]\x20Successfully\x20receiving\x20data\x20on\x20','publish','search','24px\x20Arial','push','7384essvJO','#1a1a1a','[WebRTC\x20Appliance]\x20Trying\x20alternative\x20topic:\x20','drawLoadingPattern','wrtc','1160HObiiZ','\x20detected\x20as\x20','candidate','activeSessions','font','handleMessage','[WebRTC\x20Appliance]\x20Processing\x20offer\x20for\x20session\x20','add','rgba(0,\x20170,\x20255,\x20','from','close','canvas','videoTrack','address','webrtc','fillStyle','ðŸ“¹\x20Color','#00ffff','[WebRTC\x20Appliance]\x20Error\x20adding\x20ICE\x20candidate\x20for\x20session\x20','14826eNSAjU','frameCount','convertRGBAtoI420','35fYHEQP','sensor_msgs/msg/CompressedImage','size','[WebRTC\x20Appliance]\x20Creating\x20new\x20shared\x20video\x20source\x20for\x20topic\x20','[WebRTC\x20Appliance]\x20Answer\x20sent\x20for\x20session\x20','beginPath','[WebRTC\x20Appliance]\x20Created\x20answer',',\x20trying\x20alternative\x20depth\x20topics','1655688GjRkff','fill','getActiveSessions','[WebRTC\x20Appliance]\x20Stopping\x20session:\x20','error','exports','split','./turnCredentialsService','peerConnection','../config','height','[WebRTC\x20Appliance]\x20Depth\x20processing\x20issue.\x20Alternative\x20topics:\x20','keys','arc','depthProcessor','compressed','webrtc_ice_candidate','sensor_msgs/msg/Image','48CAaSrh','[WebRTC\x20Appliance]\x20Topic\x20','msg','startsWith','[WebRTC\x20Appliance]\x20Error\x20processing\x20alternative\x20topic\x20message:',',\x20size:\x20','\x20connection\x20state:\x20','includes','12px\x20Arial','max','onconnectionstatechange','cleanupSession','warn','\x20initialized\x20successfully','webrtc_stop_session','delete','initializeSession','[WebRTC\x20Appliance]\x20Cleaned\x20up\x20session:\x20','[WebRTC\x20Appliance]\x20Service\x20initialized','data','12px\x20monospace','[WebRTC\x20Appliance]\x20Trying\x20subscription\x20with\x20type:\x20','webrtc_offer','stun:stun1.l.google.com:19302','isDepthTopic','./DepthImageProcessor','serverWs','failed','color','[WebRTC\x20Appliance]\x20Released\x20shared\x20video\x20source\x20for\x20topic\x20','webrtc_','length','type','toString','webrtc_answer','fillRect','processDepthImage','addIceCandidate','depth','updateCanvasWithImageData','getContext','readyState','unsubscribe','/image_raw','subscribeToROSTopic','[WebRTC\x20Appliance]\x20Generated\x20ICE\x20candidate\x20for\x20session\x20','rgba(0,\x200,\x200,\x200.7)','16px\x20Arial','[WebRTC\x20Appliance]\x20No\x20data\x20received\x20on\x20','videoSource','/9j/','[WebRTC\x20Appliance]\x20Got\x20data\x20from\x20alternative\x20topic\x20','subscribe','onicecandidate','stringify','34436lRQgAn','video','replace','OPEN','\x20image,\x20trying\x20message\x20types:','Topic:\x20','[WebRTC\x20Appliance]\x20Attempted\x20to\x20stop\x20non-existent\x20session:\x20','random','stop','[WebRTC\x20Appliance]\x20TURN\x20credentials\x20updated\x20successfully','[WebRTC\x20Appliance]\x20Error\x20initializing\x20session\x20','fillText','[WebRTC\x20Appliance]\x20Updating\x20TURN\x20credentials...','log','session_id','closed','2KPcnKP','sin','[WebRTC\x20Appliance]\x20Subscribing\x20to\x20ROS\x20topic:\x20','onFrame','parse','[WebRTC\x20Appliance]\x20Error\x20handling\x20offer\x20for\x20session\x20','[WebRTC\x20Appliance]\x20Error\x20during\x20session\x20cleanup:\x20','getImageData','setRemoteDescription','1404465pYHpOi','rosSubscriber','now','width','textAlign',',\x20cleaning\x20up\x20shared\x20resources','processColorImage','[WebRTC\x20Appliance]\x20ROSBridge\x20not\x20connected','getOrCreateSharedVideoSource','sendFrameToVideoSource','get','handleOffer','\x20with\x20message\x20type\x20','ðŸ”\x20Depth','initialize','serverUrl'];a6_0x5682=function(){return _0x510832;};return a6_0x5682();}const a6_0x1175f5=a6_0x29dd;(function(_0x3a72c2,_0x26926c){const _0x33aa1a=a6_0x29dd,_0x4f7201=_0x3a72c2();while(!![]){try{const _0x4429b0=-parseInt(_0x33aa1a(0x104))/0x1*(-parseInt(_0x33aa1a(0xf4))/0x2)+-parseInt(_0x33aa1a(0xa0))/0x3*(parseInt(_0x33aa1a(0x120))/0x4)+-parseInt(_0x33aa1a(0x10d))/0x5+parseInt(_0x33aa1a(0xab))/0x6+parseInt(_0x33aa1a(0xa3))/0x7*(-parseInt(_0x33aa1a(0x88))/0x8)+parseInt(_0x33aa1a(0x7e))/0x9*(parseInt(_0x33aa1a(0x8d))/0xa)+parseInt(_0x33aa1a(0x7f))/0xb*(parseInt(_0x33aa1a(0xbd))/0xc);if(_0x4429b0===_0x26926c)break;else _0x4f7201['push'](_0x4f7201['shift']());}catch(_0xbda4f){_0x4f7201['push'](_0x4f7201['shift']());}}}(a6_0x5682,0x295ce));const a6_0x6fbfef=(function(){let _0xf01d05=!![];return function(_0x4d836e,_0x85f835){const _0x11ef02=_0xf01d05?function(){if(_0x85f835){const _0x4c6af9=_0x85f835['apply'](_0x4d836e,arguments);return _0x85f835=null,_0x4c6af9;}}:function(){};return _0xf01d05=![],_0x11ef02;};}()),a6_0x3852c2=a6_0x6fbfef(this,function(){const _0x59e9fa=a6_0x29dd;return a6_0x3852c2[_0x59e9fa(0xde)]()['search'](_0x59e9fa(0x12c))[_0x59e9fa(0xde)]()[_0x59e9fa(0x124)](a6_0x3852c2)[_0x59e9fa(0x85)]('(((.+)+)+)+$');});a6_0x3852c2();function a6_0x29dd(_0x54966f,_0x15cb42){const _0x3c923e=a6_0x5682();return a6_0x29dd=function(_0x3852c2,_0x6fbfef){_0x3852c2=_0x3852c2-0x78;let _0x56825c=_0x3c923e[_0x3852c2];return _0x56825c;},a6_0x29dd(_0x54966f,_0x15cb42);}const {RTCPeerConnection,RTCSessionDescription,RTCIceCandidate,nonstandard}=require(a6_0x1175f5(0x8c)),sharp=require('sharp'),config=require(a6_0x1175f5(0xb4)),DepthImageProcessor=require(a6_0x1175f5(0xd6)),turnCredentialsService=require(a6_0x1175f5(0xb2));class ApplianceWebRTCService{constructor(){const _0x42272b=a6_0x1175f5;this[_0x42272b(0x90)]=new Map(),this[_0x42272b(0x138)]=new Map(),this['sharedVideoSources']=new Map(),this[_0x42272b(0x130)]=null,this['serverWs']=null,this['depthProcessor']=new DepthImageProcessor(),this[_0x42272b(0x131)]={'iceServers':[{'urls':_0x42272b(0x126)},{'urls':_0x42272b(0xd4)}]};}[a6_0x1175f5(0x11b)](_0x3e6042,_0xe6efe9){const _0x3390b3=a6_0x1175f5;this['rosbridgeWs']=_0x3e6042,this[_0x3390b3(0xd7)]=_0xe6efe9,turnCredentialsService[_0x3390b3(0x11b)](config[_0x3390b3(0x11c)]),this['updateTurnCredentials'](),console[_0x3390b3(0x101)](_0x3390b3(0xcf));}async[a6_0x1175f5(0x80)](){const _0x299287=a6_0x1175f5;try{console[_0x299287(0x101)](_0x299287(0x100));const _0x4bdbf7=await turnCredentialsService[_0x299287(0x121)]();this[_0x299287(0x131)][_0x299287(0x137)]=_0x4bdbf7,console[_0x299287(0x101)](_0x299287(0xfd));}catch(_0x169dcb){console[_0x299287(0xaf)]('[WebRTC\x20Appliance]\x20Error\x20updating\x20TURN\x20credentials:',_0x169dcb),console[_0x299287(0x101)](_0x299287(0x11f));}}[a6_0x1175f5(0x92)](_0x41a131){const _0x3262e=a6_0x1175f5;if(!_0x41a131['op']||!_0x41a131['op'][_0x3262e(0xc0)](_0x3262e(0xdb)))return![];console[_0x3262e(0x101)]('[WebRTC\x20Appliance]\x20Handling\x20message:\x20'+_0x41a131['op']);switch(_0x41a131['op']){case _0x3262e(0x7d):this[_0x3262e(0xcd)](_0x41a131[_0x3262e(0x102)],_0x41a131[_0x3262e(0x134)]);return!![];case _0x3262e(0xd3):this['handleOffer'](_0x41a131[_0x3262e(0x102)],_0x41a131['offer']);return!![];case _0x3262e(0xbb):this[_0x3262e(0x13f)](_0x41a131[_0x3262e(0x102)],_0x41a131[_0x3262e(0x8f)]);return!![];case _0x3262e(0xcb):this[_0x3262e(0x139)](_0x41a131[_0x3262e(0x102)]);return!![];default:console['warn']('[WebRTC\x20Appliance]\x20Unknown\x20operation:\x20'+_0x41a131['op']);return![];}}[a6_0x1175f5(0x115)](_0x419dad){const _0x3ab54f=a6_0x1175f5;if(this[_0x3ab54f(0x141)][_0x3ab54f(0x135)](_0x419dad)){const _0x4d2910=this[_0x3ab54f(0x141)][_0x3ab54f(0x117)](_0x419dad);return _0x4d2910[_0x3ab54f(0xa1)]++,console['log']('[WebRTC\x20Appliance]\x20Reusing\x20shared\x20video\x20source\x20for\x20topic\x20'+_0x419dad+'\x20('+_0x4d2910['frameCount']+'\x20sessions)'),_0x4d2910;}console[_0x3ab54f(0x101)](_0x3ab54f(0xa6)+_0x419dad);const {createCanvas:_0x5c50d3}=require('canvas'),_0x382f07=_0x5c50d3(config['webrtc'][_0x3ab54f(0xf5)][_0x3ab54f(0x110)],config[_0x3ab54f(0x9b)]['video'][_0x3ab54f(0xb5)]),_0x565adc=_0x382f07[_0x3ab54f(0xe5)]('2d');this[_0x3ab54f(0x8b)](_0x382f07,_0x565adc);const {RTCVideoSource:_0x568dc8}=nonstandard,_0x333a17=new _0x568dc8();let _0x43eba0=0x0;const _0x270e41=0x3e8/config[_0x3ab54f(0x9b)]['video'][_0x3ab54f(0x123)],_0x5a9eb1=this['subscribeToROSTopic'](_0x419dad,_0xae5656=>{const _0x623b12=_0x3ab54f,_0x134652=Date[_0x623b12(0x10f)]();_0x134652-_0x43eba0>=_0x270e41&&(_0x43eba0=_0x134652,this[_0x623b12(0xe4)](_0x382f07,_0x565adc,_0xae5656,_0x419dad,_0x333a17));}),_0x4e6ac9={'videoSource':_0x333a17,'canvas':_0x382f07,'rosSubscriber':_0x5a9eb1,'frameCount':0x1,'topic':_0x419dad};return this[_0x3ab54f(0x141)]['set'](_0x419dad,_0x4e6ac9),_0x4e6ac9;}[a6_0x1175f5(0x140)](_0x32bc2a){const _0x364e63=a6_0x1175f5,_0x164cf9=this[_0x364e63(0x141)][_0x364e63(0x117)](_0x32bc2a);if(!_0x164cf9)return;_0x164cf9['frameCount']--,console[_0x364e63(0x101)](_0x364e63(0xda)+_0x32bc2a+'\x20('+_0x164cf9['frameCount']+'\x20sessions\x20remaining)'),_0x164cf9[_0x364e63(0xa1)]<=0x0&&(console[_0x364e63(0x101)]('[WebRTC\x20Appliance]\x20No\x20more\x20sessions\x20for\x20topic\x20'+_0x32bc2a+_0x364e63(0x112)),_0x164cf9['videoSource']&&(_0x164cf9[_0x364e63(0xee)]=null),_0x164cf9['rosSubscriber']&&_0x164cf9[_0x364e63(0x10e)][_0x364e63(0xe7)](),this[_0x364e63(0x141)]['delete'](_0x32bc2a));}async['initializeSession'](_0x29002b,_0x92ec9c){const _0x2e42cd=a6_0x1175f5;try{console['log']('[WebRTC\x20Appliance]\x20Initializing\x20session\x20'+_0x29002b+'\x20for\x20topic\x20'+_0x92ec9c);const _0x75ea60=this[_0x2e42cd(0x115)](_0x92ec9c),_0xdb5906=new RTCPeerConnection(this[_0x2e42cd(0x131)]),_0x53621f=_0x75ea60['videoSource']['createTrack']({'width':config[_0x2e42cd(0x9b)][_0x2e42cd(0xf5)][_0x2e42cd(0x110)],'height':config[_0x2e42cd(0x9b)][_0x2e42cd(0xf5)][_0x2e42cd(0xb5)],'framerate':config['webrtc'][_0x2e42cd(0xf5)][_0x2e42cd(0x123)]});console['log']('[WebRTC\x20Appliance]\x20Created\x20video\x20track\x20for\x20session\x20'+_0x29002b);const {MediaStream:_0x12f946}=require(_0x2e42cd(0x8c)),_0x5172f4=new _0x12f946([_0x53621f]);_0xdb5906['addTrack'](_0x53621f,_0x5172f4),this[_0x2e42cd(0x116)](_0x75ea60['videoSource'],_0x75ea60[_0x2e42cd(0x98)]),_0xdb5906[_0x2e42cd(0xf2)]=_0xca0a2f=>{const _0x41897f=_0x2e42cd;if(_0xca0a2f[_0x41897f(0x8f)]&&this['serverWs'])console['log'](_0x41897f(0xea)+_0x29002b+':',{'type':_0xca0a2f[_0x41897f(0x8f)][_0x41897f(0xdd)],'protocol':_0xca0a2f['candidate']['protocol'],'address':_0xca0a2f['candidate'][_0x41897f(0x9a)],'port':_0xca0a2f[_0x41897f(0x8f)]['port']}),this['serverWs'][_0x41897f(0x13e)](JSON[_0x41897f(0xf3)]({'op':'webrtc_ice_candidate','session_id':_0x29002b,'candidate':_0xca0a2f[_0x41897f(0x8f)]}));else!_0xca0a2f[_0x41897f(0x8f)]&&console[_0x41897f(0x101)](_0x41897f(0x145)+_0x29002b);},_0xdb5906[_0x2e42cd(0xc7)]=()=>{const _0x193a77=_0x2e42cd;console[_0x193a77(0x101)]('[WebRTC\x20Appliance]\x20Session\x20'+_0x29002b+_0x193a77(0xc3)+_0xdb5906[_0x193a77(0x12e)]);if(_0xdb5906['connectionState']==='connected')console[_0x193a77(0x101)](_0x193a77(0x133)+_0x29002b+'\x20successfully\x20connected!');else{if(_0xdb5906[_0x193a77(0x12e)]===_0x193a77(0xd8))console['log']('[WebRTC\x20Appliance]\x20Session\x20'+_0x29002b+_0x193a77(0x12f)),this[_0x193a77(0x139)](_0x29002b);else _0xdb5906[_0x193a77(0x12e)]===_0x193a77(0x103)&&(console[_0x193a77(0x101)](_0x193a77(0x133)+_0x29002b+'\x20connection\x20closed,\x20cleaning\x20up'),this[_0x193a77(0xc8)](_0x29002b));}},this['activeSessions'][_0x2e42cd(0x78)](_0x29002b,{'peerConnection':_0xdb5906,'topic':_0x92ec9c,'videoTrack':_0x53621f,'mediaStream':_0x5172f4,'status':'initializing'}),!this['topicSessions'][_0x2e42cd(0x135)](_0x92ec9c)&&this[_0x2e42cd(0x138)]['set'](_0x92ec9c,new Set()),this[_0x2e42cd(0x138)][_0x2e42cd(0x117)](_0x92ec9c)[_0x2e42cd(0x94)](_0x29002b),console[_0x2e42cd(0x101)](_0x2e42cd(0x133)+_0x29002b+_0x2e42cd(0xca)),console['log'](_0x2e42cd(0x128)+_0x92ec9c+':\x20'+this[_0x2e42cd(0x138)][_0x2e42cd(0x117)](_0x92ec9c)[_0x2e42cd(0xa5)]);}catch(_0x251d83){console[_0x2e42cd(0xaf)](_0x2e42cd(0xfe)+_0x29002b+':',_0x251d83),this[_0x2e42cd(0x139)](_0x29002b);}}async[a6_0x1175f5(0x118)](_0x121e1b,_0x59f04b){const _0x3d539a=a6_0x1175f5,_0x560db1=this[_0x3d539a(0x90)][_0x3d539a(0x117)](_0x121e1b);if(!_0x560db1){console[_0x3d539a(0xaf)]('[WebRTC\x20Appliance]\x20Session\x20not\x20found:\x20'+_0x121e1b);return;}try{console['log'](_0x3d539a(0x93)+_0x121e1b),await _0x560db1[_0x3d539a(0xb3)][_0x3d539a(0x10c)](new RTCSessionDescription(_0x59f04b)),console[_0x3d539a(0x101)](_0x3d539a(0x143));const _0x43524c=await _0x560db1['peerConnection']['createAnswer']();console[_0x3d539a(0x101)](_0x3d539a(0xa9)),await _0x560db1[_0x3d539a(0xb3)]['setLocalDescription'](_0x43524c),console[_0x3d539a(0x101)]('[WebRTC\x20Appliance]\x20Set\x20local\x20description\x20(answer)'),this[_0x3d539a(0xd7)]&&(this[_0x3d539a(0xd7)]['send'](JSON[_0x3d539a(0xf3)]({'op':_0x3d539a(0xdf),'session_id':_0x121e1b,'answer':_0x43524c})),console[_0x3d539a(0x101)](_0x3d539a(0xa7)+_0x121e1b));}catch(_0x48b9b2){console[_0x3d539a(0xaf)](_0x3d539a(0x109)+_0x121e1b+':',_0x48b9b2),this['stopSession'](_0x121e1b);}}async['handleIceCandidate'](_0xdcd1c3,_0xb4dc85){const _0x512013=a6_0x1175f5,_0x5e7965=this['activeSessions']['get'](_0xdcd1c3);if(!_0x5e7965){console[_0x512013(0xaf)](_0x512013(0x7c)+_0xdcd1c3);return;}try{await _0x5e7965[_0x512013(0xb3)][_0x512013(0xe2)](new RTCIceCandidate(_0xb4dc85)),console[_0x512013(0x101)]('[WebRTC\x20Appliance]\x20ICE\x20candidate\x20added\x20for\x20session\x20'+_0xdcd1c3);}catch(_0xb2ce31){console[_0x512013(0xaf)](_0x512013(0x9f)+_0xdcd1c3+':',_0xb2ce31);}}[a6_0x1175f5(0xe9)](_0x5871b9,_0x30f387){const _0x2a6a14=a6_0x1175f5;if(!this['rosbridgeWs']||this['rosbridgeWs'][_0x2a6a14(0xe6)]!==this['rosbridgeWs']['OPEN'])return console[_0x2a6a14(0xaf)](_0x2a6a14(0x114)),null;console[_0x2a6a14(0x101)](_0x2a6a14(0x106)+_0x5871b9);const _0x454097=_0x5871b9[_0x2a6a14(0xc4)](_0x2a6a14(0xe3)),_0x5b4b68=_0x5871b9[_0x2a6a14(0xc4)](_0x2a6a14(0xba))||_0x5871b9[_0x2a6a14(0xc4)](_0x2a6a14(0x7b));let _0x32fada=[];_0x454097?_0x5b4b68?_0x32fada=[_0x2a6a14(0x132),_0x2a6a14(0xa4),'compressed_depth_image_transport/CompressedDepthImage',_0x2a6a14(0x129)]:_0x32fada=[_0x2a6a14(0x129),_0x2a6a14(0xbc),_0x2a6a14(0x132)]:_0x32fada=['sensor_msgs/CompressedImage','sensor_msgs/msg/CompressedImage',_0x2a6a14(0x129)];console['log'](_0x2a6a14(0xbe)+_0x5871b9+_0x2a6a14(0x8e)+(_0x454097?_0x2a6a14(0xe3):_0x2a6a14(0xd9))+_0x2a6a14(0xf8),_0x32fada);const _0x5e14af=[];let _0x13ebee=![];const _0x27cf05=_0x9c2a19=>{return _0x57e725=>{const _0x3d7c53=a6_0x29dd;try{const _0x5559ae=JSON[_0x3d7c53(0x108)](_0x57e725[_0x3d7c53(0xd0)]);_0x5559ae['op']===_0x3d7c53(0x84)&&_0x5559ae[_0x3d7c53(0x134)]===_0x5871b9&&_0x5559ae[_0x3d7c53(0xbf)]&&(!_0x13ebee&&(console[_0x3d7c53(0x101)](_0x3d7c53(0x83)+_0x5871b9+_0x3d7c53(0x119)+_0x9c2a19),_0x13ebee=!![]),_0x30f387(_0x5559ae[_0x3d7c53(0xbf)]));}catch(_0x489447){console[_0x3d7c53(0xaf)]('[WebRTC\x20Appliance]\x20Error\x20processing\x20ROS\x20message:',_0x489447);}};};for(const _0x36faee of _0x32fada){const _0x100155={'op':_0x2a6a14(0xf1),'topic':_0x5871b9,'type':_0x36faee};console[_0x2a6a14(0x101)](_0x2a6a14(0xd2)+_0x36faee),this[_0x2a6a14(0x130)][_0x2a6a14(0x13e)](JSON[_0x2a6a14(0xf3)](_0x100155));const _0x5942d5=_0x27cf05(_0x36faee);this[_0x2a6a14(0x130)][_0x2a6a14(0x7a)](_0x2a6a14(0x127),_0x5942d5),_0x5e14af[_0x2a6a14(0x87)]({'handler':_0x5942d5,'type':_0x36faee});}return _0x454097&&_0x5b4b68&&setTimeout(()=>{const _0x5b6e19=_0x2a6a14;if(!_0x13ebee){console[_0x5b6e19(0x101)](_0x5b6e19(0xed)+_0x5871b9+_0x5b6e19(0xaa));const _0x2b5623=_0x5871b9[_0x5b6e19(0xf6)]('/compressedDepth','')[_0x5b6e19(0xf6)](_0x5b6e19(0x12d),''),_0x224750=[_0x2b5623+_0x5b6e19(0xe8),_0x2b5623+'/image',_0x2b5623];for(const _0x49dab9 of _0x224750){console[_0x5b6e19(0x101)](_0x5b6e19(0x8a)+_0x49dab9);const _0x5ac399={'op':'subscribe','topic':_0x49dab9,'type':'sensor_msgs/Image'};this[_0x5b6e19(0x130)]['send'](JSON['stringify'](_0x5ac399));const _0x14a2b9=_0x5d4c2e=>{const _0x21848d=_0x5b6e19;try{const _0x58855=JSON[_0x21848d(0x108)](_0x5d4c2e[_0x21848d(0xd0)]);_0x58855['op']===_0x21848d(0x84)&&_0x58855['topic']===_0x49dab9&&_0x58855[_0x21848d(0xbf)]&&(console[_0x21848d(0x101)](_0x21848d(0xf0)+_0x49dab9+',\x20converting\x20to\x20base64...'),_0x58855[_0x21848d(0xbf)][_0x21848d(0xd0)]&&!_0x58855[_0x21848d(0xbf)]['data'][_0x21848d(0xc0)](_0x21848d(0xef))&&_0x30f387(_0x58855[_0x21848d(0xbf)]));}catch(_0x365d7a){console['error'](_0x21848d(0xc1),_0x365d7a);}};this[_0x5b6e19(0x130)][_0x5b6e19(0x7a)](_0x5b6e19(0x127),_0x14a2b9),_0x5e14af[_0x5b6e19(0x87)]({'handler':_0x14a2b9,'type':'sensor_msgs/Image','topic':_0x49dab9});}}},0xbb8),{'unsubscribe':()=>{const _0x1085eb=_0x2a6a14;for(const {handler:_0x37a947,type:_0x59df5e,topic:_0xe40941}of _0x5e14af){this['rosbridgeWs']['removeEventListener'](_0x1085eb(0x127),_0x37a947),this[_0x1085eb(0x130)][_0x1085eb(0xe6)]===this[_0x1085eb(0x130)][_0x1085eb(0xf7)]&&this[_0x1085eb(0x130)][_0x1085eb(0x13e)](JSON[_0x1085eb(0xf3)]({'op':_0x1085eb(0xe7),'topic':_0xe40941||_0x5871b9}));}}};}[a6_0x1175f5(0x8b)](_0x219908,_0x40df51){const _0x17dc70=a6_0x1175f5;_0x40df51['fillStyle']=_0x17dc70(0x89),_0x40df51['fillRect'](0x0,0x0,_0x219908[_0x17dc70(0x110)],_0x219908[_0x17dc70(0xb5)]),_0x40df51[_0x17dc70(0x9c)]=_0x17dc70(0x136),_0x40df51[_0x17dc70(0x91)]=_0x17dc70(0x86),_0x40df51[_0x17dc70(0x111)]=_0x17dc70(0x13a),_0x40df51['fillText']('ðŸ¤–\x20Robot\x20Camera',_0x219908[_0x17dc70(0x110)]/0x2,_0x219908[_0x17dc70(0xb5)]/0x2-0x14),_0x40df51['fillStyle']=_0x17dc70(0x81),_0x40df51[_0x17dc70(0x91)]=_0x17dc70(0xec),_0x40df51[_0x17dc70(0xff)](_0x17dc70(0x142),_0x219908[_0x17dc70(0x110)]/0x2,_0x219908['height']/0x2+0x14);const _0x38004b=Date[_0x17dc70(0x10f)]()/0x3e8;for(let _0x5528b5=0x0;_0x5528b5<0x3;_0x5528b5++){const _0x33b3bd=(Math[_0x17dc70(0x105)](_0x38004b*0x2+_0x5528b5*0.5)+0x1)/0x2;_0x40df51[_0x17dc70(0x9c)]=_0x17dc70(0x95)+_0x33b3bd*0.5+')',_0x40df51[_0x17dc70(0xa8)](),_0x40df51[_0x17dc70(0xb8)](_0x219908[_0x17dc70(0x110)]/0x2-0x28+_0x5528b5*0x28,_0x219908[_0x17dc70(0xb5)]/0x2+0x3c,0x8,0x0,0x2*Math['PI']),_0x40df51[_0x17dc70(0xac)]();}}['sendFrameToVideoSource'](_0xb60c84,_0x44c887){const _0x4ec278=a6_0x1175f5;try{if(!_0xb60c84||!_0x44c887)return;const _0x316a97=_0x44c887[_0x4ec278(0xe5)]('2d'),_0x5eaac8=_0x316a97[_0x4ec278(0x10b)](0x0,0x0,_0x44c887['width'],_0x44c887[_0x4ec278(0xb5)]),_0x3a0870=this[_0x4ec278(0xa2)](_0x5eaac8[_0x4ec278(0xd0)],_0x44c887[_0x4ec278(0x110)],_0x44c887[_0x4ec278(0xb5)]),_0x558aee={'width':_0x44c887['width'],'height':_0x44c887[_0x4ec278(0xb5)],'data':_0x3a0870};typeof _0xb60c84[_0x4ec278(0x107)]==='function'&&_0xb60c84['onFrame'](_0x558aee);}catch(_0x5bed96){console[_0x4ec278(0xaf)](_0x4ec278(0x12a),_0x5bed96);}}[a6_0x1175f5(0xa2)](_0x2aa585,_0x41d97f,_0x3533a2){const _0x427715=a6_0x1175f5,_0x436b29=_0x41d97f*_0x3533a2,_0x1e07d8=_0x41d97f*_0x3533a2/0x4,_0x317be2=new Uint8Array(_0x436b29+_0x1e07d8*0x2);let _0x479203=0x0,_0x15970b=_0x436b29,_0x3e4692=_0x436b29+_0x1e07d8;for(let _0x367385=0x0;_0x367385<_0x3533a2;_0x367385++){for(let _0x546dc9=0x0;_0x546dc9<_0x41d97f;_0x546dc9++){const _0x382dde=(_0x367385*_0x41d97f+_0x546dc9)*0x4,_0x4b5f68=_0x2aa585[_0x382dde],_0x57783c=_0x2aa585[_0x382dde+0x1],_0x428691=_0x2aa585[_0x382dde+0x2],_0x47d57e=Math[_0x427715(0x11e)](0.299*_0x4b5f68+0.587*_0x57783c+0.114*_0x428691);_0x317be2[_0x479203++]=_0x47d57e;if(_0x367385%0x2===0x0&&_0x546dc9%0x2===0x0){const _0x29580c=Math[_0x427715(0x11e)](-0.169*_0x4b5f68-0.331*_0x57783c+0.5*_0x428691+0x80),_0xe33d2d=Math[_0x427715(0x11e)](0.5*_0x4b5f68-0.419*_0x57783c-0.081*_0x428691+0x80);_0x317be2[_0x15970b++]=Math[_0x427715(0xc6)](0x0,Math['min'](0xff,_0x29580c)),_0x317be2[_0x3e4692++]=Math[_0x427715(0xc6)](0x0,Math['min'](0xff,_0xe33d2d));}}}return _0x317be2;}async['updateCanvasWithImageData'](_0x4a59e3,_0x284320,_0x33304f,_0x9e9216,_0xc0021c){const _0x1e6167=a6_0x1175f5;try{if(!_0x33304f||!_0x33304f[_0x1e6167(0xd0)])return;Math[_0x1e6167(0xfb)]()<0.01&&console[_0x1e6167(0x101)](_0x1e6167(0x13d)+_0x9e9216+_0x1e6167(0xc2)+_0x33304f[_0x1e6167(0xd0)][_0x1e6167(0xdc)]+'\x20bytes');const _0x4c3943=Buffer[_0x1e6167(0x96)](_0x33304f[_0x1e6167(0xd0)],_0x1e6167(0x144)),_0xa49487=this[_0x1e6167(0xb9)][_0x1e6167(0xd5)](_0x9e9216);let _0x40cb6c;_0xa49487?_0x40cb6c=await this[_0x1e6167(0xb9)][_0x1e6167(0xe1)](_0x4c3943,_0x4a59e3,_0x284320,_0x9e9216):_0x40cb6c=await this[_0x1e6167(0xb9)][_0x1e6167(0x113)](_0x4c3943,_0x4a59e3,_0x284320),_0x284320['putImageData'](_0x40cb6c,0x0,0x0),_0x284320[_0x1e6167(0x9c)]=_0x1e6167(0xeb),_0x284320['fillRect'](0xa,0xa,0xdc,0x32),_0x284320[_0x1e6167(0x9c)]=_0xa49487?_0x1e6167(0x9e):'#00ff00',_0x284320[_0x1e6167(0x91)]=_0x1e6167(0xd1),_0x284320[_0x1e6167(0xff)]((_0xa49487?_0x1e6167(0x11a):_0x1e6167(0x9d))+':\x20'+new Date()[_0x1e6167(0x13c)](),0xf,0x1c),_0x284320['fillStyle']=_0x1e6167(0x81),_0x284320[_0x1e6167(0x91)]='10px\x20monospace',_0x284320[_0x1e6167(0xff)](_0x1e6167(0xf9)+_0x9e9216[_0x1e6167(0xb1)]('/')[_0x1e6167(0x79)](),0xf,0x2d),this[_0x1e6167(0x116)](_0xc0021c,_0x4a59e3);}catch(_0x2a6266){console[_0x1e6167(0xc9)](_0x1e6167(0x125)+_0x9e9216+':',_0x2a6266[_0x1e6167(0x127)]);_0x9e9216[_0x1e6167(0xc4)](_0x1e6167(0xe3))&&Math['random']()<0.1&&console['warn'](_0x1e6167(0xb6)+_0x9e9216[_0x1e6167(0xf6)]('/compressedDepth',_0x1e6167(0xe8)));_0x284320[_0x1e6167(0x9c)]=_0x1e6167(0x89),_0x284320[_0x1e6167(0xe0)](0x0,0x0,_0x4a59e3[_0x1e6167(0x110)],_0x4a59e3[_0x1e6167(0xb5)]),_0x284320[_0x1e6167(0x9c)]='#888',_0x284320[_0x1e6167(0x91)]='16px\x20Arial',_0x284320[_0x1e6167(0x111)]='center';const _0x4ad195=_0x9e9216['includes'](_0x1e6167(0xe3))?'ðŸ”\x20Processing\x20depth...':_0x1e6167(0x12b);_0x284320[_0x1e6167(0xff)](_0x4ad195,_0x4a59e3[_0x1e6167(0x110)]/0x2,_0x4a59e3[_0x1e6167(0xb5)]/0x2),_0x284320[_0x1e6167(0x9c)]='#666',_0x284320['font']=_0x1e6167(0xc5),_0x284320['fillText']('Topic:\x20'+_0x9e9216['split']('/')['pop'](),_0x4a59e3[_0x1e6167(0x110)]/0x2,_0x4a59e3[_0x1e6167(0xb5)]/0x2+0x19),this['sendFrameToVideoSource'](_0xc0021c,_0x4a59e3);}}[a6_0x1175f5(0x139)](_0x2b01a8){const _0x25893b=a6_0x1175f5,_0x28c470=this['activeSessions']['get'](_0x2b01a8);if(!_0x28c470){console[_0x25893b(0xc9)](_0x25893b(0xfa)+_0x2b01a8);return;}console[_0x25893b(0x101)](_0x25893b(0xae)+_0x2b01a8+_0x25893b(0x122)+_0x28c470[_0x25893b(0x134)]);try{this[_0x25893b(0xd7)]&&this[_0x25893b(0xd7)][_0x25893b(0xe6)]===this[_0x25893b(0xd7)][_0x25893b(0xf7)]&&this[_0x25893b(0xd7)][_0x25893b(0x13e)](JSON[_0x25893b(0xf3)]({'op':_0x25893b(0xcb),'session_id':_0x2b01a8})),_0x28c470[_0x25893b(0x99)]&&_0x28c470[_0x25893b(0x99)][_0x25893b(0xfc)](),_0x28c470[_0x25893b(0xb3)]&&_0x28c470[_0x25893b(0xb3)][_0x25893b(0x97)]();}catch(_0x5160aa){console[_0x25893b(0xaf)](_0x25893b(0x10a)+_0x5160aa);}this[_0x25893b(0xc8)](_0x2b01a8);}[a6_0x1175f5(0xc8)](_0x29c79b){const _0x143798=a6_0x1175f5,_0x2780c4=this[_0x143798(0x90)][_0x143798(0x117)](_0x29c79b);if(_0x2780c4){const _0x18bf9d=this[_0x143798(0x138)]['get'](_0x2780c4[_0x143798(0x134)]);_0x18bf9d&&(_0x18bf9d['delete'](_0x29c79b),_0x18bf9d[_0x143798(0xa5)]===0x0&&this[_0x143798(0x138)][_0x143798(0xcc)](_0x2780c4[_0x143798(0x134)])),this[_0x143798(0x140)](_0x2780c4[_0x143798(0x134)]);}this[_0x143798(0x90)][_0x143798(0xcc)](_0x29c79b),console[_0x143798(0x101)](_0x143798(0xce)+_0x29c79b);}['stopAllSessions'](){const _0xd462ca=a6_0x1175f5;console['log'](_0xd462ca(0x82));const _0x4620b5=Array[_0xd462ca(0x96)](this[_0xd462ca(0x90)][_0xd462ca(0xb7)]());_0x4620b5['forEach'](_0x52d742=>this[_0xd462ca(0x139)](_0x52d742));}[a6_0x1175f5(0xad)](){const _0x2cb024=a6_0x1175f5,_0x5da0f7=[];for(const [_0x3118ab,_0x3527a4]of this[_0x2cb024(0x90)]){_0x5da0f7[_0x2cb024(0x87)]({'sessionId':_0x3118ab,'topic':_0x3527a4['topic'],'connectionState':_0x3527a4[_0x2cb024(0xb3)]?.['connectionState']||_0x2cb024(0x13b),'hasVideoTrack':!!_0x3527a4['videoTrack']});}return _0x5da0f7;}[a6_0x1175f5(0x11d)](){const _0x583959=a6_0x1175f5,_0x122308=[];for(const [_0x2c8659,_0x41f5a9]of this[_0x583959(0x141)]){_0x122308[_0x583959(0x87)]({'topic':_0x2c8659,'frameCount':_0x41f5a9[_0x583959(0xa1)],'hasVideoSource':!!_0x41f5a9[_0x583959(0xee)],'hasRosSubscriber':!!_0x41f5a9[_0x583959(0x10e)]});}return _0x122308;}}module[a6_0x1175f5(0xb0)]=new ApplianceWebRTCService();