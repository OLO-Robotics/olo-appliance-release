const a5_0x3a3a86=a5_0x5c77;(function(_0x44d0a9,_0x49ab55){const _0x1ee16b=a5_0x5c77,_0x5d78fc=_0x44d0a9();while(!![]){try{const _0x3d7110=parseInt(_0x1ee16b(0x176))/0x1*(-parseInt(_0x1ee16b(0x173))/0x2)+-parseInt(_0x1ee16b(0x154))/0x3+parseInt(_0x1ee16b(0x144))/0x4+-parseInt(_0x1ee16b(0x152))/0x5+parseInt(_0x1ee16b(0x16e))/0x6*(-parseInt(_0x1ee16b(0x14c))/0x7)+-parseInt(_0x1ee16b(0x169))/0x8+parseInt(_0x1ee16b(0x177))/0x9*(parseInt(_0x1ee16b(0x15e))/0xa);if(_0x3d7110===_0x49ab55)break;else _0x5d78fc['push'](_0x5d78fc['shift']());}catch(_0x11a19e){_0x5d78fc['push'](_0x5d78fc['shift']());}}}(a5_0x2e8d,0x6a6d3));function a5_0x5c77(_0x539d9f,_0xf9f7a){const _0x342ad7=a5_0x2e8d();return a5_0x5c77=function(_0x5b6da4,_0xaf94c2){_0x5b6da4=_0x5b6da4-0x143;let _0x2e8d54=_0x342ad7[_0x5b6da4];return _0x2e8d54;},a5_0x5c77(_0x539d9f,_0xf9f7a);}const a5_0xaf94c2=(function(){let _0x7daa32=!![];return function(_0xa54bfe,_0x595e90){const _0x2c8cab=_0x7daa32?function(){const _0x1cff84=a5_0x5c77;if(_0x595e90){const _0x48534f=_0x595e90[_0x1cff84(0x149)](_0xa54bfe,arguments);return _0x595e90=null,_0x48534f;}}:function(){};return _0x7daa32=![],_0x2c8cab;};}()),a5_0x5b6da4=a5_0xaf94c2(this,function(){const _0x220281=a5_0x5c77;return a5_0x5b6da4['toString']()[_0x220281(0x145)](_0x220281(0x175))[_0x220281(0x158)]()['constructor'](a5_0x5b6da4)[_0x220281(0x145)](_0x220281(0x175));});a5_0x5b6da4();function a5_0x2e8d(){const _0xf52ed2=['https:','484835zEyaIj','clearCache','1728393iRdmVX','[Appliance\x20TURN\x20Service]\x20Credentials\x20cache\x20cleared','[Appliance\x20TURN\x20Service]\x20Initialized\x20with\x20server\x20URL:','GET','toString','warn','serverUrl','[Appliance\x20TURN\x20Service]\x20Error\x20parsing\x20response:','[Appliance\x20TURN\x20Service]\x20Successfully\x20fetched\x20TURN\x20credentials\x20from\x20server','[Appliance\x20TURN\x20Service]\x20No\x20authentication\x20token\x20available','10335970hGQsdw','[Appliance\x20TURN\x20Service]\x20Server\x20URL\x20not\x20initialized','initialize','request','[Appliance\x20TURN\x20Service]\x20Cached\x20new\x20TURN\x20credentials','Bearer\x20','now','cacheDuration','log','iceServers','getIceServers','2041128EXJGZj','error','isAuthenticated','getFallbackIceServers','getCredentials','41826BbJzYn','port','stun:stun.l.google.com:19302','[Appliance\x20TURN\x20Service]\x20Request\x20error:','http','451450VOgMWZ','https','(((.+)+)+)+$','1qiuACh','9Wqhgjw','OLO-Appliance/1.0','2280928Bqdywa','search','data','/webrtc/turn-credentials','getToken','apply','credentialsCache','[Appliance\x20TURN\x20Service]\x20Request\x20timeout','14KCRUyT','fetchCredentials','end','[Appliance\x20TURN\x20Service]\x20Not\x20authenticated,\x20attempting\x20to\x20login...','exports'];a5_0x2e8d=function(){return _0xf52ed2;};return a5_0x2e8d();}const https=require(a5_0x3a3a86(0x174)),http=require(a5_0x3a3a86(0x172)),authService=require('./auth');class ApplianceTurnCredentialsService{constructor(){const _0x4606b3=a5_0x3a3a86;this['credentialsCache']=null,this['cacheExpiry']=0x0,this[_0x4606b3(0x165)]=0xe10*0x3e8,this[_0x4606b3(0x15a)]=null;}[a5_0x3a3a86(0x160)](_0x288eff){const _0x5e82cb=a5_0x3a3a86;this['serverUrl']=_0x288eff,console['log'](_0x5e82cb(0x156),_0x288eff);}async[a5_0x3a3a86(0x14d)](){const _0x7b1be8=a5_0x3a3a86;if(!this['serverUrl'])return console[_0x7b1be8(0x16a)](_0x7b1be8(0x15f)),this[_0x7b1be8(0x16c)]();if(!authService[_0x7b1be8(0x16b)]()){console[_0x7b1be8(0x166)](_0x7b1be8(0x14f));const _0x202688=await authService['login']();if(!_0x202688)return console[_0x7b1be8(0x16a)]('[Appliance\x20TURN\x20Service]\x20Failed\x20to\x20authenticate'),this[_0x7b1be8(0x16c)]();}try{console[_0x7b1be8(0x166)]('[Appliance\x20TURN\x20Service]\x20Fetching\x20TURN\x20credentials\x20from\x20server...');const _0x5d484e=new URL(_0x7b1be8(0x147),this[_0x7b1be8(0x15a)]),_0x55f956=_0x5d484e['protocol']===_0x7b1be8(0x151),_0xbc31b1=_0x55f956?https:http,_0x4a1929=authService[_0x7b1be8(0x148)]();if(!_0x4a1929)return console[_0x7b1be8(0x16a)](_0x7b1be8(0x15d)),this[_0x7b1be8(0x16c)]();return new Promise((_0x5e8a66,_0x48d059)=>{const _0x40dfca=_0x7b1be8,_0x2a98b2={'hostname':_0x5d484e['hostname'],'port':_0x5d484e[_0x40dfca(0x16f)]||(_0x55f956?0x1bb:0x50),'path':_0x5d484e['pathname'],'method':_0x40dfca(0x157),'headers':{'User-Agent':_0x40dfca(0x143),'Authorization':_0x40dfca(0x163)+_0x4a1929}},_0x13bd57=_0xbc31b1[_0x40dfca(0x161)](_0x2a98b2,_0x47010b=>{const _0x441e30=_0x40dfca;let _0x7c0b4='';_0x47010b['on'](_0x441e30(0x146),_0x3ebf45=>{_0x7c0b4+=_0x3ebf45;}),_0x47010b['on'](_0x441e30(0x14e),()=>{const _0x234eb0=_0x441e30;try{const _0x483973=JSON['parse'](_0x7c0b4);_0x483973[_0x234eb0(0x167)]?(console[_0x234eb0(0x166)](_0x234eb0(0x15c)),_0x5e8a66(_0x483973[_0x234eb0(0x167)])):(console[_0x234eb0(0x159)]('[Appliance\x20TURN\x20Service]\x20No\x20iceServers\x20in\x20response,\x20using\x20fallback'),_0x5e8a66(this[_0x234eb0(0x16c)]()));}catch(_0x2831dc){console['error'](_0x234eb0(0x15b),_0x2831dc),_0x5e8a66(this[_0x234eb0(0x16c)]());}});});_0x13bd57['on'](_0x40dfca(0x16a),_0x1b57d3=>{const _0x2723af=_0x40dfca;console[_0x2723af(0x16a)](_0x2723af(0x171),_0x1b57d3),_0x5e8a66(this[_0x2723af(0x16c)]());}),_0x13bd57['setTimeout'](0x2710,()=>{const _0x3570f3=_0x40dfca;console[_0x3570f3(0x16a)](_0x3570f3(0x14b)),_0x13bd57['destroy'](),_0x5e8a66(this[_0x3570f3(0x16c)]());}),_0x13bd57['end']();});}catch(_0x35d1d0){return console[_0x7b1be8(0x16a)]('[Appliance\x20TURN\x20Service]\x20Error\x20fetching\x20credentials:',_0x35d1d0),this[_0x7b1be8(0x16c)]();}}async[a5_0x3a3a86(0x16d)](){const _0x467f8e=a5_0x3a3a86,_0x150475=Date[_0x467f8e(0x164)]();if(this[_0x467f8e(0x14a)]&&_0x150475<this['cacheExpiry'])return console['log']('[Appliance\x20TURN\x20Service]\x20Using\x20cached\x20TURN\x20credentials'),this['credentialsCache'];const _0x145551=await this['fetchCredentials']();return this[_0x467f8e(0x14a)]=_0x145551,this['cacheExpiry']=_0x150475+this['cacheDuration'],console[_0x467f8e(0x166)](_0x467f8e(0x162)),_0x145551;}async[a5_0x3a3a86(0x168)](){return await this['getCredentials']();}[a5_0x3a3a86(0x16c)](){const _0xdb385a=a5_0x3a3a86;return console[_0xdb385a(0x166)]('[Appliance\x20TURN\x20Service]\x20Using\x20fallback\x20STUN\x20servers'),[{'urls':_0xdb385a(0x170)},{'urls':'stun:stun1.l.google.com:19302'}];}[a5_0x3a3a86(0x153)](){const _0x324434=a5_0x3a3a86;this[_0x324434(0x14a)]=null,this['cacheExpiry']=0x0,console['log'](_0x324434(0x155));}}module[a5_0x3a3a86(0x150)]=new ApplianceTurnCredentialsService();