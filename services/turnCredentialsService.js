const a5_0x486091=a5_0x5381;(function(_0x7f185c,_0x3f9776){const _0x4c9f14=a5_0x5381,_0x11a372=_0x7f185c();while(!![]){try{const _0x2d1d63=-parseInt(_0x4c9f14(0x1d0))/0x1+-parseInt(_0x4c9f14(0x1ee))/0x2+parseInt(_0x4c9f14(0x1e3))/0x3*(-parseInt(_0x4c9f14(0x1d1))/0x4)+-parseInt(_0x4c9f14(0x1f1))/0x5+-parseInt(_0x4c9f14(0x1f2))/0x6*(parseInt(_0x4c9f14(0x1da))/0x7)+parseInt(_0x4c9f14(0x1dd))/0x8+parseInt(_0x4c9f14(0x1d8))/0x9;if(_0x2d1d63===_0x3f9776)break;else _0x11a372['push'](_0x11a372['shift']());}catch(_0x53dd45){_0x11a372['push'](_0x11a372['shift']());}}}(a5_0x427c,0x48b68));function a5_0x5381(_0x54e20e,_0x117da8){const _0x3c7f38=a5_0x427c();return a5_0x5381=function(_0x3441d6,_0x4b4585){_0x3441d6=_0x3441d6-0x1cf;let _0x427c6a=_0x3c7f38[_0x3441d6];return _0x427c6a;},a5_0x5381(_0x54e20e,_0x117da8);}const a5_0x4b4585=(function(){let _0x4bd081=!![];return function(_0x2288da,_0x3c0755){const _0x12d027=_0x4bd081?function(){const _0x2029b7=a5_0x5381;if(_0x3c0755){const _0x3950b0=_0x3c0755[_0x2029b7(0x1f7)](_0x2288da,arguments);return _0x3c0755=null,_0x3950b0;}}:function(){};return _0x4bd081=![],_0x12d027;};}()),a5_0x3441d6=a5_0x4b4585(this,function(){const _0x5e74ec=a5_0x5381;return a5_0x3441d6[_0x5e74ec(0x1ef)]()['search'](_0x5e74ec(0x1dc))[_0x5e74ec(0x1ef)]()[_0x5e74ec(0x1cf)](a5_0x3441d6)['search'](_0x5e74ec(0x1dc));});a5_0x3441d6();const https=require('https'),http=require('http'),authService=require('./auth');class ApplianceTurnCredentialsService{constructor(){const _0x2cf081=a5_0x5381;this['credentialsCache']=null,this[_0x2cf081(0x1e1)]=0x0,this[_0x2cf081(0x1e2)]=0xe10*0x3e8,this['serverUrl']=null;}[a5_0x486091(0x1d9)](_0x33ec81){const _0x688ccf=a5_0x486091;this[_0x688ccf(0x1de)]=_0x33ec81,console['log'](_0x688ccf(0x1e6),_0x33ec81);}async[a5_0x486091(0x1e5)](){const _0x57bff4=a5_0x486091;if(!this[_0x57bff4(0x1de)])return console['error']('[Appliance\x20TURN\x20Service]\x20Server\x20URL\x20not\x20initialized'),this[_0x57bff4(0x1d5)]();if(!authService['isAuthenticated']()){console[_0x57bff4(0x202)]('[Appliance\x20TURN\x20Service]\x20Not\x20authenticated,\x20attempting\x20to\x20login...');const _0x476018=await authService[_0x57bff4(0x200)]();if(!_0x476018)return console[_0x57bff4(0x1fc)](_0x57bff4(0x1f9)),this[_0x57bff4(0x1d5)]();}try{console[_0x57bff4(0x202)](_0x57bff4(0x1f8));const _0x8bd574=new URL('/webrtc/turn-credentials',this[_0x57bff4(0x1de)]),_0x29f79d=_0x8bd574[_0x57bff4(0x201)]===_0x57bff4(0x1f4),_0x20ff9f=_0x29f79d?https:http,_0x2c6bae=authService[_0x57bff4(0x1ea)]();if(!_0x2c6bae)return console[_0x57bff4(0x1fc)](_0x57bff4(0x1eb)),this['getFallbackIceServers']();return new Promise((_0x2f9633,_0x5e4b79)=>{const _0x117146=_0x57bff4,_0xc9443c={'hostname':_0x8bd574[_0x117146(0x1df)],'port':_0x8bd574[_0x117146(0x1d7)]||(_0x29f79d?0x1bb:0x50),'path':_0x8bd574[_0x117146(0x1e0)],'method':_0x117146(0x1fb),'headers':{'User-Agent':_0x117146(0x1db),'Authorization':'Bearer\x20'+_0x2c6bae}},_0x1a180b=_0x20ff9f['request'](_0xc9443c,_0xbef8f9=>{const _0x151716=_0x117146;let _0x2199c4='';_0xbef8f9['on'](_0x151716(0x1f3),_0x47b4d4=>{_0x2199c4+=_0x47b4d4;}),_0xbef8f9['on'](_0x151716(0x1d3),()=>{const _0x58708c=_0x151716;try{const _0x55f9a7=JSON[_0x58708c(0x1ff)](_0x2199c4);_0x55f9a7[_0x58708c(0x1e4)]?(console[_0x58708c(0x202)](_0x58708c(0x1fe)),_0x2f9633(_0x55f9a7[_0x58708c(0x1e4)])):(console[_0x58708c(0x1f6)](_0x58708c(0x1e8)),_0x2f9633(this[_0x58708c(0x1d5)]()));}catch(_0x37fd46){console['error'](_0x58708c(0x1d2),_0x37fd46),_0x2f9633(this[_0x58708c(0x1d5)]());}});});_0x1a180b['on']('error',_0x45cd21=>{const _0x46ffdd=_0x117146;console[_0x46ffdd(0x1fc)](_0x46ffdd(0x1e7),_0x45cd21),_0x2f9633(this[_0x46ffdd(0x1d5)]());}),_0x1a180b[_0x117146(0x1e9)](0x2710,()=>{const _0x4e71e0=_0x117146;console['error']('[Appliance\x20TURN\x20Service]\x20Request\x20timeout'),_0x1a180b[_0x4e71e0(0x1d4)](),_0x2f9633(this['getFallbackIceServers']());}),_0x1a180b[_0x117146(0x1d3)]();});}catch(_0x57d0f4){return console['error'](_0x57bff4(0x1fd),_0x57d0f4),this['getFallbackIceServers']();}}async[a5_0x486091(0x1ed)](){const _0x2eef68=a5_0x486091,_0x2631c8=Date[_0x2eef68(0x1ec)]();if(this[_0x2eef68(0x1f0)]&&_0x2631c8<this[_0x2eef68(0x1e1)])return console[_0x2eef68(0x202)]('[Appliance\x20TURN\x20Service]\x20Using\x20cached\x20TURN\x20credentials'),this[_0x2eef68(0x1f0)];const _0x1f81cd=await this[_0x2eef68(0x1e5)]();return this['credentialsCache']=_0x1f81cd,this[_0x2eef68(0x1e1)]=_0x2631c8+this['cacheDuration'],console[_0x2eef68(0x202)]('[Appliance\x20TURN\x20Service]\x20Cached\x20new\x20TURN\x20credentials'),_0x1f81cd;}async[a5_0x486091(0x1fa)](){const _0xa14fea=a5_0x486091;return await this[_0xa14fea(0x1ed)]();}[a5_0x486091(0x1d5)](){const _0x27e42c=a5_0x486091;return console[_0x27e42c(0x202)]('[Appliance\x20TURN\x20Service]\x20Using\x20fallback\x20STUN\x20servers'),[{'urls':'stun:stun.l.google.com:19302'},{'urls':_0x27e42c(0x1d6)}];}['clearCache'](){const _0x2fcd4c=a5_0x486091;this['credentialsCache']=null,this[_0x2fcd4c(0x1e1)]=0x0,console[_0x2fcd4c(0x202)]('[Appliance\x20TURN\x20Service]\x20Credentials\x20cache\x20cleared');}}function a5_0x427c(){const _0x56e1ab=['(((.+)+)+)+$','1682256nJuqkX','serverUrl','hostname','pathname','cacheExpiry','cacheDuration','14619jDZwuQ','iceServers','fetchCredentials','[Appliance\x20TURN\x20Service]\x20Initialized\x20with\x20server\x20URL:','[Appliance\x20TURN\x20Service]\x20Request\x20error:','[Appliance\x20TURN\x20Service]\x20No\x20iceServers\x20in\x20response,\x20using\x20fallback','setTimeout','getToken','[Appliance\x20TURN\x20Service]\x20No\x20authentication\x20token\x20available','now','getCredentials','832318OuVZrw','toString','credentialsCache','1732085dYKhLm','1212YcQvYF','data','https:','exports','warn','apply','[Appliance\x20TURN\x20Service]\x20Fetching\x20TURN\x20credentials\x20from\x20server...','[Appliance\x20TURN\x20Service]\x20Failed\x20to\x20authenticate','getIceServers','GET','error','[Appliance\x20TURN\x20Service]\x20Error\x20fetching\x20credentials:','[Appliance\x20TURN\x20Service]\x20Successfully\x20fetched\x20TURN\x20credentials\x20from\x20server','parse','login','protocol','log','constructor','414310XIVTcq','112DAnptB','[Appliance\x20TURN\x20Service]\x20Error\x20parsing\x20response:','end','destroy','getFallbackIceServers','stun:stun1.l.google.com:19302','port','13322394WNUbJL','initialize','2751GpjNwo','OLO-Appliance/1.0'];a5_0x427c=function(){return _0x56e1ab;};return a5_0x427c();}module[a5_0x486091(0x1f5)]=new ApplianceTurnCredentialsService();