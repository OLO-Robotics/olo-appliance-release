function a5_0x5702(_0x5a23ef,_0x569f83){const _0x4c58ab=a5_0x4194();return a5_0x5702=function(_0x5623d1,_0x2c62e0){_0x5623d1=_0x5623d1-0x1bc;let _0x4194a7=_0x4c58ab[_0x5623d1];return _0x4194a7;},a5_0x5702(_0x5a23ef,_0x569f83);}const a5_0x5bbe3a=a5_0x5702;(function(_0x4f8670,_0x5869e4){const _0x57be9a=a5_0x5702,_0x3010fe=_0x4f8670();while(!![]){try{const _0x4467c4=parseInt(_0x57be9a(0x1e7))/0x1*(-parseInt(_0x57be9a(0x1c7))/0x2)+-parseInt(_0x57be9a(0x1e1))/0x3+parseInt(_0x57be9a(0x1d8))/0x4*(-parseInt(_0x57be9a(0x1c1))/0x5)+-parseInt(_0x57be9a(0x1d9))/0x6*(parseInt(_0x57be9a(0x1e3))/0x7)+-parseInt(_0x57be9a(0x1c0))/0x8*(-parseInt(_0x57be9a(0x1c4))/0x9)+parseInt(_0x57be9a(0x1ec))/0xa*(parseInt(_0x57be9a(0x1cb))/0xb)+-parseInt(_0x57be9a(0x1c2))/0xc*(-parseInt(_0x57be9a(0x1e0))/0xd);if(_0x4467c4===_0x5869e4)break;else _0x3010fe['push'](_0x3010fe['shift']());}catch(_0x17d07e){_0x3010fe['push'](_0x3010fe['shift']());}}}(a5_0x4194,0xac9fc));function a5_0x4194(){const _0x181378=['1098614Dgmagq','[Appliance\x20TURN\x20Service]\x20Server\x20URL\x20not\x20initialized','[Appliance\x20TURN\x20Service]\x20No\x20authentication\x20token\x20available','credentialsCache','[Appliance\x20TURN\x20Service]\x20Fetching\x20TURN\x20credentials\x20from\x20server...','parse','[Appliance\x20TURN\x20Service]\x20Successfully\x20fetched\x20TURN\x20credentials\x20from\x20server','cacheDuration','iceServers','[Appliance\x20TURN\x20Service]\x20Cached\x20new\x20TURN\x20credentials','search','[Appliance\x20TURN\x20Service]\x20Request\x20timeout','pathname','124356vxxRqg','6wnVsWG','[Appliance\x20TURN\x20Service]\x20Request\x20error:','[Appliance\x20TURN\x20Service]\x20Error\x20fetching\x20credentials:','Bearer\x20','constructor','hostname','serverUrl','55679agnaKQ','2919816BjVJKn','data','8236501GLpbXS','stun:stun1.l.google.com:19302','getCredentials','getFallbackIceServers','8903kHzBcB','[Appliance\x20TURN\x20Service]\x20Credentials\x20cache\x20cleared','cacheExpiry','fetchCredentials','warn','50oEtkjI','error','[Appliance\x20TURN\x20Service]\x20Using\x20fallback\x20STUN\x20servers','GET','port','getToken','[Appliance\x20TURN\x20Service]\x20Failed\x20to\x20authenticate','destroy','log','1527320vhGQYy','190RrzVFQ','9012bpCXDL','toString','45bzZWRP','stun:stun.l.google.com:19302','(((.+)+)+)+$','142xviDsi','end','http','now'];a5_0x4194=function(){return _0x181378;};return a5_0x4194();}const a5_0x2c62e0=(function(){let _0x596c99=!![];return function(_0x25d336,_0x33af95){const _0x5666f1=_0x596c99?function(){if(_0x33af95){const _0x34513d=_0x33af95['apply'](_0x25d336,arguments);return _0x33af95=null,_0x34513d;}}:function(){};return _0x596c99=![],_0x5666f1;};}()),a5_0x5623d1=a5_0x2c62e0(this,function(){const _0x4408b5=a5_0x5702;return a5_0x5623d1[_0x4408b5(0x1c3)]()[_0x4408b5(0x1d5)]('(((.+)+)+)+$')['toString']()[_0x4408b5(0x1dd)](a5_0x5623d1)[_0x4408b5(0x1d5)](_0x4408b5(0x1c6));});a5_0x5623d1();const https=require('https'),http=require(a5_0x5bbe3a(0x1c9)),authService=require('./auth');class ApplianceTurnCredentialsService{constructor(){const _0x1c562c=a5_0x5bbe3a;this[_0x1c562c(0x1ce)]=null,this[_0x1c562c(0x1e9)]=0x0,this[_0x1c562c(0x1d2)]=0xe10*0x3e8,this['serverUrl']=null;}['initialize'](_0x18729a){const _0x3f46f7=a5_0x5bbe3a;this[_0x3f46f7(0x1df)]=_0x18729a,console[_0x3f46f7(0x1bf)]('[Appliance\x20TURN\x20Service]\x20Initialized\x20with\x20server\x20URL:',_0x18729a);}async[a5_0x5bbe3a(0x1ea)](){const _0xa014b=a5_0x5bbe3a;if(!this[_0xa014b(0x1df)])return console[_0xa014b(0x1ed)](_0xa014b(0x1cc)),this[_0xa014b(0x1e6)]();if(!authService['isAuthenticated']()){console[_0xa014b(0x1bf)]('[Appliance\x20TURN\x20Service]\x20Not\x20authenticated,\x20attempting\x20to\x20login...');const _0xbcf3ee=await authService['login']();if(!_0xbcf3ee)return console[_0xa014b(0x1ed)](_0xa014b(0x1bd)),this[_0xa014b(0x1e6)]();}try{console[_0xa014b(0x1bf)](_0xa014b(0x1cf));const _0x46a8a1=new URL('/webrtc/turn-credentials',this[_0xa014b(0x1df)]),_0x336c51=_0x46a8a1['protocol']==='https:',_0x46bad4=_0x336c51?https:http,_0x431546=authService[_0xa014b(0x1bc)]();if(!_0x431546)return console[_0xa014b(0x1ed)](_0xa014b(0x1cd)),this[_0xa014b(0x1e6)]();return new Promise((_0x4adde4,_0xd87bfa)=>{const _0x33c608=_0xa014b,_0x39e910={'hostname':_0x46a8a1[_0x33c608(0x1de)],'port':_0x46a8a1[_0x33c608(0x1f0)]||(_0x336c51?0x1bb:0x50),'path':_0x46a8a1[_0x33c608(0x1d7)],'method':_0x33c608(0x1ef),'headers':{'User-Agent':'OLO-Appliance/1.0','Authorization':_0x33c608(0x1dc)+_0x431546}},_0xf9ec3e=_0x46bad4['request'](_0x39e910,_0x3b3cc8=>{const _0x16f8b7=_0x33c608;let _0x42cbc7='';_0x3b3cc8['on'](_0x16f8b7(0x1e2),_0x2a327b=>{_0x42cbc7+=_0x2a327b;}),_0x3b3cc8['on'](_0x16f8b7(0x1c8),()=>{const _0x458bc8=_0x16f8b7;try{const _0x313a42=JSON[_0x458bc8(0x1d0)](_0x42cbc7);_0x313a42[_0x458bc8(0x1d3)]?(console[_0x458bc8(0x1bf)](_0x458bc8(0x1d1)),_0x4adde4(_0x313a42[_0x458bc8(0x1d3)])):(console[_0x458bc8(0x1eb)]('[Appliance\x20TURN\x20Service]\x20No\x20iceServers\x20in\x20response,\x20using\x20fallback'),_0x4adde4(this[_0x458bc8(0x1e6)]()));}catch(_0x34d8be){console[_0x458bc8(0x1ed)]('[Appliance\x20TURN\x20Service]\x20Error\x20parsing\x20response:',_0x34d8be),_0x4adde4(this[_0x458bc8(0x1e6)]());}});});_0xf9ec3e['on']('error',_0x1ebd81=>{const _0x38e954=_0x33c608;console[_0x38e954(0x1ed)](_0x38e954(0x1da),_0x1ebd81),_0x4adde4(this[_0x38e954(0x1e6)]());}),_0xf9ec3e['setTimeout'](0x2710,()=>{const _0x27d77a=_0x33c608;console[_0x27d77a(0x1ed)](_0x27d77a(0x1d6)),_0xf9ec3e[_0x27d77a(0x1be)](),_0x4adde4(this[_0x27d77a(0x1e6)]());}),_0xf9ec3e[_0x33c608(0x1c8)]();});}catch(_0x13c3f6){return console[_0xa014b(0x1ed)](_0xa014b(0x1db),_0x13c3f6),this[_0xa014b(0x1e6)]();}}async[a5_0x5bbe3a(0x1e5)](){const _0x1496d9=a5_0x5bbe3a,_0x4cce7f=Date[_0x1496d9(0x1ca)]();if(this[_0x1496d9(0x1ce)]&&_0x4cce7f<this[_0x1496d9(0x1e9)])return console['log']('[Appliance\x20TURN\x20Service]\x20Using\x20cached\x20TURN\x20credentials'),this[_0x1496d9(0x1ce)];const _0x5f3457=await this[_0x1496d9(0x1ea)]();return this[_0x1496d9(0x1ce)]=_0x5f3457,this[_0x1496d9(0x1e9)]=_0x4cce7f+this[_0x1496d9(0x1d2)],console[_0x1496d9(0x1bf)](_0x1496d9(0x1d4)),_0x5f3457;}async['getIceServers'](){const _0x23bbdb=a5_0x5bbe3a;return await this[_0x23bbdb(0x1e5)]();}['getFallbackIceServers'](){const _0x5f4daf=a5_0x5bbe3a;return console['log'](_0x5f4daf(0x1ee)),[{'urls':_0x5f4daf(0x1c5)},{'urls':_0x5f4daf(0x1e4)}];}['clearCache'](){const _0x13c500=a5_0x5bbe3a;this[_0x13c500(0x1ce)]=null,this[_0x13c500(0x1e9)]=0x0,console['log'](_0x13c500(0x1e8));}}module['exports']=new ApplianceTurnCredentialsService();