const a1_0x4861bc=a1_0x3a1d;(function(_0x478d86,_0x63d51){const _0x4f4b9c=a1_0x3a1d,_0x585af8=_0x478d86();while(!![]){try{const _0x4a1a6b=-parseInt(_0x4f4b9c(0x14b))/0x1+parseInt(_0x4f4b9c(0xb3))/0x2*(-parseInt(_0x4f4b9c(0x127))/0x3)+parseInt(_0x4f4b9c(0xa5))/0x4*(-parseInt(_0x4f4b9c(0x135))/0x5)+-parseInt(_0x4f4b9c(0xc3))/0x6*(parseInt(_0x4f4b9c(0x169))/0x7)+-parseInt(_0x4f4b9c(0x166))/0x8*(parseInt(_0x4f4b9c(0xe8))/0x9)+-parseInt(_0x4f4b9c(0xf4))/0xa*(parseInt(_0x4f4b9c(0x160))/0xb)+parseInt(_0x4f4b9c(0xaa))/0xc*(parseInt(_0x4f4b9c(0xc1))/0xd);if(_0x4a1a6b===_0x63d51)break;else _0x585af8['push'](_0x585af8['shift']());}catch(_0x39a740){_0x585af8['push'](_0x585af8['shift']());}}}(a1_0x2aa6,0x261cc));const a1_0x256f68=(function(){let _0xac73ed=!![];return function(_0x4e37fb,_0x21543d){const _0x31c376=_0xac73ed?function(){const _0x5434dc=a1_0x3a1d;if(_0x21543d){const _0x31cd85=_0x21543d[_0x5434dc(0x12f)](_0x4e37fb,arguments);return _0x21543d=null,_0x31cd85;}}:function(){};return _0xac73ed=![],_0x31c376;};}()),a1_0x15c3f7=a1_0x256f68(this,function(){const _0x5c226f=a1_0x3a1d;return a1_0x15c3f7[_0x5c226f(0x120)]()[_0x5c226f(0x154)](_0x5c226f(0x121))[_0x5c226f(0x120)]()[_0x5c226f(0x131)](a1_0x15c3f7)[_0x5c226f(0x154)](_0x5c226f(0x121));});function a1_0x2aa6(){const _0x41ef43=['[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','Appliance\x20is\x20running\x20and\x20authenticated!','[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20','response','application/json','Disconnected\x20from\x20server\x20(','Connected\x20to\x20server','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','String\x20value\x20is:\x20','20tfjCLE','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','initialize','strategies','msg','),\x20attempting\x20to\x20reconnect...','OPEN','log','Topic\x20discovery\x20failed:','credentials','loadConfig','Enter\x20password:\x20','[MESH]\x20Successfully\x20served\x20mesh:\x20','readFileSync','urdf_param_data','getTopicStrategy','match','call_service','robotId','.dae','Failed\x20to\x20register\x20with\x20server','endsWith','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','Backend\x20Server\x20URL:\x20','service','/rosapi/topics','/rosbridge?type=appliance&token=','prompt-sync','.env','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','open','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','Failed\x20to\x20parse\x20appliance\x20identity\x20file:','header','roslib','./services/auth','exit','APP_USERNAME','Mesh\x20file\x20not\x20found:\x20','Loaded\x20appliance\x20identity:','status','serverUrl','toString','(((.+)+)+)+$','NODE_ENV','get_mesh','Port\x20','wsEndpoint','sample_skip','6VTHqGM','child_process','Not\x20authenticated','startsWith','[URDF\x20REWRITE]\x20Rewrote\x20','Authentication\x20required','Attempting\x20to\x20login\x20to:','Access-Control-Allow-Origin','apply','Successfully\x20registered\x20with\x20server','constructor','discoverTopics','slice','handleMessage','155kvQvdk','data','json','post','\x20attempts\x20starting\x20from\x20','\x20->\x20','login','Environment:\x20','password','ROSBridge\x20(WebRTC)\x20connection\x20error:','[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:','env','axios','development','Access-Control-Allow-Headers','xmldom','./config','package://','getElementsByTagName','getAttribute','./services/webrtcService','error','152304gUbbag','Access-Control-Allow-Methods','PORT','isAuthenticated','ros2\x20pkg\x20prefix\x20','Connected\x20to\x20ROSBridge\x20(WebRTC)','Enter\x20username:\x20','topics','Failed\x20to\x20connect\x20to\x20server:','search','config','stringify','.ply','serializeToString','string','registration_token','message','existsSync','strategy','registrationToken','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','1673287ZNIWIr','APP_PASSWORD','throttling','share','text/xml','robot\x20not\x20found','40bkIAdu','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','code','230293uWCssb','Successfully\x20logged\x20in','OPTIONS','estimatedSize','Connected\x20to\x20ROSBridge\x20(main)','request_id','Bearer\x20','24872iazqOB','utf8','send','getToken','mesh_data','5988YjJHaM','get_urdf_param','webrtc_skip','http','some','\x20of\x20','/appliance/register','forward','type','160044ozdbCc','replace','map','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','warn','sendStatus','readyState','.stl','samplingRate','stopAllSessions','ROSBridge\x20WebSocket\x20URL:\x20','Failed\x20to\x20register\x20with\x20server:','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','largeDataTopics','29809UyhNEZ','values','6unbjmg','ROSBridge\x20(main)\x20connection\x20error:','proxyPort','publish','uri','[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):','/ros/mesh?uri=','./services/TopicManager','close','dotenv','[MESH]\x20Error\x20serving\x20mesh:','unknown','catch','topic','WSL\x20Appliance','Proxy\x20listening\x20on\x20port:\x20','getSharedVideoSources','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','substring','/appliance/ping','EADDRINUSE','\x20from\x20','username','length','rosbridge','writeFileSync','ros2\x20param\x20get\x20','toLowerCase','filename','Ros','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','parse','types','/health','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','Registering\x20with\x20server...','trim','262548KBsfYs','param_name','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):'];a1_0x2aa6=function(){return _0x41ef43;};return a1_0x2aa6();}a1_0x15c3f7();const express=require('express'),config=require(a1_0x4861bc(0x145)),authService=require(a1_0x4861bc(0x119)),webrtcService=require(a1_0x4861bc(0x149)),topicManager=require(a1_0x4861bc(0xca)),WebSocket=require('ws'),axios=require(a1_0x4861bc(0x141)),fs=require('fs'),prompt=require(a1_0x4861bc(0x10f))({'sigint':!![]}),dotenv=require(a1_0x4861bc(0xcc)),app=express(),port=process[a1_0x4861bc(0x140)][a1_0x4861bc(0x14d)]||config[a1_0x4861bc(0xdb)][a1_0x4861bc(0xc5)],APPLIANCE_FILE='.appliance.json',{DOMParser,XMLSerializer}=require(a1_0x4861bc(0x144)),path=require('path'),{execSync}=require(a1_0x4861bc(0x128)),APPLIANCE_BASE_URL=process[a1_0x4861bc(0x140)]['APPLIANCE_BASE_URL']||'';console[a1_0x4861bc(0xfb)](a1_0x4861bc(0x13c)+(process['env'][a1_0x4861bc(0x122)]||a1_0x4861bc(0x142))),console[a1_0x4861bc(0xfb)](a1_0x4861bc(0x10b)+config['serverUrl']),console['log'](a1_0x4861bc(0xbd)+config['rosbridge'][a1_0x4861bc(0x125)]),console['log'](a1_0x4861bc(0xd2)+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x23e98e,_0x359ab0){const _0x53de49=a1_0x4861bc;fs[_0x53de49(0xdc)](_0x53de49(0x110),'APP_USERNAME='+_0x23e98e+'\x0aAPP_PASSWORD='+_0x359ab0+'\x0a');}function a1_0x3a1d(_0xbfc2fc,_0x4bdd7a){const _0x37039a=a1_0x2aa6();return a1_0x3a1d=function(_0x15c3f7,_0x256f68){_0x15c3f7=_0x15c3f7-0xa0;let _0x2aa68f=_0x37039a[_0x15c3f7];return _0x2aa68f;},a1_0x3a1d(_0xbfc2fc,_0x4bdd7a);}function reloadEnv(){const _0x45ab59=a1_0x4861bc;dotenv[_0x45ab59(0x155)]({'override':!![]}),config['credentials'][_0x45ab59(0xd9)]=process[_0x45ab59(0x140)][_0x45ab59(0x11b)],config[_0x45ab59(0xfd)][_0x45ab59(0x13d)]=process[_0x45ab59(0x140)][_0x45ab59(0x161)];}async function promptForCredentials(){const _0x158c3a=a1_0x4861bc,_0x13dd1c=prompt(_0x158c3a(0x151)),_0x42592e=prompt['hide'](_0x158c3a(0xff));updateEnvFile(_0x13dd1c,_0x42592e),reloadEnv();}function loadApplianceIdentity(){const _0x4f7202=a1_0x4861bc;if(fs[_0x4f7202(0x15c)](APPLIANCE_FILE))try{const _0x77f3cf=JSON['parse'](fs[_0x4f7202(0x101)](APPLIANCE_FILE,_0x4f7202(0xa6)));if(_0x77f3cf[_0x4f7202(0x106)]&&_0x77f3cf[_0x4f7202(0x15e)])return robotId=_0x77f3cf[_0x4f7202(0x106)],registrationToken=_0x77f3cf[_0x4f7202(0x15e)],console['log'](_0x4f7202(0x11d),robotId),topicManager[_0x4f7202(0xfe)](_0x77f3cf),!![];}catch(_0x4bcf3d){console[_0x4f7202(0x14a)](_0x4f7202(0x116),_0x4bcf3d);}return![];}function saveApplianceIdentity(_0x5d9d0c,_0x45289e){const _0x102374=a1_0x4861bc;let _0x4b08ff={};if(fs['existsSync'](APPLIANCE_FILE))try{_0x4b08ff=JSON[_0x102374(0xe2)](fs[_0x102374(0x101)](APPLIANCE_FILE,_0x102374(0xa6)));}catch(_0x2217a0){_0x4b08ff={};}_0x4b08ff[_0x102374(0x106)]=_0x5d9d0c,_0x4b08ff[_0x102374(0x15e)]=_0x45289e,fs[_0x102374(0xdc)](APPLIANCE_FILE,JSON['stringify'](_0x4b08ff,null,0x2));}async function registerWithServer(){const _0x7eebd4=a1_0x4861bc;try{const _0xb58e9f=authService[_0x7eebd4(0xa8)]();if(!_0xb58e9f)throw new Error(_0x7eebd4(0x129));let _0x299cb4,_0x4ff158=![];while(!![]){try{robotId&&registrationToken?_0x299cb4=await axios[_0x7eebd4(0x138)](config['serverUrl']+_0x7eebd4(0xb0),{'name':'WSL\x20Appliance','robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':'Bearer\x20'+_0xb58e9f,'Content-Type':_0x7eebd4(0xef)}}):_0x299cb4=await axios[_0x7eebd4(0x138)](config[_0x7eebd4(0x11f)]+'/appliance/register',{'name':_0x7eebd4(0xd1)},{'headers':{'Authorization':_0x7eebd4(0xa4)+_0xb58e9f,'Content-Type':_0x7eebd4(0xef)}});break;}catch(_0xa59e7a){const _0x367854=_0xa59e7a?.[_0x7eebd4(0xee)]?.[_0x7eebd4(0x136)]?.[_0x7eebd4(0x14a)]||_0xa59e7a['message'];if(!_0x4ff158&&_0x367854&&_0x367854[_0x7eebd4(0xde)]()['includes'](_0x7eebd4(0x165))){console[_0x7eebd4(0xb7)](_0x7eebd4(0xe5));if(fs[_0x7eebd4(0x15c)](APPLIANCE_FILE))fs['unlinkSync'](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x4ff158=!![];continue;}throw _0xa59e7a;}}if(!_0x299cb4[_0x7eebd4(0x136)]||!_0x299cb4['data'][_0x7eebd4(0x15a)]||!_0x299cb4['data']['id'])throw new Error(_0x7eebd4(0xb6));return registrationToken=_0x299cb4[_0x7eebd4(0x136)][_0x7eebd4(0x15a)],robotId=_0x299cb4[_0x7eebd4(0x136)]['id'],saveApplianceIdentity(robotId,registrationToken),console[_0x7eebd4(0xfb)](_0x7eebd4(0x130)),!![];}catch(_0x310f90){return console[_0x7eebd4(0x14a)](_0x7eebd4(0xbe),_0x310f90[_0x7eebd4(0x15b)]),![];}}function rewriteUrdfMeshUris(_0x2fb5aa){const _0x1d171d=a1_0x4861bc;try{const _0x2e1302=new DOMParser(),_0x48a01a=_0x2e1302['parseFromString'](_0x2fb5aa,_0x1d171d(0x164));let _0x5966dc=0x0,_0x30df80=0x0;const _0x3b9ef4=_0x48a01a[_0x1d171d(0x147)]('mesh');for(let _0x3820ca=0x0;_0x3820ca<_0x3b9ef4['length'];_0x3820ca++){const _0x2dbf41=_0x3b9ef4[_0x3820ca],_0xfc2e40=_0x2dbf41[_0x1d171d(0x148)](_0x1d171d(0xdf)),_0x1b422a=[_0x1d171d(0xba),_0x1d171d(0x107),'.obj',_0x1d171d(0x157),'.mesh'],_0x29a1aa=_0x1b422a[_0x1d171d(0xae)](_0x2a24f5=>_0xfc2e40['toLowerCase']()[_0x1d171d(0x109)](_0x2a24f5));if(_0xfc2e40&&_0xfc2e40[_0x1d171d(0x12a)](_0x1d171d(0x146))&&_0x29a1aa){_0x5966dc++;const _0x269e09=APPLIANCE_BASE_URL+_0x1d171d(0xc9)+encodeURIComponent(_0xfc2e40);_0x2dbf41['setAttribute'](_0x1d171d(0xdf),_0x269e09),_0x30df80++,console[_0x1d171d(0xfb)](_0x1d171d(0xed)+_0xfc2e40+_0x1d171d(0x13a)+_0x269e09);}}_0x5966dc>0x0?console[_0x1d171d(0xfb)](_0x1d171d(0x12b)+_0x30df80+_0x1d171d(0xaf)+_0x5966dc+_0x1d171d(0xbf)):console[_0x1d171d(0xfb)]('[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF');const _0x1a6a7b=new XMLSerializer();return _0x1a6a7b[_0x1d171d(0x158)](_0x48a01a);}catch(_0x1b5209){return console[_0x1d171d(0x14a)](_0x1d171d(0xc8),_0x1b5209),_0x2fb5aa;}}function connectToRosbridge(){const _0x2c26b7=a1_0x4861bc;try{rosbridgeWs=new WebSocket(config[_0x2c26b7(0xdb)]['wsEndpoint']),rosbridgeWs['on'](_0x2c26b7(0x114),()=>{const _0x3d3eb0=_0x2c26b7;console[_0x3d3eb0(0xfb)](_0x3d3eb0(0xa2));const _0x1a77ab=require(_0x3d3eb0(0x118)),_0xebeeee=new _0x1a77ab[(_0x3d3eb0(0xe0))]({'url':config[_0x3d3eb0(0xdb)][_0x3d3eb0(0x125)]});_0xebeeee['on']('connection',()=>{setTimeout(()=>{const _0x2d1610=a1_0x3a1d;topicManager[_0x2d1610(0x132)](_0xebeeee)[_0x2d1610(0xcf)](_0x4dd6af=>{const _0x97c900=_0x2d1610;console['error'](_0x97c900(0xfc),_0x4dd6af);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on'](_0x2c26b7(0x15b),_0x4c7794=>{const _0x57253c=_0x2c26b7;if(serverWs&&serverWs[_0x57253c(0xb9)]===WebSocket['OPEN']){let _0x318f82=_0x4c7794['toString']();try{const _0x1814b0=JSON[_0x57253c(0xe2)](_0x318f82);if(_0x1814b0['op']===_0x57253c(0xc6)&&_0x1814b0[_0x57253c(0xd0)]){const _0x35a263=topicManager[_0x57253c(0x134)](_0x1814b0);switch(_0x35a263['action']){case _0x57253c(0x126):return;case _0x57253c(0xac):return;case _0x57253c(0xb1):default:_0x318f82=JSON['stringify'](_0x35a263[_0x57253c(0x15b)]);break;}}if((_0x1814b0['op']==='service_response'||_0x1814b0['op']===_0x57253c(0x105))&&(_0x1814b0[_0x57253c(0x10c)]===_0x57253c(0x10d)||_0x1814b0[_0x57253c(0xc2)]&&_0x1814b0[_0x57253c(0xc2)]['topics'])){console[_0x57253c(0xfb)](_0x57253c(0x115));const _0x2fdd67=_0x1814b0[_0x57253c(0xc2)]?.[_0x57253c(0x152)]||[],_0x5b956d=_0x1814b0[_0x57253c(0xc2)]?.[_0x57253c(0xe3)]||[],_0x47afd0=_0x2fdd67[_0x57253c(0xb5)]((_0x1b028e,_0x13a8aa)=>{const _0x218a26=_0x57253c,_0x4a43f1=topicManager[_0x218a26(0x103)](_0x1b028e);return{'name':_0x1b028e,'type':_0x5b956d[_0x13a8aa]||_0x218a26(0xce),'throttling':_0x4a43f1?{'isThrottled':_0x4a43f1[_0x218a26(0x15d)]==='sample','strategy':_0x4a43f1['strategy'],'samplingRate':_0x4a43f1[_0x218a26(0xbb)],'reason':_0x4a43f1['reason'],'estimatedSize':_0x4a43f1[_0x218a26(0xa1)]}:null};});_0x1814b0[_0x57253c(0xc2)]={'topics':_0x47afd0['map'](_0x4ee32b=>_0x4ee32b['name']),'types':_0x47afd0[_0x57253c(0xb5)](_0x36883c=>_0x36883c[_0x57253c(0xb2)]),'throttling':_0x47afd0[_0x57253c(0xb5)](_0x58bd0f=>_0x58bd0f[_0x57253c(0x162)])},_0x318f82=JSON['stringify'](_0x1814b0),console[_0x57253c(0xfb)](_0x57253c(0x167));}if(_0x1814b0['op']==='publish'&&_0x1814b0['topic']==='/robot_description')try{const _0x564dfe=_0x1814b0[_0x57253c(0xf8)][_0x57253c(0x136)],_0x572a1d=rewriteUrdfMeshUris(_0x564dfe);_0x1814b0[_0x57253c(0xf8)][_0x57253c(0x136)]=_0x572a1d,_0x318f82=JSON[_0x57253c(0x156)](_0x1814b0);}catch(_0x5509a5){console[_0x57253c(0x14a)](_0x57253c(0xf2),_0x5509a5);}}catch(_0x102d0f){console['warn']('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0x102d0f[_0x57253c(0x15b)]);}serverWs[_0x57253c(0xa7)](_0x318f82);}}),rosbridgeWs['on'](_0x2c26b7(0xcb),()=>{const _0x1c9680=_0x2c26b7;console[_0x1c9680(0xfb)](_0x1c9680(0x111)),webrtcService[_0x1c9680(0xbc)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on'](_0x2c26b7(0x14a),_0x3eebdc=>{const _0x18cecf=_0x2c26b7;console['error'](_0x18cecf(0xc4),_0x3eebdc);});}catch(_0x1a591c){console[_0x2c26b7(0x14a)](_0x2c26b7(0xea),_0x1a591c),setTimeout(connectToRosbridge,0x1388);}}function connectToRosbridgeWebRTC(){const _0x1c35a4=a1_0x4861bc;try{rosbridgeWebRTCWs=new WebSocket(config[_0x1c35a4(0xdb)][_0x1c35a4(0x125)]),rosbridgeWebRTCWs['on'](_0x1c35a4(0x114),()=>{const _0xc04d70=_0x1c35a4;console[_0xc04d70(0xfb)](_0xc04d70(0x150)),webrtcService[_0xc04d70(0xf6)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on'](_0x1c35a4(0x15b),_0x20ee0e=>{}),rosbridgeWebRTCWs['on']('close',()=>{const _0x16b05a=_0x1c35a4;console[_0x16b05a(0xfb)](_0x16b05a(0x112)),webrtcService[_0x16b05a(0xbc)](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on']('error',_0x31bb64=>{const _0x37c989=_0x1c35a4;console[_0x37c989(0x14a)](_0x37c989(0x13e),_0x31bb64);});}catch(_0x369291){console['error']('Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):',_0x369291),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0xf25856=a1_0x4861bc;try{if(!registrationToken)throw new Error(_0xf25856(0xe1));const _0x2b3f50=config['serverUrl'][_0xf25856(0xb4)](_0xf25856(0xad),'ws')+_0xf25856(0x10e)+registrationToken;serverWs=new WebSocket(_0x2b3f50),serverWs['on']('open',()=>{const _0x1b014b=_0xf25856;console[_0x1b014b(0xfb)](_0x1b014b(0xf1)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x1b014b(0xb9)]===WebSocket[_0x1b014b(0xfa)]&&webrtcService[_0x1b014b(0xf6)](rosbridgeWebRTCWs,serverWs);}),serverWs['on'](_0xf25856(0x15b),_0x3c960f=>{const _0x2ad167=_0xf25856;if(rosbridgeWs&&rosbridgeWs[_0x2ad167(0xb9)]===WebSocket['OPEN']){let _0x7dd9be=_0x3c960f[_0x2ad167(0x120)]();try{const _0x2d31e3=JSON[_0x2ad167(0xe2)](_0x7dd9be);if(webrtcService[_0x2ad167(0x134)](_0x2d31e3))return;if(_0x2d31e3['op']===_0x2ad167(0xab)&&typeof _0x2d31e3[_0x2ad167(0xe9)]===_0x2ad167(0x159)&&_0x2d31e3[_0x2ad167(0xa3)])try{console['log'](_0x2ad167(0x10a)+_0x2d31e3[_0x2ad167(0xe9)]);const _0x10a087=execSync(_0x2ad167(0xdd)+_0x2d31e3[_0x2ad167(0xe9)],{'encoding':_0x2ad167(0xa6)})[_0x2ad167(0xe7)]();let _0x3f467d=_0x10a087;_0x10a087[_0x2ad167(0x12a)](_0x2ad167(0xf3))&&(_0x3f467d=_0x10a087[_0x2ad167(0xd5)]('String\x20value\x20is:\x20'['length']()));_0x3f467d[_0x2ad167(0x12a)]('\x22')&&_0x3f467d['endsWith']('\x22')&&(_0x3f467d=_0x3f467d[_0x2ad167(0x133)](0x1,-0x1));_0x3f467d=_0x3f467d[_0x2ad167(0xb4)](/\\n/g,'\x0a')[_0x2ad167(0xb4)](/\\"/g,'\x22');const _0xded45d={'op':_0x2ad167(0x102),'request_id':_0x2d31e3[_0x2ad167(0xa3)],'data':_0x3f467d};serverWs[_0x2ad167(0xa7)](JSON[_0x2ad167(0x156)](_0xded45d)),console[_0x2ad167(0xfb)](_0x2ad167(0xeb)+_0x2d31e3[_0x2ad167(0xe9)]);return;}catch(_0xa35a4c){console[_0x2ad167(0x14a)](_0x2ad167(0x13f),_0xa35a4c);const _0x37d5b5={'op':_0x2ad167(0x102),'request_id':_0x2d31e3['request_id'],'error':_0xa35a4c[_0x2ad167(0x15b)]};serverWs['send'](JSON[_0x2ad167(0x156)](_0x37d5b5));return;}if(_0x2d31e3['op']===_0x2ad167(0x123)&&typeof _0x2d31e3[_0x2ad167(0xc7)]===_0x2ad167(0x159)&&_0x2d31e3['request_id'])try{const _0x4cd818=_0x2d31e3[_0x2ad167(0xc7)][_0x2ad167(0x104)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0x4cd818){const _0x441248=_0x4cd818[0x1],_0x380612=_0x4cd818[0x2],_0x6bffca=execSync(_0x2ad167(0x14f)+_0x441248,{'encoding':_0x2ad167(0xa6)})['trim'](),_0x4dc495=path['join'](_0x6bffca,_0x2ad167(0x163),_0x441248,_0x380612);if(!fs[_0x2ad167(0x15c)](_0x4dc495))throw new Error(_0x2ad167(0x11c)+_0x4dc495);const _0x4d321a=fs[_0x2ad167(0x101)](_0x4dc495),_0x50f5cc={'op':_0x2ad167(0xa9),'request_id':_0x2d31e3[_0x2ad167(0xa3)],'data':_0x4d321a['toString']('base64')};serverWs[_0x2ad167(0xa7)](JSON['stringify'](_0x50f5cc)),console[_0x2ad167(0xfb)](_0x2ad167(0x100)+_0x2d31e3['uri']+_0x2ad167(0xd8)+_0x4dc495);return;}}catch(_0x5d1c2b){console['error'](_0x2ad167(0xcd),_0x5d1c2b);const _0x15ae3c={'op':'mesh_data','request_id':_0x2d31e3[_0x2ad167(0xa3)],'error':_0x5d1c2b['message']};serverWs[_0x2ad167(0xa7)](JSON['stringify'](_0x15ae3c));return;}rosbridgeWs[_0x2ad167(0xa7)](_0x7dd9be);}catch(_0x144471){rosbridgeWs[_0x2ad167(0xa7)](_0x7dd9be);}}}),serverWs['on']('close',(_0x4d53e4,_0x2924c5)=>{const _0x7999a1=_0xf25856;console[_0x7999a1(0xfb)](_0x7999a1(0xf0)+_0x4d53e4+':\x20'+_0x2924c5+_0x7999a1(0xf9)),webrtcService[_0x7999a1(0xbc)](),setTimeout(connectToServer,0x1388);}),serverWs['on']('error',_0x59e2e9=>{const _0x20e0b6=_0xf25856;console[_0x20e0b6(0x14a)]('Server\x20connection\x20error:',_0x59e2e9);});}catch(_0x2e027e){console[_0xf25856(0x14a)](_0xf25856(0x153),_0x2e027e),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x163c67,_0x341e99,_0x565b04)=>{const _0x5cd033=a1_0x4861bc;if(!authService[_0x5cd033(0x14e)]()){console[_0x5cd033(0xfb)](_0x5cd033(0x12d),config['serverUrl']);const _0x599ea1=await authService[_0x5cd033(0x13b)]();if(!_0x599ea1)return _0x341e99[_0x5cd033(0x11e)](0x191)[_0x5cd033(0x137)]({'error':_0x5cd033(0x12c)});}_0x565b04();};app['use']((_0x4c8740,_0x1b5424,_0x33ca47)=>{const _0x410ea5=a1_0x4861bc;_0x1b5424[_0x410ea5(0x117)](_0x410ea5(0x12e),'*'),_0x1b5424[_0x410ea5(0x117)](_0x410ea5(0x14c),_0x410ea5(0xd4)),_0x1b5424['header'](_0x410ea5(0x143),_0x410ea5(0xf5)),_0x4c8740['method']===_0x410ea5(0xa0)?_0x1b5424[_0x410ea5(0xb8)](0xc8):_0x33ca47();}),app['get']('/',requireAuth,(_0x54706c,_0x1dbf24)=>{const _0x553377=a1_0x4861bc;_0x1dbf24[_0x553377(0xa7)](_0x553377(0xec));}),app['get'](a1_0x4861bc(0xe4),async(_0x4e3274,_0x48aa90)=>{const _0x3383da=a1_0x4861bc,_0x16ce84=authService[_0x3383da(0x14e)](),_0x3294ee=webrtcService['getActiveSessions'](),_0x3071ac=webrtcService[_0x3383da(0xd3)](),_0x24214e=topicManager['getStatistics']();_0x48aa90[_0x3383da(0x137)]({'status':'ok','environment':process[_0x3383da(0x140)][_0x3383da(0x122)]||_0x3383da(0x142),'backendUrl':config[_0x3383da(0x11f)],'rosbridgeUrl':config['rosbridge'][_0x3383da(0x125)],'proxyPort':port,'authenticated':_0x16ce84,'topicManagement':{'discovered':_0x24214e['totalTopics'],'strategies':_0x24214e[_0x3383da(0xf7)],'largeDataTopics':_0x24214e['largeDataTopics']['length'],'largeTopicsList':_0x24214e[_0x3383da(0xc0)]},'webrtc':{'activeSessions':_0x3294ee['length'],'sharedVideoSources':_0x3071ac[_0x3383da(0xda)],'sessions':_0x3294ee,'sharedSources':_0x3071ac}});});const getInitialPort=()=>{const _0x2f46d4=a1_0x4861bc;if(process[_0x2f46d4(0x140)][_0x2f46d4(0x14d)])return parseInt(process[_0x2f46d4(0x140)][_0x2f46d4(0x14d)],0xa);return config[_0x2f46d4(0xdb)][_0x2f46d4(0xc5)];};async function listenWithRetries(_0x42a38d,_0x2811e3,_0x215c7f=0xa){const _0x11ca34=a1_0x4861bc;let _0x3b7d95=_0x2811e3;for(let _0x369f9f=0x1;_0x369f9f<=_0x215c7f;_0x369f9f++){try{return await new Promise((_0xfe4e1f,_0x311123)=>{const _0x344bf2=a1_0x3a1d,_0x192eeb=_0x42a38d['listen'](_0x3b7d95,()=>{const _0x3eca9e=a1_0x3a1d;console[_0x3eca9e(0xfb)](_0x3eca9e(0x15f)+_0x3b7d95),_0xfe4e1f(_0x192eeb);});_0x192eeb['on'](_0x344bf2(0x14a),_0x2f1888=>{const _0x2eb9ba=_0x344bf2;_0x2f1888[_0x2eb9ba(0x168)]===_0x2eb9ba(0xd7)?(console[_0x2eb9ba(0xb7)](_0x2eb9ba(0x124)+_0x3b7d95+'\x20in\x20use,\x20trying\x20next\x20port...'),_0x311123(_0x2f1888)):_0x311123(_0x2f1888);});}),_0x3b7d95;}catch(_0x1e2e22){_0x3b7d95++;}}throw new Error(_0x11ca34(0x113)+_0x215c7f+_0x11ca34(0x139)+_0x2811e3);}const startApp=async()=>{const _0x5bfdbd=a1_0x4861bc;try{let _0x492927=await authService[_0x5bfdbd(0x13b)]();while(!_0x492927){console[_0x5bfdbd(0xfb)]('Login\x20failed.\x20Please\x20enter\x20credentials\x20again.'),await promptForCredentials(),_0x492927=await authService[_0x5bfdbd(0x13b)]();}console[_0x5bfdbd(0xfb)](_0x5bfdbd(0x16a));!loadApplianceIdentity()&&console[_0x5bfdbd(0xfb)]('No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.');console['log'](_0x5bfdbd(0xe6));const _0x50a74e=await registerWithServer();if(!_0x50a74e)throw new Error(_0x5bfdbd(0x108));connectToRosbridge(),connectToServer();const _0x589d17=getInitialPort();await listenWithRetries(app,_0x589d17,0xa);}catch(_0xa7e5e0){console['error']('Failed\x20to\x20start\x20application:',_0xa7e5e0),process[_0x5bfdbd(0x11a)](0x1);}};setInterval(async()=>{const _0x28eccf=a1_0x4861bc;try{if(robotId){const _0x1cc789=authService[_0x28eccf(0xa8)]();await axios['post'](config[_0x28eccf(0x11f)]+_0x28eccf(0xd6),{'robotId':robotId},{'headers':{'Authorization':_0x28eccf(0xa4)+_0x1cc789,'Content-Type':_0x28eccf(0xef)}});}}catch(_0x1aeb2b){console[_0x28eccf(0x14a)]('Failed\x20to\x20ping\x20server:',_0x1aeb2b['message']);}},0x1388),startApp();