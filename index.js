const a1_0x1fdf72=a1_0x43c3;(function(_0x176b7c,_0x461312){const _0x415dbf=a1_0x43c3,_0x240e72=_0x176b7c();while(!![]){try{const _0x10a0ed=-parseInt(_0x415dbf(0x271))/0x1+parseInt(_0x415dbf(0x1fc))/0x2+parseInt(_0x415dbf(0x260))/0x3*(-parseInt(_0x415dbf(0x220))/0x4)+-parseInt(_0x415dbf(0x283))/0x5+parseInt(_0x415dbf(0x1df))/0x6+parseInt(_0x415dbf(0x1dc))/0x7*(parseInt(_0x415dbf(0x239))/0x8)+-parseInt(_0x415dbf(0x1de))/0x9;if(_0x10a0ed===_0x461312)break;else _0x240e72['push'](_0x240e72['shift']());}catch(_0x2154fb){_0x240e72['push'](_0x240e72['shift']());}}}(a1_0x2473,0xc2083));const a1_0x1c8c97=(function(){let _0x5bbb6d=!![];return function(_0x8bc552,_0x43a46b){const _0x462f13=_0x5bbb6d?function(){if(_0x43a46b){const _0x7edd37=_0x43a46b['apply'](_0x8bc552,arguments);return _0x43a46b=null,_0x7edd37;}}:function(){};return _0x5bbb6d=![],_0x462f13;};}()),a1_0x1e1d6a=a1_0x1c8c97(this,function(){const _0x3206d0=a1_0x43c3;return a1_0x1e1d6a[_0x3206d0(0x263)]()[_0x3206d0(0x1e7)]('(((.+)+)+)+$')[_0x3206d0(0x263)]()[_0x3206d0(0x23e)](a1_0x1e1d6a)['search'](_0x3206d0(0x1d5));});a1_0x1e1d6a();const express=require('express'),config=require('./config'),authService=require(a1_0x1fdf72(0x225)),webrtcService=require(a1_0x1fdf72(0x228)),topicManager=require(a1_0x1fdf72(0x242)),WebSocket=require('ws'),axios=require(a1_0x1fdf72(0x25a)),fs=require('fs'),prompt=require('prompt-sync')({'sigint':!![]}),dotenv=require('dotenv'),app=express(),port=process[a1_0x1fdf72(0x1e2)]['PORT']||config[a1_0x1fdf72(0x264)]['proxyPort'],APPLIANCE_FILE=a1_0x1fdf72(0x27e),{DOMParser,XMLSerializer}=require(a1_0x1fdf72(0x281)),path=require(a1_0x1fdf72(0x200)),{execSync}=require(a1_0x1fdf72(0x261)),APPLIANCE_BASE_URL=process[a1_0x1fdf72(0x1e2)][a1_0x1fdf72(0x1ff)]||'';console[a1_0x1fdf72(0x201)](a1_0x1fdf72(0x22d)+(process[a1_0x1fdf72(0x1e2)][a1_0x1fdf72(0x1d6)]||a1_0x1fdf72(0x254))),console[a1_0x1fdf72(0x201)]('Backend\x20Server\x20URL:\x20'+config['serverUrl']),console[a1_0x1fdf72(0x201)](a1_0x1fdf72(0x1f0)+config[a1_0x1fdf72(0x264)][a1_0x1fdf72(0x20a)]),console[a1_0x1fdf72(0x201)](a1_0x1fdf72(0x230)+port);let serverWs=null,rosbridgeWs=null,rosbridgeWebRTCWs=null,registrationToken=null,robotId=null;function updateEnvFile(_0x1e3244,_0x4af0be){const _0x5d4bd9=a1_0x1fdf72;fs[_0x5d4bd9(0x206)]('.env',_0x5d4bd9(0x224)+_0x1e3244+_0x5d4bd9(0x20c)+_0x4af0be+'\x0a');}function reloadEnv(){const _0x4c1e59=a1_0x1fdf72;dotenv[_0x4c1e59(0x1e5)]({'override':!![]}),config[_0x4c1e59(0x21a)][_0x4c1e59(0x286)]=process['env'][_0x4c1e59(0x28e)],config['credentials'][_0x4c1e59(0x229)]=process['env'][_0x4c1e59(0x280)];}async function promptForCredentials(){const _0x324b5e=a1_0x1fdf72,_0x5b13cd=prompt('Enter\x20username:\x20'),_0x57ac93=prompt['hide'](_0x324b5e(0x26a));updateEnvFile(_0x5b13cd,_0x57ac93),reloadEnv();}function loadApplianceIdentity(){const _0x4e91fc=a1_0x1fdf72;if(fs[_0x4e91fc(0x23c)](APPLIANCE_FILE))try{const _0x3e4c21=JSON['parse'](fs[_0x4e91fc(0x24e)](APPLIANCE_FILE,_0x4e91fc(0x27d)));if(_0x3e4c21['robotId']&&_0x3e4c21['registrationToken'])return robotId=_0x3e4c21['robotId'],registrationToken=_0x3e4c21[_0x4e91fc(0x21d)],console[_0x4e91fc(0x201)](_0x4e91fc(0x23f),robotId),topicManager[_0x4e91fc(0x266)](_0x3e4c21),!![];}catch(_0x1d2e0d){console[_0x4e91fc(0x233)]('Failed\x20to\x20parse\x20appliance\x20identity\x20file:',_0x1d2e0d);}return![];}function saveApplianceIdentity(_0x32fa92,_0x695d1d){const _0x3f9eb0=a1_0x1fdf72;let _0xb2c586={};if(fs['existsSync'](APPLIANCE_FILE))try{_0xb2c586=JSON[_0x3f9eb0(0x1f7)](fs['readFileSync'](APPLIANCE_FILE,'utf8'));}catch(_0x21d8c9){_0xb2c586={};}_0xb2c586[_0x3f9eb0(0x234)]=_0x32fa92,_0xb2c586[_0x3f9eb0(0x21d)]=_0x695d1d,fs[_0x3f9eb0(0x206)](APPLIANCE_FILE,JSON[_0x3f9eb0(0x28c)](_0xb2c586,null,0x2));}async function registerWithServer(){const _0x48fd80=a1_0x1fdf72;try{const _0x334aff=authService[_0x48fd80(0x217)]();if(!_0x334aff)throw new Error('Not\x20authenticated');let _0x2a04fd,_0x1eee3c=![];while(!![]){try{robotId&&registrationToken?_0x2a04fd=await axios[_0x48fd80(0x27f)](config[_0x48fd80(0x1fa)]+_0x48fd80(0x1dd),{'name':'WSL\x20Appliance','robotId':robotId,'registration_token':registrationToken},{'headers':{'Authorization':_0x48fd80(0x1d1)+_0x334aff,'Content-Type':_0x48fd80(0x27b)}}):_0x2a04fd=await axios['post'](config[_0x48fd80(0x1fa)]+_0x48fd80(0x1dd),{'name':'WSL\x20Appliance'},{'headers':{'Authorization':_0x48fd80(0x1d1)+_0x334aff,'Content-Type':_0x48fd80(0x27b)}});break;}catch(_0x19f845){const _0x53fb87=_0x19f845?.['response']?.[_0x48fd80(0x214)]?.['error']||_0x19f845['message'];if(!_0x1eee3c&&_0x53fb87&&_0x53fb87['toLowerCase']()[_0x48fd80(0x1d9)](_0x48fd80(0x216))){console['warn'](_0x48fd80(0x1e8));if(fs[_0x48fd80(0x23c)](APPLIANCE_FILE))fs[_0x48fd80(0x1f9)](APPLIANCE_FILE);robotId=null,registrationToken=null,_0x1eee3c=!![];continue;}throw _0x19f845;}}if(!_0x2a04fd[_0x48fd80(0x214)]||!_0x2a04fd['data'][_0x48fd80(0x1f3)]||!_0x2a04fd[_0x48fd80(0x214)]['id'])throw new Error(_0x48fd80(0x1fe));return registrationToken=_0x2a04fd['data'][_0x48fd80(0x1f3)],robotId=_0x2a04fd[_0x48fd80(0x214)]['id'],saveApplianceIdentity(robotId,registrationToken),console[_0x48fd80(0x201)]('Successfully\x20registered\x20with\x20server'),!![];}catch(_0xa373d6){return console['error'](_0x48fd80(0x279),_0xa373d6[_0x48fd80(0x26f)]),![];}}function rewriteUrdfMeshUris(_0x4b7359){const _0x11d349=a1_0x1fdf72;try{const _0x1e7155=new DOMParser(),_0x4de0d2=_0x1e7155[_0x11d349(0x246)](_0x4b7359,'text/xml');let _0xd395ab=0x0,_0x13077c=0x0;const _0x2c5903=_0x4de0d2['getElementsByTagName'](_0x11d349(0x277));for(let _0x295bde=0x0;_0x295bde<_0x2c5903[_0x11d349(0x28f)];_0x295bde++){const _0xbc6cef=_0x2c5903[_0x295bde],_0x94f38e=_0xbc6cef[_0x11d349(0x28d)](_0x11d349(0x1e6)),_0x12c940=[_0x11d349(0x1d8),_0x11d349(0x22a),'.obj',_0x11d349(0x25f),_0x11d349(0x267)],_0x24bcae=_0x12c940[_0x11d349(0x219)](_0x4651f8=>_0x94f38e[_0x11d349(0x238)]()[_0x11d349(0x259)](_0x4651f8));if(_0x94f38e&&_0x94f38e[_0x11d349(0x248)](_0x11d349(0x256))&&_0x24bcae){_0xd395ab++;const _0x3c57b9=APPLIANCE_BASE_URL+'/ros/mesh?uri='+encodeURIComponent(_0x94f38e);_0xbc6cef[_0x11d349(0x22b)]('filename',_0x3c57b9),_0x13077c++,console[_0x11d349(0x201)]('[URDF\x20REWRITE]\x20Rewrote\x20mesh\x20URI:\x20'+_0x94f38e+_0x11d349(0x1ed)+_0x3c57b9);}}_0xd395ab>0x0?console[_0x11d349(0x201)](_0x11d349(0x1da)+_0x13077c+_0x11d349(0x22e)+_0xd395ab+_0x11d349(0x25e)):console[_0x11d349(0x201)](_0x11d349(0x205));const _0x5254c3=new XMLSerializer();return _0x5254c3['serializeToString'](_0x4de0d2);}catch(_0xc976d4){return console['error']('[URDF\x20REWRITE]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs\x20in\x20URDF\x20(WebSocket):',_0xc976d4),_0x4b7359;}}function connectToRosbridge(){const _0x187877=a1_0x1fdf72;try{rosbridgeWs=new WebSocket(config[_0x187877(0x264)][_0x187877(0x20a)]),rosbridgeWs['on'](_0x187877(0x235),()=>{const _0x243043=_0x187877;console[_0x243043(0x201)](_0x243043(0x1e9));const _0x2141a8=require(_0x243043(0x1f4)),_0x5dab57=new _0x2141a8[(_0x243043(0x22f))]({'url':config[_0x243043(0x264)][_0x243043(0x20a)]});_0x5dab57['on'](_0x243043(0x28b),()=>{setTimeout(()=>{const _0x2dfac0=a1_0x43c3;topicManager[_0x2dfac0(0x22c)](_0x5dab57)[_0x2dfac0(0x209)](_0x3408b7=>{const _0x3e1249=_0x2dfac0;console['error'](_0x3e1249(0x20e),_0x3408b7);});},0x3e8);}),connectToRosbridgeWebRTC();}),rosbridgeWs['on'](_0x187877(0x26f),_0x13b5a0=>{const _0x499de6=_0x187877;if(serverWs&&serverWs[_0x499de6(0x25b)]===WebSocket[_0x499de6(0x208)]){let _0x468138=_0x13b5a0[_0x499de6(0x263)]();try{const _0x23eea4=JSON['parse'](_0x468138);if(_0x23eea4['op']===_0x499de6(0x25d)&&_0x23eea4[_0x499de6(0x24d)]){const _0x23feab=topicManager['handleMessage'](_0x23eea4);switch(_0x23feab[_0x499de6(0x237)]){case _0x499de6(0x1d2):return;case _0x499de6(0x262):return;case'forward':default:_0x468138=JSON[_0x499de6(0x28c)](_0x23feab['message']);break;}}if((_0x23eea4['op']===_0x499de6(0x207)||_0x23eea4['op']==='call_service')&&(_0x23eea4[_0x499de6(0x251)]==='/rosapi/topics'||_0x23eea4[_0x499de6(0x23a)]&&_0x23eea4['values'][_0x499de6(0x210)])){console[_0x499de6(0x201)](_0x499de6(0x232));const _0x16b3f1=_0x23eea4[_0x499de6(0x23a)]?.[_0x499de6(0x210)]||[],_0xb1abc5=_0x23eea4[_0x499de6(0x23a)]?.[_0x499de6(0x257)]||[],_0x522b0f=_0x16b3f1[_0x499de6(0x231)]((_0x5c1d4f,_0x245a37)=>{const _0x2280c6=_0x499de6,_0x4a088a=topicManager[_0x2280c6(0x255)](_0x5c1d4f);return{'name':_0x5c1d4f,'type':_0xb1abc5[_0x245a37]||_0x2280c6(0x278),'throttling':_0x4a088a?{'isThrottled':_0x4a088a['strategy']==='sample','strategy':_0x4a088a[_0x2280c6(0x27a)],'samplingRate':_0x4a088a[_0x2280c6(0x213)],'reason':_0x4a088a['reason'],'estimatedSize':_0x4a088a[_0x2280c6(0x222)]}:null};});_0x23eea4[_0x499de6(0x23a)]={'topics':_0x522b0f[_0x499de6(0x231)](_0x19ee33=>_0x19ee33['name']),'types':_0x522b0f[_0x499de6(0x231)](_0x4acc13=>_0x4acc13[_0x499de6(0x26d)]),'throttling':_0x522b0f[_0x499de6(0x231)](_0x2ee543=>_0x2ee543[_0x499de6(0x269)])},_0x468138=JSON[_0x499de6(0x28c)](_0x23eea4),console['log'](_0x499de6(0x226));}if(_0x23eea4['op']==='publish'&&_0x23eea4[_0x499de6(0x24d)]===_0x499de6(0x1ef))try{const _0x16a79f=_0x23eea4['msg'][_0x499de6(0x214)],_0x4be27d=rewriteUrdfMeshUris(_0x16a79f);_0x23eea4[_0x499de6(0x23b)][_0x499de6(0x214)]=_0x4be27d,_0x468138=JSON[_0x499de6(0x28c)](_0x23eea4);}catch(_0x602734){console[_0x499de6(0x233)](_0x499de6(0x1e0),_0x602734);}}catch(_0x7f9cea){console[_0x499de6(0x28a)]('[ROSBridge]\x20Failed\x20to\x20parse\x20message\x20for\x20topic\x20management:',_0x7f9cea[_0x499de6(0x26f)]);}serverWs['send'](_0x468138);}}),rosbridgeWs['on'](_0x187877(0x221),()=>{const _0x4b5b39=_0x187877;console['log'](_0x4b5b39(0x20f)),webrtcService[_0x4b5b39(0x1ea)](),setTimeout(connectToRosbridge,0x1388);}),rosbridgeWs['on'](_0x187877(0x233),_0x3374da=>{const _0x27fca5=_0x187877;console[_0x27fca5(0x233)](_0x27fca5(0x24c),_0x3374da);});}catch(_0x32ff62){console['error']('Failed\x20to\x20connect\x20to\x20ROSBridge\x20(main):',_0x32ff62),setTimeout(connectToRosbridge,0x1388);}}function a1_0x43c3(_0x2d4513,_0x539985){const _0x22a9bb=a1_0x2473();return a1_0x43c3=function(_0x1e1d6a,_0x1c8c97){_0x1e1d6a=_0x1e1d6a-0x1d1;let _0x247385=_0x22a9bb[_0x1e1d6a];return _0x247385;},a1_0x43c3(_0x2d4513,_0x539985);}function connectToRosbridgeWebRTC(){const _0x464d96=a1_0x1fdf72;try{rosbridgeWebRTCWs=new WebSocket(config[_0x464d96(0x264)][_0x464d96(0x20a)]),rosbridgeWebRTCWs['on'](_0x464d96(0x235),()=>{const _0x2fc600=_0x464d96;console['log'](_0x2fc600(0x23d)),webrtcService[_0x2fc600(0x1f2)](rosbridgeWebRTCWs,serverWs);}),rosbridgeWebRTCWs['on'](_0x464d96(0x26f),_0x3a4538=>{}),rosbridgeWebRTCWs['on'](_0x464d96(0x221),()=>{const _0x3d8e11=_0x464d96;console[_0x3d8e11(0x201)](_0x3d8e11(0x284)),webrtcService['stopAllSessions'](),setTimeout(connectToRosbridgeWebRTC,0x1388);}),rosbridgeWebRTCWs['on'](_0x464d96(0x233),_0x18e42d=>{const _0x51e3c2=_0x464d96;console[_0x51e3c2(0x233)](_0x51e3c2(0x258),_0x18e42d);});}catch(_0xeeb03d){console['error'](_0x464d96(0x1d4),_0xeeb03d),setTimeout(connectToRosbridgeWebRTC,0x1388);}}function connectToServer(){const _0x338625=a1_0x1fdf72;try{if(!registrationToken)throw new Error(_0x338625(0x245));const _0x2bb74f=config[_0x338625(0x1fa)][_0x338625(0x1e4)](_0x338625(0x21c),'ws')+_0x338625(0x273)+registrationToken;serverWs=new WebSocket(_0x2bb74f),serverWs['on'](_0x338625(0x235),()=>{const _0x282f1c=_0x338625;console[_0x282f1c(0x201)](_0x282f1c(0x289)),rosbridgeWebRTCWs&&rosbridgeWebRTCWs[_0x282f1c(0x25b)]===WebSocket[_0x282f1c(0x208)]&&webrtcService[_0x282f1c(0x1f2)](rosbridgeWebRTCWs,serverWs);}),serverWs['on']('message',_0x5a512b=>{const _0x1bbf1f=_0x338625;if(rosbridgeWs&&rosbridgeWs[_0x1bbf1f(0x25b)]===WebSocket[_0x1bbf1f(0x208)]){let _0x450eec=_0x5a512b[_0x1bbf1f(0x263)]();try{const _0x3715ad=JSON['parse'](_0x450eec);if(webrtcService[_0x1bbf1f(0x253)](_0x3715ad))return;if(_0x3715ad['op']==='get_urdf_param'&&typeof _0x3715ad['param_name']===_0x1bbf1f(0x265)&&_0x3715ad[_0x1bbf1f(0x1ec)])try{console[_0x1bbf1f(0x201)](_0x1bbf1f(0x218)+_0x3715ad[_0x1bbf1f(0x282)]);const _0x20650d=execSync(_0x1bbf1f(0x24a)+_0x3715ad['param_name'],{'encoding':_0x1bbf1f(0x27d)})[_0x1bbf1f(0x249)]();let _0x2d6548=_0x20650d;_0x20650d['startsWith']('String\x20value\x20is:\x20')&&(_0x2d6548=_0x20650d[_0x1bbf1f(0x275)]('String\x20value\x20is:\x20'['length']()));_0x2d6548[_0x1bbf1f(0x248)]('\x22')&&_0x2d6548['endsWith']('\x22')&&(_0x2d6548=_0x2d6548[_0x1bbf1f(0x243)](0x1,-0x1));_0x2d6548=_0x2d6548[_0x1bbf1f(0x1e4)](/\\n/g,'\x0a')[_0x1bbf1f(0x1e4)](/\\"/g,'\x22');const _0x2e4349={'op':'urdf_param_data','request_id':_0x3715ad['request_id'],'data':_0x2d6548};serverWs['send'](JSON['stringify'](_0x2e4349)),console['log'](_0x1bbf1f(0x244)+_0x3715ad[_0x1bbf1f(0x282)]);return;}catch(_0x745e7b){console[_0x1bbf1f(0x233)]('[URDF\x20PARAM]\x20Error\x20fetching\x20URDF\x20parameter:',_0x745e7b);const _0x47a9a3={'op':'urdf_param_data','request_id':_0x3715ad['request_id'],'error':_0x745e7b[_0x1bbf1f(0x26f)]};serverWs[_0x1bbf1f(0x276)](JSON[_0x1bbf1f(0x28c)](_0x47a9a3));return;}if(_0x3715ad['op']==='get_mesh'&&typeof _0x3715ad[_0x1bbf1f(0x24f)]===_0x1bbf1f(0x265)&&_0x3715ad[_0x1bbf1f(0x1ec)])try{const _0xe4e587=_0x3715ad[_0x1bbf1f(0x24f)][_0x1bbf1f(0x1f8)](/^package:\/\/([^\/]+)\/(.+)$/);if(_0xe4e587){const _0x3ec3ed=_0xe4e587[0x1],_0xe47c3c=_0xe4e587[0x2],_0x2dc474=execSync(_0x1bbf1f(0x236)+_0x3ec3ed,{'encoding':_0x1bbf1f(0x27d)})['trim'](),_0x42bf7c=path[_0x1bbf1f(0x212)](_0x2dc474,'share',_0x3ec3ed,_0xe47c3c);if(!fs[_0x1bbf1f(0x23c)](_0x42bf7c))throw new Error('Mesh\x20file\x20not\x20found:\x20'+_0x42bf7c);const _0xc4c8c5=fs[_0x1bbf1f(0x24e)](_0x42bf7c),_0x1add51={'op':_0x1bbf1f(0x27c),'request_id':_0x3715ad[_0x1bbf1f(0x1ec)],'data':_0xc4c8c5[_0x1bbf1f(0x263)](_0x1bbf1f(0x290))};serverWs[_0x1bbf1f(0x276)](JSON[_0x1bbf1f(0x28c)](_0x1add51)),console[_0x1bbf1f(0x201)](_0x1bbf1f(0x285)+_0x3715ad[_0x1bbf1f(0x24f)]+'\x20from\x20'+_0x42bf7c);return;}}catch(_0x3b96cb){console[_0x1bbf1f(0x233)]('[MESH]\x20Error\x20serving\x20mesh:',_0x3b96cb);const _0x125fc1={'op':'mesh_data','request_id':_0x3715ad[_0x1bbf1f(0x1ec)],'error':_0x3b96cb[_0x1bbf1f(0x26f)]};serverWs[_0x1bbf1f(0x276)](JSON['stringify'](_0x125fc1));return;}rosbridgeWs[_0x1bbf1f(0x276)](_0x450eec);}catch(_0x1fe494){rosbridgeWs[_0x1bbf1f(0x276)](_0x450eec);}}}),serverWs['on'](_0x338625(0x221),(_0x520ed1,_0x337820)=>{const _0x457270=_0x338625;console['log'](_0x457270(0x1d7)+_0x520ed1+':\x20'+_0x337820+_0x457270(0x20d)),webrtcService[_0x457270(0x1ea)](),setTimeout(connectToServer,0x1388);}),serverWs['on'](_0x338625(0x233),_0x5cfcc9=>{const _0x4ba7c9=_0x338625;console['error'](_0x4ba7c9(0x287),_0x5cfcc9);});}catch(_0x3c3263){console[_0x338625(0x233)](_0x338625(0x1ee),_0x3c3263),setTimeout(connectToServer,0x1388);}}const requireAuth=async(_0x5d032b,_0x5cd035,_0x59d437)=>{const _0x230b5f=a1_0x1fdf72;if(!authService['isAuthenticated']()){console[_0x230b5f(0x201)](_0x230b5f(0x26c),config[_0x230b5f(0x1fa)]);const _0xfb3d9c=await authService[_0x230b5f(0x1fd)]();if(!_0xfb3d9c)return _0x5cd035[_0x230b5f(0x270)](0x191)[_0x230b5f(0x288)]({'error':_0x230b5f(0x240)});}_0x59d437();};app[a1_0x1fdf72(0x203)]((_0x354712,_0x206ca5,_0x127c67)=>{const _0x24baf5=a1_0x1fdf72;_0x206ca5[_0x24baf5(0x1db)](_0x24baf5(0x204),'*'),_0x206ca5[_0x24baf5(0x1db)](_0x24baf5(0x20b),_0x24baf5(0x247)),_0x206ca5['header'](_0x24baf5(0x1f5),_0x24baf5(0x227)),_0x354712['method']===_0x24baf5(0x21f)?_0x206ca5[_0x24baf5(0x1f6)](0xc8):_0x127c67();}),app['get']('/',requireAuth,(_0x27eef6,_0x3a4fb4)=>{const _0x1d8246=a1_0x1fdf72;_0x3a4fb4[_0x1d8246(0x276)](_0x1d8246(0x26b));}),app[a1_0x1fdf72(0x274)](a1_0x1fdf72(0x250),async(_0x235ab2,_0x1a1461)=>{const _0x9d480c=a1_0x1fdf72,_0x23c241=authService['isAuthenticated'](),_0x14bf79=webrtcService['getActiveSessions'](),_0x5436f4=webrtcService[_0x9d480c(0x1d3)](),_0x4353b2=topicManager['getStatistics']();_0x1a1461[_0x9d480c(0x288)]({'status':'ok','environment':process[_0x9d480c(0x1e2)][_0x9d480c(0x1d6)]||_0x9d480c(0x254),'backendUrl':config[_0x9d480c(0x1fa)],'rosbridgeUrl':config[_0x9d480c(0x264)][_0x9d480c(0x20a)],'proxyPort':port,'authenticated':_0x23c241,'topicManagement':{'discovered':_0x4353b2[_0x9d480c(0x252)],'strategies':_0x4353b2[_0x9d480c(0x1fb)],'largeDataTopics':_0x4353b2[_0x9d480c(0x268)][_0x9d480c(0x28f)],'largeTopicsList':_0x4353b2[_0x9d480c(0x268)]},'webrtc':{'activeSessions':_0x14bf79['length'],'sharedVideoSources':_0x5436f4[_0x9d480c(0x28f)],'sessions':_0x14bf79,'sharedSources':_0x5436f4}});});const getInitialPort=()=>{const _0x3d1762=a1_0x1fdf72;if(process[_0x3d1762(0x1e2)][_0x3d1762(0x21b)])return parseInt(process[_0x3d1762(0x1e2)][_0x3d1762(0x21b)],0xa);return config['rosbridge']['proxyPort'];};function a1_0x2473(){const _0x3e331d=['username','Server\x20connection\x20error:','json','Connected\x20to\x20server','warn','connection','stringify','getAttribute','APP_USERNAME','length','base64','Bearer\x20','sample_skip','getSharedVideoSources','Failed\x20to\x20connect\x20to\x20ROSBridge\x20(WebRTC):','(((.+)+)+)+$','NODE_ENV','Disconnected\x20from\x20server\x20(','.stl','includes','[URDF\x20REWRITE]\x20Rewrote\x20','header','10261517onHZeZ','/appliance/register','13989123OExjMK','8258490zDCgct','[URDF]\x20Failed\x20to\x20rewrite\x20mesh\x20URIs:','code','env','Appliance\x20server\x20started\x20successfully\x20on\x20port\x20','replace','config','filename','search','Robot\x20not\x20found\x20on\x20server.\x20Deleting\x20local\x20identity\x20and\x20re-registering.','Connected\x20to\x20ROSBridge\x20(main)','stopAllSessions','listen','request_id','\x20->\x20','Failed\x20to\x20connect\x20to\x20server:','/robot_description','ROSBridge\x20WebSocket\x20URL:\x20','Successfully\x20logged\x20in','initialize','registration_token','roslib','Access-Control-Allow-Headers','sendStatus','parse','match','unlinkSync','serverUrl','strategies','1942962ZGmdqx','login','Failed\x20to\x20get\x20registration\x20token\x20or\x20robot\x20id\x20from\x20server','APPLIANCE_BASE_URL','path','log','EADDRINUSE','use','Access-Control-Allow-Origin','[URDF\x20REWRITE]\x20No\x20mesh\x20references\x20found\x20in\x20URDF','writeFileSync','service_response','OPEN','catch','wsEndpoint','Access-Control-Allow-Methods','\x0aAPP_PASSWORD=','),\x20attempting\x20to\x20reconnect...','Topic\x20discovery\x20failed:','Disconnected\x20from\x20ROSBridge\x20(main),\x20attempting\x20to\x20reconnect...','topics','\x20attempts\x20starting\x20from\x20','join','samplingRate','data','No\x20appliance\x20identity\x20found.\x20Registering\x20as\x20new.','robot\x20not\x20found','getToken','[URDF\x20PARAM]\x20Fetching\x20URDF\x20from\x20parameter:\x20','some','credentials','PORT','http','registrationToken','Registering\x20with\x20server...','OPTIONS','1224436FIfjtn','close','estimatedSize','Failed\x20to\x20start\x20application:','APP_USERNAME=','./services/auth','[TopicManager]\x20Enhanced\x20topics\x20response\x20sent\x20to\x20client','Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,\x20Authorization','./services/webrtcService','password','.dae','setAttribute','discoverTopics','Environment:\x20','\x20of\x20','Ros','Proxy\x20listening\x20on\x20port:\x20','map','[TopicManager]\x20Enhancing\x20topics\x20response\x20with\x20throttling\x20metadata','error','robotId','open','ros2\x20pkg\x20prefix\x20','action','toLowerCase','8XtMlHB','values','msg','existsSync','Connected\x20to\x20ROSBridge\x20(WebRTC)','constructor','Loaded\x20appliance\x20identity:','Authentication\x20required','Login\x20failed.\x20Please\x20enter\x20credentials\x20again.','./services/TopicManager','slice','[URDF\x20PARAM]\x20Successfully\x20served\x20URDF\x20parameter:\x20','Registration\x20token\x20not\x20found.\x20Please\x20register\x20this\x20appliance\x20first.','parseFromString','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','startsWith','trim','ros2\x20param\x20get\x20','Failed\x20to\x20ping\x20server:','ROSBridge\x20(main)\x20connection\x20error:','topic','readFileSync','uri','/health','service','totalTopics','handleMessage','development','getTopicStrategy','package://','types','ROSBridge\x20(WebRTC)\x20connection\x20error:','endsWith','axios','readyState','\x20in\x20use,\x20trying\x20next\x20port...','publish','\x20mesh\x20references\x20in\x20URDF\x20(WebSocket)','.ply','3CRayPW','child_process','webrtc_skip','toString','rosbridge','string','loadConfig','.mesh','largeDataTopics','throttling','Enter\x20password:\x20','Appliance\x20is\x20running\x20and\x20authenticated!','Attempting\x20to\x20login\x20to:','type','Failed\x20to\x20bind\x20to\x20a\x20port\x20after\x20','message','status','569388yXIRZh','Port\x20','/rosbridge?type=appliance&token=','get','substring','send','mesh','unknown','Failed\x20to\x20register\x20with\x20server:','strategy','application/json','mesh_data','utf8','.appliance.json','post','APP_PASSWORD','xmldom','param_name','2946140cEWIur','Disconnected\x20from\x20ROSBridge\x20(WebRTC),\x20attempting\x20to\x20reconnect...','[MESH]\x20Successfully\x20served\x20mesh:\x20'];a1_0x2473=function(){return _0x3e331d;};return a1_0x2473();}async function listenWithRetries(_0x1d2a6d,_0x273783,_0x28c647=0xa){const _0x31d1b1=a1_0x1fdf72;let _0x294b6e=_0x273783;for(let _0x35345f=0x1;_0x35345f<=_0x28c647;_0x35345f++){try{return await new Promise((_0x5e54db,_0x2410c1)=>{const _0x4f7833=a1_0x43c3,_0x1fc41e=_0x1d2a6d[_0x4f7833(0x1eb)](_0x294b6e,()=>{const _0x573481=_0x4f7833;console[_0x573481(0x201)](_0x573481(0x1e3)+_0x294b6e),_0x5e54db(_0x1fc41e);});_0x1fc41e['on'](_0x4f7833(0x233),_0x5cbcc5=>{const _0x9aee9e=_0x4f7833;_0x5cbcc5[_0x9aee9e(0x1e1)]===_0x9aee9e(0x202)?(console[_0x9aee9e(0x28a)](_0x9aee9e(0x272)+_0x294b6e+_0x9aee9e(0x25c)),_0x2410c1(_0x5cbcc5)):_0x2410c1(_0x5cbcc5);});}),_0x294b6e;}catch(_0x2fc1e2){_0x294b6e++;}}throw new Error(_0x31d1b1(0x26e)+_0x28c647+_0x31d1b1(0x211)+_0x273783);}const startApp=async()=>{const _0x4a2763=a1_0x1fdf72;try{let _0xf74808=await authService['login']();while(!_0xf74808){console[_0x4a2763(0x201)](_0x4a2763(0x241)),await promptForCredentials(),_0xf74808=await authService[_0x4a2763(0x1fd)]();}console['log'](_0x4a2763(0x1f1));!loadApplianceIdentity()&&console[_0x4a2763(0x201)](_0x4a2763(0x215));console[_0x4a2763(0x201)](_0x4a2763(0x21e));const _0x4ba520=await registerWithServer();if(!_0x4ba520)throw new Error('Failed\x20to\x20register\x20with\x20server');connectToRosbridge(),connectToServer();const _0x505046=getInitialPort();await listenWithRetries(app,_0x505046,0xa);}catch(_0x1f79cc){console['error'](_0x4a2763(0x223),_0x1f79cc),process['exit'](0x1);}};setInterval(async()=>{const _0x2d9c05=a1_0x1fdf72;try{if(robotId){const _0x413dcf=authService[_0x2d9c05(0x217)]();await axios[_0x2d9c05(0x27f)](config[_0x2d9c05(0x1fa)]+'/appliance/ping',{'robotId':robotId},{'headers':{'Authorization':'Bearer\x20'+_0x413dcf,'Content-Type':_0x2d9c05(0x27b)}});}}catch(_0xa9c87c){console[_0x2d9c05(0x233)](_0x2d9c05(0x24b),_0xa9c87c['message']);}},0x1388),startApp();